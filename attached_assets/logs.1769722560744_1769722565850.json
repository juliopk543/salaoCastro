[{"message":"Starting Container","attributes":{"level":"info"},"tags":{"project":"29c6c2c4-ea10-4fe6-8901-1198a13520db","environment":"9a47f9fb-0d50-4031-a85e-16db1d46fb86","service":"09a1965e-88d6-44ee-9836-14176d4bb0b5","deployment":"e78c90dd-bc00-48f5-9312-8a8fa977b2c2","replica":"68b779c1-91b1-4ca6-88f4-a907899be5f1"},"timestamp":"2026-01-29T21:34:42.000000000Z"},{"message":"Thu, 29 Jan 2026 21:34:43 GMT express-session deprecated req.secret; provide secret option at node:internal/modules/cjs/loader:1706:14","attributes":{"level":"error"},"tags":{"project":"29c6c2c4-ea10-4fe6-8901-1198a13520db","environment":"9a47f9fb-0d50-4031-a85e-16db1d46fb86","service":"09a1965e-88d6-44ee-9836-14176d4bb0b5","deployment":"e78c90dd-bc00-48f5-9312-8a8fa977b2c2","replica":"68b779c1-91b1-4ca6-88f4-a907899be5f1"},"timestamp":"2026-01-29T21:34:44.354671859Z"},{"message":"/app/dist/index.cjs:71","attributes":{"level":"error"},"tags":{"project":"29c6c2c4-ea10-4fe6-8901-1198a13520db","environment":"9a47f9fb-0d50-4031-a85e-16db1d46fb86","service":"09a1965e-88d6-44ee-9836-14176d4bb0b5","deployment":"e78c90dd-bc00-48f5-9312-8a8fa977b2c2","replica":"68b779c1-91b1-4ca6-88f4-a907899be5f1"},"timestamp":"2026-01-29T21:34:44.354678787Z"},{"message":"\t\t`;await r.execute(g`CREATE SCHEMA IF NOT EXISTS ${g.identifier(a)}`),await r.execute(s);let u=(await r.all(g`select id, hash, created_at from ${g.identifier(a)}.${g.identifier(i)} order by created_at desc limit 1`))[0];await r.transaction(async c=>{for await(let l of e)if(!u||Number(u.created_at)<l.folderMillis){for(let p of l.sql)await c.execute(g.raw(p));await c.execute(g`insert into ${g.identifier(a)}.${g.identifier(i)} (\"hash\", \"created_at\") values(${l.hash}, ${l.folderMillis})`)}})}escapeName(e){return`\"${e}\"`}escapeParam(e){return`$${e+1}`}escapeString(e){return`'${e.replace(/'/g,\"''\")}'`}buildWithCTE(e){if(!e?.length)return;let r=[g`with `];for(let[n,i]of e.entries())r.push(g`${g.identifier(i._.alias)} as (${i._.sql})`),n<e.length-1&&r.push(g`, `);return r.push(g` `),g.join(r)}buildDeleteQuery({table:e,where:r,returning:n,withList:i}){let a=this.buildWithCTE(i),s=n?g` returning ${this.buildSelection(n,{isSingleTable:!0})}`:void 0,o=r?g` where ${r}`:void 0;return g`${a}delete from ${e}${o}${s}`}buildUpdateSet(e,r){let n=e[A.Symbol.Columns],i=Object.keys(n).filter(s=>r[s]!==void 0||n[s]?.onUpdateFn!==void 0),a=i.length;return g.join(i.flatMap((s,o)=>{let u=n[s],c=r[s]??g.param(u.onUpdateFn(),u),l=g`${g.identifier(this.casing.getColumnCasing(u))} = ${c}`;return o<a-1?[l,g.raw(\", \")]:[l]}))}buildUpdateQuery({table:e,set:r,where:n,returning:i,withList:a,from:s,joins:o}){let u=this.buildWithCTE(a),c=e[Te.Symbol.Name],l=e[Te.Symbol.Schema],p=e[Te.Symbol.OriginalName],d=c===p?void 0:c,f=g`${l?g`${g.identifier(l)}.`:void 0}${g.identifier(p)}${d&&g` ${g.identifier(d)}`}`,y=this.buildUpdateSet(e,r),m=s&&g.join([g.raw(\" from \"),this.buildFromTable(s)]),x=this.buildJoins(o),w=i?g` returning ${this.buildSelection(i,{isSingleTable:!s})}`:void 0,T=n?g` where ${n}`:void 0;return g`${u}update ${f} set ${y}${m}${x}${T}${w}`}buildSelection(e,{isSingleTable:r=!1}={}){let n=e.length,i=e.flatMap(({field:a},s)=>{let o=[];if(b(a,O.Aliased)&&a.isSelectionField)o.push(g.identifier(a.fieldAlias));else if(b(a,O.Aliased)||b(a,O)){let u=b(a,O.Aliased)?a.sql:a;r?o.push(new O(u.queryChunks.map(c=>b(c,E)?g.identifier(this.casing.getColumnCasing(c)):c))):o.push(u),b(a,O.Aliased)&&o.push(g` as ${g.identifier(a.fieldAlias)}`)}else b(a,J)&&(r?o.push(g.identifier(this.casing.getColumnCasing(a))):o.push(a));return s<n-1&&o.push(g`, `),o});return g.join(i)}buildJoins(e){if(!e||e.length===0)return;let r=[];for(let[n,i]of e.entries()){n===0&&r.push(g` `);let a=i.table,s=i.lateral?g` lateral`:void 0;if(b(a,Te)){let o=a[Te.Symbol.Name],u=a[Te.Symbol.Schema],c=a[Te.Symbol.OriginalName],l=o===c?void 0:i.alias;r.push(g`${g.raw(i.joinType)} join${s} ${u?g`${g.identifier(u)}.`:void 0}${g.identifier(c)}${l&&g` ${g.identifier(l)}`} on ${i.on}`)}else if(b(a,Ue)){let o=a[te].name,u=a[te].schema,c=a[te].originalName,l=o===c?void 0:i.alias;r.push(g`${g.raw(i.joinType)} join${s} ${u?g`${g.identifier(u)}.`:void 0}${g.identifier(c)}${l&&g` ${g.identifier(l)}`} on ${i.on}`)}else r.push(g`${g.raw(i.joinType)} join${s} ${a} on ${i.on}`);n<e.length-1&&r.push(g` `)}return g.join(r)}buildFromTable(e){if(b(e,A)&&e[A.Symbol.OriginalName]!==e[A.Symbol.Name]){let r=g`${g.identifier(e[A.Symbol.OriginalName])}`;return e[A.Symbol.Schema]&&(r=g`${g.identifier(e[A.Symbol.Schema])}.${r}`),g`${r} ${g.identifier(e[A.Symbol.Name])}`}return e}buildSelectQuery({withList:e,fields:r,fieldsFlat:n,where:i,having:a,table:s,joins:o,orderBy:u,groupBy:c,limit:l,offset:p,lockingClause:d,distinct:f,setOperators:y}){let m=n??gt(r);for(let ne of m)if(b(ne.field,J)&&We(ne.field.table)!==(b(s,ye)?s._.alias:b(s,oi)?s[te].name:b(s,O)?void 0:We(s))&&!(he=>o?.some(({alias:et})=>et===(he[A.Symbol.IsAlias]?We(he):he[A.Symbol.BaseName])))(ne.field.table)){let he=We(ne.field.table);throw new Error(`Your \"${ne.path.join(\"->\")}\" field references a column \"${he}\".\"${ne.field.name}\", but the table \"${he}\" is not part of the query! Did you forget to join it?`)}let x=!o||o.length===0,w=this.buildWithCTE(e),T;f&&(T=f===!0?g` distinct`:g` distinct on (${g.join(f.on,g`, `)})`);let S=this.buildSelection(m,{isSingleTable:x}),C=this.buildFromTable(s),L=this.buildJoins(o),j=i?g` where ${i}`:void 0,R=a?g` having ${a}`:void 0,N;u&&u.length>0&&(N=g` order by ${g.join(u,g`, `)}`);let Q;c&&c.length>0&&(Q=g` group by ${g.join(c,g`, `)}`);let fe=typeof l==\"object\"||typeof l==\"number\"&&l>=0?g` limit ${l}`:void 0,_t=p?g` offset ${p}`:void 0,qe=g.empty();if(d){let ne=g` for ${g.raw(d.strength)}`;d.config.of&&ne.append(g` of ${g.join(Array.isArray(d.config.of)?d.config.of:[d.config.of],g`, `)}`),d.config.noWait?ne.append(g` no wait`):d.config.skipLocked&&ne.append(g` skip locked`),qe.append(ne)}let se=g`${w}select${T} ${S} from ${C}${L}${j}${Q}${R}${N}${fe}${_t}${qe}`;return y.length>0?this.buildSetOperations(se,y):se}buildSetOperations(e,r){let[n,...i]=r;if(!n)throw new Error(\"Cannot pass undefined values to any set operator\");return i.length===0?this.buildSetOperationQuery({leftSelect:e,setOperator:n}):this.buildSetOperations(this.buildSetOperationQuery({leftSelect:e,setOperator:n}),i)}buildSetOperationQuery({leftSelect:e,setOperator:{type:r,isAll:n,rightSelect:i,limit:a,orderBy:s,offset:o}}){let u=g`(${e.getSQL()}) `,c=g`(${i.getSQL()})`,l;if(s&&s.length>0){let y=[];for(let m of s)if(b(m,E))y.push(g.identifier(m.name));else if(b(m,O)){for(let x=0;x<m.queryChunks.length;x++){let w=m.queryChunks[x];b(w,E)&&(m.queryChunks[x]=g.identifier(w.name))}y.push(g`${m}`)}else y.push(g`${m}`);l=g` order by ${g.join(y,g`, `)} `}let p=typeof a==\"object\"||typeof a==\"number\"&&a>=0?g` limit ${a}`:void 0,d=g.raw(`${r} ${n?\"all \":\"\"}`),f=o?g` offset ${o}`:void 0;return g`${u}${d}${c}${l}${p}${f}`}buildInsertQuery({table:e,values:r,onConflict:n,returning:i,withList:a,select:s,overridingSystemValue_:o}){let u=[],c=e[A.Symbol.Columns],l=Object.entries(c).filter(([w,T])=>!T.shouldDisableInsert()),p=l.map(([,w])=>g.identifier(this.casing.getColumnCasing(w)));if(s){let w=r;b(w,O)?u.push(w):u.push(w.getSQL())}else{let w=r;u.push(g.raw(\"values \"));for(let[T,S]of w.entries()){let C=[];for(let[L,j]of l){let R=S[L];if(R===void 0||b(R,Ge)&&R.value===void 0)if(j.defaultFn!==void 0){let N=j.defaultFn(),Q=b(N,O)?N:g.param(N,j);C.push(Q)}else if(!j.default&&j.onUpdateFn!==void 0){let N=j.onUpdateFn(),Q=b(N,O)?N:g.param(N,j);C.push(Q)}else C.push(g`default`);else C.push(R)}u.push(C),T<w.length-1&&u.push(g`, `)}}let d=this.buildWithCTE(a),f=g.join(u),y=i?g` returning ${this.buildSelection(i,{isSingleTable:!0})}`:void 0,m=n?g` on conflict ${n}`:void 0,x=o===!0?g`overriding system value `:void 0;return g`${d}insert into ${e} ${p} ${x}${f}${m}${y}`}buildRefreshMaterializedViewQuery({view:e,concurrently:r,withNoData:n}){let i=r?g` concurrently`:void 0,a=n?g` with no data`:void 0;return g`refresh materialized view${i} ${e}${a}`}prepareTyping(e){return b(e,Sa)||b(e,_a)?\"json\":b(e,Ea)?\"decimal\":b(e,Ta)?\"time\":b(e,ka)||b(e,Aa)?\"timestamp\":b(e,ba)||b(e,wa)?\"date\":b(e,Ca)?\"uuid\":\"none\"}sqlToQuery(e,r){return e.toQuery({casing:this.casing,escapeName:this.escapeName,escapeParam:this.escapeParam,escapeString:this.escapeString,prepareTyping:this.prepareTyping,invokeSource:r})}buildRelationalQueryWithoutPK({fullSchema:e,schema:r,tableNamesMap:n,table:i,tableConfig:a,queryConfig:s,tableAlias:o,nestedQueryRelation:u,joinOn:c}){let l=[],p,d,f=[],y,m=[];if(s===!0)l=Object.entries(a.columns).map(([T,S])=>({dbKey:S.name,tsKey:T,field:Dt(S,o),relationTableTsKey:void 0,isJson:!1,selection:[]}));else{let w=Object.fromEntries(Object.entries(a.columns).map(([R,N])=>[R,Dt(N,o)]));if(s.where){let R=typeof s.where==\"function\"?s.where(w,F_()):s.where;y=R&&ga(R,o)}let T=[],S=[];if(s.columns){let R=!1;for(let[N,Q]of Object.entries(s.columns))Q!==void 0&&N in a.columns&&(!R&&Q===!0&&(R=!0),S.push(N));S.length>0&&(S=R?S.filter(N=>s.columns?.[N]===!0):Object.keys(a.columns).filter(N=>!S.includes(N)))}else S=Object.keys(a.columns);for(let R of S){let N=a.columns[R];T.push({tsKey:R,value:N})}let C=[];s.with&&(C=Object.entries(s.with).filter(R=>!!R[1]).map(([R,N])=>({tsKey:R,queryConfig:N,relation:a.relations[R]})));let L;if(s.extras){L=typeof s.extras==\"function\"?s.extras(w,{sql:g}):s.extras;for(let[R,N]of Object.entries(L))T.push({tsKey:R,value:pd(N,o)})}for(let{tsKey:R,value:N}of T)l.push({dbKey:b(N,O.Aliased)?N.fieldAlias:a.columns[R].name,tsKey:R,field:b(N,J)?Dt(N,o):N,relationTableTsKey:void 0,isJson:!1,selection:[]});let j=typeof s.orderBy==\"function\"?s.orderBy(w,$_()):s.orderBy??[];Array.isArray(j)||(j=[j]),f=j.map(R=>b(R,J)?Dt(R,o):ga(R,o)),p=s.limit,d=s.offset;for(let{tsKey:R,queryConfig:N,relation:Q}of C){let fe=B_(r,n,Q),_t=Hr(Q.referencedTable),qe=n[_t],se=`${o}_${R}`,ne=Pa(...fe.fields.map((Ht,qi)=>kt(Dt(fe.references[qi],se),Dt(Ht,o)))),he=this.buildRelationalQueryWithoutPK({fullSchema:e,schema:r,tableNamesMap:n,table:e[qe],tableConfig:r[qe],queryConfig:b(Q,xr)?N===!0?{limit:1}:{...N,limit:1}:N,tableAlias:se,joinOn:ne,nestedQueryRelation:Q}),et=g`${g.identifier(se)}.${g.identifier(\"data\")}`.as(R);m.push({on:g`true`,table:new ye(he.sql,{},se),alias:se,joinType:\"left\",lateral:!0}),l.push({dbKey:R,tsKey:R,field:et,relationTableTsKey:qe,isJson:!0,selection:he.selection})}}if(l.length===0)throw new xa({message:`No fields selected for table \"${a.tsName}\" (\"${o}\")`});let x;if(y=Pa(c,y),u){let w=g`json_build_array(${g.join(l.map(({field:C,tsKey:L,isJson:j})=>j?g`${g.identifier(`${o}_${L}`)}.${g.identifier(\"data\")}`:b(C,O.Aliased)?C.sql:C),g`, `)})`;b(u,Oa)&&(w=g`coalesce(json_agg(${w}${f.length>0?g` order by ${g.join(f,g`, `)}`:void 0}), '[]'::json)`);let T=[{dbKey:\"data\",tsKey:\"data\",field:w.as(\"data\"),isJson:!0,relationTableTsKey:a.tsName,selection:l}];p!==void 0||d!==void 0||f.length>0?(x=this.buildSelectQuery({table:ma(i,o),fields:{},fieldsFlat:[{path:[],field:g.raw(\"*\")}],where:y,limit:p,offset:d,orderBy:f,setOperators:[]}),y=void 0,p=void 0,d=void 0,f=[]):x=ma(i,o),x=this.buildSelectQuery({table:b(x,Te)?x:new ye(x,{},o),fields:{},fieldsFlat:T.map(({field:C})=>({path:[],field:b(C,J)?Dt(C,o):C})),joins:m,where:y,limit:p,offset:d,orderBy:f,setOperators:[]})}else x=this.buildSelectQuery({table:ma(i,o),fields:{},fieldsFlat:l.map(({field:w})=>({path:[],field:b(w,J)?Dt(w,o):w})),joins:m,where:y,limit:p,offset:d,orderBy:f,setOperators:[]});return{tableTsKey:a.tsName,sql:x,selection:l}}};var zo=class{static[h]=\"TypedQueryBuilder\";getSelectedFields(){return this._.selectedFields}};var De=class{static[h]=\"PgSelectBuilder\";fields;session;dialect;withList=[];distinct;constructor(e){this.fields=e.fields,this.session=e.session,this.dialect=e.dialect,e.withList&&(this.withList=e.withList),this.distinct=e.distinct}authToken;setToken(e){return this.authToken=e,this}from(e){let r=!!this.fields,n=e,i;return this.fields?i=this.fields:b(n,ye)?i=Object.fromEntries(Object.keys(n._.selectedFields).map(a=>[a,n[a]])):b(n,oi)?i=n[te].selectedFields:b(n,O)?i={}:i=qo(n),new Ho({table:n,fields:i,isPartialSelect:r,session:this.session,dialect:this.dialect,withList:this.withList,distinct:this.distinct}).setToken(this.authToken)}},If=class extends zo{static[h]=\"PgSelectQueryBuilder\";_;config;joinsNotNullableMap;tableName;isPartialSelect;session;dialect;constructor({table:e,fields:r,isPartialSelect:n,session:i,dialect:a,withList:s,distinct:o}){super(),this.config={withList:s,table:e,fields:{...r},distinct:o,setOperators:[]},this.isPartialSelect=n,this.session=i,this.dialect=a,this._={selectedFields:r},this.tableName=er(e),this.joinsNotNullableMap=typeof this.tableName==\"string\"?{[this.tableName]:!0}:{}}createJoin(e){return(r,n)=>{let i=this.tableName,a=er(r);if(typeof a==\"string\"&&this.config.joins?.some(s=>s.alias===a))throw new Error(`Alias \"${a}\" is already used in this query`);if(!this.isPartialSelect&&(Object.keys(this.joinsNotNullableMap).length===1&&typeof i==\"string\"&&(this.config.fields={[i]:this.config.fields}),typeof a==\"string\"&&!b(r,O))){let s=b(r,ye)?r._.selectedFields:b(r,Ue)?r[te].selectedFields:r[A.Symbol.Columns];this.config.fields[a]=s}if(typeof n==\"function\"&&(n=n(new Proxy(this.config.fields,new de({sqlAliasedBehavior:\"sql\",sqlBehavior:\"sql\"})))),this.config.joins||(this.config.joins=[]),this.config.joins.push({on:n,table:r,joinType:e,alias:a}),typeof a==\"string\")switch(e){case\"left\":{this.joinsNotNullableMap[a]=!1;break}case\"right\":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([s])=>[s,!1])),this.joinsNotNullableMap[a]=!0;break}case\"inner\":{this.joinsNotNullableMap[a]=!0;break}case\"full\":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([s])=>[s,!1])),this.joinsNotNullableMap[a]=!1;break}}return this}}leftJoin=this.createJoin(\"left\");rightJoin=this.createJoin(\"right\");innerJoin=this.createJoin(\"inner\");fullJoin=this.createJoin(\"full\");createSetOperator(e,r){return n=>{let i=typeof n==\"function\"?n(MI()):n;if(!va(this.getSelectedFields(),i.getSelectedFields()))throw new Error(\"Set operator error (union / intersect / except): selected fields are not the same or are in a different order\");return this.config.setOperators.push({type:e,isAll:r,rightSelect:i}),this}}union=this.createSetOperator(\"union\",!1);unionAll=this.createSetOperator(\"union\",!0);intersect=this.createSetOperator(\"intersect\",!1);intersectAll=this.createSetOperator(\"intersect\",!0);except=this.createSetOperator(\"except\",!1);exceptAll=this.createSetOperator(\"except\",!0);addSetOperators(e){return this.config.setOperators.push(...e),this}where(e){return typeof e==\"function\"&&(e=e(new Proxy(this.config.fields,new de({sqlAliasedBehavior:\"sql\",sqlBehavior:\"sql\"})))),this.config.where=e,this}having(e){return typeof e==\"function\"&&(e=e(new Proxy(this.config.fields,new de({sqlAliasedBehavior:\"sql\",sqlBehavior:\"sql\"})))),this.config.having=e,this}groupBy(...e){if(typeof e[0]==\"function\"){let r=e[0](new Proxy(this.config.fields,new de({sqlAliasedBehavior:\"alias\",sqlBehavior:\"sql\"})));this.config.groupBy=Array.isArray(r)?r:[r]}else this.config.groupBy=e;return this}orderBy(...e){if(typeof e[0]==\"function\"){let r=e[0](new Proxy(this.config.fields,new de({sqlAliasedBehavior:\"alias\",sqlBehavior:\"sql\"}))),n=Array.isArray(r)?r:[r];this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=n:this.config.orderBy=n}else{let r=e;this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=r:this.config.orderBy=r}return this}limit(e){return this.config.setOperators.length>0?this.config.setOperators.at(-1).limit=e:this.config.limit=e,this}offset(e){return this.config.setOperators.length>0?this.config.setOperators.at(-1).offset=e:this.config.offset=e,this}for(e,r={}){return this.config.lockingClause={strength:e,config:r},this}getSQL(){return this.dialect.buildSelectQuery(this.config)}toSQL(){let{typings:e,...r}=this.dialect.sqlToQuery(this.getSQL());return r}as(e){return new Proxy(new ye(this.getSQL(),this.config.fields,e),new de({alias:e,sqlAliasedBehavior:\"alias\",sqlBehavior:\"error\"}))}getSelectedFields(){return new Proxy(this.config.fields,new de({alias:this.tableName,sqlAliasedBehavior:\"alias\",sqlBehavior:\"error\"}))}$dynamic(){return this}},Ho=class extends If{static[h]=\"PgSelect\";_prepare(e){let{session:r,config:n,dialect:i,joinsNotNullableMap:a,authToken:s}=this;if(!r)throw new Error(\"Cannot execute a query on a query builder. Please use a database instance instead.\");return ee.startActiveSpan(\"drizzle.prepareQuery\",()=>{let o=gt(n.fields),u=r.prepareQuery(i.sqlToQuery(this.getSQL()),o,e,!0);return u.joinsNotNullableMap=a,u.setToken(s)})}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>ee.startActiveSpan(\"drizzle.operation\",()=>this._prepare().execute(e,this.authToken))};$1(Ho,[je]);function ci(t,e){return(r,n,...i)=>{let a=[n,...i].map(s=>({type:t,isAll:e,rightSelect:s}));for(let s of a)if(!va(r.getSelectedFields(),s.rightSelect.getSelectedFields()))throw new Error(\"Set operator error (union / intersect / except): selected fields are not the same or are in a different order\");return r.addSetOperators(a)}}var MI=()=>({union:FI,unionAll:$I,intersect:UI,intersectAll:BI,except:zI,exceptAll:HI}),FI=ci(\"union\",!1),$I=ci(\"union\",!0),UI=ci(\"intersect\",!1),BI=ci(\"intersect\",!0),zI=ci(\"except\",!1),HI=ci(\"except\",!0);var ui=class{static[h]=\"PgQueryBuilder\";dialect;dialectConfig;constructor(e){this.dialect=b(e,br)?e:void 0,this.dialectConfig=b(e,br)?void 0:e}$with=(e,r)=>{let n=this;return{as:a=>(typeof a==\"function\"&&(a=a(n)),new Proxy(new ni(a.getSQL(),r??(\"getSelectedFields\"in a?a.getSelectedFields()??{}:{}),e,!0),new de({alias:e,sqlAliasedBehavior:\"alias\",sqlBehavior:\"error\"})))}};with(...e){let r=this;function n(s){return new De({fields:s??void 0,session:void 0,dialect:r.getDialect(),withList:e})}function i(s){return new De({fields:s??void 0,session:void 0,dialect:r.getDialect(),distinct:!0})}function a(s,o){return new De({fields:o??void 0,session:void 0,dialect:r.getDialect(),distinct:{on:s}})}return{select:n,selectDistinct:i,selectDistinctOn:a}}select(e){return new De({fields:e??void 0,session:void 0,dialect:this.getDialect()})}selectDistinct(e){return new De({fields:e??void 0,session:void 0,dialect:this.getDialect(),distinct:!0})}selectDistinctOn(e,r){return new De({fields:r??void 0,session:void 0,dialect:this.getDialect(),distinct:{on:e}})}getDialect(){return this.dialect||(this.dialect=new br(this.dialectConfig)),this.dialect}};var Ra=class{constructor(e,r,n,i,a){this.table=e,this.session=r,this.dialect=n,this.withList=i,this.overridingSystemValue_=a}static[h]=\"PgInsertBuilder\";authToken;setToken(e){return this.authToken=e,this}overridingSystemValue(){return this.overridingSystemValue_=!0,this}values(e){if(e=Array.isArray(e)?e:[e],e.length===0)throw new Error(\"values() must be called with at least one value\");let r=e.map(n=>{let i={},a=this.table[A.Symbol.Columns];for(let s of Object.keys(n)){let o=n[s];i[s]=b(o,O)?o:new Ge(o,a[s])}return i});return new Qo(this.table,r,this.session,this.dialect,this.withList,!1,this.overridingSystemValue_).setToken(this.authToken)}select(e){let r=typeof e==\"function\"?e(new ui):e;if(!b(r,O)&&!va(this.table[Io],r._.selectedFields))throw new Error(\"Insert select error: selected fields are not the same or are in a different order compared to the table definition\");return new Qo(this.table,r,this.session,this.dialect,this.withList,!0)}},Qo=class extends je{constructor(e,r,n,i,a,s,o){super(),this.session=n,this.dialect=i,this.config={table:e,values:r,withList:a,select:s,overridingSystemValue_:o}}static[h]=\"PgInsert\";config;returning(e=this.config.table[A.Symbol.Columns]){return this.config.returningFields=e,this.config.returning=gt(e),this}onConflictDoNothing(e={}){if(e.target===void 0)this.config.onConflict=g`do nothing`;else{let r=\"\";r=Array.isArray(e.target)?e.target.map(i=>this.dialect.escapeName(this.dialect.casing.getColumnCasing(i))).join(\",\"):this.dialect.escapeName(this.dialect.casing.getColumnCasing(e.target));let n=e.where?g` where ${e.where}`:void 0;this.config.onConflict=g`(${g.raw(r)})${n} do nothing`}return this}onConflictDoUpdate(e){if(e.where&&(e.targetWhere||e.setWhere))throw new Error('You cannot use both \"where\" and \"targetWhere\"/\"setWhere\" at the same time - \"where\" is deprecated, use \"targetWhere\" or \"setWhere\" instead.');let r=e.where?g` where ${e.where}`:void 0,n=e.targetWhere?g` where ${e.targetWhere}`:void 0,i=e.setWhere?g` where ${e.setWhere}`:void 0,a=this.dialect.buildUpdateSet(this.config.table,No(this.config.table,e.set)),s=\"\";return s=Array.isArray(e.target)?e.target.map(o=>this.dialect.escapeName(this.dialect.casing.getColumnCasing(o))).join(\",\"):this.dialect.escapeName(this.dialect.casing.getColumnCasing(e.target)),this.config.onConflict=g`(${g.raw(s)})${n} do update set ${a}${r}${i}`,this}getSQL(){return this.dialect.buildInsertQuery(this.config)}toSQL(){let{typings:e,...r}=this.dialect.sqlToQuery(this.getSQL());return r}_prepare(e){return ee.startActiveSpan(\"drizzle.prepareQuery\",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,e,!0))}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>ee.startActiveSpan(\"drizzle.operation\",()=>this._prepare().execute(e,this.authToken));getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new de({alias:We(this.config.table),sqlAliasedBehavior:\"alias\",sqlBehavior:\"error\"})):void 0}$dynamic(){return this}};var Vo=class extends je{constructor(e,r,n){super(),this.session=r,this.dialect=n,this.config={view:e}}static[h]=\"PgRefreshMaterializedView\";config;concurrently(){if(this.config.withNoData!==void 0)throw new Error(\"Cannot use concurrently and withNoData together\");return this.config.concurrently=!0,this}withNoData(){if(this.config.concurrently!==void 0)throw new Error(\"Cannot use concurrently and withNoData together\");return this.config.withNoData=!0,this}getSQL(){return this.dialect.buildRefreshMaterializedViewQuery(this.config)}toSQL(){let{typings:e,...r}=this.dialect.sqlToQuery(this.getSQL());return r}_prepare(e){return ee.startActiveSpan(\"drizzle.prepareQuery\",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),void 0,e,!0))}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>ee.startActiveSpan(\"drizzle.operation\",()=>this._prepare().execute(e,this.authToken))};var Ia=class{constructor(e,r,n,i){this.table=e,this.session=r,this.dialect=n,this.withList=i}static[h]=\"PgUpdateBuilder\";authToken;setToken(e){return this.authToken=e,this}set(e){return new Nf(this.table,No(this.table,e),this.session,this.dialect,this.withList).setToken(this.authToken)}},Nf=class extends je{constructor(e,r,n,i,a){super(),this.session=n,this.dialect=i,this.config={set:r,table:e,withList:a,joins:[]},this.tableName=er(e),this.joinsNotNullableMap=typeof this.tableName==\"string\"?{[this.tableName]:!0}:{}}static[h]=\"PgUpdate\";config;tableName;joinsNotNullableMap;from(e){let r=e,n=er(r);return typeof n==\"string\"&&(this.joinsNotNullableMap[n]=!0),this.config.from=r,this}getTableLikeFields(e){return b(e,Te)?e[A.Symbol.Columns]:b(e,ye)?e._.selectedFields:e[te].selectedFields}createJoin(e){return(r,n)=>{let i=er(r);if(typeof i==\"string\"&&this.config.joins.some(a=>a.alias===i))throw new Error(`Alias \"${i}\" is already used in this query`);if(typeof n==\"function\"){let a=this.config.from&&!b(this.config.from,O)?this.getTableLikeFields(this.config.from):void 0;n=n(new Proxy(this.config.table[A.Symbol.Columns],new de({sqlAliasedBehavior:\"sql\",sqlBehavior:\"sql\"})),a&&new Proxy(a,new de({sqlAliasedBehavior:\"sql\",sqlBehavior:\"sql\"})))}if(this.config.joins.push({on:n,table:r,joinType:e,alias:i}),typeof i==\"string\")switch(e){case\"left\":{this.joinsNotNullableMap[i]=!1;break}case\"right\":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([a])=>[a,!1])),this.joinsNotNullableMap[i]=!0;break}case\"inner\":{this.joinsNotNullableMap[i]=!0;break}case\"full\":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([a])=>[a,!1])),this.joinsNotNullableMap[i]=!1;break}}return this}}leftJoin=this.createJoin(\"left\");rightJoin=this.createJoin(\"right\");innerJoin=this.createJoin(\"inner\");fullJoin=this.createJoin(\"full\");where(e){return this.config.where=e,this}returning(e){if(!e&&(e=Object.assign({},this.config.table[A.Symbol.Columns]),this.config.from)){let r=er(this.config.from);if(typeof r==\"string\"&&this.config.from&&!b(this.config.from,O)){let n=this.getTableLikeFields(this.config.from);e[r]=n}for(let n of this.config.joins){let i=er(n.table);if(typeof i==\"string\"&&!b(n.table,O)){let a=this.getTableLikeFields(n.table);e[i]=a}}}return this.config.returningFields=e,this.config.returning=gt(e),this}getSQL(){return this.dialect.buildUpdateQuery(this.config)}toSQL(){let{typings:e,...r}=this.dialect.sqlToQuery(this.getSQL());return r}_prepare(e){let r=this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,e,!0);return r.joinsNotNullableMap=this.joinsNotNullableMap,r}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>this._prepare().execute(e,this.authToken);getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new de({alias:We(this.config.table),sqlAliasedBehavior:\"alias\",sqlBehavior:\"error\"})):void 0}$dynamic(){return this}};var Ko=class t extends O{constructor(e){super(t.buildEmbeddedCount(e.source,e.filters).queryChunks),this.params=e,this.mapWith(Number),this.session=e.session,this.sql=t.buildCount(e.source,e.filters)}sql;token;static[h]=\"PgCountBuilder\";[Symbol.toStringTag]=\"PgCountBuilder\";session;static buildEmbeddedCount(e,r){return g`(select count(*) from ${e}${g.raw(\" where \").if(r)}${r})`}static buildCount(e,r){return g`select count(*) as count from ${e}${g.raw(\" where \").if(r)}${r};`}setToken(e){return this.token=e,this}then(e,r){return Promise.resolve(this.session.count(this.sql,this.token)).then(e,r)}catch(e){return this.then(void 0,e)}finally(e){return this.then(r=>(e?.(),r),r=>{throw e?.(),r})}};var Wo=class{constructor(e,r,n,i,a,s,o){this.fullSchema=e,this.schema=r,this.tableNamesMap=n,this.table=i,this.tableConfig=a,this.dialect=s,this.session=o}static[h]=\"PgRelationalQueryBuilder\";findMany(e){return new Go(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,e||{},\"many\")}findFirst(e){return new Go(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,e?{...e,limit:1}:{limit:1},\"first\")}},Go=class extends je{constructor(e,r,n,i,a,s,o,u,c){super(),this.fullSchema=e,this.schema=r,this.tableNamesMap=n,this.table=i,this.tableConfig=a,this.dialect=s,this.session=o,this.config=u,this.mode=c}static[h]=\"PgRelationalQuery\";_prepare(e){return ee.startActiveSpan(\"drizzle.prepareQuery\",()=>{let{query:r,builtQuery:n}=this._toSQL();return this.session.prepareQuery(n,void 0,e,!0,(i,a)=>{let s=i.map(o=>Bo(this.schema,this.tableConfig,o,r.selection,a));return this.mode===\"first\"?s[0]:s})})}prepare(e){return this._prepare(e)}_getQuery(){return this.dialect.buildRelationalQueryWithoutPK({fullSchema:this.fullSchema,schema:this.schema,tableNamesMap:this.tableNamesMap,table:this.table,tableConfig:this.tableConfig,queryConfig:this.config,tableAlias:this.tableConfig.tsName})}getSQL(){return this._getQuery().sql}_toSQL(){let e=this._getQuery(),r=this.dialect.sqlToQuery(e.sql);return{query:e,builtQuery:r}}toSQL(){return this._toSQL().builtQuery}authToken;setToken(e){return this.authToken=e,this}execute(){return ee.startActiveSpan(\"drizzle.operation\",()=>this._prepare().execute(void 0,this.authToken))}};var Jo=class extends je{constructor(e,r,n,i){super(),this.execute=e,this.sql=r,this.query=n,this.mapBatchResult=i}static[h]=\"PgRaw\";getSQL(){return this.sql}getQuery(){return this.query}mapResult(e,r){return r?this.mapBatchResult(e):e}_prepare(){return this}isResponseInArrayMode(){return!1}};var li=class{constructor(e,r,n){if(this.dialect=e,this.session=r,this._=n?{schema:n.schema,fullSchema:n.fullSchema,tableNamesMap:n.tableNamesMap,session:r}:{schema:void 0,fullSchema:{},tableNamesMap:{},session:r},this.query={},this._.schema)for(let[i,a]of Object.entries(this._.schema))this.query[i]=new Wo(n.fullSchema,this._.schema,this._.tableNamesMap,n.fullSchema[i],a,e,r)}static[h]=\"PgDatabase\";query;$with=(e,r)=>{let n=this;return{as:a=>(typeof a==\"function\"&&(a=a(new ui(n.dialect))),new Proxy(new ni(a.getSQL(),r??(\"getSelectedFields\"in a?a.getSelectedFields()??{}:{}),e,!0),new de({alias:e,sqlAliasedBehavior:\"alias\",sqlBehavior:\"error\"})))}};$count(e,r){return new Ko({source:e,filters:r,session:this.session})}with(...e){let r=this;function n(c){return new De({fields:c??void 0,session:r.session,dialect:r.dialect,withList:e})}function i(c){return new De({fields:c??void 0,session:r.session,dialect:r.dialect,withList:e,distinct:!0})}function a(c,l){return new De({fields:l??void 0,session:r.session,dialect:r.dialect,withList:e,distinct:{on:c}})}function s(c){return new Ia(c,r.session,r.dialect,e)}function o(c){return new Ra(c,r.session,r.dialect,e)}function u(c){return new ya(c,r.session,r.dialect,e)}return{select:n,selectDistinct:i,selectDistinctOn:a,update:s,insert:o,delete:u}}select(e){return new De({fields:e??void 0,session:this.session,dialect:this.dialect})}selectDistinct(e){return new De({fields:e??void 0,session:this.session,dialect:this.dialect,distinct:!0})}selectDistinctOn(e,r){return new De({fields:r??void 0,session:this.session,dialect:this.dialect,distinct:{on:e}})}update(e){return new Ia(e,this.session,this.dialect)}insert(e){return new Ra(e,this.session,this.dialect)}delete(e){return new ya(e,this.session,this.dialect)}refreshMaterializedView(e){return new Vo(e,this.session,this.dialect)}authToken;execute(e){let r=typeof e==\"string\"?g.raw(e):e.getSQL(),n=this.dialect.sqlToQuery(r),i=this.session.prepareQuery(n,void 0,void 0,!1);return new Jo(()=>i.execute(void 0,this.authToken),r,n,a=>i.mapResult(a,!0))}transaction(e,r){return this.session.transaction(e,r)}};var qf=class{constructor(e,r){this.unique=e,this.name=r}static[h]=\"PgIndexBuilderOn\";on(...e){return new Na(e.map(r=>{if(b(r,O))return r;r=r;let n=new ri(r.name,!!r.keyAsName,r.columnType,r.indexConfig);return r.indexConfig=JSON.parse(JSON.stringify(r.defaultConfig)),n}),this.unique,!1,this.name)}onOnly(...e){return new Na(e.map(r=>{if(b(r,O))return r;r=r;let n=new ri(r.name,!!r.keyAsName,r.columnType,r.indexConfig);return r.indexConfig=r.defaultConfig,n}),this.unique,!0,this.name)}using(e,...r){return new Na(r.map(n=>{if(b(n,O))return n;n=n;let i=new ri(n.name,!!n.keyAsName,n.columnType,n.indexConfig);return n.indexConfig=JSON.parse(JSON.stringify(n.defaultConfig)),i}),this.unique,!0,this.name,e)}},Na=class{static[h]=\"PgIndexBuilder\";config;constructor(e,r,n,i,a=\"btree\"){this.config={name:i,columns:e,unique:r,only:n,method:a}}concurrently(){return this.config.concurrently=!0,this}with(e){return this.config.with=e,this}where(e){return this.config.where=e,this}build(e){return new jf(this.config,e)}},jf=class{static[h]=\"PgIndex\";config;constructor(e,r){this.config={...e,table:r}}};function H_(t){return new qf(!1,t)}var Zo=class{constructor(e){this.query=e}authToken;getQuery(){return this.query}mapResult(e,r){return e}setToken(e){return this.authToken=e,this}static[h]=\"PgPreparedQuery\";joinsNotNullableMap},Xo=class{constructor(e){this.dialect=e}static[h]=\"PgSession\";execute(e,r){return ee.startActiveSpan(\"drizzle.operation\",()=>ee.startActiveSpan(\"drizzle.prepareQuery\",()=>this.prepareQuery(this.dialect.sqlToQuery(e),void 0,void 0,!1)).setToken(r).execute(void 0,r))}all(e){return this.prepareQuery(this.dialect.sqlToQuery(e),void 0,void 0,!1).all()}async count(e,r){let n=await this.execute(e,r);return Number(n[0].count)}},Yo=class extends li{constructor(e,r,n,i=0){super(e,r,n),this.schema=n,this.nestedIndex=i}static[h]=\"PgTransaction\";rollback(){throw new Do}getTransactionConfigSQL(e){let r=[];return e.isolationLevel&&r.push(`isolation level ${e.isolationLevel}`),e.accessMode&&r.push(e.accessMode),typeof e.deferrable==\"boolean\"&&r.push(e.deferrable?\"deferrable\":\"not deferrable\"),g.raw(r.join(\" \"))}setTransaction(e){return this.session.execute(g`set transaction ${this.getTransactionConfigSQL(e)}`)}};var{Pool:Q_,types:Mt}=yr,Df=class extends Zo{constructor(e,r,n,i,a,s,o,u){super({sql:r,params:n}),this.client=e,this.params=n,this.logger=i,this.fields=a,this._isResponseInArrayMode=o,this.customResultMapper=u,this.rawQueryConfig={name:s,text:r,types:{getTypeParser:(c,l)=>c===Mt.builtins.TIMESTAMPTZ?p=>p:c===Mt.builtins.TIMESTAMP?p=>p:c===Mt.builtins.DATE?p=>p:c===Mt.builtins.INTERVAL?p=>p:Mt.getTypeParser(c,l)}},this.queryConfig={name:s,text:r,rowMode:\"array\",types:{getTypeParser:(c,l)=>c===Mt.builtins.TIMESTAMPTZ?p=>p:c===Mt.builtins.TIMESTAMP?p=>p:c===Mt.builtins.DATE?p=>p:c===Mt.builtins.INTERVAL?p=>p:Mt.getTypeParser(c,l)}}}static[h]=\"NodePgPreparedQuery\";rawQueryConfig;queryConfig;async execute(e={}){return ee.startActiveSpan(\"drizzle.execute\",async()=>{let r=ld(this.params,e);this.logger.logQuery(this.rawQueryConfig.text,r);let{fields:n,rawQueryConfig:i,client:a,queryConfig:s,joinsNotNullableMap:o,customResultMapper:u}=this;if(!n&&!u)return ee.startActiveSpan(\"drizzle.driver.execute\",async l=>(l?.setAttributes({\"drizzle.query.name\":i.name,\"drizzle.query.text\":i.text,\"drizzle.query.params\":JSON.stringify(r)}),a.query(i,r)));let c=await ee.startActiveSpan(\"drizzle.driver.execute\",l=>(l?.setAttributes({\"drizzle.query.name\":s.name,\"drizzle.query.text\":s.text,\"drizzle.query.params\":JSON.stringify(r)}),a.query(s,r)));return ee.startActiveSpan(\"drizzle.mapResponse\",()=>u?u(c.rows):c.rows.map(l=>F1(n,l,o)))})}all(e={}){return ee.startActiveSpan(\"drizzle.execute\",()=>{let r=ld(this.params,e);return this.logger.logQuery(this.rawQueryConfig.text,r),ee.startActiveSpan(\"drizzle.driver.execute\",n=>(n?.setAttributes({\"drizzle.query.name\":this.rawQueryConfig.name,\"drizzle.query.text\":this.rawQueryConfig.text,\"drizzle.query.params\":JSON.stringify(r)}),this.client.query(this.rawQueryConfig,r).then(i=>i.rows)))})}isResponseInArrayMode(){return this._isResponseInArrayMode}},ec=class t extends Xo{constructor(e,r,n,i={}){super(r),this.client=e,this.schema=n,this.options=i,this.logger=i.logger??new Ao}static[h]=\"NodePgSession\";logger;prepareQuery(e,r,n,i,a){return new Df(this.client,e.sql,e.params,this.logger,r,n,i,a)}async transaction(e,r){let n=this.client instanceof Q_?new t(await this.client.connect(),this.dialect,this.schema,this.options):this,i=new Lf(this.dialect,n,this.schema);await i.execute(g`begin${r?g` ${i.getTransactionConfigSQL(r)}`:void 0}`);try{let a=await e(i);return await i.execute(g`commit`),a}catch(a){throw await i.execute(g`rollback`),a}finally{this.client instanceof Q_&&n.client.release()}}async count(e){let r=await this.execute(e);return Number(r.rows[0].count)}},Lf=class t extends Yo{static[h]=\"NodePgTransaction\";async transaction(e){let r=`sp${this.nestedIndex+1}`,n=new t(this.dialect,this.session,this.schema,this.nestedIndex+1);await n.execute(g.raw(`savepoint ${r}`));try{let i=await e(n);return await n.execute(g.raw(`release savepoint ${r}`)),i}catch(i){throw await n.execute(g.raw(`rollback to savepoint ${r}`)),i}}};var Mf=class{constructor(e,r,n={}){this.client=e,this.dialect=r,this.options=n}static[h]=\"NodePgDriver\";createSession(e){return new ec(this.client,this.dialect,e,{logger:this.options.logger})}},Ff=class extends li{static[h]=\"NodePgDatabase\"};function qa(t,e={}){let r=new br({casing:e.casing}),n;e.logger===!0?n=new ko:e.logger!==!1&&(n=e.logger);let i;if(e.schema){let u=U_(e.schema,z_);i={fullSchema:e.schema,schema:u.tables,tableNamesMap:u.tableNamesMap}}let s=new Mf(t,r,{logger:n}).createSession(i),o=new Ff(r,s,i);return o.$client=t,o}function tc(...t){if(typeof t[0]==\"string\"){let e=new yr.Pool({connectionString:t[0]});return qa(e,t[1])}if(B1(t[0])){let{connection:e,client:r,...n}=t[0];if(r)return qa(r,n);let i=typeof e==\"string\"?new yr.Pool({connectionString:e}):new yr.Pool(e);return qa(i,n)}return qa(t[0],t[1])}(t=>{function e(r){return qa({},r)}t.mock=e})(tc||(tc={}));var oc={};Rc(oc,{inquiries:()=>at,insertInquirySchema:()=>Hf,insertUserSchema:()=>lN,sessions:()=>uN,users:()=>Tr});var Ie={};Rc(Ie,{BRAND:()=>g9,DIRTY:()=>Vr,EMPTY_PATH:()=>WI,INVALID:()=>D,NEVER:()=>eN,OK:()=>Le,ParseStatus:()=>Re,Schema:()=>H,ZodAny:()=>Sr,ZodArray:()=>ar,ZodBigInt:()=>Wr,ZodBoolean:()=>Gr,ZodBranded:()=>Da,ZodCatch:()=>on,ZodDate:()=>Jr,ZodDefault:()=>sn,ZodDiscriminatedUnion:()=>ic,ZodEffects:()=>bt,ZodEnum:()=>nn,ZodError:()=>Ze,ZodFirstPartyTypeKind:()=>M,ZodFunction:()=>sc,ZodIntersection:()=>en,ZodIssueCode:()=>_,ZodLazy:()=>tn,ZodLiteral:()=>rn,ZodMap:()=>gi,ZodNaN:()=>yi,ZodNativeEnum:()=>an,ZodNever:()=>At,ZodNull:()=>Xr,ZodNullable:()=>Ut,ZodNumber:()=>Kr,ZodObject:()=>Xe,ZodOptional:()=>yt,ZodParsedType:()=>P,ZodPipeline:()=>La,ZodPromise:()=>Er,ZodReadonly:()=>cn,ZodRecord:()=>ac,ZodSchema:()=>H,ZodSet:()=>vi,ZodString:()=>_r,ZodSymbol:()=>hi,ZodTransformer:()=>bt,ZodTuple:()=>$t,ZodType:()=>H,ZodUndefined:()=>Zr,ZodUnion:()=>Yr,ZodUnknown:()=>ir,ZodVoid:()=>mi,addIssueToContext:()=>k,any:()=>T9,array:()=>P9,bigint:()=>b9,boolean:()=>rS,coerce:()=>Y9,custom:()=>Y_,date:()=>w9,datetimeRegex:()=>Z_,defaultErrorMap:()=>rr,discriminatedUnion:()=>N9,effect:()=>Q9,enum:()=>B9,function:()=>F9,getErrorMap:()=>pi,getParsedType:()=>Ft,instanceof:()=>y9,intersection:()=>q9,isAborted:()=>rc,isAsync:()=>di,isDirty:()=>nc,isValid:()=>wr,late:()=>v9,lazy:()=>$9,literal:()=>U9,makeIssue:()=>ja,map:()=>L9,nan:()=>x9,nativeEnum:()=>z9,never:()=>A9,null:()=>E9,nullable:()=>K9,number:()=>tS,object:()=>O9,objectUtil:()=>$f,oboolean:()=>X9,onumber:()=>Z9,optional:()=>V9,ostring:()=>J9,pipeline:()=>G9,preprocess:()=>W9,promise:()=>H9,quotelessJson:()=>QI,record:()=>D9,set:()=>M9,setErrorMap:()=>KI,strictObject:()=>R9,string:()=>eS,symbol:()=>_9,transformer:()=>Q9,tuple:()=>j9,undefined:()=>S9,union:()=>I9,unknown:()=>k9,util:()=>K,void:()=>C9});var K;(function(t){t.assertEqual=i=>{};function e(i){}t.assertIs=e;function r(i){throw new Error}t.assertNever=r,t.arrayToEnum=i=>{let a={};for(let s of i)a[s]=s;return a},t.getValidEnumValues=i=>{let a=t.objectKeys(i).filter(o=>typeof i[i[o]]!=\"number\"),s={};for(let o of a)s[o]=i[o];return t.objectValues(s)},t.objectValues=i=>t.objectKeys(i).map(function(a){return i[a]}),t.objectKeys=typeof Object.keys==\"function\"?i=>Object.keys(i):i=>{let a=[];for(let s in i)Object.prototype.hasOwnProperty.call(i,s)&&a.push(s);return a},t.find=(i,a)=>{for(let s of i)if(a(s))return s},t.isInteger=typeof Number.isInteger==\"function\"?i=>Number.isInteger(i):i=>typeof i==\"number\"&&Number.isFinite(i)&&Math.floor(i)===i;function n(i,a=\" | \"){return i.map(s=>typeof s==\"string\"?`'${s}'`:s).join(a)}t.joinValues=n,t.jsonStringifyReplacer=(i,a)=>typeof a==\"bigint\"?a.toString():a})(K||(K={}));var $f;(function(t){t.mergeShapes=(e,r)=>({...e,...r})})($f||($f={}));var P=K.arrayToEnum([\"string\",\"nan\",\"number\",\"integer\",\"float\",\"boolean\",\"date\",\"bigint\",\"symbol\",\"function\",\"undefined\",\"null\",\"array\",\"object\",\"unknown\",\"promise\",\"void\",\"never\",\"map\",\"set\"]),Ft=t=>{switch(typeof t){case\"undefined\":return P.undefined;case\"string\":return P.string;case\"number\":return Number.isNaN(t)?P.nan:P.number;case\"boolean\":return P.boolean;case\"function\":return P.function;case\"bigint\":return P.bigint;case\"symbol\":return P.symbol;case\"object\":return Array.isArray(t)?P.array:t===null?P.null:t.then&&typeof t.then==\"function\"&&t.catch&&typeof t.catch==\"function\"?P.promise:typeof Map<\"u\"&&t instanceof Map?P.map:typeof Set<\"u\"&&t instanceof Set?P.set:typeof Date<\"u\"&&t instanceof Date?P.date:P.object;default:return P.unknown}};var _=K.arrayToEnum([\"invalid_type\",\"invalid_literal\",\"custom\",\"invalid_union\",\"invalid_union_discriminator\",\"invalid_enum_value\",\"unrecognized_keys\",\"invalid_arguments\",\"invalid_return_type\",\"invalid_date\",\"invalid_string\",\"too_small\",\"too_big\",\"invalid_intersection_types\",\"not_multiple_of\",\"not_finite\"]),QI=t=>JSON.stringify(t,null,2).replace(/\"([^\"]+)\":/g,\"$1:\"),Ze=class t extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};let r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name=\"ZodError\",this.issues=e}format(e){let r=e||function(a){return a.message},n={_errors:[]},i=a=>{for(let s of a.issues)if(s.code===\"invalid_union\")s.unionErrors.map(i);else if(s.code===\"invalid_return_type\")i(s.returnTypeError);else if(s.code===\"invalid_arguments\")i(s.argumentsError);else if(s.path.length===0)n._errors.push(r(s));else{let o=n,u=0;for(;u<s.path.length;){let c=s.path[u];u===s.path.length-1?(o[c]=o[c]||{_errors:[]},o[c]._errors.push(r(s))):o[c]=o[c]||{_errors:[]},o=o[c],u++}}};return i(this),n}static assert(e){if(!(e instanceof t))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,K.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=r=>r.message){let r={},n=[];for(let i of this.issues)if(i.path.length>0){let a=i.path[0];r[a]=r[a]||[],r[a].push(e(i))}else n.push(e(i));return{formErrors:n,fieldErrors:r}}get formErrors(){return this.flatten()}};Ze.create=t=>new Ze(t);var VI=(t,e)=>{let r;switch(t.code){case _.invalid_type:t.received===P.undefined?r=\"Required\":r=`Expected ${t.expected}, received ${t.received}`;break;case _.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(t.expected,K.jsonStringifyReplacer)}`;break;case _.unrecognized_keys:r=`Unrecognized key(s) in object: ${K.joinValues(t.keys,\", \")}`;break;case _.invalid_union:r=\"Invalid input\";break;case _.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${K.joinValues(t.options)}`;break;case _.invalid_enum_value:r=`Invalid enum value. Expected ${K.joinValues(t.options)}, received '${t.received}'`;break;case _.invalid_arguments:r=\"Invalid function arguments\";break;case _.invalid_return_type:r=\"Invalid function return type\";break;case _.invalid_date:r=\"Invalid date\";break;case _.invalid_string:typeof t.validation==\"object\"?\"includes\"in t.validation?(r=`Invalid input: must include \"${t.validation.includes}\"`,typeof t.validation.position==\"number\"&&(r=`${r} at one or more positions greater than or equal to ${t.validation.position}`)):\"startsWith\"in t.validation?r=`Invalid input: must start with \"${t.validation.startsWith}\"`:\"endsWith\"in t.validation?r=`Invalid input: must end with \"${t.validation.endsWith}\"`:K.assertNever(t.validation):t.validation!==\"regex\"?r=`Invalid ${t.validation}`:r=\"Invalid\";break;case _.too_small:t.type===\"array\"?r=`Array must contain ${t.exact?\"exactly\":t.inclusive?\"at least\":\"more than\"} ${t.minimum} element(s)`:t.type===\"string\"?r=`String must contain ${t.exact?\"exactly\":t.inclusive?\"at least\":\"over\"} ${t.minimum} character(s)`:t.type===\"number\"?r=`Number must be ${t.exact?\"exactly equal to \":t.inclusive?\"greater than or equal to \":\"greater than \"}${t.minimum}`:t.type===\"bigint\"?r=`Number must be ${t.exact?\"exactly equal to \":t.inclusive?\"greater than or equal to \":\"greater than \"}${t.minimum}`:t.type===\"date\"?r=`Date must be ${t.exact?\"exactly equal to \":t.inclusive?\"greater than or equal to \":\"greater than \"}${new Date(Number(t.minimum))}`:r=\"Invalid input\";break;case _.too_big:t.type===\"array\"?r=`Array must contain ${t.exact?\"exactly\":t.inclusive?\"at most\":\"less than\"} ${t.maximum} element(s)`:t.type===\"string\"?r=`String must contain ${t.exact?\"exactly\":t.inclusive?\"at most\":\"under\"} ${t.maximum} character(s)`:t.type===\"number\"?r=`Number must be ${t.exact?\"exactly\":t.inclusive?\"less than or equal to\":\"less than\"} ${t.maximum}`:t.type===\"bigint\"?r=`BigInt must be ${t.exact?\"exactly\":t.inclusive?\"less than or equal to\":\"less than\"} ${t.maximum}`:t.type===\"date\"?r=`Date must be ${t.exact?\"exactly\":t.inclusive?\"smaller than or equal to\":\"smaller than\"} ${new Date(Number(t.maximum))}`:r=\"Invalid input\";break;case _.custom:r=\"Invalid input\";break;case _.invalid_intersection_types:r=\"Intersection results could not be merged\";break;case _.not_multiple_of:r=`Number must be a multiple of ${t.multipleOf}`;break;case _.not_finite:r=\"Number must be finite\";break;default:r=e.defaultError,K.assertNever(t)}return{message:r}},rr=VI;var V_=rr;function KI(t){V_=t}function pi(){return V_}var ja=t=>{let{data:e,path:r,errorMaps:n,issueData:i}=t,a=[...r,...i.path||[]],s={...i,path:a};if(i.message!==void 0)return{...i,path:a,message:i.message};let o=\"\",u=n.filter(c=>!!c).slice().reverse();for(let c of u)o=c(s,{data:e,defaultError:o}).message;return{...i,path:a,message:o}},WI=[];function k(t,e){let r=pi(),n=ja({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,r,r===rr?void 0:rr].filter(i=>!!i)});t.common.issues.push(n)}var Re=class t{constructor(){this.value=\"valid\"}dirty(){this.value===\"valid\"&&(this.value=\"dirty\")}abort(){this.value!==\"aborted\"&&(this.value=\"aborted\")}static mergeArray(e,r){let n=[];for(let i of r){if(i.status===\"aborted\")return D;i.status===\"dirty\"&&e.dirty(),n.push(i.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,r){let n=[];for(let i of r){let a=await i.key,s=await i.value;n.push({key:a,value:s})}return t.mergeObjectSync(e,n)}static mergeObjectSync(e,r){let n={};for(let i of r){let{key:a,value:s}=i;if(a.status===\"aborted\"||s.status===\"aborted\")return D;a.status===\"dirty\"&&e.dirty(),s.status===\"dirty\"&&e.dirty(),a.value!==\"__proto__\"&&(typeof s.value<\"u\"||i.alwaysSet)&&(n[a.value]=s.value)}return{status:e.value,value:n}}},D=Object.freeze({status:\"aborted\"}),Vr=t=>({status:\"dirty\",value:t}),Le=t=>({status:\"valid\",value:t}),rc=t=>t.status===\"aborted\",nc=t=>t.status===\"dirty\",wr=t=>t.status===\"valid\",di=t=>typeof Promise<\"u\"&&t instanceof Promise;var q;(function(t){t.errToObj=e=>typeof e==\"string\"?{message:e}:e||{},t.toString=e=>typeof e==\"string\"?e:e?.message})(q||(q={}));var xt=class{constructor(e,r,n,i){this._cachedPath=[],this.parent=e,this.data=r,this._path=n,this._key=i}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}},K_=(t,e)=>{if(wr(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error(\"Validation failed but no issues detected.\");return{success:!1,get error(){if(this._error)return this._error;let r=new Ze(t.common.issues);return this._error=r,this._error}}};function z(t){if(!t)return{};let{errorMap:e,invalid_type_error:r,required_error:n,description:i}=t;if(e&&(r||n))throw new Error(`Can't use \"invalid_type_error\" or \"required_error\" in conjunction with custom error map.`);return e?{errorMap:e,description:i}:{errorMap:(s,o)=>{let{message:u}=t;return s.code===\"invalid_enum_value\"?{message:u??o.defaultError}:typeof o.data>\"u\"?{message:u??n??o.defaultError}:s.code!==\"invalid_type\"?{message:o.defaultError}:{message:u??r??o.defaultError}},description:i}}var H=class{get description(){return this._def.description}_getType(e){return Ft(e.data)}_getOrReturnCtx(e,r){return r||{common:e.parent.common,data:e.data,parsedType:Ft(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Re,ctx:{common:e.parent.common,data:e.data,parsedType:Ft(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let r=this._parse(e);if(di(r))throw new Error(\"Synchronous parse encountered promise.\");return r}_parseAsync(e){let r=this._parse(e);return Promise.resolve(r)}parse(e,r){let n=this.safeParse(e,r);if(n.success)return n.data;throw n.error}safeParse(e,r){let n={common:{issues:[],async:r?.async??!1,contextualErrorMap:r?.errorMap},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ft(e)},i=this._parseSync({data:e,path:n.path,parent:n});return K_(n,i)}\"~validate\"(e){let r={common:{issues:[],async:!!this[\"~standard\"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ft(e)};if(!this[\"~standard\"].async)try{let n=this._parseSync({data:e,path:[],parent:r});return wr(n)?{value:n.value}:{issues:r.common.issues}}catch(n){n?.message?.toLowerCase()?.includes(\"encountered\")&&(this[\"~standard\"].async=!0),r.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:r}).then(n=>wr(n)?{value:n.value}:{issues:r.common.issues})}async parseAsync(e,r){let n=await this.safeParseAsync(e,r);if(n.success)return n.data;throw n.error}async safeParseAsync(e,r){let n={common:{issues:[],contextualErrorMap:r?.errorMap,async:!0},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ft(e)},i=this._parse({data:e,path:n.path,parent:n}),a=await(di(i)?i:Promise.resolve(i));return K_(n,a)}refine(e,r){let n=i=>typeof r==\"string\"||typeof r>\"u\"?{message:r}:typeof r==\"function\"?r(i):r;return this._refinement((i,a)=>{let s=e(i),o=()=>a.addIssue({code:_.custom,...n(i)});return typeof Promise<\"u\"&&s instanceof Promise?s.then(u=>u?!0:(o(),!1)):s?!0:(o(),!1)})}refinement(e,r){return this._refinement((n,i)=>e(n)?!0:(i.addIssue(typeof r==\"function\"?r(n,i):r),!1))}_refinement(e){return new bt({schema:this,typeName:M.ZodEffects,effect:{type:\"refinement\",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this[\"~standard\"]={version:1,vendor:\"zod\",validate:r=>this[\"~validate\"](r)}}optional(){return yt.create(this,this._def)}nullable(){return Ut.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return ar.create(this)}promise(){return Er.create(this,this._def)}or(e){return Yr.create([this,e],this._def)}and(e){return en.create(this,e,this._def)}transform(e){return new bt({...z(this._def),schema:this,typeName:M.ZodEffects,effect:{type:\"transform\",transform:e}})}default(e){let r=typeof e==\"function\"?e:()=>e;return new sn({...z(this._def),innerType:this,defaultValue:r,typeName:M.ZodDefault})}brand(){return new Da({typeName:M.ZodBranded,type:this,...z(this._def)})}catch(e){let r=typeof e==\"function\"?e:()=>e;return new on({...z(this._def),innerType:this,catchValue:r,typeName:M.ZodCatch})}describe(e){let r=this.constructor;return new r({...this._def,description:e})}pipe(e){return La.create(this,e)}readonly(){return cn.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}},GI=/^c[^\\s-]{8,}$/i,JI=/^[0-9a-z]+$/,ZI=/^[0-9A-HJKMNP-TV-Z]{26}$/i,XI=/^[0-9a-fA-F]{8}\\b-[0-9a-fA-F]{4}\\b-[0-9a-fA-F]{4}\\b-[0-9a-fA-F]{4}\\b-[0-9a-fA-F]{12}$/i,YI=/^[a-z0-9_-]{21}$/i,e9=/^[A-Za-z0-9-_]+\\.[A-Za-z0-9-_]+\\.[A-Za-z0-9-_]*$/,t9=/^[-+]?P(?!$)(?:(?:[-+]?\\d+Y)|(?:[-+]?\\d+[.,]\\d+Y$))?(?:(?:[-+]?\\d+M)|(?:[-+]?\\d+[.,]\\d+M$))?(?:(?:[-+]?\\d+W)|(?:[-+]?\\d+[.,]\\d+W$))?(?:(?:[-+]?\\d+D)|(?:[-+]?\\d+[.,]\\d+D$))?(?:T(?=[\\d+-])(?:(?:[-+]?\\d+H)|(?:[-+]?\\d+[.,]\\d+H$))?(?:(?:[-+]?\\d+M)|(?:[-+]?\\d+[.,]\\d+M$))?(?:[-+]?\\d+(?:[.,]\\d+)?S)?)??$/,r9=/^(?!\\.)(?!.*\\.\\.)([A-Z0-9_'+\\-\\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\\-]*\\.)+[A-Z]{2,}$/i,n9=\"^(\\\\p{Extended_Pictographic}|\\\\p{Emoji_Component})+$\",Uf,i9=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,a9=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\\/(3[0-2]|[12]?[0-9])$/,s9=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,o9=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,c9=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,u9=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,G_=\"((\\\\d\\\\d[2468][048]|\\\\d\\\\d[13579][26]|\\\\d\\\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\\\d|30)|(02)-(0[1-9]|1\\\\d|2[0-8])))\",l9=new RegExp(`^${G_}$`);function J_(t){let e=\"[0-5]\\\\d\";t.precision?e=`${e}\\\\.\\\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\\\.\\\\d+)?`);let r=t.precision?\"+\":\"?\";return`([01]\\\\d|2[0-3]):[0-5]\\\\d(:${e})${r}`}function p9(t){return new RegExp(`^${J_(t)}$`)}function Z_(t){let e=`${G_}T${J_(t)}`,r=[];return r.push(t.local?\"Z?\":\"Z\"),t.offset&&r.push(\"([+-]\\\\d{2}:?\\\\d{2})\"),e=`${e}(${r.join(\"|\")})`,new RegExp(`^${e}$`)}function d9(t,e){return!!((e===\"v4\"||!e)&&i9.test(t)||(e===\"v6\"||!e)&&s9.test(t))}function f9(t,e){if(!e9.test(t))return!1;try{let[r]=t.split(\".\");if(!r)return!1;let n=r.replace(/-/g,\"+\").replace(/_/g,\"/\").padEnd(r.length+(4-r.length%4)%4,\"=\"),i=JSON.parse(atob(n));return!(typeof i!=\"object\"||i===null||\"typ\"in i&&i?.typ!==\"JWT\"||!i.alg||e&&i.alg!==e)}catch{return!1}}function h9(t,e){return!!((e===\"v4\"||!e)&&a9.test(t)||(e===\"v6\"||!e)&&o9.test(t))}var _r=class t extends H{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==P.string){let a=this._getOrReturnCtx(e);return k(a,{code:_.invalid_type,expected:P.string,received:a.parsedType}),D}let n=new Re,i;for(let a of this._def.checks)if(a.kind===\"min\")e.data.length<a.value&&(i=this._getOrReturnCtx(e,i),k(i,{code:_.too_small,minimum:a.value,type:\"string\",inclusive:!0,exact:!1,message:a.message}),n.dirty());else if(a.kind===\"max\")e.data.length>a.value&&(i=this._getOrReturnCtx(e,i),k(i,{code:_.too_big,maximum:a.value,type:\"string\",inclusive:!0,exact:!1,message:a.message}),n.dirty());else if(a.kind===\"length\"){let s=e.data.length>a.value,o=e.data.length<a.value;(s||o)&&(i=this._getOrReturnCtx(e,i),s?k(i,{code:_.too_big,maximum:a.value,type:\"string\",inclusive:!0,exact:!0,message:a.message}):o&&k(i,{code:_.too_small,minimum:a.value,type:\"string\",inclusive:!0,exact:!0,message:a.message}),n.dirty())}else if(a.kind===\"email\")r9.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"email\",code:_.invalid_string,message:a.message}),n.dirty());else if(a.kind===\"emoji\")Uf||(Uf=new RegExp(n9,\"u\")),Uf.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"emoji\",code:_.invalid_string,message:a.message}),n.dirty());else if(a.kind===\"uuid\")XI.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"uuid\",code:_.invalid_string,message:a.message}),n.dirty());else if(a.kind===\"nanoid\")YI.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"nanoid\",code:_.invalid_string,message:a.message}),n.dirty());else if(a.kind===\"cuid\")GI.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"cuid\",code:_.invalid_string,message:a.message}),n.dirty());else if(a.kind===\"cuid2\")JI.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"cuid2\",code:_.invalid_string,message:a.message}),n.dirty());else if(a.kind===\"ulid\")ZI.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"ulid\",code:_.invalid_string,message:a.message}),n.dirty());else if(a.kind===\"url\")try{new URL(e.data)}catch{i=this._getOrReturnCtx(e,i),k(i,{validation:\"url\",code:_.invalid_string,message:a.message}),n.dirty()}else a.kind===\"regex\"?(a.regex.lastIndex=0,a.regex.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"regex\",code:_.invalid_string,message:a.message}),n.dirty())):a.kind===\"trim\"?e.data=e.data.trim():a.kind===\"includes\"?e.data.includes(a.value,a.position)||(i=this._getOrReturnCtx(e,i),k(i,{code:_.invalid_string,validation:{includes:a.value,position:a.position},message:a.message}),n.dirty()):a.kind===\"toLowerCase\"?e.data=e.data.toLowerCase():a.kind===\"toUpperCase\"?e.data=e.data.toUpperCase():a.kind===\"startsWith\"?e.data.startsWith(a.value)||(i=this._getOrReturnCtx(e,i),k(i,{code:_.invalid_string,validation:{startsWith:a.value},message:a.message}),n.dirty()):a.kind===\"endsWith\"?e.data.endsWith(a.value)||(i=this._getOrReturnCtx(e,i),k(i,{code:_.invalid_string,validation:{endsWith:a.value},message:a.message}),n.dirty()):a.kind===\"datetime\"?Z_(a).test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{code:_.invalid_string,validation:\"datetime\",message:a.message}),n.dirty()):a.kind===\"date\"?l9.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{code:_.invalid_string,validation:\"date\",message:a.message}),n.dirty()):a.kind===\"time\"?p9(a).test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{code:_.invalid_string,validation:\"time\",message:a.message}),n.dirty()):a.kind===\"duration\"?t9.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"duration\",code:_.invalid_string,message:a.message}),n.dirty()):a.kind===\"ip\"?d9(e.data,a.version)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"ip\",code:_.invalid_string,message:a.message}),n.dirty()):a.kind===\"jwt\"?f9(e.data,a.alg)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"jwt\",code:_.invalid_string,message:a.message}),n.dirty()):a.kind===\"cidr\"?h9(e.data,a.version)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"cidr\",code:_.invalid_string,message:a.message}),n.dirty()):a.kind===\"base64\"?c9.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"base64\",code:_.invalid_string,message:a.message}),n.dirty()):a.kind===\"base64url\"?u9.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"base64url\",code:_.invalid_string,message:a.message}),n.dirty()):K.assertNever(a);return{status:n.value,value:e.data}}_regex(e,r,n){return this.refinement(i=>e.test(i),{validation:r,code:_.invalid_string,...q.errToObj(n)})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:\"email\",...q.errToObj(e)})}url(e){return this._addCheck({kind:\"url\",...q.errToObj(e)})}emoji(e){return this._addCheck({kind:\"emoji\",...q.errToObj(e)})}uuid(e){return this._addCheck({kind:\"uuid\",...q.errToObj(e)})}nanoid(e){return this._addCheck({kind:\"nanoid\",...q.errToObj(e)})}cuid(e){return this._addCheck({kind:\"cuid\",...q.errToObj(e)})}cuid2(e){return this._addCheck({kind:\"cuid2\",...q.errToObj(e)})}ulid(e){return this._addCheck({kind:\"ulid\",...q.errToObj(e)})}base64(e){return this._addCheck({kind:\"base64\",...q.errToObj(e)})}base64url(e){return this._addCheck({kind:\"base64url\",...q.errToObj(e)})}jwt(e){return this._addCheck({kind:\"jwt\",...q.errToObj(e)})}ip(e){return this._addCheck({kind:\"ip\",...q.errToObj(e)})}cidr(e){return this._addCheck({kind:\"cidr\",...q.errToObj(e)})}datetime(e){return typeof e==\"string\"?this._addCheck({kind:\"datetime\",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:\"datetime\",precision:typeof e?.precision>\"u\"?null:e?.precision,offset:e?.offset??!1,local:e?.local??!1,...q.errToObj(e?.message)})}date(e){return this._addCheck({kind:\"date\",message:e})}time(e){return typeof e==\"string\"?this._addCheck({kind:\"time\",precision:null,message:e}):this._addCheck({kind:\"time\",precision:typeof e?.precision>\"u\"?null:e?.precision,...q.errToObj(e?.message)})}duration(e){return this._addCheck({kind:\"duration\",...q.errToObj(e)})}regex(e,r){return this._addCheck({kind:\"regex\",regex:e,...q.errToObj(r)})}includes(e,r){return this._addCheck({kind:\"includes\",value:e,position:r?.position,...q.errToObj(r?.message)})}startsWith(e,r){return this._addCheck({kind:\"startsWith\",value:e,...q.errToObj(r)})}endsWith(e,r){return this._addCheck({kind:\"endsWith\",value:e,...q.errToObj(r)})}min(e,r){return this._addCheck({kind:\"min\",value:e,...q.errToObj(r)})}max(e,r){return this._addCheck({kind:\"max\",value:e,...q.errToObj(r)})}length(e,r){return this._addCheck({kind:\"length\",value:e,...q.errToObj(r)})}nonempty(e){return this.min(1,q.errToObj(e))}trim(){return new t({...this._def,checks:[...this._def.checks,{kind:\"trim\"}]})}toLowerCase(){return new t({...this._def,checks:[...this._def.checks,{kind:\"toLowerCase\"}]})}toUpperCase(){return new t({...this._def,checks:[...this._def.checks,{kind:\"toUpperCase\"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind===\"datetime\")}get isDate(){return!!this._def.checks.find(e=>e.kind===\"date\")}get isTime(){return!!this._def.checks.find(e=>e.kind===\"time\")}get isDuration(){return!!this._def.checks.find(e=>e.kind===\"duration\")}get isEmail(){return!!this._def.checks.find(e=>e.kind===\"email\")}get isURL(){return!!this._def.checks.find(e=>e.kind===\"url\")}get isEmoji(){return!!this._def.checks.find(e=>e.kind===\"emoji\")}get isUUID(){return!!this._def.checks.find(e=>e.kind===\"uuid\")}get isNANOID(){return!!this._def.checks.find(e=>e.kind===\"nanoid\")}get isCUID(){return!!this._def.checks.find(e=>e.kind===\"cuid\")}get isCUID2(){return!!this._def.checks.find(e=>e.kind===\"cuid2\")}get isULID(){return!!this._def.checks.find(e=>e.kind===\"ulid\")}get isIP(){return!!this._def.checks.find(e=>e.kind===\"ip\")}get isCIDR(){return!!this._def.checks.find(e=>e.kind===\"cidr\")}get isBase64(){return!!this._def.checks.find(e=>e.kind===\"base64\")}get isBase64url(){return!!this._def.checks.find(e=>e.kind===\"base64url\")}get minLength(){let e=null;for(let r of this._def.checks)r.kind===\"min\"&&(e===null||r.value>e)&&(e=r.value);return e}get maxLength(){let e=null;for(let r of this._def.checks)r.kind===\"max\"&&(e===null||r.value<e)&&(e=r.value);return e}};_r.create=t=>new _r({checks:[],typeName:M.ZodString,coerce:t?.coerce??!1,...z(t)});function m9(t,e){let r=(t.toString().split(\".\")[1]||\"\").length,n=(e.toString().split(\".\")[1]||\"\").length,i=r>n?r:n,a=Number.parseInt(t.toFixed(i).replace(\".\",\"\")),s=Number.parseInt(e.toFixed(i).replace(\".\",\"\"));return a%s/10**i}var Kr=class t extends H{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==P.number){let a=this._getOrReturnCtx(e);return k(a,{code:_.invalid_type,expected:P.number,received:a.parsedType}),D}let n,i=new Re;for(let a of this._def.checks)a.kind===\"int\"?K.isInteger(e.data)||(n=this._getOrReturnCtx(e,n),k(n,{code:_.invalid_type,expected:\"integer\",received:\"float\",message:a.message}),i.dirty()):a.kind===\"min\"?(a.inclusive?e.data<a.value:e.data<=a.value)&&(n=this._getOrReturnCtx(e,n),k(n,{code:_.too_small,minimum:a.value,type:\"number\",inclusive:a.inclusive,exact:!1,message:a.message}),i.dirty()):a.kind===\"max\"?(a.inclusive?e.data>a.value:e.data>=a.value)&&(n=this._getOrReturnCtx(e,n),k(n,{code:_.too_big,maximum:a.value,type:\"number\",inclusive:a.inclusive,exact:!1,message:a.message}),i.dirty()):a.kind===\"multipleOf\"?m9(e.data,a.value)!==0&&(n=this._getOrReturnCtx(e,n),k(n,{code:_.not_multiple_of,multipleOf:a.value,message:a.message}),i.dirty()):a.kind===\"finite\"?Number.isFinite(e.data)||(n=this._getOrReturnCtx(e,n),k(n,{code:_.not_finite,message:a.message}),i.dirty()):K.assertNever(a);return{status:i.value,value:e.data}}gte(e,r){return this.setLimit(\"min\",e,!0,q.toString(r))}gt(e,r){return this.setLimit(\"min\",e,!1,q.toString(r))}lte(e,r){return this.setLimit(\"max\",e,!0,q.toString(r))}lt(e,r){return this.setLimit(\"max\",e,!1,q.toString(r))}setLimit(e,r,n,i){return new t({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:n,message:q.toString(i)}]})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:\"int\",message:q.toString(e)})}positive(e){return this._addCheck({kind:\"min\",value:0,inclusive:!1,message:q.toString(e)})}negative(e){return this._addCheck({kind:\"max\",value:0,inclusive:!1,message:q.toString(e)})}nonpositive(e){return this._addCheck({kind:\"max\",value:0,inclusive:!0,message:q.toString(e)})}nonnegative(e){return this._addCheck({kind:\"min\",value:0,inclusive:!0,message:q.toString(e)})}multipleOf(e,r){return this._addCheck({kind:\"multipleOf\",value:e,message:q.toString(r)})}finite(e){return this._addCheck({kind:\"finite\",message:q.toString(e)})}safe(e){return this._addCheck({kind:\"min\",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:q.toString(e)})._addCheck({kind:\"max\",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:q.toString(e)})}get minValue(){let e=null;for(let r of this._def.checks)r.kind===\"min\"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(let r of this._def.checks)r.kind===\"max\"&&(e===null||r.value<e)&&(e=r.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind===\"int\"||e.kind===\"multipleOf\"&&K.isInteger(e.value))}get isFinite(){let e=null,r=null;for(let n of this._def.checks){if(n.kind===\"finite\"||n.kind===\"int\"||n.kind===\"multipleOf\")return!0;n.kind===\"min\"?(r===null||n.value>r)&&(r=n.value):n.kind===\"max\"&&(e===null||n.value<e)&&(e=n.value)}return Number.isFinite(r)&&NumberThu, 29 Jan 2026 21:34:45 GMT express-session deprecated req.secret; provide secret option at node:internal/modules/cjs/loader:1706:14","attributes":{"level":"error"},"tags":{"project":"29c6c2c4-ea10-4fe6-8901-1198a13520db","environment":"9a47f9fb-0d50-4031-a85e-16db1d46fb86","service":"09a1965e-88d6-44ee-9836-14176d4bb0b5","deployment":"e78c90dd-bc00-48f5-9312-8a8fa977b2c2","replica":"68b779c1-91b1-4ca6-88f4-a907899be5f1"},"timestamp":"2026-01-29T21:34:45.382908004Z"},{"message":"/app/dist/index.cjs:71","attributes":{"level":"error"},"tags":{"project":"29c6c2c4-ea10-4fe6-8901-1198a13520db","environment":"9a47f9fb-0d50-4031-a85e-16db1d46fb86","service":"09a1965e-88d6-44ee-9836-14176d4bb0b5","deployment":"e78c90dd-bc00-48f5-9312-8a8fa977b2c2","replica":"68b779c1-91b1-4ca6-88f4-a907899be5f1"},"timestamp":"2026-01-29T21:34:45.382912931Z"},{"message":"\t\t`;await r.execute(g`CREATE SCHEMA IF NOT EXISTS ${g.identifier(a)}`),await r.execute(s);let u=(await r.all(g`select id, hash, created_at from ${g.identifier(a)}.${g.identifier(i)} order by created_at desc limit 1`))[0];await r.transaction(async c=>{for await(let l of e)if(!u||Number(u.created_at)<l.folderMillis){for(let p of l.sql)await c.execute(g.raw(p));await c.execute(g`insert into ${g.identifier(a)}.${g.identifier(i)} (\"hash\", \"created_at\") values(${l.hash}, ${l.folderMillis})`)}})}escapeName(e){return`\"${e}\"`}escapeParam(e){return`$${e+1}`}escapeString(e){return`'${e.replace(/'/g,\"''\")}'`}buildWithCTE(e){if(!e?.length)return;let r=[g`with `];for(let[n,i]of e.entries())r.push(g`${g.identifier(i._.alias)} as (${i._.sql})`),n<e.length-1&&r.push(g`, `);return r.push(g` `),g.join(r)}buildDeleteQuery({table:e,where:r,returning:n,withList:i}){let a=this.buildWithCTE(i),s=n?g` returning ${this.buildSelection(n,{isSingleTable:!0})}`:void 0,o=r?g` where ${r}`:void 0;return g`${a}delete from ${e}${o}${s}`}buildUpdateSet(e,r){let n=e[A.Symbol.Columns],i=Object.keys(n).filter(s=>r[s]!==void 0||n[s]?.onUpdateFn!==void 0),a=i.length;return g.join(i.flatMap((s,o)=>{let u=n[s],c=r[s]??g.param(u.onUpdateFn(),u),l=g`${g.identifier(this.casing.getColumnCasing(u))} = ${c}`;return o<a-1?[l,g.raw(\", \")]:[l]}))}buildUpdateQuery({table:e,set:r,where:n,returning:i,withList:a,from:s,joins:o}){let u=this.buildWithCTE(a),c=e[Te.Symbol.Name],l=e[Te.Symbol.Schema],p=e[Te.Symbol.OriginalName],d=c===p?void 0:c,f=g`${l?g`${g.identifier(l)}.`:void 0}${g.identifier(p)}${d&&g` ${g.identifier(d)}`}`,y=this.buildUpdateSet(e,r),m=s&&g.join([g.raw(\" from \"),this.buildFromTable(s)]),x=this.buildJoins(o),w=i?g` returning ${this.buildSelection(i,{isSingleTable:!s})}`:void 0,T=n?g` where ${n}`:void 0;return g`${u}update ${f} set ${y}${m}${x}${T}${w}`}buildSelection(e,{isSingleTable:r=!1}={}){let n=e.length,i=e.flatMap(({field:a},s)=>{let o=[];if(b(a,O.Aliased)&&a.isSelectionField)o.push(g.identifier(a.fieldAlias));else if(b(a,O.Aliased)||b(a,O)){let u=b(a,O.Aliased)?a.sql:a;r?o.push(new O(u.queryChunks.map(c=>b(c,E)?g.identifier(this.casing.getColumnCasing(c)):c))):o.push(u),b(a,O.Aliased)&&o.push(g` as ${g.identifier(a.fieldAlias)}`)}else b(a,J)&&(r?o.push(g.identifier(this.casing.getColumnCasing(a))):o.push(a));return s<n-1&&o.push(g`, `),o});return g.join(i)}buildJoins(e){if(!e||e.length===0)return;let r=[];for(let[n,i]of e.entries()){n===0&&r.push(g` `);let a=i.table,s=i.lateral?g` lateral`:void 0;if(b(a,Te)){let o=a[Te.Symbol.Name],u=a[Te.Symbol.Schema],c=a[Te.Symbol.OriginalName],l=o===c?void 0:i.alias;r.push(g`${g.raw(i.joinType)} join${s} ${u?g`${g.identifier(u)}.`:void 0}${g.identifier(c)}${l&&g` ${g.identifier(l)}`} on ${i.on}`)}else if(b(a,Ue)){let o=a[te].name,u=a[te].schema,c=a[te].originalName,l=o===c?void 0:i.alias;r.push(g`${g.raw(i.joinType)} join${s} ${u?g`${g.identifier(u)}.`:void 0}${g.identifier(c)}${l&&g` ${g.identifier(l)}`} on ${i.on}`)}else r.push(g`${g.raw(i.joinType)} join${s} ${a} on ${i.on}`);n<e.length-1&&r.push(g` `)}return g.join(r)}buildFromTable(e){if(b(e,A)&&e[A.Symbol.OriginalName]!==e[A.Symbol.Name]){let r=g`${g.identifier(e[A.Symbol.OriginalName])}`;return e[A.Symbol.Schema]&&(r=g`${g.identifier(e[A.Symbol.Schema])}.${r}`),g`${r} ${g.identifier(e[A.Symbol.Name])}`}return e}buildSelectQuery({withList:e,fields:r,fieldsFlat:n,where:i,having:a,table:s,joins:o,orderBy:u,groupBy:c,limit:l,offset:p,lockingClause:d,distinct:f,setOperators:y}){let m=n??gt(r);for(let ne of m)if(b(ne.field,J)&&We(ne.field.table)!==(b(s,ye)?s._.alias:b(s,oi)?s[te].name:b(s,O)?void 0:We(s))&&!(he=>o?.some(({alias:et})=>et===(he[A.Symbol.IsAlias]?We(he):he[A.Symbol.BaseName])))(ne.field.table)){let he=We(ne.field.table);throw new Error(`Your \"${ne.path.join(\"->\")}\" field references a column \"${he}\".\"${ne.field.name}\", but the table \"${he}\" is not part of the query! Did you forget to join it?`)}let x=!o||o.length===0,w=this.buildWithCTE(e),T;f&&(T=f===!0?g` distinct`:g` distinct on (${g.join(f.on,g`, `)})`);let S=this.buildSelection(m,{isSingleTable:x}),C=this.buildFromTable(s),L=this.buildJoins(o),j=i?g` where ${i}`:void 0,R=a?g` having ${a}`:void 0,N;u&&u.length>0&&(N=g` order by ${g.join(u,g`, `)}`);let Q;c&&c.length>0&&(Q=g` group by ${g.join(c,g`, `)}`);let fe=typeof l==\"object\"||typeof l==\"number\"&&l>=0?g` limit ${l}`:void 0,_t=p?g` offset ${p}`:void 0,qe=g.empty();if(d){let ne=g` for ${g.raw(d.strength)}`;d.config.of&&ne.append(g` of ${g.join(Array.isArray(d.config.of)?d.config.of:[d.config.of],g`, `)}`),d.config.noWait?ne.append(g` no wait`):d.config.skipLocked&&ne.append(g` skip locked`),qe.append(ne)}let se=g`${w}select${T} ${S} from ${C}${L}${j}${Q}${R}${N}${fe}${_t}${qe}`;return y.length>0?this.buildSetOperations(se,y):se}buildSetOperations(e,r){let[n,...i]=r;if(!n)throw new Error(\"Cannot pass undefined values to any set operator\");return i.length===0?this.buildSetOperationQuery({leftSelect:e,setOperator:n}):this.buildSetOperations(this.buildSetOperationQuery({leftSelect:e,setOperator:n}),i)}buildSetOperationQuery({leftSelect:e,setOperator:{type:r,isAll:n,rightSelect:i,limit:a,orderBy:s,offset:o}}){let u=g`(${e.getSQL()}) `,c=g`(${i.getSQL()})`,l;if(s&&s.length>0){let y=[];for(let m of s)if(b(m,E))y.push(g.identifier(m.name));else if(b(m,O)){for(let x=0;x<m.queryChunks.length;x++){let w=m.queryChunks[x];b(w,E)&&(m.queryChunks[x]=g.identifier(w.name))}y.push(g`${m}`)}else y.push(g`${m}`);l=g` order by ${g.join(y,g`, `)} `}let p=typeof a==\"object\"||typeof a==\"number\"&&a>=0?g` limit ${a}`:void 0,d=g.raw(`${r} ${n?\"all \":\"\"}`),f=o?g` offset ${o}`:void 0;return g`${u}${d}${c}${l}${p}${f}`}buildInsertQuery({table:e,values:r,onConflict:n,returning:i,withList:a,select:s,overridingSystemValue_:o}){let u=[],c=e[A.Symbol.Columns],l=Object.entries(c).filter(([w,T])=>!T.shouldDisableInsert()),p=l.map(([,w])=>g.identifier(this.casing.getColumnCasing(w)));if(s){let w=r;b(w,O)?u.push(w):u.push(w.getSQL())}else{let w=r;u.push(g.raw(\"values \"));for(let[T,S]of w.entries()){let C=[];for(let[L,j]of l){let R=S[L];if(R===void 0||b(R,Ge)&&R.value===void 0)if(j.defaultFn!==void 0){let N=j.defaultFn(),Q=b(N,O)?N:g.param(N,j);C.push(Q)}else if(!j.default&&j.onUpdateFn!==void 0){let N=j.onUpdateFn(),Q=b(N,O)?N:g.param(N,j);C.push(Q)}else C.push(g`default`);else C.push(R)}u.push(C),T<w.length-1&&u.push(g`, `)}}let d=this.buildWithCTE(a),f=g.join(u),y=i?g` returning ${this.buildSelection(i,{isSingleTable:!0})}`:void 0,m=n?g` on conflict ${n}`:void 0,x=o===!0?g`overriding system value `:void 0;return g`${d}insert into ${e} ${p} ${x}${f}${m}${y}`}buildRefreshMaterializedViewQuery({view:e,concurrently:r,withNoData:n}){let i=r?g` concurrently`:void 0,a=n?g` with no data`:void 0;return g`refresh materialized view${i} ${e}${a}`}prepareTyping(e){return b(e,Sa)||b(e,_a)?\"json\":b(e,Ea)?\"decimal\":b(e,Ta)?\"time\":b(e,ka)||b(e,Aa)?\"timestamp\":b(e,ba)||b(e,wa)?\"date\":b(e,Ca)?\"uuid\":\"none\"}sqlToQuery(e,r){return e.toQuery({casing:this.casing,escapeName:this.escapeName,escapeParam:this.escapeParam,escapeString:this.escapeString,prepareTyping:this.prepareTyping,invokeSource:r})}buildRelationalQueryWithoutPK({fullSchema:e,schema:r,tableNamesMap:n,table:i,tableConfig:a,queryConfig:s,tableAlias:o,nestedQueryRelation:u,joinOn:c}){let l=[],p,d,f=[],y,m=[];if(s===!0)l=Object.entries(a.columns).map(([T,S])=>({dbKey:S.name,tsKey:T,field:Dt(S,o),relationTableTsKey:void 0,isJson:!1,selection:[]}));else{let w=Object.fromEntries(Object.entries(a.columns).map(([R,N])=>[R,Dt(N,o)]));if(s.where){let R=typeof s.where==\"function\"?s.where(w,F_()):s.where;y=R&&ga(R,o)}let T=[],S=[];if(s.columns){let R=!1;for(let[N,Q]of Object.entries(s.columns))Q!==void 0&&N in a.columns&&(!R&&Q===!0&&(R=!0),S.push(N));S.length>0&&(S=R?S.filter(N=>s.columns?.[N]===!0):Object.keys(a.columns).filter(N=>!S.includes(N)))}else S=Object.keys(a.columns);for(let R of S){let N=a.columns[R];T.push({tsKey:R,value:N})}let C=[];s.with&&(C=Object.entries(s.with).filter(R=>!!R[1]).map(([R,N])=>({tsKey:R,queryConfig:N,relation:a.relations[R]})));let L;if(s.extras){L=typeof s.extras==\"function\"?s.extras(w,{sql:g}):s.extras;for(let[R,N]of Object.entries(L))T.push({tsKey:R,value:pd(N,o)})}for(let{tsKey:R,value:N}of T)l.push({dbKey:b(N,O.Aliased)?N.fieldAlias:a.columns[R].name,tsKey:R,field:b(N,J)?Dt(N,o):N,relationTableTsKey:void 0,isJson:!1,selection:[]});let j=typeof s.orderBy==\"function\"?s.orderBy(w,$_()):s.orderBy??[];Array.isArray(j)||(j=[j]),f=j.map(R=>b(R,J)?Dt(R,o):ga(R,o)),p=s.limit,d=s.offset;for(let{tsKey:R,queryConfig:N,relation:Q}of C){let fe=B_(r,n,Q),_t=Hr(Q.referencedTable),qe=n[_t],se=`${o}_${R}`,ne=Pa(...fe.fields.map((Ht,qi)=>kt(Dt(fe.references[qi],se),Dt(Ht,o)))),he=this.buildRelationalQueryWithoutPK({fullSchema:e,schema:r,tableNamesMap:n,table:e[qe],tableConfig:r[qe],queryConfig:b(Q,xr)?N===!0?{limit:1}:{...N,limit:1}:N,tableAlias:se,joinOn:ne,nestedQueryRelation:Q}),et=g`${g.identifier(se)}.${g.identifier(\"data\")}`.as(R);m.push({on:g`true`,table:new ye(he.sql,{},se),alias:se,joinType:\"left\",lateral:!0}),l.push({dbKey:R,tsKey:R,field:et,relationTableTsKey:qe,isJson:!0,selection:he.selection})}}if(l.length===0)throw new xa({message:`No fields selected for table \"${a.tsName}\" (\"${o}\")`});let x;if(y=Pa(c,y),u){let w=g`json_build_array(${g.join(l.map(({field:C,tsKey:L,isJson:j})=>j?g`${g.identifier(`${o}_${L}`)}.${g.identifier(\"data\")}`:b(C,O.Aliased)?C.sql:C),g`, `)})`;b(u,Oa)&&(w=g`coalesce(json_agg(${w}${f.length>0?g` order by ${g.join(f,g`, `)}`:void 0}), '[]'::json)`);let T=[{dbKey:\"data\",tsKey:\"data\",field:w.as(\"data\"),isJson:!0,relationTableTsKey:a.tsName,selection:l}];p!==void 0||d!==void 0||f.length>0?(x=this.buildSelectQuery({table:ma(i,o),fields:{},fieldsFlat:[{path:[],field:g.raw(\"*\")}],where:y,limit:p,offset:d,orderBy:f,setOperators:[]}),y=void 0,p=void 0,d=void 0,f=[]):x=ma(i,o),x=this.buildSelectQuery({table:b(x,Te)?x:new ye(x,{},o),fields:{},fieldsFlat:T.map(({field:C})=>({path:[],field:b(C,J)?Dt(C,o):C})),joins:m,where:y,limit:p,offset:d,orderBy:f,setOperators:[]})}else x=this.buildSelectQuery({table:ma(i,o),fields:{},fieldsFlat:l.map(({field:w})=>({path:[],field:b(w,J)?Dt(w,o):w})),joins:m,where:y,limit:p,offset:d,orderBy:f,setOperators:[]});return{tableTsKey:a.tsName,sql:x,selection:l}}};var zo=class{static[h]=\"TypedQueryBuilder\";getSelectedFields(){return this._.selectedFields}};var De=class{static[h]=\"PgSelectBuilder\";fields;session;dialect;withList=[];distinct;constructor(e){this.fields=e.fields,this.session=e.session,this.dialect=e.dialect,e.withList&&(this.withList=e.withList),this.distinct=e.distinct}authToken;setToken(e){return this.authToken=e,this}from(e){let r=!!this.fields,n=e,i;return this.fields?i=this.fields:b(n,ye)?i=Object.fromEntries(Object.keys(n._.selectedFields).map(a=>[a,n[a]])):b(n,oi)?i=n[te].selectedFields:b(n,O)?i={}:i=qo(n),new Ho({table:n,fields:i,isPartialSelect:r,session:this.session,dialect:this.dialect,withList:this.withList,distinct:this.distinct}).setToken(this.authToken)}},If=class extends zo{static[h]=\"PgSelectQueryBuilder\";_;config;joinsNotNullableMap;tableName;isPartialSelect;session;dialect;constructor({table:e,fields:r,isPartialSelect:n,session:i,dialect:a,withList:s,distinct:o}){super(),this.config={withList:s,table:e,fields:{...r},distinct:o,setOperators:[]},this.isPartialSelect=n,this.session=i,this.dialect=a,this._={selectedFields:r},this.tableName=er(e),this.joinsNotNullableMap=typeof this.tableName==\"string\"?{[this.tableName]:!0}:{}}createJoin(e){return(r,n)=>{let i=this.tableName,a=er(r);if(typeof a==\"string\"&&this.config.joins?.some(s=>s.alias===a))throw new Error(`Alias \"${a}\" is already used in this query`);if(!this.isPartialSelect&&(Object.keys(this.joinsNotNullableMap).length===1&&typeof i==\"string\"&&(this.config.fields={[i]:this.config.fields}),typeof a==\"string\"&&!b(r,O))){let s=b(r,ye)?r._.selectedFields:b(r,Ue)?r[te].selectedFields:r[A.Symbol.Columns];this.config.fields[a]=s}if(typeof n==\"function\"&&(n=n(new Proxy(this.config.fields,new de({sqlAliasedBehavior:\"sql\",sqlBehavior:\"sql\"})))),this.config.joins||(this.config.joins=[]),this.config.joins.push({on:n,table:r,joinType:e,alias:a}),typeof a==\"string\")switch(e){case\"left\":{this.joinsNotNullableMap[a]=!1;break}case\"right\":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([s])=>[s,!1])),this.joinsNotNullableMap[a]=!0;break}case\"inner\":{this.joinsNotNullableMap[a]=!0;break}case\"full\":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([s])=>[s,!1])),this.joinsNotNullableMap[a]=!1;break}}return this}}leftJoin=this.createJoin(\"left\");rightJoin=this.createJoin(\"right\");innerJoin=this.createJoin(\"inner\");fullJoin=this.createJoin(\"full\");createSetOperator(e,r){return n=>{let i=typeof n==\"function\"?n(MI()):n;if(!va(this.getSelectedFields(),i.getSelectedFields()))throw new Error(\"Set operator error (union / intersect / except): selected fields are not the same or are in a different order\");return this.config.setOperators.push({type:e,isAll:r,rightSelect:i}),this}}union=this.createSetOperator(\"union\",!1);unionAll=this.createSetOperator(\"union\",!0);intersect=this.createSetOperator(\"intersect\",!1);intersectAll=this.createSetOperator(\"intersect\",!0);except=this.createSetOperator(\"except\",!1);exceptAll=this.createSetOperator(\"except\",!0);addSetOperators(e){return this.config.setOperators.push(...e),this}where(e){return typeof e==\"function\"&&(e=e(new Proxy(this.config.fields,new de({sqlAliasedBehavior:\"sql\",sqlBehavior:\"sql\"})))),this.config.where=e,this}having(e){return typeof e==\"function\"&&(e=e(new Proxy(this.config.fields,new de({sqlAliasedBehavior:\"sql\",sqlBehavior:\"sql\"})))),this.config.having=e,this}groupBy(...e){if(typeof e[0]==\"function\"){let r=e[0](new Proxy(this.config.fields,new de({sqlAliasedBehavior:\"alias\",sqlBehavior:\"sql\"})));this.config.groupBy=Array.isArray(r)?r:[r]}else this.config.groupBy=e;return this}orderBy(...e){if(typeof e[0]==\"function\"){let r=e[0](new Proxy(this.config.fields,new de({sqlAliasedBehavior:\"alias\",sqlBehavior:\"sql\"}))),n=Array.isArray(r)?r:[r];this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=n:this.config.orderBy=n}else{let r=e;this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=r:this.config.orderBy=r}return this}limit(e){return this.config.setOperators.length>0?this.config.setOperators.at(-1).limit=e:this.config.limit=e,this}offset(e){return this.config.setOperators.length>0?this.config.setOperators.at(-1).offset=e:this.config.offset=e,this}for(e,r={}){return this.config.lockingClause={strength:e,config:r},this}getSQL(){return this.dialect.buildSelectQuery(this.config)}toSQL(){let{typings:e,...r}=this.dialect.sqlToQuery(this.getSQL());return r}as(e){return new Proxy(new ye(this.getSQL(),this.config.fields,e),new de({alias:e,sqlAliasedBehavior:\"alias\",sqlBehavior:\"error\"}))}getSelectedFields(){return new Proxy(this.config.fields,new de({alias:this.tableName,sqlAliasedBehavior:\"alias\",sqlBehavior:\"error\"}))}$dynamic(){return this}},Ho=class extends If{static[h]=\"PgSelect\";_prepare(e){let{session:r,config:n,dialect:i,joinsNotNullableMap:a,authToken:s}=this;if(!r)throw new Error(\"Cannot execute a query on a query builder. Please use a database instance instead.\");return ee.startActiveSpan(\"drizzle.prepareQuery\",()=>{let o=gt(n.fields),u=r.prepareQuery(i.sqlToQuery(this.getSQL()),o,e,!0);return u.joinsNotNullableMap=a,u.setToken(s)})}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>ee.startActiveSpan(\"drizzle.operation\",()=>this._prepare().execute(e,this.authToken))};$1(Ho,[je]);function ci(t,e){return(r,n,...i)=>{let a=[n,...i].map(s=>({type:t,isAll:e,rightSelect:s}));for(let s of a)if(!va(r.getSelectedFields(),s.rightSelect.getSelectedFields()))throw new Error(\"Set operator error (union / intersect / except): selected fields are not the same or are in a different order\");return r.addSetOperators(a)}}var MI=()=>({union:FI,unionAll:$I,intersect:UI,intersectAll:BI,except:zI,exceptAll:HI}),FI=ci(\"union\",!1),$I=ci(\"union\",!0),UI=ci(\"intersect\",!1),BI=ci(\"intersect\",!0),zI=ci(\"except\",!1),HI=ci(\"except\",!0);var ui=class{static[h]=\"PgQueryBuilder\";dialect;dialectConfig;constructor(e){this.dialect=b(e,br)?e:void 0,this.dialectConfig=b(e,br)?void 0:e}$with=(e,r)=>{let n=this;return{as:a=>(typeof a==\"function\"&&(a=a(n)),new Proxy(new ni(a.getSQL(),r??(\"getSelectedFields\"in a?a.getSelectedFields()??{}:{}),e,!0),new de({alias:e,sqlAliasedBehavior:\"alias\",sqlBehavior:\"error\"})))}};with(...e){let r=this;function n(s){return new De({fields:s??void 0,session:void 0,dialect:r.getDialect(),withList:e})}function i(s){return new De({fields:s??void 0,session:void 0,dialect:r.getDialect(),distinct:!0})}function a(s,o){return new De({fields:o??void 0,session:void 0,dialect:r.getDialect(),distinct:{on:s}})}return{select:n,selectDistinct:i,selectDistinctOn:a}}select(e){return new De({fields:e??void 0,session:void 0,dialect:this.getDialect()})}selectDistinct(e){return new De({fields:e??void 0,session:void 0,dialect:this.getDialect(),distinct:!0})}selectDistinctOn(e,r){return new De({fields:r??void 0,session:void 0,dialect:this.getDialect(),distinct:{on:e}})}getDialect(){return this.dialect||(this.dialect=new br(this.dialectConfig)),this.dialect}};var Ra=class{constructor(e,r,n,i,a){this.table=e,this.session=r,this.dialect=n,this.withList=i,this.overridingSystemValue_=a}static[h]=\"PgInsertBuilder\";authToken;setToken(e){return this.authToken=e,this}overridingSystemValue(){return this.overridingSystemValue_=!0,this}values(e){if(e=Array.isArray(e)?e:[e],e.length===0)throw new Error(\"values() must be called with at least one value\");let r=e.map(n=>{let i={},a=this.table[A.Symbol.Columns];for(let s of Object.keys(n)){let o=n[s];i[s]=b(o,O)?o:new Ge(o,a[s])}return i});return new Qo(this.table,r,this.session,this.dialect,this.withList,!1,this.overridingSystemValue_).setToken(this.authToken)}select(e){let r=typeof e==\"function\"?e(new ui):e;if(!b(r,O)&&!va(this.table[Io],r._.selectedFields))throw new Error(\"Insert select error: selected fields are not the same or are in a different order compared to the table definition\");return new Qo(this.table,r,this.session,this.dialect,this.withList,!0)}},Qo=class extends je{constructor(e,r,n,i,a,s,o){super(),this.session=n,this.dialect=i,this.config={table:e,values:r,withList:a,select:s,overridingSystemValue_:o}}static[h]=\"PgInsert\";config;returning(e=this.config.table[A.Symbol.Columns]){return this.config.returningFields=e,this.config.returning=gt(e),this}onConflictDoNothing(e={}){if(e.target===void 0)this.config.onConflict=g`do nothing`;else{let r=\"\";r=Array.isArray(e.target)?e.target.map(i=>this.dialect.escapeName(this.dialect.casing.getColumnCasing(i))).join(\",\"):this.dialect.escapeName(this.dialect.casing.getColumnCasing(e.target));let n=e.where?g` where ${e.where}`:void 0;this.config.onConflict=g`(${g.raw(r)})${n} do nothing`}return this}onConflictDoUpdate(e){if(e.where&&(e.targetWhere||e.setWhere))throw new Error('You cannot use both \"where\" and \"targetWhere\"/\"setWhere\" at the same time - \"where\" is deprecated, use \"targetWhere\" or \"setWhere\" instead.');let r=e.where?g` where ${e.where}`:void 0,n=e.targetWhere?g` where ${e.targetWhere}`:void 0,i=e.setWhere?g` where ${e.setWhere}`:void 0,a=this.dialect.buildUpdateSet(this.config.table,No(this.config.table,e.set)),s=\"\";return s=Array.isArray(e.target)?e.target.map(o=>this.dialect.escapeName(this.dialect.casing.getColumnCasing(o))).join(\",\"):this.dialect.escapeName(this.dialect.casing.getColumnCasing(e.target)),this.config.onConflict=g`(${g.raw(s)})${n} do update set ${a}${r}${i}`,this}getSQL(){return this.dialect.buildInsertQuery(this.config)}toSQL(){let{typings:e,...r}=this.dialect.sqlToQuery(this.getSQL());return r}_prepare(e){return ee.startActiveSpan(\"drizzle.prepareQuery\",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,e,!0))}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>ee.startActiveSpan(\"drizzle.operation\",()=>this._prepare().execute(e,this.authToken));getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new de({alias:We(this.config.table),sqlAliasedBehavior:\"alias\",sqlBehavior:\"error\"})):void 0}$dynamic(){return this}};var Vo=class extends je{constructor(e,r,n){super(),this.session=r,this.dialect=n,this.config={view:e}}static[h]=\"PgRefreshMaterializedView\";config;concurrently(){if(this.config.withNoData!==void 0)throw new Error(\"Cannot use concurrently and withNoData together\");return this.config.concurrently=!0,this}withNoData(){if(this.config.concurrently!==void 0)throw new Error(\"Cannot use concurrently and withNoData together\");return this.config.withNoData=!0,this}getSQL(){return this.dialect.buildRefreshMaterializedViewQuery(this.config)}toSQL(){let{typings:e,...r}=this.dialect.sqlToQuery(this.getSQL());return r}_prepare(e){return ee.startActiveSpan(\"drizzle.prepareQuery\",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),void 0,e,!0))}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>ee.startActiveSpan(\"drizzle.operation\",()=>this._prepare().execute(e,this.authToken))};var Ia=class{constructor(e,r,n,i){this.table=e,this.session=r,this.dialect=n,this.withList=i}static[h]=\"PgUpdateBuilder\";authToken;setToken(e){return this.authToken=e,this}set(e){return new Nf(this.table,No(this.table,e),this.session,this.dialect,this.withList).setToken(this.authToken)}},Nf=class extends je{constructor(e,r,n,i,a){super(),this.session=n,this.dialect=i,this.config={set:r,table:e,withList:a,joins:[]},this.tableName=er(e),this.joinsNotNullableMap=typeof this.tableName==\"string\"?{[this.tableName]:!0}:{}}static[h]=\"PgUpdate\";config;tableName;joinsNotNullableMap;from(e){let r=e,n=er(r);return typeof n==\"string\"&&(this.joinsNotNullableMap[n]=!0),this.config.from=r,this}getTableLikeFields(e){return b(e,Te)?e[A.Symbol.Columns]:b(e,ye)?e._.selectedFields:e[te].selectedFields}createJoin(e){return(r,n)=>{let i=er(r);if(typeof i==\"string\"&&this.config.joins.some(a=>a.alias===i))throw new Error(`Alias \"${i}\" is already used in this query`);if(typeof n==\"function\"){let a=this.config.from&&!b(this.config.from,O)?this.getTableLikeFields(this.config.from):void 0;n=n(new Proxy(this.config.table[A.Symbol.Columns],new de({sqlAliasedBehavior:\"sql\",sqlBehavior:\"sql\"})),a&&new Proxy(a,new de({sqlAliasedBehavior:\"sql\",sqlBehavior:\"sql\"})))}if(this.config.joins.push({on:n,table:r,joinType:e,alias:i}),typeof i==\"string\")switch(e){case\"left\":{this.joinsNotNullableMap[i]=!1;break}case\"right\":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([a])=>[a,!1])),this.joinsNotNullableMap[i]=!0;break}case\"inner\":{this.joinsNotNullableMap[i]=!0;break}case\"full\":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([a])=>[a,!1])),this.joinsNotNullableMap[i]=!1;break}}return this}}leftJoin=this.createJoin(\"left\");rightJoin=this.createJoin(\"right\");innerJoin=this.createJoin(\"inner\");fullJoin=this.createJoin(\"full\");where(e){return this.config.where=e,this}returning(e){if(!e&&(e=Object.assign({},this.config.table[A.Symbol.Columns]),this.config.from)){let r=er(this.config.from);if(typeof r==\"string\"&&this.config.from&&!b(this.config.from,O)){let n=this.getTableLikeFields(this.config.from);e[r]=n}for(let n of this.config.joins){let i=er(n.table);if(typeof i==\"string\"&&!b(n.table,O)){let a=this.getTableLikeFields(n.table);e[i]=a}}}return this.config.returningFields=e,this.config.returning=gt(e),this}getSQL(){return this.dialect.buildUpdateQuery(this.config)}toSQL(){let{typings:e,...r}=this.dialect.sqlToQuery(this.getSQL());return r}_prepare(e){let r=this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,e,!0);return r.joinsNotNullableMap=this.joinsNotNullableMap,r}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>this._prepare().execute(e,this.authToken);getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new de({alias:We(this.config.table),sqlAliasedBehavior:\"alias\",sqlBehavior:\"error\"})):void 0}$dynamic(){return this}};var Ko=class t extends O{constructor(e){super(t.buildEmbeddedCount(e.source,e.filters).queryChunks),this.params=e,this.mapWith(Number),this.session=e.session,this.sql=t.buildCount(e.source,e.filters)}sql;token;static[h]=\"PgCountBuilder\";[Symbol.toStringTag]=\"PgCountBuilder\";session;static buildEmbeddedCount(e,r){return g`(select count(*) from ${e}${g.raw(\" where \").if(r)}${r})`}static buildCount(e,r){return g`select count(*) as count from ${e}${g.raw(\" where \").if(r)}${r};`}setToken(e){return this.token=e,this}then(e,r){return Promise.resolve(this.session.count(this.sql,this.token)).then(e,r)}catch(e){return this.then(void 0,e)}finally(e){return this.then(r=>(e?.(),r),r=>{throw e?.(),r})}};var Wo=class{constructor(e,r,n,i,a,s,o){this.fullSchema=e,this.schema=r,this.tableNamesMap=n,this.table=i,this.tableConfig=a,this.dialect=s,this.session=o}static[h]=\"PgRelationalQueryBuilder\";findMany(e){return new Go(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,e||{},\"many\")}findFirst(e){return new Go(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,e?{...e,limit:1}:{limit:1},\"first\")}},Go=class extends je{constructor(e,r,n,i,a,s,o,u,c){super(),this.fullSchema=e,this.schema=r,this.tableNamesMap=n,this.table=i,this.tableConfig=a,this.dialect=s,this.session=o,this.config=u,this.mode=c}static[h]=\"PgRelationalQuery\";_prepare(e){return ee.startActiveSpan(\"drizzle.prepareQuery\",()=>{let{query:r,builtQuery:n}=this._toSQL();return this.session.prepareQuery(n,void 0,e,!0,(i,a)=>{let s=i.map(o=>Bo(this.schema,this.tableConfig,o,r.selection,a));return this.mode===\"first\"?s[0]:s})})}prepare(e){return this._prepare(e)}_getQuery(){return this.dialect.buildRelationalQueryWithoutPK({fullSchema:this.fullSchema,schema:this.schema,tableNamesMap:this.tableNamesMap,table:this.table,tableConfig:this.tableConfig,queryConfig:this.config,tableAlias:this.tableConfig.tsName})}getSQL(){return this._getQuery().sql}_toSQL(){let e=this._getQuery(),r=this.dialect.sqlToQuery(e.sql);return{query:e,builtQuery:r}}toSQL(){return this._toSQL().builtQuery}authToken;setToken(e){return this.authToken=e,this}execute(){return ee.startActiveSpan(\"drizzle.operation\",()=>this._prepare().execute(void 0,this.authToken))}};var Jo=class extends je{constructor(e,r,n,i){super(),this.execute=e,this.sql=r,this.query=n,this.mapBatchResult=i}static[h]=\"PgRaw\";getSQL(){return this.sql}getQuery(){return this.query}mapResult(e,r){return r?this.mapBatchResult(e):e}_prepare(){return this}isResponseInArrayMode(){return!1}};var li=class{constructor(e,r,n){if(this.dialect=e,this.session=r,this._=n?{schema:n.schema,fullSchema:n.fullSchema,tableNamesMap:n.tableNamesMap,session:r}:{schema:void 0,fullSchema:{},tableNamesMap:{},session:r},this.query={},this._.schema)for(let[i,a]of Object.entries(this._.schema))this.query[i]=new Wo(n.fullSchema,this._.schema,this._.tableNamesMap,n.fullSchema[i],a,e,r)}static[h]=\"PgDatabase\";query;$with=(e,r)=>{let n=this;return{as:a=>(typeof a==\"function\"&&(a=a(new ui(n.dialect))),new Proxy(new ni(a.getSQL(),r??(\"getSelectedFields\"in a?a.getSelectedFields()??{}:{}),e,!0),new de({alias:e,sqlAliasedBehavior:\"alias\",sqlBehavior:\"error\"})))}};$count(e,r){return new Ko({source:e,filters:r,session:this.session})}with(...e){let r=this;function n(c){return new De({fields:c??void 0,session:r.session,dialect:r.dialect,withList:e})}function i(c){return new De({fields:c??void 0,session:r.session,dialect:r.dialect,withList:e,distinct:!0})}function a(c,l){return new De({fields:l??void 0,session:r.session,dialect:r.dialect,withList:e,distinct:{on:c}})}function s(c){return new Ia(c,r.session,r.dialect,e)}function o(c){return new Ra(c,r.session,r.dialect,e)}function u(c){return new ya(c,r.session,r.dialect,e)}return{select:n,selectDistinct:i,selectDistinctOn:a,update:s,insert:o,delete:u}}select(e){return new De({fields:e??void 0,session:this.session,dialect:this.dialect})}selectDistinct(e){return new De({fields:e??void 0,session:this.session,dialect:this.dialect,distinct:!0})}selectDistinctOn(e,r){return new De({fields:r??void 0,session:this.session,dialect:this.dialect,distinct:{on:e}})}update(e){return new Ia(e,this.session,this.dialect)}insert(e){return new Ra(e,this.session,this.dialect)}delete(e){return new ya(e,this.session,this.dialect)}refreshMaterializedView(e){return new Vo(e,this.session,this.dialect)}authToken;execute(e){let r=typeof e==\"string\"?g.raw(e):e.getSQL(),n=this.dialect.sqlToQuery(r),i=this.session.prepareQuery(n,void 0,void 0,!1);return new Jo(()=>i.execute(void 0,this.authToken),r,n,a=>i.mapResult(a,!0))}transaction(e,r){return this.session.transaction(e,r)}};var qf=class{constructor(e,r){this.unique=e,this.name=r}static[h]=\"PgIndexBuilderOn\";on(...e){return new Na(e.map(r=>{if(b(r,O))return r;r=r;let n=new ri(r.name,!!r.keyAsName,r.columnType,r.indexConfig);return r.indexConfig=JSON.parse(JSON.stringify(r.defaultConfig)),n}),this.unique,!1,this.name)}onOnly(...e){return new Na(e.map(r=>{if(b(r,O))return r;r=r;let n=new ri(r.name,!!r.keyAsName,r.columnType,r.indexConfig);return r.indexConfig=r.defaultConfig,n}),this.unique,!0,this.name)}using(e,...r){return new Na(r.map(n=>{if(b(n,O))return n;n=n;let i=new ri(n.name,!!n.keyAsName,n.columnType,n.indexConfig);return n.indexConfig=JSON.parse(JSON.stringify(n.defaultConfig)),i}),this.unique,!0,this.name,e)}},Na=class{static[h]=\"PgIndexBuilder\";config;constructor(e,r,n,i,a=\"btree\"){this.config={name:i,columns:e,unique:r,only:n,method:a}}concurrently(){return this.config.concurrently=!0,this}with(e){return this.config.with=e,this}where(e){return this.config.where=e,this}build(e){return new jf(this.config,e)}},jf=class{static[h]=\"PgIndex\";config;constructor(e,r){this.config={...e,table:r}}};function H_(t){return new qf(!1,t)}var Zo=class{constructor(e){this.query=e}authToken;getQuery(){return this.query}mapResult(e,r){return e}setToken(e){return this.authToken=e,this}static[h]=\"PgPreparedQuery\";joinsNotNullableMap},Xo=class{constructor(e){this.dialect=e}static[h]=\"PgSession\";execute(e,r){return ee.startActiveSpan(\"drizzle.operation\",()=>ee.startActiveSpan(\"drizzle.prepareQuery\",()=>this.prepareQuery(this.dialect.sqlToQuery(e),void 0,void 0,!1)).setToken(r).execute(void 0,r))}all(e){return this.prepareQuery(this.dialect.sqlToQuery(e),void 0,void 0,!1).all()}async count(e,r){let n=await this.execute(e,r);return Number(n[0].count)}},Yo=class extends li{constructor(e,r,n,i=0){super(e,r,n),this.schema=n,this.nestedIndex=i}static[h]=\"PgTransaction\";rollback(){throw new Do}getTransactionConfigSQL(e){let r=[];return e.isolationLevel&&r.push(`isolation level ${e.isolationLevel}`),e.accessMode&&r.push(e.accessMode),typeof e.deferrable==\"boolean\"&&r.push(e.deferrable?\"deferrable\":\"not deferrable\"),g.raw(r.join(\" \"))}setTransaction(e){return this.session.execute(g`set transaction ${this.getTransactionConfigSQL(e)}`)}};var{Pool:Q_,types:Mt}=yr,Df=class extends Zo{constructor(e,r,n,i,a,s,o,u){super({sql:r,params:n}),this.client=e,this.params=n,this.logger=i,this.fields=a,this._isResponseInArrayMode=o,this.customResultMapper=u,this.rawQueryConfig={name:s,text:r,types:{getTypeParser:(c,l)=>c===Mt.builtins.TIMESTAMPTZ?p=>p:c===Mt.builtins.TIMESTAMP?p=>p:c===Mt.builtins.DATE?p=>p:c===Mt.builtins.INTERVAL?p=>p:Mt.getTypeParser(c,l)}},this.queryConfig={name:s,text:r,rowMode:\"array\",types:{getTypeParser:(c,l)=>c===Mt.builtins.TIMESTAMPTZ?p=>p:c===Mt.builtins.TIMESTAMP?p=>p:c===Mt.builtins.DATE?p=>p:c===Mt.builtins.INTERVAL?p=>p:Mt.getTypeParser(c,l)}}}static[h]=\"NodePgPreparedQuery\";rawQueryConfig;queryConfig;async execute(e={}){return ee.startActiveSpan(\"drizzle.execute\",async()=>{let r=ld(this.params,e);this.logger.logQuery(this.rawQueryConfig.text,r);let{fields:n,rawQueryConfig:i,client:a,queryConfig:s,joinsNotNullableMap:o,customResultMapper:u}=this;if(!n&&!u)return ee.startActiveSpan(\"drizzle.driver.execute\",async l=>(l?.setAttributes({\"drizzle.query.name\":i.name,\"drizzle.query.text\":i.text,\"drizzle.query.params\":JSON.stringify(r)}),a.query(i,r)));let c=await ee.startActiveSpan(\"drizzle.driver.execute\",l=>(l?.setAttributes({\"drizzle.query.name\":s.name,\"drizzle.query.text\":s.text,\"drizzle.query.params\":JSON.stringify(r)}),a.query(s,r)));return ee.startActiveSpan(\"drizzle.mapResponse\",()=>u?u(c.rows):c.rows.map(l=>F1(n,l,o)))})}all(e={}){return ee.startActiveSpan(\"drizzle.execute\",()=>{let r=ld(this.params,e);return this.logger.logQuery(this.rawQueryConfig.text,r),ee.startActiveSpan(\"drizzle.driver.execute\",n=>(n?.setAttributes({\"drizzle.query.name\":this.rawQueryConfig.name,\"drizzle.query.text\":this.rawQueryConfig.text,\"drizzle.query.params\":JSON.stringify(r)}),this.client.query(this.rawQueryConfig,r).then(i=>i.rows)))})}isResponseInArrayMode(){return this._isResponseInArrayMode}},ec=class t extends Xo{constructor(e,r,n,i={}){super(r),this.client=e,this.schema=n,this.options=i,this.logger=i.logger??new Ao}static[h]=\"NodePgSession\";logger;prepareQuery(e,r,n,i,a){return new Df(this.client,e.sql,e.params,this.logger,r,n,i,a)}async transaction(e,r){let n=this.client instanceof Q_?new t(await this.client.connect(),this.dialect,this.schema,this.options):this,i=new Lf(this.dialect,n,this.schema);await i.execute(g`begin${r?g` ${i.getTransactionConfigSQL(r)}`:void 0}`);try{let a=await e(i);return await i.execute(g`commit`),a}catch(a){throw await i.execute(g`rollback`),a}finally{this.client instanceof Q_&&n.client.release()}}async count(e){let r=await this.execute(e);return Number(r.rows[0].count)}},Lf=class t extends Yo{static[h]=\"NodePgTransaction\";async transaction(e){let r=`sp${this.nestedIndex+1}`,n=new t(this.dialect,this.session,this.schema,this.nestedIndex+1);await n.execute(g.raw(`savepoint ${r}`));try{let i=await e(n);return await n.execute(g.raw(`release savepoint ${r}`)),i}catch(i){throw await n.execute(g.raw(`rollback to savepoint ${r}`)),i}}};var Mf=class{constructor(e,r,n={}){this.client=e,this.dialect=r,this.options=n}static[h]=\"NodePgDriver\";createSession(e){return new ec(this.client,this.dialect,e,{logger:this.options.logger})}},Ff=class extends li{static[h]=\"NodePgDatabase\"};function qa(t,e={}){let r=new br({casing:e.casing}),n;e.logger===!0?n=new ko:e.logger!==!1&&(n=e.logger);let i;if(e.schema){let u=U_(e.schema,z_);i={fullSchema:e.schema,schema:u.tables,tableNamesMap:u.tableNamesMap}}let s=new Mf(t,r,{logger:n}).createSession(i),o=new Ff(r,s,i);return o.$client=t,o}function tc(...t){if(typeof t[0]==\"string\"){let e=new yr.Pool({connectionString:t[0]});return qa(e,t[1])}if(B1(t[0])){let{connection:e,client:r,...n}=t[0];if(r)return qa(r,n);let i=typeof e==\"string\"?new yr.Pool({connectionString:e}):new yr.Pool(e);return qa(i,n)}return qa(t[0],t[1])}(t=>{function e(r){return qa({},r)}t.mock=e})(tc||(tc={}));var oc={};Rc(oc,{inquiries:()=>at,insertInquirySchema:()=>Hf,insertUserSchema:()=>lN,sessions:()=>uN,users:()=>Tr});var Ie={};Rc(Ie,{BRAND:()=>g9,DIRTY:()=>Vr,EMPTY_PATH:()=>WI,INVALID:()=>D,NEVER:()=>eN,OK:()=>Le,ParseStatus:()=>Re,Schema:()=>H,ZodAny:()=>Sr,ZodArray:()=>ar,ZodBigInt:()=>Wr,ZodBoolean:()=>Gr,ZodBranded:()=>Da,ZodCatch:()=>on,ZodDate:()=>Jr,ZodDefault:()=>sn,ZodDiscriminatedUnion:()=>ic,ZodEffects:()=>bt,ZodEnum:()=>nn,ZodError:()=>Ze,ZodFirstPartyTypeKind:()=>M,ZodFunction:()=>sc,ZodIntersection:()=>en,ZodIssueCode:()=>_,ZodLazy:()=>tn,ZodLiteral:()=>rn,ZodMap:()=>gi,ZodNaN:()=>yi,ZodNativeEnum:()=>an,ZodNever:()=>At,ZodNull:()=>Xr,ZodNullable:()=>Ut,ZodNumber:()=>Kr,ZodObject:()=>Xe,ZodOptional:()=>yt,ZodParsedType:()=>P,ZodPipeline:()=>La,ZodPromise:()=>Er,ZodReadonly:()=>cn,ZodRecord:()=>ac,ZodSchema:()=>H,ZodSet:()=>vi,ZodString:()=>_r,ZodSymbol:()=>hi,ZodTransformer:()=>bt,ZodTuple:()=>$t,ZodType:()=>H,ZodUndefined:()=>Zr,ZodUnion:()=>Yr,ZodUnknown:()=>ir,ZodVoid:()=>mi,addIssueToContext:()=>k,any:()=>T9,array:()=>P9,bigint:()=>b9,boolean:()=>rS,coerce:()=>Y9,custom:()=>Y_,date:()=>w9,datetimeRegex:()=>Z_,defaultErrorMap:()=>rr,discriminatedUnion:()=>N9,effect:()=>Q9,enum:()=>B9,function:()=>F9,getErrorMap:()=>pi,getParsedType:()=>Ft,instanceof:()=>y9,intersection:()=>q9,isAborted:()=>rc,isAsync:()=>di,isDirty:()=>nc,isValid:()=>wr,late:()=>v9,lazy:()=>$9,literal:()=>U9,makeIssue:()=>ja,map:()=>L9,nan:()=>x9,nativeEnum:()=>z9,never:()=>A9,null:()=>E9,nullable:()=>K9,number:()=>tS,object:()=>O9,objectUtil:()=>$f,oboolean:()=>X9,onumber:()=>Z9,optional:()=>V9,ostring:()=>J9,pipeline:()=>G9,preprocess:()=>W9,promise:()=>H9,quotelessJson:()=>QI,record:()=>D9,set:()=>M9,setErrorMap:()=>KI,strictObject:()=>R9,string:()=>eS,symbol:()=>_9,transformer:()=>Q9,tuple:()=>j9,undefined:()=>S9,union:()=>I9,unknown:()=>k9,util:()=>K,void:()=>C9});var K;(function(t){t.assertEqual=i=>{};function e(i){}t.assertIs=e;function r(i){throw new Error}t.assertNever=r,t.arrayToEnum=i=>{let a={};for(let s of i)a[s]=s;return a},t.getValidEnumValues=i=>{let a=t.objectKeys(i).filter(o=>typeof i[i[o]]!=\"number\"),s={};for(let o of a)s[o]=i[o];return t.objectValues(s)},t.objectValues=i=>t.objectKeys(i).map(function(a){return i[a]}),t.objectKeys=typeof Object.keys==\"function\"?i=>Object.keys(i):i=>{let a=[];for(let s in i)Object.prototype.hasOwnProperty.call(i,s)&&a.push(s);return a},t.find=(i,a)=>{for(let s of i)if(a(s))return s},t.isInteger=typeof Number.isInteger==\"function\"?i=>Number.isInteger(i):i=>typeof i==\"number\"&&Number.isFinite(i)&&Math.floor(i)===i;function n(i,a=\" | \"){return i.map(s=>typeof s==\"string\"?`'${s}'`:s).join(a)}t.joinValues=n,t.jsonStringifyReplacer=(i,a)=>typeof a==\"bigint\"?a.toString():a})(K||(K={}));var $f;(function(t){t.mergeShapes=(e,r)=>({...e,...r})})($f||($f={}));var P=K.arrayToEnum([\"string\",\"nan\",\"number\",\"integer\",\"float\",\"boolean\",\"date\",\"bigint\",\"symbol\",\"function\",\"undefined\",\"null\",\"array\",\"object\",\"unknown\",\"promise\",\"void\",\"never\",\"map\",\"set\"]),Ft=t=>{switch(typeof t){case\"undefined\":return P.undefined;case\"string\":return P.string;case\"number\":return Number.isNaN(t)?P.nan:P.number;case\"boolean\":return P.boolean;case\"function\":return P.function;case\"bigint\":return P.bigint;case\"symbol\":return P.symbol;case\"object\":return Array.isArray(t)?P.array:t===null?P.null:t.then&&typeof t.then==\"function\"&&t.catch&&typeof t.catch==\"function\"?P.promise:typeof Map<\"u\"&&t instanceof Map?P.map:typeof Set<\"u\"&&t instanceof Set?P.set:typeof Date<\"u\"&&t instanceof Date?P.date:P.object;default:return P.unknown}};var _=K.arrayToEnum([\"invalid_type\",\"invalid_literal\",\"custom\",\"invalid_union\",\"invalid_union_discriminator\",\"invalid_enum_value\",\"unrecognized_keys\",\"invalid_arguments\",\"invalid_return_type\",\"invalid_date\",\"invalid_string\",\"too_small\",\"too_big\",\"invalid_intersection_types\",\"not_multiple_of\",\"not_finite\"]),QI=t=>JSON.stringify(t,null,2).replace(/\"([^\"]+)\":/g,\"$1:\"),Ze=class t extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};let r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name=\"ZodError\",this.issues=e}format(e){let r=e||function(a){return a.message},n={_errors:[]},i=a=>{for(let s of a.issues)if(s.code===\"invalid_union\")s.unionErrors.map(i);else if(s.code===\"invalid_return_type\")i(s.returnTypeError);else if(s.code===\"invalid_arguments\")i(s.argumentsError);else if(s.path.length===0)n._errors.push(r(s));else{let o=n,u=0;for(;u<s.path.length;){let c=s.path[u];u===s.path.length-1?(o[c]=o[c]||{_errors:[]},o[c]._errors.push(r(s))):o[c]=o[c]||{_errors:[]},o=o[c],u++}}};return i(this),n}static assert(e){if(!(e instanceof t))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,K.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=r=>r.message){let r={},n=[];for(let i of this.issues)if(i.path.length>0){let a=i.path[0];r[a]=r[a]||[],r[a].push(e(i))}else n.push(e(i));return{formErrors:n,fieldErrors:r}}get formErrors(){return this.flatten()}};Ze.create=t=>new Ze(t);var VI=(t,e)=>{let r;switch(t.code){case _.invalid_type:t.received===P.undefined?r=\"Required\":r=`Expected ${t.expected}, received ${t.received}`;break;case _.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(t.expected,K.jsonStringifyReplacer)}`;break;case _.unrecognized_keys:r=`Unrecognized key(s) in object: ${K.joinValues(t.keys,\", \")}`;break;case _.invalid_union:r=\"Invalid input\";break;case _.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${K.joinValues(t.options)}`;break;case _.invalid_enum_value:r=`Invalid enum value. Expected ${K.joinValues(t.options)}, received '${t.received}'`;break;case _.invalid_arguments:r=\"Invalid function arguments\";break;case _.invalid_return_type:r=\"Invalid function return type\";break;case _.invalid_date:r=\"Invalid date\";break;case _.invalid_string:typeof t.validation==\"object\"?\"includes\"in t.validation?(r=`Invalid input: must include \"${t.validation.includes}\"`,typeof t.validation.position==\"number\"&&(r=`${r} at one or more positions greater than or equal to ${t.validation.position}`)):\"startsWith\"in t.validation?r=`Invalid input: must start with \"${t.validation.startsWith}\"`:\"endsWith\"in t.validation?r=`Invalid input: must end with \"${t.validation.endsWith}\"`:K.assertNever(t.validation):t.validation!==\"regex\"?r=`Invalid ${t.validation}`:r=\"Invalid\";break;case _.too_small:t.type===\"array\"?r=`Array must contain ${t.exact?\"exactly\":t.inclusive?\"at least\":\"more than\"} ${t.minimum} element(s)`:t.type===\"string\"?r=`String must contain ${t.exact?\"exactly\":t.inclusive?\"at least\":\"over\"} ${t.minimum} character(s)`:t.type===\"number\"?r=`Number must be ${t.exact?\"exactly equal to \":t.inclusive?\"greater than or equal to \":\"greater than \"}${t.minimum}`:t.type===\"bigint\"?r=`Number must be ${t.exact?\"exactly equal to \":t.inclusive?\"greater than or equal to \":\"greater than \"}${t.minimum}`:t.type===\"date\"?r=`Date must be ${t.exact?\"exactly equal to \":t.inclusive?\"greater than or equal to \":\"greater than \"}${new Date(Number(t.minimum))}`:r=\"Invalid input\";break;case _.too_big:t.type===\"array\"?r=`Array must contain ${t.exact?\"exactly\":t.inclusive?\"at most\":\"less than\"} ${t.maximum} element(s)`:t.type===\"string\"?r=`String must contain ${t.exact?\"exactly\":t.inclusive?\"at most\":\"under\"} ${t.maximum} character(s)`:t.type===\"number\"?r=`Number must be ${t.exact?\"exactly\":t.inclusive?\"less than or equal to\":\"less than\"} ${t.maximum}`:t.type===\"bigint\"?r=`BigInt must be ${t.exact?\"exactly\":t.inclusive?\"less than or equal to\":\"less than\"} ${t.maximum}`:t.type===\"date\"?r=`Date must be ${t.exact?\"exactly\":t.inclusive?\"smaller than or equal to\":\"smaller than\"} ${new Date(Number(t.maximum))}`:r=\"Invalid input\";break;case _.custom:r=\"Invalid input\";break;case _.invalid_intersection_types:r=\"Intersection results could not be merged\";break;case _.not_multiple_of:r=`Number must be a multiple of ${t.multipleOf}`;break;case _.not_finite:r=\"Number must be finite\";break;default:r=e.defaultError,K.assertNever(t)}return{message:r}},rr=VI;var V_=rr;function KI(t){V_=t}function pi(){return V_}var ja=t=>{let{data:e,path:r,errorMaps:n,issueData:i}=t,a=[...r,...i.path||[]],s={...i,path:a};if(i.message!==void 0)return{...i,path:a,message:i.message};let o=\"\",u=n.filter(c=>!!c).slice().reverse();for(let c of u)o=c(s,{data:e,defaultError:o}).message;return{...i,path:a,message:o}},WI=[];function k(t,e){let r=pi(),n=ja({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,r,r===rr?void 0:rr].filter(i=>!!i)});t.common.issues.push(n)}var Re=class t{constructor(){this.value=\"valid\"}dirty(){this.value===\"valid\"&&(this.value=\"dirty\")}abort(){this.value!==\"aborted\"&&(this.value=\"aborted\")}static mergeArray(e,r){let n=[];for(let i of r){if(i.status===\"aborted\")return D;i.status===\"dirty\"&&e.dirty(),n.push(i.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,r){let n=[];for(let i of r){let a=await i.key,s=await i.value;n.push({key:a,value:s})}return t.mergeObjectSync(e,n)}static mergeObjectSync(e,r){let n={};for(let i of r){let{key:a,value:s}=i;if(a.status===\"aborted\"||s.status===\"aborted\")return D;a.status===\"dirty\"&&e.dirty(),s.status===\"dirty\"&&e.dirty(),a.value!==\"__proto__\"&&(typeof s.value<\"u\"||i.alwaysSet)&&(n[a.value]=s.value)}return{status:e.value,value:n}}},D=Object.freeze({status:\"aborted\"}),Vr=t=>({status:\"dirty\",value:t}),Le=t=>({status:\"valid\",value:t}),rc=t=>t.status===\"aborted\",nc=t=>t.status===\"dirty\",wr=t=>t.status===\"valid\",di=t=>typeof Promise<\"u\"&&t instanceof Promise;var q;(function(t){t.errToObj=e=>typeof e==\"string\"?{message:e}:e||{},t.toString=e=>typeof e==\"string\"?e:e?.message})(q||(q={}));var xt=class{constructor(e,r,n,i){this._cachedPath=[],this.parent=e,this.data=r,this._path=n,this._key=i}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}},K_=(t,e)=>{if(wr(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error(\"Validation failed but no issues detected.\");return{success:!1,get error(){if(this._error)return this._error;let r=new Ze(t.common.issues);return this._error=r,this._error}}};function z(t){if(!t)return{};let{errorMap:e,invalid_type_error:r,required_error:n,description:i}=t;if(e&&(r||n))throw new Error(`Can't use \"invalid_type_error\" or \"required_error\" in conjunction with custom error map.`);return e?{errorMap:e,description:i}:{errorMap:(s,o)=>{let{message:u}=t;return s.code===\"invalid_enum_value\"?{message:u??o.defaultError}:typeof o.data>\"u\"?{message:u??n??o.defaultError}:s.code!==\"invalid_type\"?{message:o.defaultError}:{message:u??r??o.defaultError}},description:i}}var H=class{get description(){return this._def.description}_getType(e){return Ft(e.data)}_getOrReturnCtx(e,r){return r||{common:e.parent.common,data:e.data,parsedType:Ft(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Re,ctx:{common:e.parent.common,data:e.data,parsedType:Ft(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let r=this._parse(e);if(di(r))throw new Error(\"Synchronous parse encountered promise.\");return r}_parseAsync(e){let r=this._parse(e);return Promise.resolve(r)}parse(e,r){let n=this.safeParse(e,r);if(n.success)return n.data;throw n.error}safeParse(e,r){let n={common:{issues:[],async:r?.async??!1,contextualErrorMap:r?.errorMap},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ft(e)},i=this._parseSync({data:e,path:n.path,parent:n});return K_(n,i)}\"~validate\"(e){let r={common:{issues:[],async:!!this[\"~standard\"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ft(e)};if(!this[\"~standard\"].async)try{let n=this._parseSync({data:e,path:[],parent:r});return wr(n)?{value:n.value}:{issues:r.common.issues}}catch(n){n?.message?.toLowerCase()?.includes(\"encountered\")&&(this[\"~standard\"].async=!0),r.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:r}).then(n=>wr(n)?{value:n.value}:{issues:r.common.issues})}async parseAsync(e,r){let n=await this.safeParseAsync(e,r);if(n.success)return n.data;throw n.error}async safeParseAsync(e,r){let n={common:{issues:[],contextualErrorMap:r?.errorMap,async:!0},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ft(e)},i=this._parse({data:e,path:n.path,parent:n}),a=await(di(i)?i:Promise.resolve(i));return K_(n,a)}refine(e,r){let n=i=>typeof r==\"string\"||typeof r>\"u\"?{message:r}:typeof r==\"function\"?r(i):r;return this._refinement((i,a)=>{let s=e(i),o=()=>a.addIssue({code:_.custom,...n(i)});return typeof Promise<\"u\"&&s instanceof Promise?s.then(u=>u?!0:(o(),!1)):s?!0:(o(),!1)})}refinement(e,r){return this._refinement((n,i)=>e(n)?!0:(i.addIssue(typeof r==\"function\"?r(n,i):r),!1))}_refinement(e){return new bt({schema:this,typeName:M.ZodEffects,effect:{type:\"refinement\",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this[\"~standard\"]={version:1,vendor:\"zod\",validate:r=>this[\"~validate\"](r)}}optional(){return yt.create(this,this._def)}nullable(){return Ut.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return ar.create(this)}promise(){return Er.create(this,this._def)}or(e){return Yr.create([this,e],this._def)}and(e){return en.create(this,e,this._def)}transform(e){return new bt({...z(this._def),schema:this,typeName:M.ZodEffects,effect:{type:\"transform\",transform:e}})}default(e){let r=typeof e==\"function\"?e:()=>e;return new sn({...z(this._def),innerType:this,defaultValue:r,typeName:M.ZodDefault})}brand(){return new Da({typeName:M.ZodBranded,type:this,...z(this._def)})}catch(e){let r=typeof e==\"function\"?e:()=>e;return new on({...z(this._def),innerType:this,catchValue:r,typeName:M.ZodCatch})}describe(e){let r=this.constructor;return new r({...this._def,description:e})}pipe(e){return La.create(this,e)}readonly(){return cn.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}},GI=/^c[^\\s-]{8,}$/i,JI=/^[0-9a-z]+$/,ZI=/^[0-9A-HJKMNP-TV-Z]{26}$/i,XI=/^[0-9a-fA-F]{8}\\b-[0-9a-fA-F]{4}\\b-[0-9a-fA-F]{4}\\b-[0-9a-fA-F]{4}\\b-[0-9a-fA-F]{12}$/i,YI=/^[a-z0-9_-]{21}$/i,e9=/^[A-Za-z0-9-_]+\\.[A-Za-z0-9-_]+\\.[A-Za-z0-9-_]*$/,t9=/^[-+]?P(?!$)(?:(?:[-+]?\\d+Y)|(?:[-+]?\\d+[.,]\\d+Y$))?(?:(?:[-+]?\\d+M)|(?:[-+]?\\d+[.,]\\d+M$))?(?:(?:[-+]?\\d+W)|(?:[-+]?\\d+[.,]\\d+W$))?(?:(?:[-+]?\\d+D)|(?:[-+]?\\d+[.,]\\d+D$))?(?:T(?=[\\d+-])(?:(?:[-+]?\\d+H)|(?:[-+]?\\d+[.,]\\d+H$))?(?:(?:[-+]?\\d+M)|(?:[-+]?\\d+[.,]\\d+M$))?(?:[-+]?\\d+(?:[.,]\\d+)?S)?)??$/,r9=/^(?!\\.)(?!.*\\.\\.)([A-Z0-9_'+\\-\\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\\-]*\\.)+[A-Z]{2,}$/i,n9=\"^(\\\\p{Extended_Pictographic}|\\\\p{Emoji_Component})+$\",Uf,i9=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,a9=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\\/(3[0-2]|[12]?[0-9])$/,s9=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,o9=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,c9=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,u9=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,G_=\"((\\\\d\\\\d[2468][048]|\\\\d\\\\d[13579][26]|\\\\d\\\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\\\d|30)|(02)-(0[1-9]|1\\\\d|2[0-8])))\",l9=new RegExp(`^${G_}$`);function J_(t){let e=\"[0-5]\\\\d\";t.precision?e=`${e}\\\\.\\\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\\\.\\\\d+)?`);let r=t.precision?\"+\":\"?\";return`([01]\\\\d|2[0-3]):[0-5]\\\\d(:${e})${r}`}function p9(t){return new RegExp(`^${J_(t)}$`)}function Z_(t){let e=`${G_}T${J_(t)}`,r=[];return r.push(t.local?\"Z?\":\"Z\"),t.offset&&r.push(\"([+-]\\\\d{2}:?\\\\d{2})\"),e=`${e}(${r.join(\"|\")})`,new RegExp(`^${e}$`)}function d9(t,e){return!!((e===\"v4\"||!e)&&i9.test(t)||(e===\"v6\"||!e)&&s9.test(t))}function f9(t,e){if(!e9.test(t))return!1;try{let[r]=t.split(\".\");if(!r)return!1;let n=r.replace(/-/g,\"+\").replace(/_/g,\"/\").padEnd(r.length+(4-r.length%4)%4,\"=\"),i=JSON.parse(atob(n));return!(typeof i!=\"object\"||i===null||\"typ\"in i&&i?.typ!==\"JWT\"||!i.alg||e&&i.alg!==e)}catch{return!1}}function h9(t,e){return!!((e===\"v4\"||!e)&&a9.test(t)||(e===\"v6\"||!e)&&o9.test(t))}var _r=class t extends H{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==P.string){let a=this._getOrReturnCtx(e);return k(a,{code:_.invalid_type,expected:P.string,received:a.parsedType}),D}let n=new Re,i;for(let a of this._def.checks)if(a.kind===\"min\")e.data.length<a.value&&(i=this._getOrReturnCtx(e,i),k(i,{code:_.too_small,minimum:a.value,type:\"string\",inclusive:!0,exact:!1,message:a.message}),n.dirty());else if(a.kind===\"max\")e.data.length>a.value&&(i=this._getOrReturnCtx(e,i),k(i,{code:_.too_big,maximum:a.value,type:\"string\",inclusive:!0,exact:!1,message:a.message}),n.dirty());else if(a.kind===\"length\"){let s=e.data.length>a.value,o=e.data.length<a.value;(s||o)&&(i=this._getOrReturnCtx(e,i),s?k(i,{code:_.too_big,maximum:a.value,type:\"string\",inclusive:!0,exact:!0,message:a.message}):o&&k(i,{code:_.too_small,minimum:a.value,type:\"string\",inclusive:!0,exact:!0,message:a.message}),n.dirty())}else if(a.kind===\"email\")r9.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"email\",code:_.invalid_string,message:a.message}),n.dirty());else if(a.kind===\"emoji\")Uf||(Uf=new RegExp(n9,\"u\")),Uf.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"emoji\",code:_.invalid_string,message:a.message}),n.dirty());else if(a.kind===\"uuid\")XI.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"uuid\",code:_.invalid_string,message:a.message}),n.dirty());else if(a.kind===\"nanoid\")YI.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"nanoid\",code:_.invalid_string,message:a.message}),n.dirty());else if(a.kind===\"cuid\")GI.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"cuid\",code:_.invalid_string,message:a.message}),n.dirty());else if(a.kind===\"cuid2\")JI.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"cuid2\",code:_.invalid_string,message:a.message}),n.dirty());else if(a.kind===\"ulid\")ZI.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"ulid\",code:_.invalid_string,message:a.message}),n.dirty());else if(a.kind===\"url\")try{new URL(e.data)}catch{i=this._getOrReturnCtx(e,i),k(i,{validation:\"url\",code:_.invalid_string,message:a.message}),n.dirty()}else a.kind===\"regex\"?(a.regex.lastIndex=0,a.regex.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"regex\",code:_.invalid_string,message:a.message}),n.dirty())):a.kind===\"trim\"?e.data=e.data.trim():a.kind===\"includes\"?e.data.includes(a.value,a.position)||(i=this._getOrReturnCtx(e,i),k(i,{code:_.invalid_string,validation:{includes:a.value,position:a.position},message:a.message}),n.dirty()):a.kind===\"toLowerCase\"?e.data=e.data.toLowerCase():a.kind===\"toUpperCase\"?e.data=e.data.toUpperCase():a.kind===\"startsWith\"?e.data.startsWith(a.value)||(i=this._getOrReturnCtx(e,i),k(i,{code:_.invalid_string,validation:{startsWith:a.value},message:a.message}),n.dirty()):a.kind===\"endsWith\"?e.data.endsWith(a.value)||(i=this._getOrReturnCtx(e,i),k(i,{code:_.invalid_string,validation:{endsWith:a.value},message:a.message}),n.dirty()):a.kind===\"datetime\"?Z_(a).test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{code:_.invalid_string,validation:\"datetime\",message:a.message}),n.dirty()):a.kind===\"date\"?l9.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{code:_.invalid_string,validation:\"date\",message:a.message}),n.dirty()):a.kind===\"time\"?p9(a).test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{code:_.invalid_string,validation:\"time\",message:a.message}),n.dirty()):a.kind===\"duration\"?t9.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"duration\",code:_.invalid_string,message:a.message}),n.dirty()):a.kind===\"ip\"?d9(e.data,a.version)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"ip\",code:_.invalid_string,message:a.message}),n.dirty()):a.kind===\"jwt\"?f9(e.data,a.alg)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"jwt\",code:_.invalid_string,message:a.message}),n.dirty()):a.kind===\"cidr\"?h9(e.data,a.version)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"cidr\",code:_.invalid_string,message:a.message}),n.dirty()):a.kind===\"base64\"?c9.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"base64\",code:_.invalid_string,message:a.message}),n.dirty()):a.kind===\"base64url\"?u9.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"base64url\",code:_.invalid_string,message:a.message}),n.dirty()):K.assertNever(a);return{status:n.value,value:e.data}}_regex(e,r,n){return this.refinement(i=>e.test(i),{validation:r,code:_.invalid_string,...q.errToObj(n)})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:\"email\",...q.errToObj(e)})}url(e){return this._addCheck({kind:\"url\",...q.errToObj(e)})}emoji(e){return this._addCheck({kind:\"emoji\",...q.errToObj(e)})}uuid(e){return this._addCheck({kind:\"uuid\",...q.errToObj(e)})}nanoid(e){return this._addCheck({kind:\"nanoid\",...q.errToObj(e)})}cuid(e){return this._addCheck({kind:\"cuid\",...q.errToObj(e)})}cuid2(e){return this._addCheck({kind:\"cuid2\",...q.errToObj(e)})}ulid(e){return this._addCheck({kind:\"ulid\",...q.errToObj(e)})}base64(e){return this._addCheck({kind:\"base64\",...q.errToObj(e)})}base64url(e){return this._addCheck({kind:\"base64url\",...q.errToObj(e)})}jwt(e){return this._addCheck({kind:\"jwt\",...q.errToObj(e)})}ip(e){return this._addCheck({kind:\"ip\",...q.errToObj(e)})}cidr(e){return this._addCheck({kind:\"cidr\",...q.errToObj(e)})}datetime(e){return typeof e==\"string\"?this._addCheck({kind:\"datetime\",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:\"datetime\",precision:typeof e?.precision>\"u\"?null:e?.precision,offset:e?.offset??!1,local:e?.local??!1,...q.errToObj(e?.message)})}date(e){return this._addCheck({kind:\"date\",message:e})}time(e){return typeof e==\"string\"?this._addCheck({kind:\"time\",precision:null,message:e}):this._addCheck({kind:\"time\",precision:typeof e?.precision>\"u\"?null:e?.precision,...q.errToObj(e?.message)})}duration(e){return this._addCheck({kind:\"duration\",...q.errToObj(e)})}regex(e,r){return this._addCheck({kind:\"regex\",regex:e,...q.errToObj(r)})}includes(e,r){return this._addCheck({kind:\"includes\",value:e,position:r?.position,...q.errToObj(r?.message)})}startsWith(e,r){return this._addCheck({kind:\"startsWith\",value:e,...q.errToObj(r)})}endsWith(e,r){return this._addCheck({kind:\"endsWith\",value:e,...q.errToObj(r)})}min(e,r){return this._addCheck({kind:\"min\",value:e,...q.errToObj(r)})}max(e,r){return this._addCheck({kind:\"max\",value:e,...q.errToObj(r)})}length(e,r){return this._addCheck({kind:\"length\",value:e,...q.errToObj(r)})}nonempty(e){return this.min(1,q.errToObj(e))}trim(){return new t({...this._def,checks:[...this._def.checks,{kind:\"trim\"}]})}toLowerCase(){return new t({...this._def,checks:[...this._def.checks,{kind:\"toLowerCase\"}]})}toUpperCase(){return new t({...this._def,checks:[...this._def.checks,{kind:\"toUpperCase\"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind===\"datetime\")}get isDate(){return!!this._def.checks.find(e=>e.kind===\"date\")}get isTime(){return!!this._def.checks.find(e=>e.kind===\"time\")}get isDuration(){return!!this._def.checks.find(e=>e.kind===\"duration\")}get isEmail(){return!!this._def.checks.find(e=>e.kind===\"email\")}get isURL(){return!!this._def.checks.find(e=>e.kind===\"url\")}get isEmoji(){return!!this._def.checks.find(e=>e.kind===\"emoji\")}get isUUID(){return!!this._def.checks.find(e=>e.kind===\"uuid\")}get isNANOID(){return!!this._def.checks.find(e=>e.kind===\"nanoid\")}get isCUID(){return!!this._def.checks.find(e=>e.kind===\"cuid\")}get isCUID2(){return!!this._def.checks.find(e=>e.kind===\"cuid2\")}get isULID(){return!!this._def.checks.find(e=>e.kind===\"ulid\")}get isIP(){return!!this._def.checks.find(e=>e.kind===\"ip\")}get isCIDR(){return!!this._def.checks.find(e=>e.kind===\"cidr\")}get isBase64(){return!!this._def.checks.find(e=>e.kind===\"base64\")}get isBase64url(){return!!this._def.checks.find(e=>e.kind===\"base64url\")}get minLength(){let e=null;for(let r of this._def.checks)r.kind===\"min\"&&(e===null||r.value>e)&&(e=r.value);return e}get maxLength(){let e=null;for(let r of this._def.checks)r.kind===\"max\"&&(e===null||r.value<e)&&(e=r.value);return e}};_r.create=t=>new _r({checks:[],typeName:M.ZodString,coerce:t?.coerce??!1,...z(t)});function m9(t,e){let r=(t.toString().split(\".\")[1]||\"\").length,n=(e.toString().split(\".\")[1]||\"\").length,i=r>n?r:n,a=Number.parseInt(t.toFixed(i).replace(\".\",\"\")),s=Number.parseInt(e.toFixed(i).replace(\".\",\"\"));return a%s/10**i}var Kr=class t extends H{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==P.number){let a=this._getOrReturnCtx(e);return k(a,{code:_.invalid_type,expected:P.number,received:a.parsedType}),D}let n,i=new Re;for(let a of this._def.checks)a.kind===\"int\"?K.isInteger(e.data)||(n=this._getOrReturnCtx(e,n),k(n,{code:_.invalid_type,expected:\"integer\",received:\"float\",message:a.message}),i.dirty()):a.kind===\"min\"?(a.inclusive?e.data<a.value:e.data<=a.value)&&(n=this._getOrReturnCtx(e,n),k(n,{code:_.too_small,minimum:a.value,type:\"number\",inclusive:a.inclusive,exact:!1,message:a.message}),i.dirty()):a.kind===\"max\"?(a.inclusive?e.data>a.value:e.data>=a.value)&&(n=this._getOrReturnCtx(e,n),k(n,{code:_.too_big,maximum:a.value,type:\"number\",inclusive:a.inclusive,exact:!1,message:a.message}),i.dirty()):a.kind===\"multipleOf\"?m9(e.data,a.value)!==0&&(n=this._getOrReturnCtx(e,n),k(n,{code:_.not_multiple_of,multipleOf:a.value,message:a.message}),i.dirty()):a.kind===\"finite\"?Number.isFinite(e.data)||(n=this._getOrReturnCtx(e,n),k(n,{code:_.not_finite,message:a.message}),i.dirty()):K.assertNever(a);return{status:i.value,value:e.data}}gte(e,r){return this.setLimit(\"min\",e,!0,q.toString(r))}gt(e,r){return this.setLimit(\"min\",e,!1,q.toString(r))}lte(e,r){return this.setLimit(\"max\",e,!0,q.toString(r))}lt(e,r){return this.setLimit(\"max\",e,!1,q.toString(r))}setLimit(e,r,n,i){return new t({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:n,message:q.toString(i)}]})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:\"int\",message:q.toString(e)})}positive(e){return this._addCheck({kind:\"min\",value:0,inclusive:!1,message:q.toString(e)})}negative(e){return this._addCheck({kind:\"max\",value:0,inclusive:!1,message:q.toString(e)})}nonpositive(e){return this._addCheck({kind:\"max\",value:0,inclusive:!0,message:q.toString(e)})}nonnegative(e){return this._addCheck({kind:\"min\",value:0,inclusive:!0,message:q.toString(e)})}multipleOf(e,r){return this._addCheck({kind:\"multipleOf\",value:e,message:q.toString(r)})}finite(e){return this._addCheck({kind:\"finite\",message:q.toString(e)})}safe(e){return this._addCheck({kind:\"min\",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:q.toString(e)})._addCheck({kind:\"max\",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:q.toString(e)})}get minValue(){let e=null;for(let r of this._def.checks)r.kind===\"min\"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(let r of this._def.checks)r.kind===\"max\"&&(e===null||r.value<e)&&(e=r.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind===\"int\"||e.kind===\"multipleOf\"&&K.isInteger(e.value))}get isFinite(){let e=null,r=null;for(let n of this._def.checks){if(n.kind===\"finite\"||n.kind===\"int\"||n.kind===\"multipleOf\")return!0;n.kind===\"min\"?(r===null||n.value>r)&&(r=n.value):n.kind===\"max\"&&(e===null||n.value<e)&&(e=n.value)}return Number.isFinite(r)&&NumberThu, 29 Jan 2026 21:34:47 GMT express-session deprecated req.secret; provide secret option at node:internal/modules/cjs/loader:1706:14","attributes":{"level":"error"},"tags":{"project":"29c6c2c4-ea10-4fe6-8901-1198a13520db","environment":"9a47f9fb-0d50-4031-a85e-16db1d46fb86","service":"09a1965e-88d6-44ee-9836-14176d4bb0b5","deployment":"e78c90dd-bc00-48f5-9312-8a8fa977b2c2","replica":"68b779c1-91b1-4ca6-88f4-a907899be5f1"},"timestamp":"2026-01-29T21:34:47.409592447Z"},{"message":"/app/dist/index.cjs:71","attributes":{"level":"error"},"tags":{"project":"29c6c2c4-ea10-4fe6-8901-1198a13520db","environment":"9a47f9fb-0d50-4031-a85e-16db1d46fb86","service":"09a1965e-88d6-44ee-9836-14176d4bb0b5","deployment":"e78c90dd-bc00-48f5-9312-8a8fa977b2c2","replica":"68b779c1-91b1-4ca6-88f4-a907899be5f1"},"timestamp":"2026-01-29T21:34:47.466934064Z"},{"message":"\t\t`;await r.execute(g`CREATE SCHEMA IF NOT EXISTS ${g.identifier(a)}`),await r.execute(s);let u=(await r.all(g`select id, hash, created_at from ${g.identifier(a)}.${g.identifier(i)} order by created_at desc limit 1`))[0];await r.transaction(async c=>{for await(let l of e)if(!u||Number(u.created_at)<l.folderMillis){for(let p of l.sql)await c.execute(g.raw(p));await c.execute(g`insert into ${g.identifier(a)}.${g.identifier(i)} (\"hash\", \"created_at\") values(${l.hash}, ${l.folderMillis})`)}})}escapeName(e){return`\"${e}\"`}escapeParam(e){return`$${e+1}`}escapeString(e){return`'${e.replace(/'/g,\"''\")}'`}buildWithCTE(e){if(!e?.length)return;let r=[g`with `];for(let[n,i]of e.entries())r.push(g`${g.identifier(i._.alias)} as (${i._.sql})`),n<e.length-1&&r.push(g`, `);return r.push(g` `),g.join(r)}buildDeleteQuery({table:e,where:r,returning:n,withList:i}){let a=this.buildWithCTE(i),s=n?g` returning ${this.buildSelection(n,{isSingleTable:!0})}`:void 0,o=r?g` where ${r}`:void 0;return g`${a}delete from ${e}${o}${s}`}buildUpdateSet(e,r){let n=e[A.Symbol.Columns],i=Object.keys(n).filter(s=>r[s]!==void 0||n[s]?.onUpdateFn!==void 0),a=i.length;return g.join(i.flatMap((s,o)=>{let u=n[s],c=r[s]??g.param(u.onUpdateFn(),u),l=g`${g.identifier(this.casing.getColumnCasing(u))} = ${c}`;return o<a-1?[l,g.raw(\", \")]:[l]}))}buildUpdateQuery({table:e,set:r,where:n,returning:i,withList:a,from:s,joins:o}){let u=this.buildWithCTE(a),c=e[Te.Symbol.Name],l=e[Te.Symbol.Schema],p=e[Te.Symbol.OriginalName],d=c===p?void 0:c,f=g`${l?g`${g.identifier(l)}.`:void 0}${g.identifier(p)}${d&&g` ${g.identifier(d)}`}`,y=this.buildUpdateSet(e,r),m=s&&g.join([g.raw(\" from \"),this.buildFromTable(s)]),x=this.buildJoins(o),w=i?g` returning ${this.buildSelection(i,{isSingleTable:!s})}`:void 0,T=n?g` where ${n}`:void 0;return g`${u}update ${f} set ${y}${m}${x}${T}${w}`}buildSelection(e,{isSingleTable:r=!1}={}){let n=e.length,i=e.flatMap(({field:a},s)=>{let o=[];if(b(a,O.Aliased)&&a.isSelectionField)o.push(g.identifier(a.fieldAlias));else if(b(a,O.Aliased)||b(a,O)){let u=b(a,O.Aliased)?a.sql:a;r?o.push(new O(u.queryChunks.map(c=>b(c,E)?g.identifier(this.casing.getColumnCasing(c)):c))):o.push(u),b(a,O.Aliased)&&o.push(g` as ${g.identifier(a.fieldAlias)}`)}else b(a,J)&&(r?o.push(g.identifier(this.casing.getColumnCasing(a))):o.push(a));return s<n-1&&o.push(g`, `),o});return g.join(i)}buildJoins(e){if(!e||e.length===0)return;let r=[];for(let[n,i]of e.entries()){n===0&&r.push(g` `);let a=i.table,s=i.lateral?g` lateral`:void 0;if(b(a,Te)){let o=a[Te.Symbol.Name],u=a[Te.Symbol.Schema],c=a[Te.Symbol.OriginalName],l=o===c?void 0:i.alias;r.push(g`${g.raw(i.joinType)} join${s} ${u?g`${g.identifier(u)}.`:void 0}${g.identifier(c)}${l&&g` ${g.identifier(l)}`} on ${i.on}`)}else if(b(a,Ue)){let o=a[te].name,u=a[te].schema,c=a[te].originalName,l=o===c?void 0:i.alias;r.push(g`${g.raw(i.joinType)} join${s} ${u?g`${g.identifier(u)}.`:void 0}${g.identifier(c)}${l&&g` ${g.identifier(l)}`} on ${i.on}`)}else r.push(g`${g.raw(i.joinType)} join${s} ${a} on ${i.on}`);n<e.length-1&&r.push(g` `)}return g.join(r)}buildFromTable(e){if(b(e,A)&&e[A.Symbol.OriginalName]!==e[A.Symbol.Name]){let r=g`${g.identifier(e[A.Symbol.OriginalName])}`;return e[A.Symbol.Schema]&&(r=g`${g.identifier(e[A.Symbol.Schema])}.${r}`),g`${r} ${g.identifier(e[A.Symbol.Name])}`}return e}buildSelectQuery({withList:e,fields:r,fieldsFlat:n,where:i,having:a,table:s,joins:o,orderBy:u,groupBy:c,limit:l,offset:p,lockingClause:d,distinct:f,setOperators:y}){let m=n??gt(r);for(let ne of m)if(b(ne.field,J)&&We(ne.field.table)!==(b(s,ye)?s._.alias:b(s,oi)?s[te].name:b(s,O)?void 0:We(s))&&!(he=>o?.some(({alias:et})=>et===(he[A.Symbol.IsAlias]?We(he):he[A.Symbol.BaseName])))(ne.field.table)){let he=We(ne.field.table);throw new Error(`Your \"${ne.path.join(\"->\")}\" field references a column \"${he}\".\"${ne.field.name}\", but the table \"${he}\" is not part of the query! Did you forget to join it?`)}let x=!o||o.length===0,w=this.buildWithCTE(e),T;f&&(T=f===!0?g` distinct`:g` distinct on (${g.join(f.on,g`, `)})`);let S=this.buildSelection(m,{isSingleTable:x}),C=this.buildFromTable(s),L=this.buildJoins(o),j=i?g` where ${i}`:void 0,R=a?g` having ${a}`:void 0,N;u&&u.length>0&&(N=g` order by ${g.join(u,g`, `)}`);let Q;c&&c.length>0&&(Q=g` group by ${g.join(c,g`, `)}`);let fe=typeof l==\"object\"||typeof l==\"number\"&&l>=0?g` limit ${l}`:void 0,_t=p?g` offset ${p}`:void 0,qe=g.empty();if(d){let ne=g` for ${g.raw(d.strength)}`;d.config.of&&ne.append(g` of ${g.join(Array.isArray(d.config.of)?d.config.of:[d.config.of],g`, `)}`),d.config.noWait?ne.append(g` no wait`):d.config.skipLocked&&ne.append(g` skip locked`),qe.append(ne)}let se=g`${w}select${T} ${S} from ${C}${L}${j}${Q}${R}${N}${fe}${_t}${qe}`;return y.length>0?this.buildSetOperations(se,y):se}buildSetOperations(e,r){let[n,...i]=r;if(!n)throw new Error(\"Cannot pass undefined values to any set operator\");return i.length===0?this.buildSetOperationQuery({leftSelect:e,setOperator:n}):this.buildSetOperations(this.buildSetOperationQuery({leftSelect:e,setOperator:n}),i)}buildSetOperationQuery({leftSelect:e,setOperator:{type:r,isAll:n,rightSelect:i,limit:a,orderBy:s,offset:o}}){let u=g`(${e.getSQL()}) `,c=g`(${i.getSQL()})`,l;if(s&&s.length>0){let y=[];for(let m of s)if(b(m,E))y.push(g.identifier(m.name));else if(b(m,O)){for(let x=0;x<m.queryChunks.length;x++){let w=m.queryChunks[x];b(w,E)&&(m.queryChunks[x]=g.identifier(w.name))}y.push(g`${m}`)}else y.push(g`${m}`);l=g` order by ${g.join(y,g`, `)} `}let p=typeof a==\"object\"||typeof a==\"number\"&&a>=0?g` limit ${a}`:void 0,d=g.raw(`${r} ${n?\"all \":\"\"}`),f=o?g` offset ${o}`:void 0;return g`${u}${d}${c}${l}${p}${f}`}buildInsertQuery({table:e,values:r,onConflict:n,returning:i,withList:a,select:s,overridingSystemValue_:o}){let u=[],c=e[A.Symbol.Columns],l=Object.entries(c).filter(([w,T])=>!T.shouldDisableInsert()),p=l.map(([,w])=>g.identifier(this.casing.getColumnCasing(w)));if(s){let w=r;b(w,O)?u.push(w):u.push(w.getSQL())}else{let w=r;u.push(g.raw(\"values \"));for(let[T,S]of w.entries()){let C=[];for(let[L,j]of l){let R=S[L];if(R===void 0||b(R,Ge)&&R.value===void 0)if(j.defaultFn!==void 0){let N=j.defaultFn(),Q=b(N,O)?N:g.param(N,j);C.push(Q)}else if(!j.default&&j.onUpdateFn!==void 0){let N=j.onUpdateFn(),Q=b(N,O)?N:g.param(N,j);C.push(Q)}else C.push(g`default`);else C.push(R)}u.push(C),T<w.length-1&&u.push(g`, `)}}let d=this.buildWithCTE(a),f=g.join(u),y=i?g` returning ${this.buildSelection(i,{isSingleTable:!0})}`:void 0,m=n?g` on conflict ${n}`:void 0,x=o===!0?g`overriding system value `:void 0;return g`${d}insert into ${e} ${p} ${x}${f}${m}${y}`}buildRefreshMaterializedViewQuery({view:e,concurrently:r,withNoData:n}){let i=r?g` concurrently`:void 0,a=n?g` with no data`:void 0;return g`refresh materialized view${i} ${e}${a}`}prepareTyping(e){return b(e,Sa)||b(e,_a)?\"json\":b(e,Ea)?\"decimal\":b(e,Ta)?\"time\":b(e,ka)||b(e,Aa)?\"timestamp\":b(e,ba)||b(e,wa)?\"date\":b(e,Ca)?\"uuid\":\"none\"}sqlToQuery(e,r){return e.toQuery({casing:this.casing,escapeName:this.escapeName,escapeParam:this.escapeParam,escapeString:this.escapeString,prepareTyping:this.prepareTyping,invokeSource:r})}buildRelationalQueryWithoutPK({fullSchema:e,schema:r,tableNamesMap:n,table:i,tableConfig:a,queryConfig:s,tableAlias:o,nestedQueryRelation:u,joinOn:c}){let l=[],p,d,f=[],y,m=[];if(s===!0)l=Object.entries(a.columns).map(([T,S])=>({dbKey:S.name,tsKey:T,field:Dt(S,o),relationTableTsKey:void 0,isJson:!1,selection:[]}));else{let w=Object.fromEntries(Object.entries(a.columns).map(([R,N])=>[R,Dt(N,o)]));if(s.where){let R=typeof s.where==\"function\"?s.where(w,F_()):s.where;y=R&&ga(R,o)}let T=[],S=[];if(s.columns){let R=!1;for(let[N,Q]of Object.entries(s.columns))Q!==void 0&&N in a.columns&&(!R&&Q===!0&&(R=!0),S.push(N));S.length>0&&(S=R?S.filter(N=>s.columns?.[N]===!0):Object.keys(a.columns).filter(N=>!S.includes(N)))}else S=Object.keys(a.columns);for(let R of S){let N=a.columns[R];T.push({tsKey:R,value:N})}let C=[];s.with&&(C=Object.entries(s.with).filter(R=>!!R[1]).map(([R,N])=>({tsKey:R,queryConfig:N,relation:a.relations[R]})));let L;if(s.extras){L=typeof s.extras==\"function\"?s.extras(w,{sql:g}):s.extras;for(let[R,N]of Object.entries(L))T.push({tsKey:R,value:pd(N,o)})}for(let{tsKey:R,value:N}of T)l.push({dbKey:b(N,O.Aliased)?N.fieldAlias:a.columns[R].name,tsKey:R,field:b(N,J)?Dt(N,o):N,relationTableTsKey:void 0,isJson:!1,selection:[]});let j=typeof s.orderBy==\"function\"?s.orderBy(w,$_()):s.orderBy??[];Array.isArray(j)||(j=[j]),f=j.map(R=>b(R,J)?Dt(R,o):ga(R,o)),p=s.limit,d=s.offset;for(let{tsKey:R,queryConfig:N,relation:Q}of C){let fe=B_(r,n,Q),_t=Hr(Q.referencedTable),qe=n[_t],se=`${o}_${R}`,ne=Pa(...fe.fields.map((Ht,qi)=>kt(Dt(fe.references[qi],se),Dt(Ht,o)))),he=this.buildRelationalQueryWithoutPK({fullSchema:e,schema:r,tableNamesMap:n,table:e[qe],tableConfig:r[qe],queryConfig:b(Q,xr)?N===!0?{limit:1}:{...N,limit:1}:N,tableAlias:se,joinOn:ne,nestedQueryRelation:Q}),et=g`${g.identifier(se)}.${g.identifier(\"data\")}`.as(R);m.push({on:g`true`,table:new ye(he.sql,{},se),alias:se,joinType:\"left\",lateral:!0}),l.push({dbKey:R,tsKey:R,field:et,relationTableTsKey:qe,isJson:!0,selection:he.selection})}}if(l.length===0)throw new xa({message:`No fields selected for table \"${a.tsName}\" (\"${o}\")`});let x;if(y=Pa(c,y),u){let w=g`json_build_array(${g.join(l.map(({field:C,tsKey:L,isJson:j})=>j?g`${g.identifier(`${o}_${L}`)}.${g.identifier(\"data\")}`:b(C,O.Aliased)?C.sql:C),g`, `)})`;b(u,Oa)&&(w=g`coalesce(json_agg(${w}${f.length>0?g` order by ${g.join(f,g`, `)}`:void 0}), '[]'::json)`);let T=[{dbKey:\"data\",tsKey:\"data\",field:w.as(\"data\"),isJson:!0,relationTableTsKey:a.tsName,selection:l}];p!==void 0||d!==void 0||f.length>0?(x=this.buildSelectQuery({table:ma(i,o),fields:{},fieldsFlat:[{path:[],field:g.raw(\"*\")}],where:y,limit:p,offset:d,orderBy:f,setOperators:[]}),y=void 0,p=void 0,d=void 0,f=[]):x=ma(i,o),x=this.buildSelectQuery({table:b(x,Te)?x:new ye(x,{},o),fields:{},fieldsFlat:T.map(({field:C})=>({path:[],field:b(C,J)?Dt(C,o):C})),joins:m,where:y,limit:p,offset:d,orderBy:f,setOperators:[]})}else x=this.buildSelectQuery({table:ma(i,o),fields:{},fieldsFlat:l.map(({field:w})=>({path:[],field:b(w,J)?Dt(w,o):w})),joins:m,where:y,limit:p,offset:d,orderBy:f,setOperators:[]});return{tableTsKey:a.tsName,sql:x,selection:l}}};var zo=class{static[h]=\"TypedQueryBuilder\";getSelectedFields(){return this._.selectedFields}};var De=class{static[h]=\"PgSelectBuilder\";fields;session;dialect;withList=[];distinct;constructor(e){this.fields=e.fields,this.session=e.session,this.dialect=e.dialect,e.withList&&(this.withList=e.withList),this.distinct=e.distinct}authToken;setToken(e){return this.authToken=e,this}from(e){let r=!!this.fields,n=e,i;return this.fields?i=this.fields:b(n,ye)?i=Object.fromEntries(Object.keys(n._.selectedFields).map(a=>[a,n[a]])):b(n,oi)?i=n[te].selectedFields:b(n,O)?i={}:i=qo(n),new Ho({table:n,fields:i,isPartialSelect:r,session:this.session,dialect:this.dialect,withList:this.withList,distinct:this.distinct}).setToken(this.authToken)}},If=class extends zo{static[h]=\"PgSelectQueryBuilder\";_;config;joinsNotNullableMap;tableName;isPartialSelect;session;dialect;constructor({table:e,fields:r,isPartialSelect:n,session:i,dialect:a,withList:s,distinct:o}){super(),this.config={withList:s,table:e,fields:{...r},distinct:o,setOperators:[]},this.isPartialSelect=n,this.session=i,this.dialect=a,this._={selectedFields:r},this.tableName=er(e),this.joinsNotNullableMap=typeof this.tableName==\"string\"?{[this.tableName]:!0}:{}}createJoin(e){return(r,n)=>{let i=this.tableName,a=er(r);if(typeof a==\"string\"&&this.config.joins?.some(s=>s.alias===a))throw new Error(`Alias \"${a}\" is already used in this query`);if(!this.isPartialSelect&&(Object.keys(this.joinsNotNullableMap).length===1&&typeof i==\"string\"&&(this.config.fields={[i]:this.config.fields}),typeof a==\"string\"&&!b(r,O))){let s=b(r,ye)?r._.selectedFields:b(r,Ue)?r[te].selectedFields:r[A.Symbol.Columns];this.config.fields[a]=s}if(typeof n==\"function\"&&(n=n(new Proxy(this.config.fields,new de({sqlAliasedBehavior:\"sql\",sqlBehavior:\"sql\"})))),this.config.joins||(this.config.joins=[]),this.config.joins.push({on:n,table:r,joinType:e,alias:a}),typeof a==\"string\")switch(e){case\"left\":{this.joinsNotNullableMap[a]=!1;break}case\"right\":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([s])=>[s,!1])),this.joinsNotNullableMap[a]=!0;break}case\"inner\":{this.joinsNotNullableMap[a]=!0;break}case\"full\":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([s])=>[s,!1])),this.joinsNotNullableMap[a]=!1;break}}return this}}leftJoin=this.createJoin(\"left\");rightJoin=this.createJoin(\"right\");innerJoin=this.createJoin(\"inner\");fullJoin=this.createJoin(\"full\");createSetOperator(e,r){return n=>{let i=typeof n==\"function\"?n(MI()):n;if(!va(this.getSelectedFields(),i.getSelectedFields()))throw new Error(\"Set operator error (union / intersect / except): selected fields are not the same or are in a different order\");return this.config.setOperators.push({type:e,isAll:r,rightSelect:i}),this}}union=this.createSetOperator(\"union\",!1);unionAll=this.createSetOperator(\"union\",!0);intersect=this.createSetOperator(\"intersect\",!1);intersectAll=this.createSetOperator(\"intersect\",!0);except=this.createSetOperator(\"except\",!1);exceptAll=this.createSetOperator(\"except\",!0);addSetOperators(e){return this.config.setOperators.push(...e),this}where(e){return typeof e==\"function\"&&(e=e(new Proxy(this.config.fields,new de({sqlAliasedBehavior:\"sql\",sqlBehavior:\"sql\"})))),this.config.where=e,this}having(e){return typeof e==\"function\"&&(e=e(new Proxy(this.config.fields,new de({sqlAliasedBehavior:\"sql\",sqlBehavior:\"sql\"})))),this.config.having=e,this}groupBy(...e){if(typeof e[0]==\"function\"){let r=e[0](new Proxy(this.config.fields,new de({sqlAliasedBehavior:\"alias\",sqlBehavior:\"sql\"})));this.config.groupBy=Array.isArray(r)?r:[r]}else this.config.groupBy=e;return this}orderBy(...e){if(typeof e[0]==\"function\"){let r=e[0](new Proxy(this.config.fields,new de({sqlAliasedBehavior:\"alias\",sqlBehavior:\"sql\"}))),n=Array.isArray(r)?r:[r];this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=n:this.config.orderBy=n}else{let r=e;this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=r:this.config.orderBy=r}return this}limit(e){return this.config.setOperators.length>0?this.config.setOperators.at(-1).limit=e:this.config.limit=e,this}offset(e){return this.config.setOperators.length>0?this.config.setOperators.at(-1).offset=e:this.config.offset=e,this}for(e,r={}){return this.config.lockingClause={strength:e,config:r},this}getSQL(){return this.dialect.buildSelectQuery(this.config)}toSQL(){let{typings:e,...r}=this.dialect.sqlToQuery(this.getSQL());return r}as(e){return new Proxy(new ye(this.getSQL(),this.config.fields,e),new de({alias:e,sqlAliasedBehavior:\"alias\",sqlBehavior:\"error\"}))}getSelectedFields(){return new Proxy(this.config.fields,new de({alias:this.tableName,sqlAliasedBehavior:\"alias\",sqlBehavior:\"error\"}))}$dynamic(){return this}},Ho=class extends If{static[h]=\"PgSelect\";_prepare(e){let{session:r,config:n,dialect:i,joinsNotNullableMap:a,authToken:s}=this;if(!r)throw new Error(\"Cannot execute a query on a query builder. Please use a database instance instead.\");return ee.startActiveSpan(\"drizzle.prepareQuery\",()=>{let o=gt(n.fields),u=r.prepareQuery(i.sqlToQuery(this.getSQL()),o,e,!0);return u.joinsNotNullableMap=a,u.setToken(s)})}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>ee.startActiveSpan(\"drizzle.operation\",()=>this._prepare().execute(e,this.authToken))};$1(Ho,[je]);function ci(t,e){return(r,n,...i)=>{let a=[n,...i].map(s=>({type:t,isAll:e,rightSelect:s}));for(let s of a)if(!va(r.getSelectedFields(),s.rightSelect.getSelectedFields()))throw new Error(\"Set operator error (union / intersect / except): selected fields are not the same or are in a different order\");return r.addSetOperators(a)}}var MI=()=>({union:FI,unionAll:$I,intersect:UI,intersectAll:BI,except:zI,exceptAll:HI}),FI=ci(\"union\",!1),$I=ci(\"union\",!0),UI=ci(\"intersect\",!1),BI=ci(\"intersect\",!0),zI=ci(\"except\",!1),HI=ci(\"except\",!0);var ui=class{static[h]=\"PgQueryBuilder\";dialect;dialectConfig;constructor(e){this.dialect=b(e,br)?e:void 0,this.dialectConfig=b(e,br)?void 0:e}$with=(e,r)=>{let n=this;return{as:a=>(typeof a==\"function\"&&(a=a(n)),new Proxy(new ni(a.getSQL(),r??(\"getSelectedFields\"in a?a.getSelectedFields()??{}:{}),e,!0),new de({alias:e,sqlAliasedBehavior:\"alias\",sqlBehavior:\"error\"})))}};with(...e){let r=this;function n(s){return new De({fields:s??void 0,session:void 0,dialect:r.getDialect(),withList:e})}function i(s){return new De({fields:s??void 0,session:void 0,dialect:r.getDialect(),distinct:!0})}function a(s,o){return new De({fields:o??void 0,session:void 0,dialect:r.getDialect(),distinct:{on:s}})}return{select:n,selectDistinct:i,selectDistinctOn:a}}select(e){return new De({fields:e??void 0,session:void 0,dialect:this.getDialect()})}selectDistinct(e){return new De({fields:e??void 0,session:void 0,dialect:this.getDialect(),distinct:!0})}selectDistinctOn(e,r){return new De({fields:r??void 0,session:void 0,dialect:this.getDialect(),distinct:{on:e}})}getDialect(){return this.dialect||(this.dialect=new br(this.dialectConfig)),this.dialect}};var Ra=class{constructor(e,r,n,i,a){this.table=e,this.session=r,this.dialect=n,this.withList=i,this.overridingSystemValue_=a}static[h]=\"PgInsertBuilder\";authToken;setToken(e){return this.authToken=e,this}overridingSystemValue(){return this.overridingSystemValue_=!0,this}values(e){if(e=Array.isArray(e)?e:[e],e.length===0)throw new Error(\"values() must be called with at least one value\");let r=e.map(n=>{let i={},a=this.table[A.Symbol.Columns];for(let s of Object.keys(n)){let o=n[s];i[s]=b(o,O)?o:new Ge(o,a[s])}return i});return new Qo(this.table,r,this.session,this.dialect,this.withList,!1,this.overridingSystemValue_).setToken(this.authToken)}select(e){let r=typeof e==\"function\"?e(new ui):e;if(!b(r,O)&&!va(this.table[Io],r._.selectedFields))throw new Error(\"Insert select error: selected fields are not the same or are in a different order compared to the table definition\");return new Qo(this.table,r,this.session,this.dialect,this.withList,!0)}},Qo=class extends je{constructor(e,r,n,i,a,s,o){super(),this.session=n,this.dialect=i,this.config={table:e,values:r,withList:a,select:s,overridingSystemValue_:o}}static[h]=\"PgInsert\";config;returning(e=this.config.table[A.Symbol.Columns]){return this.config.returningFields=e,this.config.returning=gt(e),this}onConflictDoNothing(e={}){if(e.target===void 0)this.config.onConflict=g`do nothing`;else{let r=\"\";r=Array.isArray(e.target)?e.target.map(i=>this.dialect.escapeName(this.dialect.casing.getColumnCasing(i))).join(\",\"):this.dialect.escapeName(this.dialect.casing.getColumnCasing(e.target));let n=e.where?g` where ${e.where}`:void 0;this.config.onConflict=g`(${g.raw(r)})${n} do nothing`}return this}onConflictDoUpdate(e){if(e.where&&(e.targetWhere||e.setWhere))throw new Error('You cannot use both \"where\" and \"targetWhere\"/\"setWhere\" at the same time - \"where\" is deprecated, use \"targetWhere\" or \"setWhere\" instead.');let r=e.where?g` where ${e.where}`:void 0,n=e.targetWhere?g` where ${e.targetWhere}`:void 0,i=e.setWhere?g` where ${e.setWhere}`:void 0,a=this.dialect.buildUpdateSet(this.config.table,No(this.config.table,e.set)),s=\"\";return s=Array.isArray(e.target)?e.target.map(o=>this.dialect.escapeName(this.dialect.casing.getColumnCasing(o))).join(\",\"):this.dialect.escapeName(this.dialect.casing.getColumnCasing(e.target)),this.config.onConflict=g`(${g.raw(s)})${n} do update set ${a}${r}${i}`,this}getSQL(){return this.dialect.buildInsertQuery(this.config)}toSQL(){let{typings:e,...r}=this.dialect.sqlToQuery(this.getSQL());return r}_prepare(e){return ee.startActiveSpan(\"drizzle.prepareQuery\",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,e,!0))}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>ee.startActiveSpan(\"drizzle.operation\",()=>this._prepare().execute(e,this.authToken));getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new de({alias:We(this.config.table),sqlAliasedBehavior:\"alias\",sqlBehavior:\"error\"})):void 0}$dynamic(){return this}};var Vo=class extends je{constructor(e,r,n){super(),this.session=r,this.dialect=n,this.config={view:e}}static[h]=\"PgRefreshMaterializedView\";config;concurrently(){if(this.config.withNoData!==void 0)throw new Error(\"Cannot use concurrently and withNoData together\");return this.config.concurrently=!0,this}withNoData(){if(this.config.concurrently!==void 0)throw new Error(\"Cannot use concurrently and withNoData together\");return this.config.withNoData=!0,this}getSQL(){return this.dialect.buildRefreshMaterializedViewQuery(this.config)}toSQL(){let{typings:e,...r}=this.dialect.sqlToQuery(this.getSQL());return r}_prepare(e){return ee.startActiveSpan(\"drizzle.prepareQuery\",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),void 0,e,!0))}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>ee.startActiveSpan(\"drizzle.operation\",()=>this._prepare().execute(e,this.authToken))};var Ia=class{constructor(e,r,n,i){this.table=e,this.session=r,this.dialect=n,this.withList=i}static[h]=\"PgUpdateBuilder\";authToken;setToken(e){return this.authToken=e,this}set(e){return new Nf(this.table,No(this.table,e),this.session,this.dialect,this.withList).setToken(this.authToken)}},Nf=class extends je{constructor(e,r,n,i,a){super(),this.session=n,this.dialect=i,this.config={set:r,table:e,withList:a,joins:[]},this.tableName=er(e),this.joinsNotNullableMap=typeof this.tableName==\"string\"?{[this.tableName]:!0}:{}}static[h]=\"PgUpdate\";config;tableName;joinsNotNullableMap;from(e){let r=e,n=er(r);return typeof n==\"string\"&&(this.joinsNotNullableMap[n]=!0),this.config.from=r,this}getTableLikeFields(e){return b(e,Te)?e[A.Symbol.Columns]:b(e,ye)?e._.selectedFields:e[te].selectedFields}createJoin(e){return(r,n)=>{let i=er(r);if(typeof i==\"string\"&&this.config.joins.some(a=>a.alias===i))throw new Error(`Alias \"${i}\" is already used in this query`);if(typeof n==\"function\"){let a=this.config.from&&!b(this.config.from,O)?this.getTableLikeFields(this.config.from):void 0;n=n(new Proxy(this.config.table[A.Symbol.Columns],new de({sqlAliasedBehavior:\"sql\",sqlBehavior:\"sql\"})),a&&new Proxy(a,new de({sqlAliasedBehavior:\"sql\",sqlBehavior:\"sql\"})))}if(this.config.joins.push({on:n,table:r,joinType:e,alias:i}),typeof i==\"string\")switch(e){case\"left\":{this.joinsNotNullableMap[i]=!1;break}case\"right\":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([a])=>[a,!1])),this.joinsNotNullableMap[i]=!0;break}case\"inner\":{this.joinsNotNullableMap[i]=!0;break}case\"full\":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([a])=>[a,!1])),this.joinsNotNullableMap[i]=!1;break}}return this}}leftJoin=this.createJoin(\"left\");rightJoin=this.createJoin(\"right\");innerJoin=this.createJoin(\"inner\");fullJoin=this.createJoin(\"full\");where(e){return this.config.where=e,this}returning(e){if(!e&&(e=Object.assign({},this.config.table[A.Symbol.Columns]),this.config.from)){let r=er(this.config.from);if(typeof r==\"string\"&&this.config.from&&!b(this.config.from,O)){let n=this.getTableLikeFields(this.config.from);e[r]=n}for(let n of this.config.joins){let i=er(n.table);if(typeof i==\"string\"&&!b(n.table,O)){let a=this.getTableLikeFields(n.table);e[i]=a}}}return this.config.returningFields=e,this.config.returning=gt(e),this}getSQL(){return this.dialect.buildUpdateQuery(this.config)}toSQL(){let{typings:e,...r}=this.dialect.sqlToQuery(this.getSQL());return r}_prepare(e){let r=this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,e,!0);return r.joinsNotNullableMap=this.joinsNotNullableMap,r}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>this._prepare().execute(e,this.authToken);getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new de({alias:We(this.config.table),sqlAliasedBehavior:\"alias\",sqlBehavior:\"error\"})):void 0}$dynamic(){return this}};var Ko=class t extends O{constructor(e){super(t.buildEmbeddedCount(e.source,e.filters).queryChunks),this.params=e,this.mapWith(Number),this.session=e.session,this.sql=t.buildCount(e.source,e.filters)}sql;token;static[h]=\"PgCountBuilder\";[Symbol.toStringTag]=\"PgCountBuilder\";session;static buildEmbeddedCount(e,r){return g`(select count(*) from ${e}${g.raw(\" where \").if(r)}${r})`}static buildCount(e,r){return g`select count(*) as count from ${e}${g.raw(\" where \").if(r)}${r};`}setToken(e){return this.token=e,this}then(e,r){return Promise.resolve(this.session.count(this.sql,this.token)).then(e,r)}catch(e){return this.then(void 0,e)}finally(e){return this.then(r=>(e?.(),r),r=>{throw e?.(),r})}};var Wo=class{constructor(e,r,n,i,a,s,o){this.fullSchema=e,this.schema=r,this.tableNamesMap=n,this.table=i,this.tableConfig=a,this.dialect=s,this.session=o}static[h]=\"PgRelationalQueryBuilder\";findMany(e){return new Go(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,e||{},\"many\")}findFirst(e){return new Go(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,e?{...e,limit:1}:{limit:1},\"first\")}},Go=class extends je{constructor(e,r,n,i,a,s,o,u,c){super(),this.fullSchema=e,this.schema=r,this.tableNamesMap=n,this.table=i,this.tableConfig=a,this.dialect=s,this.session=o,this.config=u,this.mode=c}static[h]=\"PgRelationalQuery\";_prepare(e){return ee.startActiveSpan(\"drizzle.prepareQuery\",()=>{let{query:r,builtQuery:n}=this._toSQL();return this.session.prepareQuery(n,void 0,e,!0,(i,a)=>{let s=i.map(o=>Bo(this.schema,this.tableConfig,o,r.selection,a));return this.mode===\"first\"?s[0]:s})})}prepare(e){return this._prepare(e)}_getQuery(){return this.dialect.buildRelationalQueryWithoutPK({fullSchema:this.fullSchema,schema:this.schema,tableNamesMap:this.tableNamesMap,table:this.table,tableConfig:this.tableConfig,queryConfig:this.config,tableAlias:this.tableConfig.tsName})}getSQL(){return this._getQuery().sql}_toSQL(){let e=this._getQuery(),r=this.dialect.sqlToQuery(e.sql);return{query:e,builtQuery:r}}toSQL(){return this._toSQL().builtQuery}authToken;setToken(e){return this.authToken=e,this}execute(){return ee.startActiveSpan(\"drizzle.operation\",()=>this._prepare().execute(void 0,this.authToken))}};var Jo=class extends je{constructor(e,r,n,i){super(),this.execute=e,this.sql=r,this.query=n,this.mapBatchResult=i}static[h]=\"PgRaw\";getSQL(){return this.sql}getQuery(){return this.query}mapResult(e,r){return r?this.mapBatchResult(e):e}_prepare(){return this}isResponseInArrayMode(){return!1}};var li=class{constructor(e,r,n){if(this.dialect=e,this.session=r,this._=n?{schema:n.schema,fullSchema:n.fullSchema,tableNamesMap:n.tableNamesMap,session:r}:{schema:void 0,fullSchema:{},tableNamesMap:{},session:r},this.query={},this._.schema)for(let[i,a]of Object.entries(this._.schema))this.query[i]=new Wo(n.fullSchema,this._.schema,this._.tableNamesMap,n.fullSchema[i],a,e,r)}static[h]=\"PgDatabase\";query;$with=(e,r)=>{let n=this;return{as:a=>(typeof a==\"function\"&&(a=a(new ui(n.dialect))),new Proxy(new ni(a.getSQL(),r??(\"getSelectedFields\"in a?a.getSelectedFields()??{}:{}),e,!0),new de({alias:e,sqlAliasedBehavior:\"alias\",sqlBehavior:\"error\"})))}};$count(e,r){return new Ko({source:e,filters:r,session:this.session})}with(...e){let r=this;function n(c){return new De({fields:c??void 0,session:r.session,dialect:r.dialect,withList:e})}function i(c){return new De({fields:c??void 0,session:r.session,dialect:r.dialect,withList:e,distinct:!0})}function a(c,l){return new De({fields:l??void 0,session:r.session,dialect:r.dialect,withList:e,distinct:{on:c}})}function s(c){return new Ia(c,r.session,r.dialect,e)}function o(c){return new Ra(c,r.session,r.dialect,e)}function u(c){return new ya(c,r.session,r.dialect,e)}return{select:n,selectDistinct:i,selectDistinctOn:a,update:s,insert:o,delete:u}}select(e){return new De({fields:e??void 0,session:this.session,dialect:this.dialect})}selectDistinct(e){return new De({fields:e??void 0,session:this.session,dialect:this.dialect,distinct:!0})}selectDistinctOn(e,r){return new De({fields:r??void 0,session:this.session,dialect:this.dialect,distinct:{on:e}})}update(e){return new Ia(e,this.session,this.dialect)}insert(e){return new Ra(e,this.session,this.dialect)}delete(e){return new ya(e,this.session,this.dialect)}refreshMaterializedView(e){return new Vo(e,this.session,this.dialect)}authToken;execute(e){let r=typeof e==\"string\"?g.raw(e):e.getSQL(),n=this.dialect.sqlToQuery(r),i=this.session.prepareQuery(n,void 0,void 0,!1);return new Jo(()=>i.execute(void 0,this.authToken),r,n,a=>i.mapResult(a,!0))}transaction(e,r){return this.session.transaction(e,r)}};var qf=class{constructor(e,r){this.unique=e,this.name=r}static[h]=\"PgIndexBuilderOn\";on(...e){return new Na(e.map(r=>{if(b(r,O))return r;r=r;let n=new ri(r.name,!!r.keyAsName,r.columnType,r.indexConfig);return r.indexConfig=JSON.parse(JSON.stringify(r.defaultConfig)),n}),this.unique,!1,this.name)}onOnly(...e){return new Na(e.map(r=>{if(b(r,O))return r;r=r;let n=new ri(r.name,!!r.keyAsName,r.columnType,r.indexConfig);return r.indexConfig=r.defaultConfig,n}),this.unique,!0,this.name)}using(e,...r){return new Na(r.map(n=>{if(b(n,O))return n;n=n;let i=new ri(n.name,!!n.keyAsName,n.columnType,n.indexConfig);return n.indexConfig=JSON.parse(JSON.stringify(n.defaultConfig)),i}),this.unique,!0,this.name,e)}},Na=class{static[h]=\"PgIndexBuilder\";config;constructor(e,r,n,i,a=\"btree\"){this.config={name:i,columns:e,unique:r,only:n,method:a}}concurrently(){return this.config.concurrently=!0,this}with(e){return this.config.with=e,this}where(e){return this.config.where=e,this}build(e){return new jf(this.config,e)}},jf=class{static[h]=\"PgIndex\";config;constructor(e,r){this.config={...e,table:r}}};function H_(t){return new qf(!1,t)}var Zo=class{constructor(e){this.query=e}authToken;getQuery(){return this.query}mapResult(e,r){return e}setToken(e){return this.authToken=e,this}static[h]=\"PgPreparedQuery\";joinsNotNullableMap},Xo=class{constructor(e){this.dialect=e}static[h]=\"PgSession\";execute(e,r){return ee.startActiveSpan(\"drizzle.operation\",()=>ee.startActiveSpan(\"drizzle.prepareQuery\",()=>this.prepareQuery(this.dialect.sqlToQuery(e),void 0,void 0,!1)).setToken(r).execute(void 0,r))}all(e){return this.prepareQuery(this.dialect.sqlToQuery(e),void 0,void 0,!1).all()}async count(e,r){let n=await this.execute(e,r);return Number(n[0].count)}},Yo=class extends li{constructor(e,r,n,i=0){super(e,r,n),this.schema=n,this.nestedIndex=i}static[h]=\"PgTransaction\";rollback(){throw new Do}getTransactionConfigSQL(e){let r=[];return e.isolationLevel&&r.push(`isolation level ${e.isolationLevel}`),e.accessMode&&r.push(e.accessMode),typeof e.deferrable==\"boolean\"&&r.push(e.deferrable?\"deferrable\":\"not deferrable\"),g.raw(r.join(\" \"))}setTransaction(e){return this.session.execute(g`set transaction ${this.getTransactionConfigSQL(e)}`)}};var{Pool:Q_,types:Mt}=yr,Df=class extends Zo{constructor(e,r,n,i,a,s,o,u){super({sql:r,params:n}),this.client=e,this.params=n,this.logger=i,this.fields=a,this._isResponseInArrayMode=o,this.customResultMapper=u,this.rawQueryConfig={name:s,text:r,types:{getTypeParser:(c,l)=>c===Mt.builtins.TIMESTAMPTZ?p=>p:c===Mt.builtins.TIMESTAMP?p=>p:c===Mt.builtins.DATE?p=>p:c===Mt.builtins.INTERVAL?p=>p:Mt.getTypeParser(c,l)}},this.queryConfig={name:s,text:r,rowMode:\"array\",types:{getTypeParser:(c,l)=>c===Mt.builtins.TIMESTAMPTZ?p=>p:c===Mt.builtins.TIMESTAMP?p=>p:c===Mt.builtins.DATE?p=>p:c===Mt.builtins.INTERVAL?p=>p:Mt.getTypeParser(c,l)}}}static[h]=\"NodePgPreparedQuery\";rawQueryConfig;queryConfig;async execute(e={}){return ee.startActiveSpan(\"drizzle.execute\",async()=>{let r=ld(this.params,e);this.logger.logQuery(this.rawQueryConfig.text,r);let{fields:n,rawQueryConfig:i,client:a,queryConfig:s,joinsNotNullableMap:o,customResultMapper:u}=this;if(!n&&!u)return ee.startActiveSpan(\"drizzle.driver.execute\",async l=>(l?.setAttributes({\"drizzle.query.name\":i.name,\"drizzle.query.text\":i.text,\"drizzle.query.params\":JSON.stringify(r)}),a.query(i,r)));let c=await ee.startActiveSpan(\"drizzle.driver.execute\",l=>(l?.setAttributes({\"drizzle.query.name\":s.name,\"drizzle.query.text\":s.text,\"drizzle.query.params\":JSON.stringify(r)}),a.query(s,r)));return ee.startActiveSpan(\"drizzle.mapResponse\",()=>u?u(c.rows):c.rows.map(l=>F1(n,l,o)))})}all(e={}){return ee.startActiveSpan(\"drizzle.execute\",()=>{let r=ld(this.params,e);return this.logger.logQuery(this.rawQueryConfig.text,r),ee.startActiveSpan(\"drizzle.driver.execute\",n=>(n?.setAttributes({\"drizzle.query.name\":this.rawQueryConfig.name,\"drizzle.query.text\":this.rawQueryConfig.text,\"drizzle.query.params\":JSON.stringify(r)}),this.client.query(this.rawQueryConfig,r).then(i=>i.rows)))})}isResponseInArrayMode(){return this._isResponseInArrayMode}},ec=class t extends Xo{constructor(e,r,n,i={}){super(r),this.client=e,this.schema=n,this.options=i,this.logger=i.logger??new Ao}static[h]=\"NodePgSession\";logger;prepareQuery(e,r,n,i,a){return new Df(this.client,e.sql,e.params,this.logger,r,n,i,a)}async transaction(e,r){let n=this.client instanceof Q_?new t(await this.client.connect(),this.dialect,this.schema,this.options):this,i=new Lf(this.dialect,n,this.schema);await i.execute(g`begin${r?g` ${i.getTransactionConfigSQL(r)}`:void 0}`);try{let a=await e(i);return await i.execute(g`commit`),a}catch(a){throw await i.execute(g`rollback`),a}finally{this.client instanceof Q_&&n.client.release()}}async count(e){let r=await this.execute(e);return Number(r.rows[0].count)}},Lf=class t extends Yo{static[h]=\"NodePgTransaction\";async transaction(e){let r=`sp${this.nestedIndex+1}`,n=new t(this.dialect,this.session,this.schema,this.nestedIndex+1);await n.execute(g.raw(`savepoint ${r}`));try{let i=await e(n);return await n.execute(g.raw(`release savepoint ${r}`)),i}catch(i){throw await n.execute(g.raw(`rollback to savepoint ${r}`)),i}}};var Mf=class{constructor(e,r,n={}){this.client=e,this.dialect=r,this.options=n}static[h]=\"NodePgDriver\";createSession(e){return new ec(this.client,this.dialect,e,{logger:this.options.logger})}},Ff=class extends li{static[h]=\"NodePgDatabase\"};function qa(t,e={}){let r=new br({casing:e.casing}),n;e.logger===!0?n=new ko:e.logger!==!1&&(n=e.logger);let i;if(e.schema){let u=U_(e.schema,z_);i={fullSchema:e.schema,schema:u.tables,tableNamesMap:u.tableNamesMap}}let s=new Mf(t,r,{logger:n}).createSession(i),o=new Ff(r,s,i);return o.$client=t,o}function tc(...t){if(typeof t[0]==\"string\"){let e=new yr.Pool({connectionString:t[0]});return qa(e,t[1])}if(B1(t[0])){let{connection:e,client:r,...n}=t[0];if(r)return qa(r,n);let i=typeof e==\"string\"?new yr.Pool({connectionString:e}):new yr.Pool(e);return qa(i,n)}return qa(t[0],t[1])}(t=>{function e(r){return qa({},r)}t.mock=e})(tc||(tc={}));var oc={};Rc(oc,{inquiries:()=>at,insertInquirySchema:()=>Hf,insertUserSchema:()=>lN,sessions:()=>uN,users:()=>Tr});var Ie={};Rc(Ie,{BRAND:()=>g9,DIRTY:()=>Vr,EMPTY_PATH:()=>WI,INVALID:()=>D,NEVER:()=>eN,OK:()=>Le,ParseStatus:()=>Re,Schema:()=>H,ZodAny:()=>Sr,ZodArray:()=>ar,ZodBigInt:()=>Wr,ZodBoolean:()=>Gr,ZodBranded:()=>Da,ZodCatch:()=>on,ZodDate:()=>Jr,ZodDefault:()=>sn,ZodDiscriminatedUnion:()=>ic,ZodEffects:()=>bt,ZodEnum:()=>nn,ZodError:()=>Ze,ZodFirstPartyTypeKind:()=>M,ZodFunction:()=>sc,ZodIntersection:()=>en,ZodIssueCode:()=>_,ZodLazy:()=>tn,ZodLiteral:()=>rn,ZodMap:()=>gi,ZodNaN:()=>yi,ZodNativeEnum:()=>an,ZodNever:()=>At,ZodNull:()=>Xr,ZodNullable:()=>Ut,ZodNumber:()=>Kr,ZodObject:()=>Xe,ZodOptional:()=>yt,ZodParsedType:()=>P,ZodPipeline:()=>La,ZodPromise:()=>Er,ZodReadonly:()=>cn,ZodRecord:()=>ac,ZodSchema:()=>H,ZodSet:()=>vi,ZodString:()=>_r,ZodSymbol:()=>hi,ZodTransformer:()=>bt,ZodTuple:()=>$t,ZodType:()=>H,ZodUndefined:()=>Zr,ZodUnion:()=>Yr,ZodUnknown:()=>ir,ZodVoid:()=>mi,addIssueToContext:()=>k,any:()=>T9,array:()=>P9,bigint:()=>b9,boolean:()=>rS,coerce:()=>Y9,custom:()=>Y_,date:()=>w9,datetimeRegex:()=>Z_,defaultErrorMap:()=>rr,discriminatedUnion:()=>N9,effect:()=>Q9,enum:()=>B9,function:()=>F9,getErrorMap:()=>pi,getParsedType:()=>Ft,instanceof:()=>y9,intersection:()=>q9,isAborted:()=>rc,isAsync:()=>di,isDirty:()=>nc,isValid:()=>wr,late:()=>v9,lazy:()=>$9,literal:()=>U9,makeIssue:()=>ja,map:()=>L9,nan:()=>x9,nativeEnum:()=>z9,never:()=>A9,null:()=>E9,nullable:()=>K9,number:()=>tS,object:()=>O9,objectUtil:()=>$f,oboolean:()=>X9,onumber:()=>Z9,optional:()=>V9,ostring:()=>J9,pipeline:()=>G9,preprocess:()=>W9,promise:()=>H9,quotelessJson:()=>QI,record:()=>D9,set:()=>M9,setErrorMap:()=>KI,strictObject:()=>R9,string:()=>eS,symbol:()=>_9,transformer:()=>Q9,tuple:()=>j9,undefined:()=>S9,union:()=>I9,unknown:()=>k9,util:()=>K,void:()=>C9});var K;(function(t){t.assertEqual=i=>{};function e(i){}t.assertIs=e;function r(i){throw new Error}t.assertNever=r,t.arrayToEnum=i=>{let a={};for(let s of i)a[s]=s;return a},t.getValidEnumValues=i=>{let a=t.objectKeys(i).filter(o=>typeof i[i[o]]!=\"number\"),s={};for(let o of a)s[o]=i[o];return t.objectValues(s)},t.objectValues=i=>t.objectKeys(i).map(function(a){return i[a]}),t.objectKeys=typeof Object.keys==\"function\"?i=>Object.keys(i):i=>{let a=[];for(let s in i)Object.prototype.hasOwnProperty.call(i,s)&&a.push(s);return a},t.find=(i,a)=>{for(let s of i)if(a(s))return s},t.isInteger=typeof Number.isInteger==\"function\"?i=>Number.isInteger(i):i=>typeof i==\"number\"&&Number.isFinite(i)&&Math.floor(i)===i;function n(i,a=\" | \"){return i.map(s=>typeof s==\"string\"?`'${s}'`:s).join(a)}t.joinValues=n,t.jsonStringifyReplacer=(i,a)=>typeof a==\"bigint\"?a.toString():a})(K||(K={}));var $f;(function(t){t.mergeShapes=(e,r)=>({...e,...r})})($f||($f={}));var P=K.arrayToEnum([\"string\",\"nan\",\"number\",\"integer\",\"float\",\"boolean\",\"date\",\"bigint\",\"symbol\",\"function\",\"undefined\",\"null\",\"array\",\"object\",\"unknown\",\"promise\",\"void\",\"never\",\"map\",\"set\"]),Ft=t=>{switch(typeof t){case\"undefined\":return P.undefined;case\"string\":return P.string;case\"number\":return Number.isNaN(t)?P.nan:P.number;case\"boolean\":return P.boolean;case\"function\":return P.function;case\"bigint\":return P.bigint;case\"symbol\":return P.symbol;case\"object\":return Array.isArray(t)?P.array:t===null?P.null:t.then&&typeof t.then==\"function\"&&t.catch&&typeof t.catch==\"function\"?P.promise:typeof Map<\"u\"&&t instanceof Map?P.map:typeof Set<\"u\"&&t instanceof Set?P.set:typeof Date<\"u\"&&t instanceof Date?P.date:P.object;default:return P.unknown}};var _=K.arrayToEnum([\"invalid_type\",\"invalid_literal\",\"custom\",\"invalid_union\",\"invalid_union_discriminator\",\"invalid_enum_value\",\"unrecognized_keys\",\"invalid_arguments\",\"invalid_return_type\",\"invalid_date\",\"invalid_string\",\"too_small\",\"too_big\",\"invalid_intersection_types\",\"not_multiple_of\",\"not_finite\"]),QI=t=>JSON.stringify(t,null,2).replace(/\"([^\"]+)\":/g,\"$1:\"),Ze=class t extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};let r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name=\"ZodError\",this.issues=e}format(e){let r=e||function(a){return a.message},n={_errors:[]},i=a=>{for(let s of a.issues)if(s.code===\"invalid_union\")s.unionErrors.map(i);else if(s.code===\"invalid_return_type\")i(s.returnTypeError);else if(s.code===\"invalid_arguments\")i(s.argumentsError);else if(s.path.length===0)n._errors.push(r(s));else{let o=n,u=0;for(;u<s.path.length;){let c=s.path[u];u===s.path.length-1?(o[c]=o[c]||{_errors:[]},o[c]._errors.push(r(s))):o[c]=o[c]||{_errors:[]},o=o[c],u++}}};return i(this),n}static assert(e){if(!(e instanceof t))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,K.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=r=>r.message){let r={},n=[];for(let i of this.issues)if(i.path.length>0){let a=i.path[0];r[a]=r[a]||[],r[a].push(e(i))}else n.push(e(i));return{formErrors:n,fieldErrors:r}}get formErrors(){return this.flatten()}};Ze.create=t=>new Ze(t);var VI=(t,e)=>{let r;switch(t.code){case _.invalid_type:t.received===P.undefined?r=\"Required\":r=`Expected ${t.expected}, received ${t.received}`;break;case _.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(t.expected,K.jsonStringifyReplacer)}`;break;case _.unrecognized_keys:r=`Unrecognized key(s) in object: ${K.joinValues(t.keys,\", \")}`;break;case _.invalid_union:r=\"Invalid input\";break;case _.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${K.joinValues(t.options)}`;break;case _.invalid_enum_value:r=`Invalid enum value. Expected ${K.joinValues(t.options)}, received '${t.received}'`;break;case _.invalid_arguments:r=\"Invalid function arguments\";break;case _.invalid_return_type:r=\"Invalid function return type\";break;case _.invalid_date:r=\"Invalid date\";break;case _.invalid_string:typeof t.validation==\"object\"?\"includes\"in t.validation?(r=`Invalid input: must include \"${t.validation.includes}\"`,typeof t.validation.position==\"number\"&&(r=`${r} at one or more positions greater than or equal to ${t.validation.position}`)):\"startsWith\"in t.validation?r=`Invalid input: must start with \"${t.validation.startsWith}\"`:\"endsWith\"in t.validation?r=`Invalid input: must end with \"${t.validation.endsWith}\"`:K.assertNever(t.validation):t.validation!==\"regex\"?r=`Invalid ${t.validation}`:r=\"Invalid\";break;case _.too_small:t.type===\"array\"?r=`Array must contain ${t.exact?\"exactly\":t.inclusive?\"at least\":\"more than\"} ${t.minimum} element(s)`:t.type===\"string\"?r=`String must contain ${t.exact?\"exactly\":t.inclusive?\"at least\":\"over\"} ${t.minimum} character(s)`:t.type===\"number\"?r=`Number must be ${t.exact?\"exactly equal to \":t.inclusive?\"greater than or equal to \":\"greater than \"}${t.minimum}`:t.type===\"bigint\"?r=`Number must be ${t.exact?\"exactly equal to \":t.inclusive?\"greater than or equal to \":\"greater than \"}${t.minimum}`:t.type===\"date\"?r=`Date must be ${t.exact?\"exactly equal to \":t.inclusive?\"greater than or equal to \":\"greater than \"}${new Date(Number(t.minimum))}`:r=\"Invalid input\";break;case _.too_big:t.type===\"array\"?r=`Array must contain ${t.exact?\"exactly\":t.inclusive?\"at most\":\"less than\"} ${t.maximum} element(s)`:t.type===\"string\"?r=`String must contain ${t.exact?\"exactly\":t.inclusive?\"at most\":\"under\"} ${t.maximum} character(s)`:t.type===\"number\"?r=`Number must be ${t.exact?\"exactly\":t.inclusive?\"less than or equal to\":\"less than\"} ${t.maximum}`:t.type===\"bigint\"?r=`BigInt must be ${t.exact?\"exactly\":t.inclusive?\"less than or equal to\":\"less than\"} ${t.maximum}`:t.type===\"date\"?r=`Date must be ${t.exact?\"exactly\":t.inclusive?\"smaller than or equal to\":\"smaller than\"} ${new Date(Number(t.maximum))}`:r=\"Invalid input\";break;case _.custom:r=\"Invalid input\";break;case _.invalid_intersection_types:r=\"Intersection results could not be merged\";break;case _.not_multiple_of:r=`Number must be a multiple of ${t.multipleOf}`;break;case _.not_finite:r=\"Number must be finite\";break;default:r=e.defaultError,K.assertNever(t)}return{message:r}},rr=VI;var V_=rr;function KI(t){V_=t}function pi(){return V_}var ja=t=>{let{data:e,path:r,errorMaps:n,issueData:i}=t,a=[...r,...i.path||[]],s={...i,path:a};if(i.message!==void 0)return{...i,path:a,message:i.message};let o=\"\",u=n.filter(c=>!!c).slice().reverse();for(let c of u)o=c(s,{data:e,defaultError:o}).message;return{...i,path:a,message:o}},WI=[];function k(t,e){let r=pi(),n=ja({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,r,r===rr?void 0:rr].filter(i=>!!i)});t.common.issues.push(n)}var Re=class t{constructor(){this.value=\"valid\"}dirty(){this.value===\"valid\"&&(this.value=\"dirty\")}abort(){this.value!==\"aborted\"&&(this.value=\"aborted\")}static mergeArray(e,r){let n=[];for(let i of r){if(i.status===\"aborted\")return D;i.status===\"dirty\"&&e.dirty(),n.push(i.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,r){let n=[];for(let i of r){let a=await i.key,s=await i.value;n.push({key:a,value:s})}return t.mergeObjectSync(e,n)}static mergeObjectSync(e,r){let n={};for(let i of r){let{key:a,value:s}=i;if(a.status===\"aborted\"||s.status===\"aborted\")return D;a.status===\"dirty\"&&e.dirty(),s.status===\"dirty\"&&e.dirty(),a.value!==\"__proto__\"&&(typeof s.value<\"u\"||i.alwaysSet)&&(n[a.value]=s.value)}return{status:e.value,value:n}}},D=Object.freeze({status:\"aborted\"}),Vr=t=>({status:\"dirty\",value:t}),Le=t=>({status:\"valid\",value:t}),rc=t=>t.status===\"aborted\",nc=t=>t.status===\"dirty\",wr=t=>t.status===\"valid\",di=t=>typeof Promise<\"u\"&&t instanceof Promise;var q;(function(t){t.errToObj=e=>typeof e==\"string\"?{message:e}:e||{},t.toString=e=>typeof e==\"string\"?e:e?.message})(q||(q={}));var xt=class{constructor(e,r,n,i){this._cachedPath=[],this.parent=e,this.data=r,this._path=n,this._key=i}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}},K_=(t,e)=>{if(wr(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error(\"Validation failed but no issues detected.\");return{success:!1,get error(){if(this._error)return this._error;let r=new Ze(t.common.issues);return this._error=r,this._error}}};function z(t){if(!t)return{};let{errorMap:e,invalid_type_error:r,required_error:n,description:i}=t;if(e&&(r||n))throw new Error(`Can't use \"invalid_type_error\" or \"required_error\" in conjunction with custom error map.`);return e?{errorMap:e,description:i}:{errorMap:(s,o)=>{let{message:u}=t;return s.code===\"invalid_enum_value\"?{message:u??o.defaultError}:typeof o.data>\"u\"?{message:u??n??o.defaultError}:s.code!==\"invalid_type\"?{message:o.defaultError}:{message:u??r??o.defaultError}},description:i}}var H=class{get description(){return this._def.description}_getType(e){return Ft(e.data)}_getOrReturnCtx(e,r){return r||{common:e.parent.common,data:e.data,parsedType:Ft(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Re,ctx:{common:e.parent.common,data:e.data,parsedType:Ft(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let r=this._parse(e);if(di(r))throw new Error(\"Synchronous parse encountered promise.\");return r}_parseAsync(e){let r=this._parse(e);return Promise.resolve(r)}parse(e,r){let n=this.safeParse(e,r);if(n.success)return n.data;throw n.error}safeParse(e,r){let n={common:{issues:[],async:r?.async??!1,contextualErrorMap:r?.errorMap},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ft(e)},i=this._parseSync({data:e,path:n.path,parent:n});return K_(n,i)}\"~validate\"(e){let r={common:{issues:[],async:!!this[\"~standard\"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ft(e)};if(!this[\"~standard\"].async)try{let n=this._parseSync({data:e,path:[],parent:r});return wr(n)?{value:n.value}:{issues:r.common.issues}}catch(n){n?.message?.toLowerCase()?.includes(\"encountered\")&&(this[\"~standard\"].async=!0),r.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:r}).then(n=>wr(n)?{value:n.value}:{issues:r.common.issues})}async parseAsync(e,r){let n=await this.safeParseAsync(e,r);if(n.success)return n.data;throw n.error}async safeParseAsync(e,r){let n={common:{issues:[],contextualErrorMap:r?.errorMap,async:!0},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ft(e)},i=this._parse({data:e,path:n.path,parent:n}),a=await(di(i)?i:Promise.resolve(i));return K_(n,a)}refine(e,r){let n=i=>typeof r==\"string\"||typeof r>\"u\"?{message:r}:typeof r==\"function\"?r(i):r;return this._refinement((i,a)=>{let s=e(i),o=()=>a.addIssue({code:_.custom,...n(i)});return typeof Promise<\"u\"&&s instanceof Promise?s.then(u=>u?!0:(o(),!1)):s?!0:(o(),!1)})}refinement(e,r){return this._refinement((n,i)=>e(n)?!0:(i.addIssue(typeof r==\"function\"?r(n,i):r),!1))}_refinement(e){return new bt({schema:this,typeName:M.ZodEffects,effect:{type:\"refinement\",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this[\"~standard\"]={version:1,vendor:\"zod\",validate:r=>this[\"~validate\"](r)}}optional(){return yt.create(this,this._def)}nullable(){return Ut.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return ar.create(this)}promise(){return Er.create(this,this._def)}or(e){return Yr.create([this,e],this._def)}and(e){return en.create(this,e,this._def)}transform(e){return new bt({...z(this._def),schema:this,typeName:M.ZodEffects,effect:{type:\"transform\",transform:e}})}default(e){let r=typeof e==\"function\"?e:()=>e;return new sn({...z(this._def),innerType:this,defaultValue:r,typeName:M.ZodDefault})}brand(){return new Da({typeName:M.ZodBranded,type:this,...z(this._def)})}catch(e){let r=typeof e==\"function\"?e:()=>e;return new on({...z(this._def),innerType:this,catchValue:r,typeName:M.ZodCatch})}describe(e){let r=this.constructor;return new r({...this._def,description:e})}pipe(e){return La.create(this,e)}readonly(){return cn.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}},GI=/^c[^\\s-]{8,}$/i,JI=/^[0-9a-z]+$/,ZI=/^[0-9A-HJKMNP-TV-Z]{26}$/i,XI=/^[0-9a-fA-F]{8}\\b-[0-9a-fA-F]{4}\\b-[0-9a-fA-F]{4}\\b-[0-9a-fA-F]{4}\\b-[0-9a-fA-F]{12}$/i,YI=/^[a-z0-9_-]{21}$/i,e9=/^[A-Za-z0-9-_]+\\.[A-Za-z0-9-_]+\\.[A-Za-z0-9-_]*$/,t9=/^[-+]?P(?!$)(?:(?:[-+]?\\d+Y)|(?:[-+]?\\d+[.,]\\d+Y$))?(?:(?:[-+]?\\d+M)|(?:[-+]?\\d+[.,]\\d+M$))?(?:(?:[-+]?\\d+W)|(?:[-+]?\\d+[.,]\\d+W$))?(?:(?:[-+]?\\d+D)|(?:[-+]?\\d+[.,]\\d+D$))?(?:T(?=[\\d+-])(?:(?:[-+]?\\d+H)|(?:[-+]?\\d+[.,]\\d+H$))?(?:(?:[-+]?\\d+M)|(?:[-+]?\\d+[.,]\\d+M$))?(?:[-+]?\\d+(?:[.,]\\d+)?S)?)??$/,r9=/^(?!\\.)(?!.*\\.\\.)([A-Z0-9_'+\\-\\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\\-]*\\.)+[A-Z]{2,}$/i,n9=\"^(\\\\p{Extended_Pictographic}|\\\\p{Emoji_Component})+$\",Uf,i9=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,a9=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\\/(3[0-2]|[12]?[0-9])$/,s9=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,o9=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,c9=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,u9=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,G_=\"((\\\\d\\\\d[2468][048]|\\\\d\\\\d[13579][26]|\\\\d\\\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\\\d|30)|(02)-(0[1-9]|1\\\\d|2[0-8])))\",l9=new RegExp(`^${G_}$`);function J_(t){let e=\"[0-5]\\\\d\";t.precision?e=`${e}\\\\.\\\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\\\.\\\\d+)?`);let r=t.precision?\"+\":\"?\";return`([01]\\\\d|2[0-3]):[0-5]\\\\d(:${e})${r}`}function p9(t){return new RegExp(`^${J_(t)}$`)}function Z_(t){let e=`${G_}T${J_(t)}`,r=[];return r.push(t.local?\"Z?\":\"Z\"),t.offset&&r.push(\"([+-]\\\\d{2}:?\\\\d{2})\"),e=`${e}(${r.join(\"|\")})`,new RegExp(`^${e}$`)}function d9(t,e){return!!((e===\"v4\"||!e)&&i9.test(t)||(e===\"v6\"||!e)&&s9.test(t))}function f9(t,e){if(!e9.test(t))return!1;try{let[r]=t.split(\".\");if(!r)return!1;let n=r.replace(/-/g,\"+\").replace(/_/g,\"/\").padEnd(r.length+(4-r.length%4)%4,\"=\"),i=JSON.parse(atob(n));return!(typeof i!=\"object\"||i===null||\"typ\"in i&&i?.typ!==\"JWT\"||!i.alg||e&&i.alg!==e)}catch{return!1}}function h9(t,e){return!!((e===\"v4\"||!e)&&a9.test(t)||(e===\"v6\"||!e)&&o9.test(t))}var _r=class t extends H{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==P.string){let a=this._getOrReturnCtx(e);return k(a,{code:_.invalid_type,expected:P.string,received:a.parsedType}),D}let n=new Re,i;for(let a of this._def.checks)if(a.kind===\"min\")e.data.length<a.value&&(i=this._getOrReturnCtx(e,i),k(i,{code:_.too_small,minimum:a.value,type:\"string\",inclusive:!0,exact:!1,message:a.message}),n.dirty());else if(a.kind===\"max\")e.data.length>a.value&&(i=this._getOrReturnCtx(e,i),k(i,{code:_.too_big,maximum:a.value,type:\"string\",inclusive:!0,exact:!1,message:a.message}),n.dirty());else if(a.kind===\"length\"){let s=e.data.length>a.value,o=e.data.length<a.value;(s||o)&&(i=this._getOrReturnCtx(e,i),s?k(i,{code:_.too_big,maximum:a.value,type:\"string\",inclusive:!0,exact:!0,message:a.message}):o&&k(i,{code:_.too_small,minimum:a.value,type:\"string\",inclusive:!0,exact:!0,message:a.message}),n.dirty())}else if(a.kind===\"email\")r9.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"email\",code:_.invalid_string,message:a.message}),n.dirty());else if(a.kind===\"emoji\")Uf||(Uf=new RegExp(n9,\"u\")),Uf.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"emoji\",code:_.invalid_string,message:a.message}),n.dirty());else if(a.kind===\"uuid\")XI.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"uuid\",code:_.invalid_string,message:a.message}),n.dirty());else if(a.kind===\"nanoid\")YI.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"nanoid\",code:_.invalid_string,message:a.message}),n.dirty());else if(a.kind===\"cuid\")GI.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"cuid\",code:_.invalid_string,message:a.message}),n.dirty());else if(a.kind===\"cuid2\")JI.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"cuid2\",code:_.invalid_string,message:a.message}),n.dirty());else if(a.kind===\"ulid\")ZI.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"ulid\",code:_.invalid_string,message:a.message}),n.dirty());else if(a.kind===\"url\")try{new URL(e.data)}catch{i=this._getOrReturnCtx(e,i),k(i,{validation:\"url\",code:_.invalid_string,message:a.message}),n.dirty()}else a.kind===\"regex\"?(a.regex.lastIndex=0,a.regex.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"regex\",code:_.invalid_string,message:a.message}),n.dirty())):a.kind===\"trim\"?e.data=e.data.trim():a.kind===\"includes\"?e.data.includes(a.value,a.position)||(i=this._getOrReturnCtx(e,i),k(i,{code:_.invalid_string,validation:{includes:a.value,position:a.position},message:a.message}),n.dirty()):a.kind===\"toLowerCase\"?e.data=e.data.toLowerCase():a.kind===\"toUpperCase\"?e.data=e.data.toUpperCase():a.kind===\"startsWith\"?e.data.startsWith(a.value)||(i=this._getOrReturnCtx(e,i),k(i,{code:_.invalid_string,validation:{startsWith:a.value},message:a.message}),n.dirty()):a.kind===\"endsWith\"?e.data.endsWith(a.value)||(i=this._getOrReturnCtx(e,i),k(i,{code:_.invalid_string,validation:{endsWith:a.value},message:a.message}),n.dirty()):a.kind===\"datetime\"?Z_(a).test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{code:_.invalid_string,validation:\"datetime\",message:a.message}),n.dirty()):a.kind===\"date\"?l9.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{code:_.invalid_string,validation:\"date\",message:a.message}),n.dirty()):a.kind===\"time\"?p9(a).test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{code:_.invalid_string,validation:\"time\",message:a.message}),n.dirty()):a.kind===\"duration\"?t9.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"duration\",code:_.invalid_string,message:a.message}),n.dirty()):a.kind===\"ip\"?d9(e.data,a.version)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"ip\",code:_.invalid_string,message:a.message}),n.dirty()):a.kind===\"jwt\"?f9(e.data,a.alg)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"jwt\",code:_.invalid_string,message:a.message}),n.dirty()):a.kind===\"cidr\"?h9(e.data,a.version)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"cidr\",code:_.invalid_string,message:a.message}),n.dirty()):a.kind===\"base64\"?c9.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"base64\",code:_.invalid_string,message:a.message}),n.dirty()):a.kind===\"base64url\"?u9.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"base64url\",code:_.invalid_string,message:a.message}),n.dirty()):K.assertNever(a);return{status:n.value,value:e.data}}_regex(e,r,n){return this.refinement(i=>e.test(i),{validation:r,code:_.invalid_string,...q.errToObj(n)})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:\"email\",...q.errToObj(e)})}url(e){return this._addCheck({kind:\"url\",...q.errToObj(e)})}emoji(e){return this._addCheck({kind:\"emoji\",...q.errToObj(e)})}uuid(e){return this._addCheck({kind:\"uuid\",...q.errToObj(e)})}nanoid(e){return this._addCheck({kind:\"nanoid\",...q.errToObj(e)})}cuid(e){return this._addCheck({kind:\"cuid\",...q.errToObj(e)})}cuid2(e){return this._addCheck({kind:\"cuid2\",...q.errToObj(e)})}ulid(e){return this._addCheck({kind:\"ulid\",...q.errToObj(e)})}base64(e){return this._addCheck({kind:\"base64\",...q.errToObj(e)})}base64url(e){return this._addCheck({kind:\"base64url\",...q.errToObj(e)})}jwt(e){return this._addCheck({kind:\"jwt\",...q.errToObj(e)})}ip(e){return this._addCheck({kind:\"ip\",...q.errToObj(e)})}cidr(e){return this._addCheck({kind:\"cidr\",...q.errToObj(e)})}datetime(e){return typeof e==\"string\"?this._addCheck({kind:\"datetime\",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:\"datetime\",precision:typeof e?.precision>\"u\"?null:e?.precision,offset:e?.offset??!1,local:e?.local??!1,...q.errToObj(e?.message)})}date(e){return this._addCheck({kind:\"date\",message:e})}time(e){return typeof e==\"string\"?this._addCheck({kind:\"time\",precision:null,message:e}):this._addCheck({kind:\"time\",precision:typeof e?.precision>\"u\"?null:e?.precision,...q.errToObj(e?.message)})}duration(e){return this._addCheck({kind:\"duration\",...q.errToObj(e)})}regex(e,r){return this._addCheck({kind:\"regex\",regex:e,...q.errToObj(r)})}includes(e,r){return this._addCheck({kind:\"includes\",value:e,position:r?.position,...q.errToObj(r?.message)})}startsWith(e,r){return this._addCheck({kind:\"startsWith\",value:e,...q.errToObj(r)})}endsWith(e,r){return this._addCheck({kind:\"endsWith\",value:e,...q.errToObj(r)})}min(e,r){return this._addCheck({kind:\"min\",value:e,...q.errToObj(r)})}max(e,r){return this._addCheck({kind:\"max\",value:e,...q.errToObj(r)})}length(e,r){return this._addCheck({kind:\"length\",value:e,...q.errToObj(r)})}nonempty(e){return this.min(1,q.errToObj(e))}trim(){return new t({...this._def,checks:[...this._def.checks,{kind:\"trim\"}]})}toLowerCase(){return new t({...this._def,checks:[...this._def.checks,{kind:\"toLowerCase\"}]})}toUpperCase(){return new t({...this._def,checks:[...this._def.checks,{kind:\"toUpperCase\"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind===\"datetime\")}get isDate(){return!!this._def.checks.find(e=>e.kind===\"date\")}get isTime(){return!!this._def.checks.find(e=>e.kind===\"time\")}get isDuration(){return!!this._def.checks.find(e=>e.kind===\"duration\")}get isEmail(){return!!this._def.checks.find(e=>e.kind===\"email\")}get isURL(){return!!this._def.checks.find(e=>e.kind===\"url\")}get isEmoji(){return!!this._def.checks.find(e=>e.kind===\"emoji\")}get isUUID(){return!!this._def.checks.find(e=>e.kind===\"uuid\")}get isNANOID(){return!!this._def.checks.find(e=>e.kind===\"nanoid\")}get isCUID(){return!!this._def.checks.find(e=>e.kind===\"cuid\")}get isCUID2(){return!!this._def.checks.find(e=>e.kind===\"cuid2\")}get isULID(){return!!this._def.checks.find(e=>e.kind===\"ulid\")}get isIP(){return!!this._def.checks.find(e=>e.kind===\"ip\")}get isCIDR(){return!!this._def.checks.find(e=>e.kind===\"cidr\")}get isBase64(){return!!this._def.checks.find(e=>e.kind===\"base64\")}get isBase64url(){return!!this._def.checks.find(e=>e.kind===\"base64url\")}get minLength(){let e=null;for(let r of this._def.checks)r.kind===\"min\"&&(e===null||r.value>e)&&(e=r.value);return e}get maxLength(){let e=null;for(let r of this._def.checks)r.kind===\"max\"&&(e===null||r.value<e)&&(e=r.value);return e}};_r.create=t=>new _r({checks:[],typeName:M.ZodString,coerce:t?.coerce??!1,...z(t)});function m9(t,e){let r=(t.toString().split(\".\")[1]||\"\").length,n=(e.toString().split(\".\")[1]||\"\").length,i=r>n?r:n,a=Number.parseInt(t.toFixed(i).replace(\".\",\"\")),s=Number.parseInt(e.toFixed(i).replace(\".\",\"\"));return a%s/10**i}var Kr=class t extends H{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==P.number){let a=this._getOrReturnCtx(e);return k(a,{code:_.invalid_type,expected:P.number,received:a.parsedType}),D}let n,i=new Re;for(let a of this._def.checks)a.kind===\"int\"?K.isInteger(e.data)||(n=this._getOrReturnCtx(e,n),k(n,{code:_.invalid_type,expected:\"integer\",received:\"float\",message:a.message}),i.dirty()):a.kind===\"min\"?(a.inclusive?e.data<a.value:e.data<=a.value)&&(n=this._getOrReturnCtx(e,n),k(n,{code:_.too_small,minimum:a.value,type:\"number\",inclusive:a.inclusive,exact:!1,message:a.message}),i.dirty()):a.kind===\"max\"?(a.inclusive?e.data>a.value:e.data>=a.value)&&(n=this._getOrReturnCtx(e,n),k(n,{code:_.too_big,maximum:a.value,type:\"number\",inclusive:a.inclusive,exact:!1,message:a.message}),i.dirty()):a.kind===\"multipleOf\"?m9(e.data,a.value)!==0&&(n=this._getOrReturnCtx(e,n),k(n,{code:_.not_multiple_of,multipleOf:a.value,message:a.message}),i.dirty()):a.kind===\"finite\"?Number.isFinite(e.data)||(n=this._getOrReturnCtx(e,n),k(n,{code:_.not_finite,message:a.message}),i.dirty()):K.assertNever(a);return{status:i.value,value:e.data}}gte(e,r){return this.setLimit(\"min\",e,!0,q.toString(r))}gt(e,r){return this.setLimit(\"min\",e,!1,q.toString(r))}lte(e,r){return this.setLimit(\"max\",e,!0,q.toString(r))}lt(e,r){return this.setLimit(\"max\",e,!1,q.toString(r))}setLimit(e,r,n,i){return new t({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:n,message:q.toString(i)}]})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:\"int\",message:q.toString(e)})}positive(e){return this._addCheck({kind:\"min\",value:0,inclusive:!1,message:q.toString(e)})}negative(e){return this._addCheck({kind:\"max\",value:0,inclusive:!1,message:q.toString(e)})}nonpositive(e){return this._addCheck({kind:\"max\",value:0,inclusive:!0,message:q.toString(e)})}nonnegative(e){return this._addCheck({kind:\"min\",value:0,inclusive:!0,message:q.toString(e)})}multipleOf(e,r){return this._addCheck({kind:\"multipleOf\",value:e,message:q.toString(r)})}finite(e){return this._addCheck({kind:\"finite\",message:q.toString(e)})}safe(e){return this._addCheck({kind:\"min\",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:q.toString(e)})._addCheck({kind:\"max\",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:q.toString(e)})}get minValue(){let e=null;for(let r of this._def.checks)r.kind===\"min\"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(let r of this._def.checks)r.kind===\"max\"&&(e===null||r.value<e)&&(e=r.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind===\"int\"||e.kind===\"multipleOf\"&&K.isInteger(e.value))}get isFinite(){let e=null,r=null;for(let n of this._def.checks){if(n.kind===\"finite\"||n.kind===\"int\"||n.kind===\"multipleOf\")return!0;n.kind===\"min\"?(r===null||n.value>r)&&(r=n.value):n.kind===\"max\"&&(e===null||n.value<e)&&(e=n.value)}return Number.isFinite(r)&&NumberThu, 29 Jan 2026 21:34:49 GMT express-session deprecated req.secret; provide secret option at node:internal/modules/cjs/loader:1706:14","attributes":{"level":"error"},"tags":{"project":"29c6c2c4-ea10-4fe6-8901-1198a13520db","environment":"9a47f9fb-0d50-4031-a85e-16db1d46fb86","service":"09a1965e-88d6-44ee-9836-14176d4bb0b5","deployment":"e78c90dd-bc00-48f5-9312-8a8fa977b2c2","replica":"68b779c1-91b1-4ca6-88f4-a907899be5f1"},"timestamp":"2026-01-29T21:34:49.304812567Z"},{"message":"/app/dist/index.cjs:71","attributes":{"level":"error"},"tags":{"project":"29c6c2c4-ea10-4fe6-8901-1198a13520db","environment":"9a47f9fb-0d50-4031-a85e-16db1d46fb86","service":"09a1965e-88d6-44ee-9836-14176d4bb0b5","deployment":"e78c90dd-bc00-48f5-9312-8a8fa977b2c2","replica":"68b779c1-91b1-4ca6-88f4-a907899be5f1"},"timestamp":"2026-01-29T21:34:49.351655441Z"},{"message":"\t\t`;await r.execute(g`CREATE SCHEMA IF NOT EXISTS ${g.identifier(a)}`),await r.execute(s);let u=(await r.all(g`select id, hash, created_at from ${g.identifier(a)}.${g.identifier(i)} order by created_at desc limit 1`))[0];await r.transaction(async c=>{for await(let l of e)if(!u||Number(u.created_at)<l.folderMillis){for(let p of l.sql)await c.execute(g.raw(p));await c.execute(g`insert into ${g.identifier(a)}.${g.identifier(i)} (\"hash\", \"created_at\") values(${l.hash}, ${l.folderMillis})`)}})}escapeName(e){return`\"${e}\"`}escapeParam(e){return`$${e+1}`}escapeString(e){return`'${e.replace(/'/g,\"''\")}'`}buildWithCTE(e){if(!e?.length)return;let r=[g`with `];for(let[n,i]of e.entries())r.push(g`${g.identifier(i._.alias)} as (${i._.sql})`),n<e.length-1&&r.push(g`, `);return r.push(g` `),g.join(r)}buildDeleteQuery({table:e,where:r,returning:n,withList:i}){let a=this.buildWithCTE(i),s=n?g` returning ${this.buildSelection(n,{isSingleTable:!0})}`:void 0,o=r?g` where ${r}`:void 0;return g`${a}delete from ${e}${o}${s}`}buildUpdateSet(e,r){let n=e[A.Symbol.Columns],i=Object.keys(n).filter(s=>r[s]!==void 0||n[s]?.onUpdateFn!==void 0),a=i.length;return g.join(i.flatMap((s,o)=>{let u=n[s],c=r[s]??g.param(u.onUpdateFn(),u),l=g`${g.identifier(this.casing.getColumnCasing(u))} = ${c}`;return o<a-1?[l,g.raw(\", \")]:[l]}))}buildUpdateQuery({table:e,set:r,where:n,returning:i,withList:a,from:s,joins:o}){let u=this.buildWithCTE(a),c=e[Te.Symbol.Name],l=e[Te.Symbol.Schema],p=e[Te.Symbol.OriginalName],d=c===p?void 0:c,f=g`${l?g`${g.identifier(l)}.`:void 0}${g.identifier(p)}${d&&g` ${g.identifier(d)}`}`,y=this.buildUpdateSet(e,r),m=s&&g.join([g.raw(\" from \"),this.buildFromTable(s)]),x=this.buildJoins(o),w=i?g` returning ${this.buildSelection(i,{isSingleTable:!s})}`:void 0,T=n?g` where ${n}`:void 0;return g`${u}update ${f} set ${y}${m}${x}${T}${w}`}buildSelection(e,{isSingleTable:r=!1}={}){let n=e.length,i=e.flatMap(({field:a},s)=>{let o=[];if(b(a,O.Aliased)&&a.isSelectionField)o.push(g.identifier(a.fieldAlias));else if(b(a,O.Aliased)||b(a,O)){let u=b(a,O.Aliased)?a.sql:a;r?o.push(new O(u.queryChunks.map(c=>b(c,E)?g.identifier(this.casing.getColumnCasing(c)):c))):o.push(u),b(a,O.Aliased)&&o.push(g` as ${g.identifier(a.fieldAlias)}`)}else b(a,J)&&(r?o.push(g.identifier(this.casing.getColumnCasing(a))):o.push(a));return s<n-1&&o.push(g`, `),o});return g.join(i)}buildJoins(e){if(!e||e.length===0)return;let r=[];for(let[n,i]of e.entries()){n===0&&r.push(g` `);let a=i.table,s=i.lateral?g` lateral`:void 0;if(b(a,Te)){let o=a[Te.Symbol.Name],u=a[Te.Symbol.Schema],c=a[Te.Symbol.OriginalName],l=o===c?void 0:i.alias;r.push(g`${g.raw(i.joinType)} join${s} ${u?g`${g.identifier(u)}.`:void 0}${g.identifier(c)}${l&&g` ${g.identifier(l)}`} on ${i.on}`)}else if(b(a,Ue)){let o=a[te].name,u=a[te].schema,c=a[te].originalName,l=o===c?void 0:i.alias;r.push(g`${g.raw(i.joinType)} join${s} ${u?g`${g.identifier(u)}.`:void 0}${g.identifier(c)}${l&&g` ${g.identifier(l)}`} on ${i.on}`)}else r.push(g`${g.raw(i.joinType)} join${s} ${a} on ${i.on}`);n<e.length-1&&r.push(g` `)}return g.join(r)}buildFromTable(e){if(b(e,A)&&e[A.Symbol.OriginalName]!==e[A.Symbol.Name]){let r=g`${g.identifier(e[A.Symbol.OriginalName])}`;return e[A.Symbol.Schema]&&(r=g`${g.identifier(e[A.Symbol.Schema])}.${r}`),g`${r} ${g.identifier(e[A.Symbol.Name])}`}return e}buildSelectQuery({withList:e,fields:r,fieldsFlat:n,where:i,having:a,table:s,joins:o,orderBy:u,groupBy:c,limit:l,offset:p,lockingClause:d,distinct:f,setOperators:y}){let m=n??gt(r);for(let ne of m)if(b(ne.field,J)&&We(ne.field.table)!==(b(s,ye)?s._.alias:b(s,oi)?s[te].name:b(s,O)?void 0:We(s))&&!(he=>o?.some(({alias:et})=>et===(he[A.Symbol.IsAlias]?We(he):he[A.Symbol.BaseName])))(ne.field.table)){let he=We(ne.field.table);throw new Error(`Your \"${ne.path.join(\"->\")}\" field references a column \"${he}\".\"${ne.field.name}\", but the table \"${he}\" is not part of the query! Did you forget to join it?`)}let x=!o||o.length===0,w=this.buildWithCTE(e),T;f&&(T=f===!0?g` distinct`:g` distinct on (${g.join(f.on,g`, `)})`);let S=this.buildSelection(m,{isSingleTable:x}),C=this.buildFromTable(s),L=this.buildJoins(o),j=i?g` where ${i}`:void 0,R=a?g` having ${a}`:void 0,N;u&&u.length>0&&(N=g` order by ${g.join(u,g`, `)}`);let Q;c&&c.length>0&&(Q=g` group by ${g.join(c,g`, `)}`);let fe=typeof l==\"object\"||typeof l==\"number\"&&l>=0?g` limit ${l}`:void 0,_t=p?g` offset ${p}`:void 0,qe=g.empty();if(d){let ne=g` for ${g.raw(d.strength)}`;d.config.of&&ne.append(g` of ${g.join(Array.isArray(d.config.of)?d.config.of:[d.config.of],g`, `)}`),d.config.noWait?ne.append(g` no wait`):d.config.skipLocked&&ne.append(g` skip locked`),qe.append(ne)}let se=g`${w}select${T} ${S} from ${C}${L}${j}${Q}${R}${N}${fe}${_t}${qe}`;return y.length>0?this.buildSetOperations(se,y):se}buildSetOperations(e,r){let[n,...i]=r;if(!n)throw new Error(\"Cannot pass undefined values to any set operator\");return i.length===0?this.buildSetOperationQuery({leftSelect:e,setOperator:n}):this.buildSetOperations(this.buildSetOperationQuery({leftSelect:e,setOperator:n}),i)}buildSetOperationQuery({leftSelect:e,setOperator:{type:r,isAll:n,rightSelect:i,limit:a,orderBy:s,offset:o}}){let u=g`(${e.getSQL()}) `,c=g`(${i.getSQL()})`,l;if(s&&s.length>0){let y=[];for(let m of s)if(b(m,E))y.push(g.identifier(m.name));else if(b(m,O)){for(let x=0;x<m.queryChunks.length;x++){let w=m.queryChunks[x];b(w,E)&&(m.queryChunks[x]=g.identifier(w.name))}y.push(g`${m}`)}else y.push(g`${m}`);l=g` order by ${g.join(y,g`, `)} `}let p=typeof a==\"object\"||typeof a==\"number\"&&a>=0?g` limit ${a}`:void 0,d=g.raw(`${r} ${n?\"all \":\"\"}`),f=o?g` offset ${o}`:void 0;return g`${u}${d}${c}${l}${p}${f}`}buildInsertQuery({table:e,values:r,onConflict:n,returning:i,withList:a,select:s,overridingSystemValue_:o}){let u=[],c=e[A.Symbol.Columns],l=Object.entries(c).filter(([w,T])=>!T.shouldDisableInsert()),p=l.map(([,w])=>g.identifier(this.casing.getColumnCasing(w)));if(s){let w=r;b(w,O)?u.push(w):u.push(w.getSQL())}else{let w=r;u.push(g.raw(\"values \"));for(let[T,S]of w.entries()){let C=[];for(let[L,j]of l){let R=S[L];if(R===void 0||b(R,Ge)&&R.value===void 0)if(j.defaultFn!==void 0){let N=j.defaultFn(),Q=b(N,O)?N:g.param(N,j);C.push(Q)}else if(!j.default&&j.onUpdateFn!==void 0){let N=j.onUpdateFn(),Q=b(N,O)?N:g.param(N,j);C.push(Q)}else C.push(g`default`);else C.push(R)}u.push(C),T<w.length-1&&u.push(g`, `)}}let d=this.buildWithCTE(a),f=g.join(u),y=i?g` returning ${this.buildSelection(i,{isSingleTable:!0})}`:void 0,m=n?g` on conflict ${n}`:void 0,x=o===!0?g`overriding system value `:void 0;return g`${d}insert into ${e} ${p} ${x}${f}${m}${y}`}buildRefreshMaterializedViewQuery({view:e,concurrently:r,withNoData:n}){let i=r?g` concurrently`:void 0,a=n?g` with no data`:void 0;return g`refresh materialized view${i} ${e}${a}`}prepareTyping(e){return b(e,Sa)||b(e,_a)?\"json\":b(e,Ea)?\"decimal\":b(e,Ta)?\"time\":b(e,ka)||b(e,Aa)?\"timestamp\":b(e,ba)||b(e,wa)?\"date\":b(e,Ca)?\"uuid\":\"none\"}sqlToQuery(e,r){return e.toQuery({casing:this.casing,escapeName:this.escapeName,escapeParam:this.escapeParam,escapeString:this.escapeString,prepareTyping:this.prepareTyping,invokeSource:r})}buildRelationalQueryWithoutPK({fullSchema:e,schema:r,tableNamesMap:n,table:i,tableConfig:a,queryConfig:s,tableAlias:o,nestedQueryRelation:u,joinOn:c}){let l=[],p,d,f=[],y,m=[];if(s===!0)l=Object.entries(a.columns).map(([T,S])=>({dbKey:S.name,tsKey:T,field:Dt(S,o),relationTableTsKey:void 0,isJson:!1,selection:[]}));else{let w=Object.fromEntries(Object.entries(a.columns).map(([R,N])=>[R,Dt(N,o)]));if(s.where){let R=typeof s.where==\"function\"?s.where(w,F_()):s.where;y=R&&ga(R,o)}let T=[],S=[];if(s.columns){let R=!1;for(let[N,Q]of Object.entries(s.columns))Q!==void 0&&N in a.columns&&(!R&&Q===!0&&(R=!0),S.push(N));S.length>0&&(S=R?S.filter(N=>s.columns?.[N]===!0):Object.keys(a.columns).filter(N=>!S.includes(N)))}else S=Object.keys(a.columns);for(let R of S){let N=a.columns[R];T.push({tsKey:R,value:N})}let C=[];s.with&&(C=Object.entries(s.with).filter(R=>!!R[1]).map(([R,N])=>({tsKey:R,queryConfig:N,relation:a.relations[R]})));let L;if(s.extras){L=typeof s.extras==\"function\"?s.extras(w,{sql:g}):s.extras;for(let[R,N]of Object.entries(L))T.push({tsKey:R,value:pd(N,o)})}for(let{tsKey:R,value:N}of T)l.push({dbKey:b(N,O.Aliased)?N.fieldAlias:a.columns[R].name,tsKey:R,field:b(N,J)?Dt(N,o):N,relationTableTsKey:void 0,isJson:!1,selection:[]});let j=typeof s.orderBy==\"function\"?s.orderBy(w,$_()):s.orderBy??[];Array.isArray(j)||(j=[j]),f=j.map(R=>b(R,J)?Dt(R,o):ga(R,o)),p=s.limit,d=s.offset;for(let{tsKey:R,queryConfig:N,relation:Q}of C){let fe=B_(r,n,Q),_t=Hr(Q.referencedTable),qe=n[_t],se=`${o}_${R}`,ne=Pa(...fe.fields.map((Ht,qi)=>kt(Dt(fe.references[qi],se),Dt(Ht,o)))),he=this.buildRelationalQueryWithoutPK({fullSchema:e,schema:r,tableNamesMap:n,table:e[qe],tableConfig:r[qe],queryConfig:b(Q,xr)?N===!0?{limit:1}:{...N,limit:1}:N,tableAlias:se,joinOn:ne,nestedQueryRelation:Q}),et=g`${g.identifier(se)}.${g.identifier(\"data\")}`.as(R);m.push({on:g`true`,table:new ye(he.sql,{},se),alias:se,joinType:\"left\",lateral:!0}),l.push({dbKey:R,tsKey:R,field:et,relationTableTsKey:qe,isJson:!0,selection:he.selection})}}if(l.length===0)throw new xa({message:`No fields selected for table \"${a.tsName}\" (\"${o}\")`});let x;if(y=Pa(c,y),u){let w=g`json_build_array(${g.join(l.map(({field:C,tsKey:L,isJson:j})=>j?g`${g.identifier(`${o}_${L}`)}.${g.identifier(\"data\")}`:b(C,O.Aliased)?C.sql:C),g`, `)})`;b(u,Oa)&&(w=g`coalesce(json_agg(${w}${f.length>0?g` order by ${g.join(f,g`, `)}`:void 0}), '[]'::json)`);let T=[{dbKey:\"data\",tsKey:\"data\",field:w.as(\"data\"),isJson:!0,relationTableTsKey:a.tsName,selection:l}];p!==void 0||d!==void 0||f.length>0?(x=this.buildSelectQuery({table:ma(i,o),fields:{},fieldsFlat:[{path:[],field:g.raw(\"*\")}],where:y,limit:p,offset:d,orderBy:f,setOperators:[]}),y=void 0,p=void 0,d=void 0,f=[]):x=ma(i,o),x=this.buildSelectQuery({table:b(x,Te)?x:new ye(x,{},o),fields:{},fieldsFlat:T.map(({field:C})=>({path:[],field:b(C,J)?Dt(C,o):C})),joins:m,where:y,limit:p,offset:d,orderBy:f,setOperators:[]})}else x=this.buildSelectQuery({table:ma(i,o),fields:{},fieldsFlat:l.map(({field:w})=>({path:[],field:b(w,J)?Dt(w,o):w})),joins:m,where:y,limit:p,offset:d,orderBy:f,setOperators:[]});return{tableTsKey:a.tsName,sql:x,selection:l}}};var zo=class{static[h]=\"TypedQueryBuilder\";getSelectedFields(){return this._.selectedFields}};var De=class{static[h]=\"PgSelectBuilder\";fields;session;dialect;withList=[];distinct;constructor(e){this.fields=e.fields,this.session=e.session,this.dialect=e.dialect,e.withList&&(this.withList=e.withList),this.distinct=e.distinct}authToken;setToken(e){return this.authToken=e,this}from(e){let r=!!this.fields,n=e,i;return this.fields?i=this.fields:b(n,ye)?i=Object.fromEntries(Object.keys(n._.selectedFields).map(a=>[a,n[a]])):b(n,oi)?i=n[te].selectedFields:b(n,O)?i={}:i=qo(n),new Ho({table:n,fields:i,isPartialSelect:r,session:this.session,dialect:this.dialect,withList:this.withList,distinct:this.distinct}).setToken(this.authToken)}},If=class extends zo{static[h]=\"PgSelectQueryBuilder\";_;config;joinsNotNullableMap;tableName;isPartialSelect;session;dialect;constructor({table:e,fields:r,isPartialSelect:n,session:i,dialect:a,withList:s,distinct:o}){super(),this.config={withList:s,table:e,fields:{...r},distinct:o,setOperators:[]},this.isPartialSelect=n,this.session=i,this.dialect=a,this._={selectedFields:r},this.tableName=er(e),this.joinsNotNullableMap=typeof this.tableName==\"string\"?{[this.tableName]:!0}:{}}createJoin(e){return(r,n)=>{let i=this.tableName,a=er(r);if(typeof a==\"string\"&&this.config.joins?.some(s=>s.alias===a))throw new Error(`Alias \"${a}\" is already used in this query`);if(!this.isPartialSelect&&(Object.keys(this.joinsNotNullableMap).length===1&&typeof i==\"string\"&&(this.config.fields={[i]:this.config.fields}),typeof a==\"string\"&&!b(r,O))){let s=b(r,ye)?r._.selectedFields:b(r,Ue)?r[te].selectedFields:r[A.Symbol.Columns];this.config.fields[a]=s}if(typeof n==\"function\"&&(n=n(new Proxy(this.config.fields,new de({sqlAliasedBehavior:\"sql\",sqlBehavior:\"sql\"})))),this.config.joins||(this.config.joins=[]),this.config.joins.push({on:n,table:r,joinType:e,alias:a}),typeof a==\"string\")switch(e){case\"left\":{this.joinsNotNullableMap[a]=!1;break}case\"right\":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([s])=>[s,!1])),this.joinsNotNullableMap[a]=!0;break}case\"inner\":{this.joinsNotNullableMap[a]=!0;break}case\"full\":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([s])=>[s,!1])),this.joinsNotNullableMap[a]=!1;break}}return this}}leftJoin=this.createJoin(\"left\");rightJoin=this.createJoin(\"right\");innerJoin=this.createJoin(\"inner\");fullJoin=this.createJoin(\"full\");createSetOperator(e,r){return n=>{let i=typeof n==\"function\"?n(MI()):n;if(!va(this.getSelectedFields(),i.getSelectedFields()))throw new Error(\"Set operator error (union / intersect / except): selected fields are not the same or are in a different order\");return this.config.setOperators.push({type:e,isAll:r,rightSelect:i}),this}}union=this.createSetOperator(\"union\",!1);unionAll=this.createSetOperator(\"union\",!0);intersect=this.createSetOperator(\"intersect\",!1);intersectAll=this.createSetOperator(\"intersect\",!0);except=this.createSetOperator(\"except\",!1);exceptAll=this.createSetOperator(\"except\",!0);addSetOperators(e){return this.config.setOperators.push(...e),this}where(e){return typeof e==\"function\"&&(e=e(new Proxy(this.config.fields,new de({sqlAliasedBehavior:\"sql\",sqlBehavior:\"sql\"})))),this.config.where=e,this}having(e){return typeof e==\"function\"&&(e=e(new Proxy(this.config.fields,new de({sqlAliasedBehavior:\"sql\",sqlBehavior:\"sql\"})))),this.config.having=e,this}groupBy(...e){if(typeof e[0]==\"function\"){let r=e[0](new Proxy(this.config.fields,new de({sqlAliasedBehavior:\"alias\",sqlBehavior:\"sql\"})));this.config.groupBy=Array.isArray(r)?r:[r]}else this.config.groupBy=e;return this}orderBy(...e){if(typeof e[0]==\"function\"){let r=e[0](new Proxy(this.config.fields,new de({sqlAliasedBehavior:\"alias\",sqlBehavior:\"sql\"}))),n=Array.isArray(r)?r:[r];this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=n:this.config.orderBy=n}else{let r=e;this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=r:this.config.orderBy=r}return this}limit(e){return this.config.setOperators.length>0?this.config.setOperators.at(-1).limit=e:this.config.limit=e,this}offset(e){return this.config.setOperators.length>0?this.config.setOperators.at(-1).offset=e:this.config.offset=e,this}for(e,r={}){return this.config.lockingClause={strength:e,config:r},this}getSQL(){return this.dialect.buildSelectQuery(this.config)}toSQL(){let{typings:e,...r}=this.dialect.sqlToQuery(this.getSQL());return r}as(e){return new Proxy(new ye(this.getSQL(),this.config.fields,e),new de({alias:e,sqlAliasedBehavior:\"alias\",sqlBehavior:\"error\"}))}getSelectedFields(){return new Proxy(this.config.fields,new de({alias:this.tableName,sqlAliasedBehavior:\"alias\",sqlBehavior:\"error\"}))}$dynamic(){return this}},Ho=class extends If{static[h]=\"PgSelect\";_prepare(e){let{session:r,config:n,dialect:i,joinsNotNullableMap:a,authToken:s}=this;if(!r)throw new Error(\"Cannot execute a query on a query builder. Please use a database instance instead.\");return ee.startActiveSpan(\"drizzle.prepareQuery\",()=>{let o=gt(n.fields),u=r.prepareQuery(i.sqlToQuery(this.getSQL()),o,e,!0);return u.joinsNotNullableMap=a,u.setToken(s)})}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>ee.startActiveSpan(\"drizzle.operation\",()=>this._prepare().execute(e,this.authToken))};$1(Ho,[je]);function ci(t,e){return(r,n,...i)=>{let a=[n,...i].map(s=>({type:t,isAll:e,rightSelect:s}));for(let s of a)if(!va(r.getSelectedFields(),s.rightSelect.getSelectedFields()))throw new Error(\"Set operator error (union / intersect / except): selected fields are not the same or are in a different order\");return r.addSetOperators(a)}}var MI=()=>({union:FI,unionAll:$I,intersect:UI,intersectAll:BI,except:zI,exceptAll:HI}),FI=ci(\"union\",!1),$I=ci(\"union\",!0),UI=ci(\"intersect\",!1),BI=ci(\"intersect\",!0),zI=ci(\"except\",!1),HI=ci(\"except\",!0);var ui=class{static[h]=\"PgQueryBuilder\";dialect;dialectConfig;constructor(e){this.dialect=b(e,br)?e:void 0,this.dialectConfig=b(e,br)?void 0:e}$with=(e,r)=>{let n=this;return{as:a=>(typeof a==\"function\"&&(a=a(n)),new Proxy(new ni(a.getSQL(),r??(\"getSelectedFields\"in a?a.getSelectedFields()??{}:{}),e,!0),new de({alias:e,sqlAliasedBehavior:\"alias\",sqlBehavior:\"error\"})))}};with(...e){let r=this;function n(s){return new De({fields:s??void 0,session:void 0,dialect:r.getDialect(),withList:e})}function i(s){return new De({fields:s??void 0,session:void 0,dialect:r.getDialect(),distinct:!0})}function a(s,o){return new De({fields:o??void 0,session:void 0,dialect:r.getDialect(),distinct:{on:s}})}return{select:n,selectDistinct:i,selectDistinctOn:a}}select(e){return new De({fields:e??void 0,session:void 0,dialect:this.getDialect()})}selectDistinct(e){return new De({fields:e??void 0,session:void 0,dialect:this.getDialect(),distinct:!0})}selectDistinctOn(e,r){return new De({fields:r??void 0,session:void 0,dialect:this.getDialect(),distinct:{on:e}})}getDialect(){return this.dialect||(this.dialect=new br(this.dialectConfig)),this.dialect}};var Ra=class{constructor(e,r,n,i,a){this.table=e,this.session=r,this.dialect=n,this.withList=i,this.overridingSystemValue_=a}static[h]=\"PgInsertBuilder\";authToken;setToken(e){return this.authToken=e,this}overridingSystemValue(){return this.overridingSystemValue_=!0,this}values(e){if(e=Array.isArray(e)?e:[e],e.length===0)throw new Error(\"values() must be called with at least one value\");let r=e.map(n=>{let i={},a=this.table[A.Symbol.Columns];for(let s of Object.keys(n)){let o=n[s];i[s]=b(o,O)?o:new Ge(o,a[s])}return i});return new Qo(this.table,r,this.session,this.dialect,this.withList,!1,this.overridingSystemValue_).setToken(this.authToken)}select(e){let r=typeof e==\"function\"?e(new ui):e;if(!b(r,O)&&!va(this.table[Io],r._.selectedFields))throw new Error(\"Insert select error: selected fields are not the same or are in a different order compared to the table definition\");return new Qo(this.table,r,this.session,this.dialect,this.withList,!0)}},Qo=class extends je{constructor(e,r,n,i,a,s,o){super(),this.session=n,this.dialect=i,this.config={table:e,values:r,withList:a,select:s,overridingSystemValue_:o}}static[h]=\"PgInsert\";config;returning(e=this.config.table[A.Symbol.Columns]){return this.config.returningFields=e,this.config.returning=gt(e),this}onConflictDoNothing(e={}){if(e.target===void 0)this.config.onConflict=g`do nothing`;else{let r=\"\";r=Array.isArray(e.target)?e.target.map(i=>this.dialect.escapeName(this.dialect.casing.getColumnCasing(i))).join(\",\"):this.dialect.escapeName(this.dialect.casing.getColumnCasing(e.target));let n=e.where?g` where ${e.where}`:void 0;this.config.onConflict=g`(${g.raw(r)})${n} do nothing`}return this}onConflictDoUpdate(e){if(e.where&&(e.targetWhere||e.setWhere))throw new Error('You cannot use both \"where\" and \"targetWhere\"/\"setWhere\" at the same time - \"where\" is deprecated, use \"targetWhere\" or \"setWhere\" instead.');let r=e.where?g` where ${e.where}`:void 0,n=e.targetWhere?g` where ${e.targetWhere}`:void 0,i=e.setWhere?g` where ${e.setWhere}`:void 0,a=this.dialect.buildUpdateSet(this.config.table,No(this.config.table,e.set)),s=\"\";return s=Array.isArray(e.target)?e.target.map(o=>this.dialect.escapeName(this.dialect.casing.getColumnCasing(o))).join(\",\"):this.dialect.escapeName(this.dialect.casing.getColumnCasing(e.target)),this.config.onConflict=g`(${g.raw(s)})${n} do update set ${a}${r}${i}`,this}getSQL(){return this.dialect.buildInsertQuery(this.config)}toSQL(){let{typings:e,...r}=this.dialect.sqlToQuery(this.getSQL());return r}_prepare(e){return ee.startActiveSpan(\"drizzle.prepareQuery\",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,e,!0))}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>ee.startActiveSpan(\"drizzle.operation\",()=>this._prepare().execute(e,this.authToken));getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new de({alias:We(this.config.table),sqlAliasedBehavior:\"alias\",sqlBehavior:\"error\"})):void 0}$dynamic(){return this}};var Vo=class extends je{constructor(e,r,n){super(),this.session=r,this.dialect=n,this.config={view:e}}static[h]=\"PgRefreshMaterializedView\";config;concurrently(){if(this.config.withNoData!==void 0)throw new Error(\"Cannot use concurrently and withNoData together\");return this.config.concurrently=!0,this}withNoData(){if(this.config.concurrently!==void 0)throw new Error(\"Cannot use concurrently and withNoData together\");return this.config.withNoData=!0,this}getSQL(){return this.dialect.buildRefreshMaterializedViewQuery(this.config)}toSQL(){let{typings:e,...r}=this.dialect.sqlToQuery(this.getSQL());return r}_prepare(e){return ee.startActiveSpan(\"drizzle.prepareQuery\",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),void 0,e,!0))}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>ee.startActiveSpan(\"drizzle.operation\",()=>this._prepare().execute(e,this.authToken))};var Ia=class{constructor(e,r,n,i){this.table=e,this.session=r,this.dialect=n,this.withList=i}static[h]=\"PgUpdateBuilder\";authToken;setToken(e){return this.authToken=e,this}set(e){return new Nf(this.table,No(this.table,e),this.session,this.dialect,this.withList).setToken(this.authToken)}},Nf=class extends je{constructor(e,r,n,i,a){super(),this.session=n,this.dialect=i,this.config={set:r,table:e,withList:a,joins:[]},this.tableName=er(e),this.joinsNotNullableMap=typeof this.tableName==\"string\"?{[this.tableName]:!0}:{}}static[h]=\"PgUpdate\";config;tableName;joinsNotNullableMap;from(e){let r=e,n=er(r);return typeof n==\"string\"&&(this.joinsNotNullableMap[n]=!0),this.config.from=r,this}getTableLikeFields(e){return b(e,Te)?e[A.Symbol.Columns]:b(e,ye)?e._.selectedFields:e[te].selectedFields}createJoin(e){return(r,n)=>{let i=er(r);if(typeof i==\"string\"&&this.config.joins.some(a=>a.alias===i))throw new Error(`Alias \"${i}\" is already used in this query`);if(typeof n==\"function\"){let a=this.config.from&&!b(this.config.from,O)?this.getTableLikeFields(this.config.from):void 0;n=n(new Proxy(this.config.table[A.Symbol.Columns],new de({sqlAliasedBehavior:\"sql\",sqlBehavior:\"sql\"})),a&&new Proxy(a,new de({sqlAliasedBehavior:\"sql\",sqlBehavior:\"sql\"})))}if(this.config.joins.push({on:n,table:r,joinType:e,alias:i}),typeof i==\"string\")switch(e){case\"left\":{this.joinsNotNullableMap[i]=!1;break}case\"right\":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([a])=>[a,!1])),this.joinsNotNullableMap[i]=!0;break}case\"inner\":{this.joinsNotNullableMap[i]=!0;break}case\"full\":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([a])=>[a,!1])),this.joinsNotNullableMap[i]=!1;break}}return this}}leftJoin=this.createJoin(\"left\");rightJoin=this.createJoin(\"right\");innerJoin=this.createJoin(\"inner\");fullJoin=this.createJoin(\"full\");where(e){return this.config.where=e,this}returning(e){if(!e&&(e=Object.assign({},this.config.table[A.Symbol.Columns]),this.config.from)){let r=er(this.config.from);if(typeof r==\"string\"&&this.config.from&&!b(this.config.from,O)){let n=this.getTableLikeFields(this.config.from);e[r]=n}for(let n of this.config.joins){let i=er(n.table);if(typeof i==\"string\"&&!b(n.table,O)){let a=this.getTableLikeFields(n.table);e[i]=a}}}return this.config.returningFields=e,this.config.returning=gt(e),this}getSQL(){return this.dialect.buildUpdateQuery(this.config)}toSQL(){let{typings:e,...r}=this.dialect.sqlToQuery(this.getSQL());return r}_prepare(e){let r=this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,e,!0);return r.joinsNotNullableMap=this.joinsNotNullableMap,r}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>this._prepare().execute(e,this.authToken);getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new de({alias:We(this.config.table),sqlAliasedBehavior:\"alias\",sqlBehavior:\"error\"})):void 0}$dynamic(){return this}};var Ko=class t extends O{constructor(e){super(t.buildEmbeddedCount(e.source,e.filters).queryChunks),this.params=e,this.mapWith(Number),this.session=e.session,this.sql=t.buildCount(e.source,e.filters)}sql;token;static[h]=\"PgCountBuilder\";[Symbol.toStringTag]=\"PgCountBuilder\";session;static buildEmbeddedCount(e,r){return g`(select count(*) from ${e}${g.raw(\" where \").if(r)}${r})`}static buildCount(e,r){return g`select count(*) as count from ${e}${g.raw(\" where \").if(r)}${r};`}setToken(e){return this.token=e,this}then(e,r){return Promise.resolve(this.session.count(this.sql,this.token)).then(e,r)}catch(e){return this.then(void 0,e)}finally(e){return this.then(r=>(e?.(),r),r=>{throw e?.(),r})}};var Wo=class{constructor(e,r,n,i,a,s,o){this.fullSchema=e,this.schema=r,this.tableNamesMap=n,this.table=i,this.tableConfig=a,this.dialect=s,this.session=o}static[h]=\"PgRelationalQueryBuilder\";findMany(e){return new Go(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,e||{},\"many\")}findFirst(e){return new Go(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,e?{...e,limit:1}:{limit:1},\"first\")}},Go=class extends je{constructor(e,r,n,i,a,s,o,u,c){super(),this.fullSchema=e,this.schema=r,this.tableNamesMap=n,this.table=i,this.tableConfig=a,this.dialect=s,this.session=o,this.config=u,this.mode=c}static[h]=\"PgRelationalQuery\";_prepare(e){return ee.startActiveSpan(\"drizzle.prepareQuery\",()=>{let{query:r,builtQuery:n}=this._toSQL();return this.session.prepareQuery(n,void 0,e,!0,(i,a)=>{let s=i.map(o=>Bo(this.schema,this.tableConfig,o,r.selection,a));return this.mode===\"first\"?s[0]:s})})}prepare(e){return this._prepare(e)}_getQuery(){return this.dialect.buildRelationalQueryWithoutPK({fullSchema:this.fullSchema,schema:this.schema,tableNamesMap:this.tableNamesMap,table:this.table,tableConfig:this.tableConfig,queryConfig:this.config,tableAlias:this.tableConfig.tsName})}getSQL(){return this._getQuery().sql}_toSQL(){let e=this._getQuery(),r=this.dialect.sqlToQuery(e.sql);return{query:e,builtQuery:r}}toSQL(){return this._toSQL().builtQuery}authToken;setToken(e){return this.authToken=e,this}execute(){return ee.startActiveSpan(\"drizzle.operation\",()=>this._prepare().execute(void 0,this.authToken))}};var Jo=class extends je{constructor(e,r,n,i){super(),this.execute=e,this.sql=r,this.query=n,this.mapBatchResult=i}static[h]=\"PgRaw\";getSQL(){return this.sql}getQuery(){return this.query}mapResult(e,r){return r?this.mapBatchResult(e):e}_prepare(){return this}isResponseInArrayMode(){return!1}};var li=class{constructor(e,r,n){if(this.dialect=e,this.session=r,this._=n?{schema:n.schema,fullSchema:n.fullSchema,tableNamesMap:n.tableNamesMap,session:r}:{schema:void 0,fullSchema:{},tableNamesMap:{},session:r},this.query={},this._.schema)for(let[i,a]of Object.entries(this._.schema))this.query[i]=new Wo(n.fullSchema,this._.schema,this._.tableNamesMap,n.fullSchema[i],a,e,r)}static[h]=\"PgDatabase\";query;$with=(e,r)=>{let n=this;return{as:a=>(typeof a==\"function\"&&(a=a(new ui(n.dialect))),new Proxy(new ni(a.getSQL(),r??(\"getSelectedFields\"in a?a.getSelectedFields()??{}:{}),e,!0),new de({alias:e,sqlAliasedBehavior:\"alias\",sqlBehavior:\"error\"})))}};$count(e,r){return new Ko({source:e,filters:r,session:this.session})}with(...e){let r=this;function n(c){return new De({fields:c??void 0,session:r.session,dialect:r.dialect,withList:e})}function i(c){return new De({fields:c??void 0,session:r.session,dialect:r.dialect,withList:e,distinct:!0})}function a(c,l){return new De({fields:l??void 0,session:r.session,dialect:r.dialect,withList:e,distinct:{on:c}})}function s(c){return new Ia(c,r.session,r.dialect,e)}function o(c){return new Ra(c,r.session,r.dialect,e)}function u(c){return new ya(c,r.session,r.dialect,e)}return{select:n,selectDistinct:i,selectDistinctOn:a,update:s,insert:o,delete:u}}select(e){return new De({fields:e??void 0,session:this.session,dialect:this.dialect})}selectDistinct(e){return new De({fields:e??void 0,session:this.session,dialect:this.dialect,distinct:!0})}selectDistinctOn(e,r){return new De({fields:r??void 0,session:this.session,dialect:this.dialect,distinct:{on:e}})}update(e){return new Ia(e,this.session,this.dialect)}insert(e){return new Ra(e,this.session,this.dialect)}delete(e){return new ya(e,this.session,this.dialect)}refreshMaterializedView(e){return new Vo(e,this.session,this.dialect)}authToken;execute(e){let r=typeof e==\"string\"?g.raw(e):e.getSQL(),n=this.dialect.sqlToQuery(r),i=this.session.prepareQuery(n,void 0,void 0,!1);return new Jo(()=>i.execute(void 0,this.authToken),r,n,a=>i.mapResult(a,!0))}transaction(e,r){return this.session.transaction(e,r)}};var qf=class{constructor(e,r){this.unique=e,this.name=r}static[h]=\"PgIndexBuilderOn\";on(...e){return new Na(e.map(r=>{if(b(r,O))return r;r=r;let n=new ri(r.name,!!r.keyAsName,r.columnType,r.indexConfig);return r.indexConfig=JSON.parse(JSON.stringify(r.defaultConfig)),n}),this.unique,!1,this.name)}onOnly(...e){return new Na(e.map(r=>{if(b(r,O))return r;r=r;let n=new ri(r.name,!!r.keyAsName,r.columnType,r.indexConfig);return r.indexConfig=r.defaultConfig,n}),this.unique,!0,this.name)}using(e,...r){return new Na(r.map(n=>{if(b(n,O))return n;n=n;let i=new ri(n.name,!!n.keyAsName,n.columnType,n.indexConfig);return n.indexConfig=JSON.parse(JSON.stringify(n.defaultConfig)),i}),this.unique,!0,this.name,e)}},Na=class{static[h]=\"PgIndexBuilder\";config;constructor(e,r,n,i,a=\"btree\"){this.config={name:i,columns:e,unique:r,only:n,method:a}}concurrently(){return this.config.concurrently=!0,this}with(e){return this.config.with=e,this}where(e){return this.config.where=e,this}build(e){return new jf(this.config,e)}},jf=class{static[h]=\"PgIndex\";config;constructor(e,r){this.config={...e,table:r}}};function H_(t){return new qf(!1,t)}var Zo=class{constructor(e){this.query=e}authToken;getQuery(){return this.query}mapResult(e,r){return e}setToken(e){return this.authToken=e,this}static[h]=\"PgPreparedQuery\";joinsNotNullableMap},Xo=class{constructor(e){this.dialect=e}static[h]=\"PgSession\";execute(e,r){return ee.startActiveSpan(\"drizzle.operation\",()=>ee.startActiveSpan(\"drizzle.prepareQuery\",()=>this.prepareQuery(this.dialect.sqlToQuery(e),void 0,void 0,!1)).setToken(r).execute(void 0,r))}all(e){return this.prepareQuery(this.dialect.sqlToQuery(e),void 0,void 0,!1).all()}async count(e,r){let n=await this.execute(e,r);return Number(n[0].count)}},Yo=class extends li{constructor(e,r,n,i=0){super(e,r,n),this.schema=n,this.nestedIndex=i}static[h]=\"PgTransaction\";rollback(){throw new Do}getTransactionConfigSQL(e){let r=[];return e.isolationLevel&&r.push(`isolation level ${e.isolationLevel}`),e.accessMode&&r.push(e.accessMode),typeof e.deferrable==\"boolean\"&&r.push(e.deferrable?\"deferrable\":\"not deferrable\"),g.raw(r.join(\" \"))}setTransaction(e){return this.session.execute(g`set transaction ${this.getTransactionConfigSQL(e)}`)}};var{Pool:Q_,types:Mt}=yr,Df=class extends Zo{constructor(e,r,n,i,a,s,o,u){super({sql:r,params:n}),this.client=e,this.params=n,this.logger=i,this.fields=a,this._isResponseInArrayMode=o,this.customResultMapper=u,this.rawQueryConfig={name:s,text:r,types:{getTypeParser:(c,l)=>c===Mt.builtins.TIMESTAMPTZ?p=>p:c===Mt.builtins.TIMESTAMP?p=>p:c===Mt.builtins.DATE?p=>p:c===Mt.builtins.INTERVAL?p=>p:Mt.getTypeParser(c,l)}},this.queryConfig={name:s,text:r,rowMode:\"array\",types:{getTypeParser:(c,l)=>c===Mt.builtins.TIMESTAMPTZ?p=>p:c===Mt.builtins.TIMESTAMP?p=>p:c===Mt.builtins.DATE?p=>p:c===Mt.builtins.INTERVAL?p=>p:Mt.getTypeParser(c,l)}}}static[h]=\"NodePgPreparedQuery\";rawQueryConfig;queryConfig;async execute(e={}){return ee.startActiveSpan(\"drizzle.execute\",async()=>{let r=ld(this.params,e);this.logger.logQuery(this.rawQueryConfig.text,r);let{fields:n,rawQueryConfig:i,client:a,queryConfig:s,joinsNotNullableMap:o,customResultMapper:u}=this;if(!n&&!u)return ee.startActiveSpan(\"drizzle.driver.execute\",async l=>(l?.setAttributes({\"drizzle.query.name\":i.name,\"drizzle.query.text\":i.text,\"drizzle.query.params\":JSON.stringify(r)}),a.query(i,r)));let c=await ee.startActiveSpan(\"drizzle.driver.execute\",l=>(l?.setAttributes({\"drizzle.query.name\":s.name,\"drizzle.query.text\":s.text,\"drizzle.query.params\":JSON.stringify(r)}),a.query(s,r)));return ee.startActiveSpan(\"drizzle.mapResponse\",()=>u?u(c.rows):c.rows.map(l=>F1(n,l,o)))})}all(e={}){return ee.startActiveSpan(\"drizzle.execute\",()=>{let r=ld(this.params,e);return this.logger.logQuery(this.rawQueryConfig.text,r),ee.startActiveSpan(\"drizzle.driver.execute\",n=>(n?.setAttributes({\"drizzle.query.name\":this.rawQueryConfig.name,\"drizzle.query.text\":this.rawQueryConfig.text,\"drizzle.query.params\":JSON.stringify(r)}),this.client.query(this.rawQueryConfig,r).then(i=>i.rows)))})}isResponseInArrayMode(){return this._isResponseInArrayMode}},ec=class t extends Xo{constructor(e,r,n,i={}){super(r),this.client=e,this.schema=n,this.options=i,this.logger=i.logger??new Ao}static[h]=\"NodePgSession\";logger;prepareQuery(e,r,n,i,a){return new Df(this.client,e.sql,e.params,this.logger,r,n,i,a)}async transaction(e,r){let n=this.client instanceof Q_?new t(await this.client.connect(),this.dialect,this.schema,this.options):this,i=new Lf(this.dialect,n,this.schema);await i.execute(g`begin${r?g` ${i.getTransactionConfigSQL(r)}`:void 0}`);try{let a=await e(i);return await i.execute(g`commit`),a}catch(a){throw await i.execute(g`rollback`),a}finally{this.client instanceof Q_&&n.client.release()}}async count(e){let r=await this.execute(e);return Number(r.rows[0].count)}},Lf=class t extends Yo{static[h]=\"NodePgTransaction\";async transaction(e){let r=`sp${this.nestedIndex+1}`,n=new t(this.dialect,this.session,this.schema,this.nestedIndex+1);await n.execute(g.raw(`savepoint ${r}`));try{let i=await e(n);return await n.execute(g.raw(`release savepoint ${r}`)),i}catch(i){throw await n.execute(g.raw(`rollback to savepoint ${r}`)),i}}};var Mf=class{constructor(e,r,n={}){this.client=e,this.dialect=r,this.options=n}static[h]=\"NodePgDriver\";createSession(e){return new ec(this.client,this.dialect,e,{logger:this.options.logger})}},Ff=class extends li{static[h]=\"NodePgDatabase\"};function qa(t,e={}){let r=new br({casing:e.casing}),n;e.logger===!0?n=new ko:e.logger!==!1&&(n=e.logger);let i;if(e.schema){let u=U_(e.schema,z_);i={fullSchema:e.schema,schema:u.tables,tableNamesMap:u.tableNamesMap}}let s=new Mf(t,r,{logger:n}).createSession(i),o=new Ff(r,s,i);return o.$client=t,o}function tc(...t){if(typeof t[0]==\"string\"){let e=new yr.Pool({connectionString:t[0]});return qa(e,t[1])}if(B1(t[0])){let{connection:e,client:r,...n}=t[0];if(r)return qa(r,n);let i=typeof e==\"string\"?new yr.Pool({connectionString:e}):new yr.Pool(e);return qa(i,n)}return qa(t[0],t[1])}(t=>{function e(r){return qa({},r)}t.mock=e})(tc||(tc={}));var oc={};Rc(oc,{inquiries:()=>at,insertInquirySchema:()=>Hf,insertUserSchema:()=>lN,sessions:()=>uN,users:()=>Tr});var Ie={};Rc(Ie,{BRAND:()=>g9,DIRTY:()=>Vr,EMPTY_PATH:()=>WI,INVALID:()=>D,NEVER:()=>eN,OK:()=>Le,ParseStatus:()=>Re,Schema:()=>H,ZodAny:()=>Sr,ZodArray:()=>ar,ZodBigInt:()=>Wr,ZodBoolean:()=>Gr,ZodBranded:()=>Da,ZodCatch:()=>on,ZodDate:()=>Jr,ZodDefault:()=>sn,ZodDiscriminatedUnion:()=>ic,ZodEffects:()=>bt,ZodEnum:()=>nn,ZodError:()=>Ze,ZodFirstPartyTypeKind:()=>M,ZodFunction:()=>sc,ZodIntersection:()=>en,ZodIssueCode:()=>_,ZodLazy:()=>tn,ZodLiteral:()=>rn,ZodMap:()=>gi,ZodNaN:()=>yi,ZodNativeEnum:()=>an,ZodNever:()=>At,ZodNull:()=>Xr,ZodNullable:()=>Ut,ZodNumber:()=>Kr,ZodObject:()=>Xe,ZodOptional:()=>yt,ZodParsedType:()=>P,ZodPipeline:()=>La,ZodPromise:()=>Er,ZodReadonly:()=>cn,ZodRecord:()=>ac,ZodSchema:()=>H,ZodSet:()=>vi,ZodString:()=>_r,ZodSymbol:()=>hi,ZodTransformer:()=>bt,ZodTuple:()=>$t,ZodType:()=>H,ZodUndefined:()=>Zr,ZodUnion:()=>Yr,ZodUnknown:()=>ir,ZodVoid:()=>mi,addIssueToContext:()=>k,any:()=>T9,array:()=>P9,bigint:()=>b9,boolean:()=>rS,coerce:()=>Y9,custom:()=>Y_,date:()=>w9,datetimeRegex:()=>Z_,defaultErrorMap:()=>rr,discriminatedUnion:()=>N9,effect:()=>Q9,enum:()=>B9,function:()=>F9,getErrorMap:()=>pi,getParsedType:()=>Ft,instanceof:()=>y9,intersection:()=>q9,isAborted:()=>rc,isAsync:()=>di,isDirty:()=>nc,isValid:()=>wr,late:()=>v9,lazy:()=>$9,literal:()=>U9,makeIssue:()=>ja,map:()=>L9,nan:()=>x9,nativeEnum:()=>z9,never:()=>A9,null:()=>E9,nullable:()=>K9,number:()=>tS,object:()=>O9,objectUtil:()=>$f,oboolean:()=>X9,onumber:()=>Z9,optional:()=>V9,ostring:()=>J9,pipeline:()=>G9,preprocess:()=>W9,promise:()=>H9,quotelessJson:()=>QI,record:()=>D9,set:()=>M9,setErrorMap:()=>KI,strictObject:()=>R9,string:()=>eS,symbol:()=>_9,transformer:()=>Q9,tuple:()=>j9,undefined:()=>S9,union:()=>I9,unknown:()=>k9,util:()=>K,void:()=>C9});var K;(function(t){t.assertEqual=i=>{};function e(i){}t.assertIs=e;function r(i){throw new Error}t.assertNever=r,t.arrayToEnum=i=>{let a={};for(let s of i)a[s]=s;return a},t.getValidEnumValues=i=>{let a=t.objectKeys(i).filter(o=>typeof i[i[o]]!=\"number\"),s={};for(let o of a)s[o]=i[o];return t.objectValues(s)},t.objectValues=i=>t.objectKeys(i).map(function(a){return i[a]}),t.objectKeys=typeof Object.keys==\"function\"?i=>Object.keys(i):i=>{let a=[];for(let s in i)Object.prototype.hasOwnProperty.call(i,s)&&a.push(s);return a},t.find=(i,a)=>{for(let s of i)if(a(s))return s},t.isInteger=typeof Number.isInteger==\"function\"?i=>Number.isInteger(i):i=>typeof i==\"number\"&&Number.isFinite(i)&&Math.floor(i)===i;function n(i,a=\" | \"){return i.map(s=>typeof s==\"string\"?`'${s}'`:s).join(a)}t.joinValues=n,t.jsonStringifyReplacer=(i,a)=>typeof a==\"bigint\"?a.toString():a})(K||(K={}));var $f;(function(t){t.mergeShapes=(e,r)=>({...e,...r})})($f||($f={}));var P=K.arrayToEnum([\"string\",\"nan\",\"number\",\"integer\",\"float\",\"boolean\",\"date\",\"bigint\",\"symbol\",\"function\",\"undefined\",\"null\",\"array\",\"object\",\"unknown\",\"promise\",\"void\",\"never\",\"map\",\"set\"]),Ft=t=>{switch(typeof t){case\"undefined\":return P.undefined;case\"string\":return P.string;case\"number\":return Number.isNaN(t)?P.nan:P.number;case\"boolean\":return P.boolean;case\"function\":return P.function;case\"bigint\":return P.bigint;case\"symbol\":return P.symbol;case\"object\":return Array.isArray(t)?P.array:t===null?P.null:t.then&&typeof t.then==\"function\"&&t.catch&&typeof t.catch==\"function\"?P.promise:typeof Map<\"u\"&&t instanceof Map?P.map:typeof Set<\"u\"&&t instanceof Set?P.set:typeof Date<\"u\"&&t instanceof Date?P.date:P.object;default:return P.unknown}};var _=K.arrayToEnum([\"invalid_type\",\"invalid_literal\",\"custom\",\"invalid_union\",\"invalid_union_discriminator\",\"invalid_enum_value\",\"unrecognized_keys\",\"invalid_arguments\",\"invalid_return_type\",\"invalid_date\",\"invalid_string\",\"too_small\",\"too_big\",\"invalid_intersection_types\",\"not_multiple_of\",\"not_finite\"]),QI=t=>JSON.stringify(t,null,2).replace(/\"([^\"]+)\":/g,\"$1:\"),Ze=class t extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};let r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name=\"ZodError\",this.issues=e}format(e){let r=e||function(a){return a.message},n={_errors:[]},i=a=>{for(let s of a.issues)if(s.code===\"invalid_union\")s.unionErrors.map(i);else if(s.code===\"invalid_return_type\")i(s.returnTypeError);else if(s.code===\"invalid_arguments\")i(s.argumentsError);else if(s.path.length===0)n._errors.push(r(s));else{let o=n,u=0;for(;u<s.path.length;){let c=s.path[u];u===s.path.length-1?(o[c]=o[c]||{_errors:[]},o[c]._errors.push(r(s))):o[c]=o[c]||{_errors:[]},o=o[c],u++}}};return i(this),n}static assert(e){if(!(e instanceof t))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,K.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=r=>r.message){let r={},n=[];for(let i of this.issues)if(i.path.length>0){let a=i.path[0];r[a]=r[a]||[],r[a].push(e(i))}else n.push(e(i));return{formErrors:n,fieldErrors:r}}get formErrors(){return this.flatten()}};Ze.create=t=>new Ze(t);var VI=(t,e)=>{let r;switch(t.code){case _.invalid_type:t.received===P.undefined?r=\"Required\":r=`Expected ${t.expected}, received ${t.received}`;break;case _.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(t.expected,K.jsonStringifyReplacer)}`;break;case _.unrecognized_keys:r=`Unrecognized key(s) in object: ${K.joinValues(t.keys,\", \")}`;break;case _.invalid_union:r=\"Invalid input\";break;case _.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${K.joinValues(t.options)}`;break;case _.invalid_enum_value:r=`Invalid enum value. Expected ${K.joinValues(t.options)}, received '${t.received}'`;break;case _.invalid_arguments:r=\"Invalid function arguments\";break;case _.invalid_return_type:r=\"Invalid function return type\";break;case _.invalid_date:r=\"Invalid date\";break;case _.invalid_string:typeof t.validation==\"object\"?\"includes\"in t.validation?(r=`Invalid input: must include \"${t.validation.includes}\"`,typeof t.validation.position==\"number\"&&(r=`${r} at one or more positions greater than or equal to ${t.validation.position}`)):\"startsWith\"in t.validation?r=`Invalid input: must start with \"${t.validation.startsWith}\"`:\"endsWith\"in t.validation?r=`Invalid input: must end with \"${t.validation.endsWith}\"`:K.assertNever(t.validation):t.validation!==\"regex\"?r=`Invalid ${t.validation}`:r=\"Invalid\";break;case _.too_small:t.type===\"array\"?r=`Array must contain ${t.exact?\"exactly\":t.inclusive?\"at least\":\"more than\"} ${t.minimum} element(s)`:t.type===\"string\"?r=`String must contain ${t.exact?\"exactly\":t.inclusive?\"at least\":\"over\"} ${t.minimum} character(s)`:t.type===\"number\"?r=`Number must be ${t.exact?\"exactly equal to \":t.inclusive?\"greater than or equal to \":\"greater than \"}${t.minimum}`:t.type===\"bigint\"?r=`Number must be ${t.exact?\"exactly equal to \":t.inclusive?\"greater than or equal to \":\"greater than \"}${t.minimum}`:t.type===\"date\"?r=`Date must be ${t.exact?\"exactly equal to \":t.inclusive?\"greater than or equal to \":\"greater than \"}${new Date(Number(t.minimum))}`:r=\"Invalid input\";break;case _.too_big:t.type===\"array\"?r=`Array must contain ${t.exact?\"exactly\":t.inclusive?\"at most\":\"less than\"} ${t.maximum} element(s)`:t.type===\"string\"?r=`String must contain ${t.exact?\"exactly\":t.inclusive?\"at most\":\"under\"} ${t.maximum} character(s)`:t.type===\"number\"?r=`Number must be ${t.exact?\"exactly\":t.inclusive?\"less than or equal to\":\"less than\"} ${t.maximum}`:t.type===\"bigint\"?r=`BigInt must be ${t.exact?\"exactly\":t.inclusive?\"less than or equal to\":\"less than\"} ${t.maximum}`:t.type===\"date\"?r=`Date must be ${t.exact?\"exactly\":t.inclusive?\"smaller than or equal to\":\"smaller than\"} ${new Date(Number(t.maximum))}`:r=\"Invalid input\";break;case _.custom:r=\"Invalid input\";break;case _.invalid_intersection_types:r=\"Intersection results could not be merged\";break;case _.not_multiple_of:r=`Number must be a multiple of ${t.multipleOf}`;break;case _.not_finite:r=\"Number must be finite\";break;default:r=e.defaultError,K.assertNever(t)}return{message:r}},rr=VI;var V_=rr;function KI(t){V_=t}function pi(){return V_}var ja=t=>{let{data:e,path:r,errorMaps:n,issueData:i}=t,a=[...r,...i.path||[]],s={...i,path:a};if(i.message!==void 0)return{...i,path:a,message:i.message};let o=\"\",u=n.filter(c=>!!c).slice().reverse();for(let c of u)o=c(s,{data:e,defaultError:o}).message;return{...i,path:a,message:o}},WI=[];function k(t,e){let r=pi(),n=ja({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,r,r===rr?void 0:rr].filter(i=>!!i)});t.common.issues.push(n)}var Re=class t{constructor(){this.value=\"valid\"}dirty(){this.value===\"valid\"&&(this.value=\"dirty\")}abort(){this.value!==\"aborted\"&&(this.value=\"aborted\")}static mergeArray(e,r){let n=[];for(let i of r){if(i.status===\"aborted\")return D;i.status===\"dirty\"&&e.dirty(),n.push(i.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,r){let n=[];for(let i of r){let a=await i.key,s=await i.value;n.push({key:a,value:s})}return t.mergeObjectSync(e,n)}static mergeObjectSync(e,r){let n={};for(let i of r){let{key:a,value:s}=i;if(a.status===\"aborted\"||s.status===\"aborted\")return D;a.status===\"dirty\"&&e.dirty(),s.status===\"dirty\"&&e.dirty(),a.value!==\"__proto__\"&&(typeof s.value<\"u\"||i.alwaysSet)&&(n[a.value]=s.value)}return{status:e.value,value:n}}},D=Object.freeze({status:\"aborted\"}),Vr=t=>({status:\"dirty\",value:t}),Le=t=>({status:\"valid\",value:t}),rc=t=>t.status===\"aborted\",nc=t=>t.status===\"dirty\",wr=t=>t.status===\"valid\",di=t=>typeof Promise<\"u\"&&t instanceof Promise;var q;(function(t){t.errToObj=e=>typeof e==\"string\"?{message:e}:e||{},t.toString=e=>typeof e==\"string\"?e:e?.message})(q||(q={}));var xt=class{constructor(e,r,n,i){this._cachedPath=[],this.parent=e,this.data=r,this._path=n,this._key=i}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}},K_=(t,e)=>{if(wr(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error(\"Validation failed but no issues detected.\");return{success:!1,get error(){if(this._error)return this._error;let r=new Ze(t.common.issues);return this._error=r,this._error}}};function z(t){if(!t)return{};let{errorMap:e,invalid_type_error:r,required_error:n,description:i}=t;if(e&&(r||n))throw new Error(`Can't use \"invalid_type_error\" or \"required_error\" in conjunction with custom error map.`);return e?{errorMap:e,description:i}:{errorMap:(s,o)=>{let{message:u}=t;return s.code===\"invalid_enum_value\"?{message:u??o.defaultError}:typeof o.data>\"u\"?{message:u??n??o.defaultError}:s.code!==\"invalid_type\"?{message:o.defaultError}:{message:u??r??o.defaultError}},description:i}}var H=class{get description(){return this._def.description}_getType(e){return Ft(e.data)}_getOrReturnCtx(e,r){return r||{common:e.parent.common,data:e.data,parsedType:Ft(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Re,ctx:{common:e.parent.common,data:e.data,parsedType:Ft(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let r=this._parse(e);if(di(r))throw new Error(\"Synchronous parse encountered promise.\");return r}_parseAsync(e){let r=this._parse(e);return Promise.resolve(r)}parse(e,r){let n=this.safeParse(e,r);if(n.success)return n.data;throw n.error}safeParse(e,r){let n={common:{issues:[],async:r?.async??!1,contextualErrorMap:r?.errorMap},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ft(e)},i=this._parseSync({data:e,path:n.path,parent:n});return K_(n,i)}\"~validate\"(e){let r={common:{issues:[],async:!!this[\"~standard\"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ft(e)};if(!this[\"~standard\"].async)try{let n=this._parseSync({data:e,path:[],parent:r});return wr(n)?{value:n.value}:{issues:r.common.issues}}catch(n){n?.message?.toLowerCase()?.includes(\"encountered\")&&(this[\"~standard\"].async=!0),r.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:r}).then(n=>wr(n)?{value:n.value}:{issues:r.common.issues})}async parseAsync(e,r){let n=await this.safeParseAsync(e,r);if(n.success)return n.data;throw n.error}async safeParseAsync(e,r){let n={common:{issues:[],contextualErrorMap:r?.errorMap,async:!0},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ft(e)},i=this._parse({data:e,path:n.path,parent:n}),a=await(di(i)?i:Promise.resolve(i));return K_(n,a)}refine(e,r){let n=i=>typeof r==\"string\"||typeof r>\"u\"?{message:r}:typeof r==\"function\"?r(i):r;return this._refinement((i,a)=>{let s=e(i),o=()=>a.addIssue({code:_.custom,...n(i)});return typeof Promise<\"u\"&&s instanceof Promise?s.then(u=>u?!0:(o(),!1)):s?!0:(o(),!1)})}refinement(e,r){return this._refinement((n,i)=>e(n)?!0:(i.addIssue(typeof r==\"function\"?r(n,i):r),!1))}_refinement(e){return new bt({schema:this,typeName:M.ZodEffects,effect:{type:\"refinement\",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this[\"~standard\"]={version:1,vendor:\"zod\",validate:r=>this[\"~validate\"](r)}}optional(){return yt.create(this,this._def)}nullable(){return Ut.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return ar.create(this)}promise(){return Er.create(this,this._def)}or(e){return Yr.create([this,e],this._def)}and(e){return en.create(this,e,this._def)}transform(e){return new bt({...z(this._def),schema:this,typeName:M.ZodEffects,effect:{type:\"transform\",transform:e}})}default(e){let r=typeof e==\"function\"?e:()=>e;return new sn({...z(this._def),innerType:this,defaultValue:r,typeName:M.ZodDefault})}brand(){return new Da({typeName:M.ZodBranded,type:this,...z(this._def)})}catch(e){let r=typeof e==\"function\"?e:()=>e;return new on({...z(this._def),innerType:this,catchValue:r,typeName:M.ZodCatch})}describe(e){let r=this.constructor;return new r({...this._def,description:e})}pipe(e){return La.create(this,e)}readonly(){return cn.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}},GI=/^c[^\\s-]{8,}$/i,JI=/^[0-9a-z]+$/,ZI=/^[0-9A-HJKMNP-TV-Z]{26}$/i,XI=/^[0-9a-fA-F]{8}\\b-[0-9a-fA-F]{4}\\b-[0-9a-fA-F]{4}\\b-[0-9a-fA-F]{4}\\b-[0-9a-fA-F]{12}$/i,YI=/^[a-z0-9_-]{21}$/i,e9=/^[A-Za-z0-9-_]+\\.[A-Za-z0-9-_]+\\.[A-Za-z0-9-_]*$/,t9=/^[-+]?P(?!$)(?:(?:[-+]?\\d+Y)|(?:[-+]?\\d+[.,]\\d+Y$))?(?:(?:[-+]?\\d+M)|(?:[-+]?\\d+[.,]\\d+M$))?(?:(?:[-+]?\\d+W)|(?:[-+]?\\d+[.,]\\d+W$))?(?:(?:[-+]?\\d+D)|(?:[-+]?\\d+[.,]\\d+D$))?(?:T(?=[\\d+-])(?:(?:[-+]?\\d+H)|(?:[-+]?\\d+[.,]\\d+H$))?(?:(?:[-+]?\\d+M)|(?:[-+]?\\d+[.,]\\d+M$))?(?:[-+]?\\d+(?:[.,]\\d+)?S)?)??$/,r9=/^(?!\\.)(?!.*\\.\\.)([A-Z0-9_'+\\-\\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\\-]*\\.)+[A-Z]{2,}$/i,n9=\"^(\\\\p{Extended_Pictographic}|\\\\p{Emoji_Component})+$\",Uf,i9=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,a9=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\\/(3[0-2]|[12]?[0-9])$/,s9=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,o9=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,c9=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,u9=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,G_=\"((\\\\d\\\\d[2468][048]|\\\\d\\\\d[13579][26]|\\\\d\\\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\\\d|30)|(02)-(0[1-9]|1\\\\d|2[0-8])))\",l9=new RegExp(`^${G_}$`);function J_(t){let e=\"[0-5]\\\\d\";t.precision?e=`${e}\\\\.\\\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\\\.\\\\d+)?`);let r=t.precision?\"+\":\"?\";return`([01]\\\\d|2[0-3]):[0-5]\\\\d(:${e})${r}`}function p9(t){return new RegExp(`^${J_(t)}$`)}function Z_(t){let e=`${G_}T${J_(t)}`,r=[];return r.push(t.local?\"Z?\":\"Z\"),t.offset&&r.push(\"([+-]\\\\d{2}:?\\\\d{2})\"),e=`${e}(${r.join(\"|\")})`,new RegExp(`^${e}$`)}function d9(t,e){return!!((e===\"v4\"||!e)&&i9.test(t)||(e===\"v6\"||!e)&&s9.test(t))}function f9(t,e){if(!e9.test(t))return!1;try{let[r]=t.split(\".\");if(!r)return!1;let n=r.replace(/-/g,\"+\").replace(/_/g,\"/\").padEnd(r.length+(4-r.length%4)%4,\"=\"),i=JSON.parse(atob(n));return!(typeof i!=\"object\"||i===null||\"typ\"in i&&i?.typ!==\"JWT\"||!i.alg||e&&i.alg!==e)}catch{return!1}}function h9(t,e){return!!((e===\"v4\"||!e)&&a9.test(t)||(e===\"v6\"||!e)&&o9.test(t))}var _r=class t extends H{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==P.string){let a=this._getOrReturnCtx(e);return k(a,{code:_.invalid_type,expected:P.string,received:a.parsedType}),D}let n=new Re,i;for(let a of this._def.checks)if(a.kind===\"min\")e.data.length<a.value&&(i=this._getOrReturnCtx(e,i),k(i,{code:_.too_small,minimum:a.value,type:\"string\",inclusive:!0,exact:!1,message:a.message}),n.dirty());else if(a.kind===\"max\")e.data.length>a.value&&(i=this._getOrReturnCtx(e,i),k(i,{code:_.too_big,maximum:a.value,type:\"string\",inclusive:!0,exact:!1,message:a.message}),n.dirty());else if(a.kind===\"length\"){let s=e.data.length>a.value,o=e.data.length<a.value;(s||o)&&(i=this._getOrReturnCtx(e,i),s?k(i,{code:_.too_big,maximum:a.value,type:\"string\",inclusive:!0,exact:!0,message:a.message}):o&&k(i,{code:_.too_small,minimum:a.value,type:\"string\",inclusive:!0,exact:!0,message:a.message}),n.dirty())}else if(a.kind===\"email\")r9.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"email\",code:_.invalid_string,message:a.message}),n.dirty());else if(a.kind===\"emoji\")Uf||(Uf=new RegExp(n9,\"u\")),Uf.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"emoji\",code:_.invalid_string,message:a.message}),n.dirty());else if(a.kind===\"uuid\")XI.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"uuid\",code:_.invalid_string,message:a.message}),n.dirty());else if(a.kind===\"nanoid\")YI.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"nanoid\",code:_.invalid_string,message:a.message}),n.dirty());else if(a.kind===\"cuid\")GI.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"cuid\",code:_.invalid_string,message:a.message}),n.dirty());else if(a.kind===\"cuid2\")JI.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"cuid2\",code:_.invalid_string,message:a.message}),n.dirty());else if(a.kind===\"ulid\")ZI.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"ulid\",code:_.invalid_string,message:a.message}),n.dirty());else if(a.kind===\"url\")try{new URL(e.data)}catch{i=this._getOrReturnCtx(e,i),k(i,{validation:\"url\",code:_.invalid_string,message:a.message}),n.dirty()}else a.kind===\"regex\"?(a.regex.lastIndex=0,a.regex.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"regex\",code:_.invalid_string,message:a.message}),n.dirty())):a.kind===\"trim\"?e.data=e.data.trim():a.kind===\"includes\"?e.data.includes(a.value,a.position)||(i=this._getOrReturnCtx(e,i),k(i,{code:_.invalid_string,validation:{includes:a.value,position:a.position},message:a.message}),n.dirty()):a.kind===\"toLowerCase\"?e.data=e.data.toLowerCase():a.kind===\"toUpperCase\"?e.data=e.data.toUpperCase():a.kind===\"startsWith\"?e.data.startsWith(a.value)||(i=this._getOrReturnCtx(e,i),k(i,{code:_.invalid_string,validation:{startsWith:a.value},message:a.message}),n.dirty()):a.kind===\"endsWith\"?e.data.endsWith(a.value)||(i=this._getOrReturnCtx(e,i),k(i,{code:_.invalid_string,validation:{endsWith:a.value},message:a.message}),n.dirty()):a.kind===\"datetime\"?Z_(a).test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{code:_.invalid_string,validation:\"datetime\",message:a.message}),n.dirty()):a.kind===\"date\"?l9.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{code:_.invalid_string,validation:\"date\",message:a.message}),n.dirty()):a.kind===\"time\"?p9(a).test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{code:_.invalid_string,validation:\"time\",message:a.message}),n.dirty()):a.kind===\"duration\"?t9.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"duration\",code:_.invalid_string,message:a.message}),n.dirty()):a.kind===\"ip\"?d9(e.data,a.version)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"ip\",code:_.invalid_string,message:a.message}),n.dirty()):a.kind===\"jwt\"?f9(e.data,a.alg)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"jwt\",code:_.invalid_string,message:a.message}),n.dirty()):a.kind===\"cidr\"?h9(e.data,a.version)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"cidr\",code:_.invalid_string,message:a.message}),n.dirty()):a.kind===\"base64\"?c9.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"base64\",code:_.invalid_string,message:a.message}),n.dirty()):a.kind===\"base64url\"?u9.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"base64url\",code:_.invalid_string,message:a.message}),n.dirty()):K.assertNever(a);return{status:n.value,value:e.data}}_regex(e,r,n){return this.refinement(i=>e.test(i),{validation:r,code:_.invalid_string,...q.errToObj(n)})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:\"email\",...q.errToObj(e)})}url(e){return this._addCheck({kind:\"url\",...q.errToObj(e)})}emoji(e){return this._addCheck({kind:\"emoji\",...q.errToObj(e)})}uuid(e){return this._addCheck({kind:\"uuid\",...q.errToObj(e)})}nanoid(e){return this._addCheck({kind:\"nanoid\",...q.errToObj(e)})}cuid(e){return this._addCheck({kind:\"cuid\",...q.errToObj(e)})}cuid2(e){return this._addCheck({kind:\"cuid2\",...q.errToObj(e)})}ulid(e){return this._addCheck({kind:\"ulid\",...q.errToObj(e)})}base64(e){return this._addCheck({kind:\"base64\",...q.errToObj(e)})}base64url(e){return this._addCheck({kind:\"base64url\",...q.errToObj(e)})}jwt(e){return this._addCheck({kind:\"jwt\",...q.errToObj(e)})}ip(e){return this._addCheck({kind:\"ip\",...q.errToObj(e)})}cidr(e){return this._addCheck({kind:\"cidr\",...q.errToObj(e)})}datetime(e){return typeof e==\"string\"?this._addCheck({kind:\"datetime\",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:\"datetime\",precision:typeof e?.precision>\"u\"?null:e?.precision,offset:e?.offset??!1,local:e?.local??!1,...q.errToObj(e?.message)})}date(e){return this._addCheck({kind:\"date\",message:e})}time(e){return typeof e==\"string\"?this._addCheck({kind:\"time\",precision:null,message:e}):this._addCheck({kind:\"time\",precision:typeof e?.precision>\"u\"?null:e?.precision,...q.errToObj(e?.message)})}duration(e){return this._addCheck({kind:\"duration\",...q.errToObj(e)})}regex(e,r){return this._addCheck({kind:\"regex\",regex:e,...q.errToObj(r)})}includes(e,r){return this._addCheck({kind:\"includes\",value:e,position:r?.position,...q.errToObj(r?.message)})}startsWith(e,r){return this._addCheck({kind:\"startsWith\",value:e,...q.errToObj(r)})}endsWith(e,r){return this._addCheck({kind:\"endsWith\",value:e,...q.errToObj(r)})}min(e,r){return this._addCheck({kind:\"min\",value:e,...q.errToObj(r)})}max(e,r){return this._addCheck({kind:\"max\",value:e,...q.errToObj(r)})}length(e,r){return this._addCheck({kind:\"length\",value:e,...q.errToObj(r)})}nonempty(e){return this.min(1,q.errToObj(e))}trim(){return new t({...this._def,checks:[...this._def.checks,{kind:\"trim\"}]})}toLowerCase(){return new t({...this._def,checks:[...this._def.checks,{kind:\"toLowerCase\"}]})}toUpperCase(){return new t({...this._def,checks:[...this._def.checks,{kind:\"toUpperCase\"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind===\"datetime\")}get isDate(){return!!this._def.checks.find(e=>e.kind===\"date\")}get isTime(){return!!this._def.checks.find(e=>e.kind===\"time\")}get isDuration(){return!!this._def.checks.find(e=>e.kind===\"duration\")}get isEmail(){return!!this._def.checks.find(e=>e.kind===\"email\")}get isURL(){return!!this._def.checks.find(e=>e.kind===\"url\")}get isEmoji(){return!!this._def.checks.find(e=>e.kind===\"emoji\")}get isUUID(){return!!this._def.checks.find(e=>e.kind===\"uuid\")}get isNANOID(){return!!this._def.checks.find(e=>e.kind===\"nanoid\")}get isCUID(){return!!this._def.checks.find(e=>e.kind===\"cuid\")}get isCUID2(){return!!this._def.checks.find(e=>e.kind===\"cuid2\")}get isULID(){return!!this._def.checks.find(e=>e.kind===\"ulid\")}get isIP(){return!!this._def.checks.find(e=>e.kind===\"ip\")}get isCIDR(){return!!this._def.checks.find(e=>e.kind===\"cidr\")}get isBase64(){return!!this._def.checks.find(e=>e.kind===\"base64\")}get isBase64url(){return!!this._def.checks.find(e=>e.kind===\"base64url\")}get minLength(){let e=null;for(let r of this._def.checks)r.kind===\"min\"&&(e===null||r.value>e)&&(e=r.value);return e}get maxLength(){let e=null;for(let r of this._def.checks)r.kind===\"max\"&&(e===null||r.value<e)&&(e=r.value);return e}};_r.create=t=>new _r({checks:[],typeName:M.ZodString,coerce:t?.coerce??!1,...z(t)});function m9(t,e){let r=(t.toString().split(\".\")[1]||\"\").length,n=(e.toString().split(\".\")[1]||\"\").length,i=r>n?r:n,a=Number.parseInt(t.toFixed(i).replace(\".\",\"\")),s=Number.parseInt(e.toFixed(i).replace(\".\",\"\"));return a%s/10**i}var Kr=class t extends H{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==P.number){let a=this._getOrReturnCtx(e);return k(a,{code:_.invalid_type,expected:P.number,received:a.parsedType}),D}let n,i=new Re;for(let a of this._def.checks)a.kind===\"int\"?K.isInteger(e.data)||(n=this._getOrReturnCtx(e,n),k(n,{code:_.invalid_type,expected:\"integer\",received:\"float\",message:a.message}),i.dirty()):a.kind===\"min\"?(a.inclusive?e.data<a.value:e.data<=a.value)&&(n=this._getOrReturnCtx(e,n),k(n,{code:_.too_small,minimum:a.value,type:\"number\",inclusive:a.inclusive,exact:!1,message:a.message}),i.dirty()):a.kind===\"max\"?(a.inclusive?e.data>a.value:e.data>=a.value)&&(n=this._getOrReturnCtx(e,n),k(n,{code:_.too_big,maximum:a.value,type:\"number\",inclusive:a.inclusive,exact:!1,message:a.message}),i.dirty()):a.kind===\"multipleOf\"?m9(e.data,a.value)!==0&&(n=this._getOrReturnCtx(e,n),k(n,{code:_.not_multiple_of,multipleOf:a.value,message:a.message}),i.dirty()):a.kind===\"finite\"?Number.isFinite(e.data)||(n=this._getOrReturnCtx(e,n),k(n,{code:_.not_finite,message:a.message}),i.dirty()):K.assertNever(a);return{status:i.value,value:e.data}}gte(e,r){return this.setLimit(\"min\",e,!0,q.toString(r))}gt(e,r){return this.setLimit(\"min\",e,!1,q.toString(r))}lte(e,r){return this.setLimit(\"max\",e,!0,q.toString(r))}lt(e,r){return this.setLimit(\"max\",e,!1,q.toString(r))}setLimit(e,r,n,i){return new t({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:n,message:q.toString(i)}]})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:\"int\",message:q.toString(e)})}positive(e){return this._addCheck({kind:\"min\",value:0,inclusive:!1,message:q.toString(e)})}negative(e){return this._addCheck({kind:\"max\",value:0,inclusive:!1,message:q.toString(e)})}nonpositive(e){return this._addCheck({kind:\"max\",value:0,inclusive:!0,message:q.toString(e)})}nonnegative(e){return this._addCheck({kind:\"min\",value:0,inclusive:!0,message:q.toString(e)})}multipleOf(e,r){return this._addCheck({kind:\"multipleOf\",value:e,message:q.toString(r)})}finite(e){return this._addCheck({kind:\"finite\",message:q.toString(e)})}safe(e){return this._addCheck({kind:\"min\",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:q.toString(e)})._addCheck({kind:\"max\",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:q.toString(e)})}get minValue(){let e=null;for(let r of this._def.checks)r.kind===\"min\"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(let r of this._def.checks)r.kind===\"max\"&&(e===null||r.value<e)&&(e=r.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind===\"int\"||e.kind===\"multipleOf\"&&K.isInteger(e.value))}get isFinite(){let e=null,r=null;for(let n of this._def.checks){if(n.kind===\"finite\"||n.kind===\"int\"||n.kind===\"multipleOf\")return!0;n.kind===\"min\"?(r===null||n.value>r)&&(r=n.value):n.kind===\"max\"&&(e===null||n.value<e)&&(e=n.value)}return Number.isFinite(r)&&NumberThu, 29 Jan 2026 21:34:51 GMT express-session deprecated req.secret; provide secret option at node:internal/modules/cjs/loader:1706:14","attributes":{"level":"error"},"tags":{"project":"29c6c2c4-ea10-4fe6-8901-1198a13520db","environment":"9a47f9fb-0d50-4031-a85e-16db1d46fb86","service":"09a1965e-88d6-44ee-9836-14176d4bb0b5","deployment":"e78c90dd-bc00-48f5-9312-8a8fa977b2c2","replica":"68b779c1-91b1-4ca6-88f4-a907899be5f1"},"timestamp":"2026-01-29T21:34:51.367912936Z"},{"message":"/app/dist/index.cjs:71","attributes":{"level":"error"},"tags":{"project":"29c6c2c4-ea10-4fe6-8901-1198a13520db","environment":"9a47f9fb-0d50-4031-a85e-16db1d46fb86","service":"09a1965e-88d6-44ee-9836-14176d4bb0b5","deployment":"e78c90dd-bc00-48f5-9312-8a8fa977b2c2","replica":"68b779c1-91b1-4ca6-88f4-a907899be5f1"},"timestamp":"2026-01-29T21:34:51.367921179Z"},{"message":"\t\t`;await r.execute(g`CREATE SCHEMA IF NOT EXISTS ${g.identifier(a)}`),await r.execute(s);let u=(await r.all(g`select id, hash, created_at from ${g.identifier(a)}.${g.identifier(i)} order by created_at desc limit 1`))[0];await r.transaction(async c=>{for await(let l of e)if(!u||Number(u.created_at)<l.folderMillis){for(let p of l.sql)await c.execute(g.raw(p));await c.execute(g`insert into ${g.identifier(a)}.${g.identifier(i)} (\"hash\", \"created_at\") values(${l.hash}, ${l.folderMillis})`)}})}escapeName(e){return`\"${e}\"`}escapeParam(e){return`$${e+1}`}escapeString(e){return`'${e.replace(/'/g,\"''\")}'`}buildWithCTE(e){if(!e?.length)return;let r=[g`with `];for(let[n,i]of e.entries())r.push(g`${g.identifier(i._.alias)} as (${i._.sql})`),n<e.length-1&&r.push(g`, `);return r.push(g` `),g.join(r)}buildDeleteQuery({table:e,where:r,returning:n,withList:i}){let a=this.buildWithCTE(i),s=n?g` returning ${this.buildSelection(n,{isSingleTable:!0})}`:void 0,o=r?g` where ${r}`:void 0;return g`${a}delete from ${e}${o}${s}`}buildUpdateSet(e,r){let n=e[A.Symbol.Columns],i=Object.keys(n).filter(s=>r[s]!==void 0||n[s]?.onUpdateFn!==void 0),a=i.length;return g.join(i.flatMap((s,o)=>{let u=n[s],c=r[s]??g.param(u.onUpdateFn(),u),l=g`${g.identifier(this.casing.getColumnCasing(u))} = ${c}`;return o<a-1?[l,g.raw(\", \")]:[l]}))}buildUpdateQuery({table:e,set:r,where:n,returning:i,withList:a,from:s,joins:o}){let u=this.buildWithCTE(a),c=e[Te.Symbol.Name],l=e[Te.Symbol.Schema],p=e[Te.Symbol.OriginalName],d=c===p?void 0:c,f=g`${l?g`${g.identifier(l)}.`:void 0}${g.identifier(p)}${d&&g` ${g.identifier(d)}`}`,y=this.buildUpdateSet(e,r),m=s&&g.join([g.raw(\" from \"),this.buildFromTable(s)]),x=this.buildJoins(o),w=i?g` returning ${this.buildSelection(i,{isSingleTable:!s})}`:void 0,T=n?g` where ${n}`:void 0;return g`${u}update ${f} set ${y}${m}${x}${T}${w}`}buildSelection(e,{isSingleTable:r=!1}={}){let n=e.length,i=e.flatMap(({field:a},s)=>{let o=[];if(b(a,O.Aliased)&&a.isSelectionField)o.push(g.identifier(a.fieldAlias));else if(b(a,O.Aliased)||b(a,O)){let u=b(a,O.Aliased)?a.sql:a;r?o.push(new O(u.queryChunks.map(c=>b(c,E)?g.identifier(this.casing.getColumnCasing(c)):c))):o.push(u),b(a,O.Aliased)&&o.push(g` as ${g.identifier(a.fieldAlias)}`)}else b(a,J)&&(r?o.push(g.identifier(this.casing.getColumnCasing(a))):o.push(a));return s<n-1&&o.push(g`, `),o});return g.join(i)}buildJoins(e){if(!e||e.length===0)return;let r=[];for(let[n,i]of e.entries()){n===0&&r.push(g` `);let a=i.table,s=i.lateral?g` lateral`:void 0;if(b(a,Te)){let o=a[Te.Symbol.Name],u=a[Te.Symbol.Schema],c=a[Te.Symbol.OriginalName],l=o===c?void 0:i.alias;r.push(g`${g.raw(i.joinType)} join${s} ${u?g`${g.identifier(u)}.`:void 0}${g.identifier(c)}${l&&g` ${g.identifier(l)}`} on ${i.on}`)}else if(b(a,Ue)){let o=a[te].name,u=a[te].schema,c=a[te].originalName,l=o===c?void 0:i.alias;r.push(g`${g.raw(i.joinType)} join${s} ${u?g`${g.identifier(u)}.`:void 0}${g.identifier(c)}${l&&g` ${g.identifier(l)}`} on ${i.on}`)}else r.push(g`${g.raw(i.joinType)} join${s} ${a} on ${i.on}`);n<e.length-1&&r.push(g` `)}return g.join(r)}buildFromTable(e){if(b(e,A)&&e[A.Symbol.OriginalName]!==e[A.Symbol.Name]){let r=g`${g.identifier(e[A.Symbol.OriginalName])}`;return e[A.Symbol.Schema]&&(r=g`${g.identifier(e[A.Symbol.Schema])}.${r}`),g`${r} ${g.identifier(e[A.Symbol.Name])}`}return e}buildSelectQuery({withList:e,fields:r,fieldsFlat:n,where:i,having:a,table:s,joins:o,orderBy:u,groupBy:c,limit:l,offset:p,lockingClause:d,distinct:f,setOperators:y}){let m=n??gt(r);for(let ne of m)if(b(ne.field,J)&&We(ne.field.table)!==(b(s,ye)?s._.alias:b(s,oi)?s[te].name:b(s,O)?void 0:We(s))&&!(he=>o?.some(({alias:et})=>et===(he[A.Symbol.IsAlias]?We(he):he[A.Symbol.BaseName])))(ne.field.table)){let he=We(ne.field.table);throw new Error(`Your \"${ne.path.join(\"->\")}\" field references a column \"${he}\".\"${ne.field.name}\", but the table \"${he}\" is not part of the query! Did you forget to join it?`)}let x=!o||o.length===0,w=this.buildWithCTE(e),T;f&&(T=f===!0?g` distinct`:g` distinct on (${g.join(f.on,g`, `)})`);let S=this.buildSelection(m,{isSingleTable:x}),C=this.buildFromTable(s),L=this.buildJoins(o),j=i?g` where ${i}`:void 0,R=a?g` having ${a}`:void 0,N;u&&u.length>0&&(N=g` order by ${g.join(u,g`, `)}`);let Q;c&&c.length>0&&(Q=g` group by ${g.join(c,g`, `)}`);let fe=typeof l==\"object\"||typeof l==\"number\"&&l>=0?g` limit ${l}`:void 0,_t=p?g` offset ${p}`:void 0,qe=g.empty();if(d){let ne=g` for ${g.raw(d.strength)}`;d.config.of&&ne.append(g` of ${g.join(Array.isArray(d.config.of)?d.config.of:[d.config.of],g`, `)}`),d.config.noWait?ne.append(g` no wait`):d.config.skipLocked&&ne.append(g` skip locked`),qe.append(ne)}let se=g`${w}select${T} ${S} from ${C}${L}${j}${Q}${R}${N}${fe}${_t}${qe}`;return y.length>0?this.buildSetOperations(se,y):se}buildSetOperations(e,r){let[n,...i]=r;if(!n)throw new Error(\"Cannot pass undefined values to any set operator\");return i.length===0?this.buildSetOperationQuery({leftSelect:e,setOperator:n}):this.buildSetOperations(this.buildSetOperationQuery({leftSelect:e,setOperator:n}),i)}buildSetOperationQuery({leftSelect:e,setOperator:{type:r,isAll:n,rightSelect:i,limit:a,orderBy:s,offset:o}}){let u=g`(${e.getSQL()}) `,c=g`(${i.getSQL()})`,l;if(s&&s.length>0){let y=[];for(let m of s)if(b(m,E))y.push(g.identifier(m.name));else if(b(m,O)){for(let x=0;x<m.queryChunks.length;x++){let w=m.queryChunks[x];b(w,E)&&(m.queryChunks[x]=g.identifier(w.name))}y.push(g`${m}`)}else y.push(g`${m}`);l=g` order by ${g.join(y,g`, `)} `}let p=typeof a==\"object\"||typeof a==\"number\"&&a>=0?g` limit ${a}`:void 0,d=g.raw(`${r} ${n?\"all \":\"\"}`),f=o?g` offset ${o}`:void 0;return g`${u}${d}${c}${l}${p}${f}`}buildInsertQuery({table:e,values:r,onConflict:n,returning:i,withList:a,select:s,overridingSystemValue_:o}){let u=[],c=e[A.Symbol.Columns],l=Object.entries(c).filter(([w,T])=>!T.shouldDisableInsert()),p=l.map(([,w])=>g.identifier(this.casing.getColumnCasing(w)));if(s){let w=r;b(w,O)?u.push(w):u.push(w.getSQL())}else{let w=r;u.push(g.raw(\"values \"));for(let[T,S]of w.entries()){let C=[];for(let[L,j]of l){let R=S[L];if(R===void 0||b(R,Ge)&&R.value===void 0)if(j.defaultFn!==void 0){let N=j.defaultFn(),Q=b(N,O)?N:g.param(N,j);C.push(Q)}else if(!j.default&&j.onUpdateFn!==void 0){let N=j.onUpdateFn(),Q=b(N,O)?N:g.param(N,j);C.push(Q)}else C.push(g`default`);else C.push(R)}u.push(C),T<w.length-1&&u.push(g`, `)}}let d=this.buildWithCTE(a),f=g.join(u),y=i?g` returning ${this.buildSelection(i,{isSingleTable:!0})}`:void 0,m=n?g` on conflict ${n}`:void 0,x=o===!0?g`overriding system value `:void 0;return g`${d}insert into ${e} ${p} ${x}${f}${m}${y}`}buildRefreshMaterializedViewQuery({view:e,concurrently:r,withNoData:n}){let i=r?g` concurrently`:void 0,a=n?g` with no data`:void 0;return g`refresh materialized view${i} ${e}${a}`}prepareTyping(e){return b(e,Sa)||b(e,_a)?\"json\":b(e,Ea)?\"decimal\":b(e,Ta)?\"time\":b(e,ka)||b(e,Aa)?\"timestamp\":b(e,ba)||b(e,wa)?\"date\":b(e,Ca)?\"uuid\":\"none\"}sqlToQuery(e,r){return e.toQuery({casing:this.casing,escapeName:this.escapeName,escapeParam:this.escapeParam,escapeString:this.escapeString,prepareTyping:this.prepareTyping,invokeSource:r})}buildRelationalQueryWithoutPK({fullSchema:e,schema:r,tableNamesMap:n,table:i,tableConfig:a,queryConfig:s,tableAlias:o,nestedQueryRelation:u,joinOn:c}){let l=[],p,d,f=[],y,m=[];if(s===!0)l=Object.entries(a.columns).map(([T,S])=>({dbKey:S.name,tsKey:T,field:Dt(S,o),relationTableTsKey:void 0,isJson:!1,selection:[]}));else{let w=Object.fromEntries(Object.entries(a.columns).map(([R,N])=>[R,Dt(N,o)]));if(s.where){let R=typeof s.where==\"function\"?s.where(w,F_()):s.where;y=R&&ga(R,o)}let T=[],S=[];if(s.columns){let R=!1;for(let[N,Q]of Object.entries(s.columns))Q!==void 0&&N in a.columns&&(!R&&Q===!0&&(R=!0),S.push(N));S.length>0&&(S=R?S.filter(N=>s.columns?.[N]===!0):Object.keys(a.columns).filter(N=>!S.includes(N)))}else S=Object.keys(a.columns);for(let R of S){let N=a.columns[R];T.push({tsKey:R,value:N})}let C=[];s.with&&(C=Object.entries(s.with).filter(R=>!!R[1]).map(([R,N])=>({tsKey:R,queryConfig:N,relation:a.relations[R]})));let L;if(s.extras){L=typeof s.extras==\"function\"?s.extras(w,{sql:g}):s.extras;for(let[R,N]of Object.entries(L))T.push({tsKey:R,value:pd(N,o)})}for(let{tsKey:R,value:N}of T)l.push({dbKey:b(N,O.Aliased)?N.fieldAlias:a.columns[R].name,tsKey:R,field:b(N,J)?Dt(N,o):N,relationTableTsKey:void 0,isJson:!1,selection:[]});let j=typeof s.orderBy==\"function\"?s.orderBy(w,$_()):s.orderBy??[];Array.isArray(j)||(j=[j]),f=j.map(R=>b(R,J)?Dt(R,o):ga(R,o)),p=s.limit,d=s.offset;for(let{tsKey:R,queryConfig:N,relation:Q}of C){let fe=B_(r,n,Q),_t=Hr(Q.referencedTable),qe=n[_t],se=`${o}_${R}`,ne=Pa(...fe.fields.map((Ht,qi)=>kt(Dt(fe.references[qi],se),Dt(Ht,o)))),he=this.buildRelationalQueryWithoutPK({fullSchema:e,schema:r,tableNamesMap:n,table:e[qe],tableConfig:r[qe],queryConfig:b(Q,xr)?N===!0?{limit:1}:{...N,limit:1}:N,tableAlias:se,joinOn:ne,nestedQueryRelation:Q}),et=g`${g.identifier(se)}.${g.identifier(\"data\")}`.as(R);m.push({on:g`true`,table:new ye(he.sql,{},se),alias:se,joinType:\"left\",lateral:!0}),l.push({dbKey:R,tsKey:R,field:et,relationTableTsKey:qe,isJson:!0,selection:he.selection})}}if(l.length===0)throw new xa({message:`No fields selected for table \"${a.tsName}\" (\"${o}\")`});let x;if(y=Pa(c,y),u){let w=g`json_build_array(${g.join(l.map(({field:C,tsKey:L,isJson:j})=>j?g`${g.identifier(`${o}_${L}`)}.${g.identifier(\"data\")}`:b(C,O.Aliased)?C.sql:C),g`, `)})`;b(u,Oa)&&(w=g`coalesce(json_agg(${w}${f.length>0?g` order by ${g.join(f,g`, `)}`:void 0}), '[]'::json)`);let T=[{dbKey:\"data\",tsKey:\"data\",field:w.as(\"data\"),isJson:!0,relationTableTsKey:a.tsName,selection:l}];p!==void 0||d!==void 0||f.length>0?(x=this.buildSelectQuery({table:ma(i,o),fields:{},fieldsFlat:[{path:[],field:g.raw(\"*\")}],where:y,limit:p,offset:d,orderBy:f,setOperators:[]}),y=void 0,p=void 0,d=void 0,f=[]):x=ma(i,o),x=this.buildSelectQuery({table:b(x,Te)?x:new ye(x,{},o),fields:{},fieldsFlat:T.map(({field:C})=>({path:[],field:b(C,J)?Dt(C,o):C})),joins:m,where:y,limit:p,offset:d,orderBy:f,setOperators:[]})}else x=this.buildSelectQuery({table:ma(i,o),fields:{},fieldsFlat:l.map(({field:w})=>({path:[],field:b(w,J)?Dt(w,o):w})),joins:m,where:y,limit:p,offset:d,orderBy:f,setOperators:[]});return{tableTsKey:a.tsName,sql:x,selection:l}}};var zo=class{static[h]=\"TypedQueryBuilder\";getSelectedFields(){return this._.selectedFields}};var De=class{static[h]=\"PgSelectBuilder\";fields;session;dialect;withList=[];distinct;constructor(e){this.fields=e.fields,this.session=e.session,this.dialect=e.dialect,e.withList&&(this.withList=e.withList),this.distinct=e.distinct}authToken;setToken(e){return this.authToken=e,this}from(e){let r=!!this.fields,n=e,i;return this.fields?i=this.fields:b(n,ye)?i=Object.fromEntries(Object.keys(n._.selectedFields).map(a=>[a,n[a]])):b(n,oi)?i=n[te].selectedFields:b(n,O)?i={}:i=qo(n),new Ho({table:n,fields:i,isPartialSelect:r,session:this.session,dialect:this.dialect,withList:this.withList,distinct:this.distinct}).setToken(this.authToken)}},If=class extends zo{static[h]=\"PgSelectQueryBuilder\";_;config;joinsNotNullableMap;tableName;isPartialSelect;session;dialect;constructor({table:e,fields:r,isPartialSelect:n,session:i,dialect:a,withList:s,distinct:o}){super(),this.config={withList:s,table:e,fields:{...r},distinct:o,setOperators:[]},this.isPartialSelect=n,this.session=i,this.dialect=a,this._={selectedFields:r},this.tableName=er(e),this.joinsNotNullableMap=typeof this.tableName==\"string\"?{[this.tableName]:!0}:{}}createJoin(e){return(r,n)=>{let i=this.tableName,a=er(r);if(typeof a==\"string\"&&this.config.joins?.some(s=>s.alias===a))throw new Error(`Alias \"${a}\" is already used in this query`);if(!this.isPartialSelect&&(Object.keys(this.joinsNotNullableMap).length===1&&typeof i==\"string\"&&(this.config.fields={[i]:this.config.fields}),typeof a==\"string\"&&!b(r,O))){let s=b(r,ye)?r._.selectedFields:b(r,Ue)?r[te].selectedFields:r[A.Symbol.Columns];this.config.fields[a]=s}if(typeof n==\"function\"&&(n=n(new Proxy(this.config.fields,new de({sqlAliasedBehavior:\"sql\",sqlBehavior:\"sql\"})))),this.config.joins||(this.config.joins=[]),this.config.joins.push({on:n,table:r,joinType:e,alias:a}),typeof a==\"string\")switch(e){case\"left\":{this.joinsNotNullableMap[a]=!1;break}case\"right\":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([s])=>[s,!1])),this.joinsNotNullableMap[a]=!0;break}case\"inner\":{this.joinsNotNullableMap[a]=!0;break}case\"full\":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([s])=>[s,!1])),this.joinsNotNullableMap[a]=!1;break}}return this}}leftJoin=this.createJoin(\"left\");rightJoin=this.createJoin(\"right\");innerJoin=this.createJoin(\"inner\");fullJoin=this.createJoin(\"full\");createSetOperator(e,r){return n=>{let i=typeof n==\"function\"?n(MI()):n;if(!va(this.getSelectedFields(),i.getSelectedFields()))throw new Error(\"Set operator error (union / intersect / except): selected fields are not the same or are in a different order\");return this.config.setOperators.push({type:e,isAll:r,rightSelect:i}),this}}union=this.createSetOperator(\"union\",!1);unionAll=this.createSetOperator(\"union\",!0);intersect=this.createSetOperator(\"intersect\",!1);intersectAll=this.createSetOperator(\"intersect\",!0);except=this.createSetOperator(\"except\",!1);exceptAll=this.createSetOperator(\"except\",!0);addSetOperators(e){return this.config.setOperators.push(...e),this}where(e){return typeof e==\"function\"&&(e=e(new Proxy(this.config.fields,new de({sqlAliasedBehavior:\"sql\",sqlBehavior:\"sql\"})))),this.config.where=e,this}having(e){return typeof e==\"function\"&&(e=e(new Proxy(this.config.fields,new de({sqlAliasedBehavior:\"sql\",sqlBehavior:\"sql\"})))),this.config.having=e,this}groupBy(...e){if(typeof e[0]==\"function\"){let r=e[0](new Proxy(this.config.fields,new de({sqlAliasedBehavior:\"alias\",sqlBehavior:\"sql\"})));this.config.groupBy=Array.isArray(r)?r:[r]}else this.config.groupBy=e;return this}orderBy(...e){if(typeof e[0]==\"function\"){let r=e[0](new Proxy(this.config.fields,new de({sqlAliasedBehavior:\"alias\",sqlBehavior:\"sql\"}))),n=Array.isArray(r)?r:[r];this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=n:this.config.orderBy=n}else{let r=e;this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=r:this.config.orderBy=r}return this}limit(e){return this.config.setOperators.length>0?this.config.setOperators.at(-1).limit=e:this.config.limit=e,this}offset(e){return this.config.setOperators.length>0?this.config.setOperators.at(-1).offset=e:this.config.offset=e,this}for(e,r={}){return this.config.lockingClause={strength:e,config:r},this}getSQL(){return this.dialect.buildSelectQuery(this.config)}toSQL(){let{typings:e,...r}=this.dialect.sqlToQuery(this.getSQL());return r}as(e){return new Proxy(new ye(this.getSQL(),this.config.fields,e),new de({alias:e,sqlAliasedBehavior:\"alias\",sqlBehavior:\"error\"}))}getSelectedFields(){return new Proxy(this.config.fields,new de({alias:this.tableName,sqlAliasedBehavior:\"alias\",sqlBehavior:\"error\"}))}$dynamic(){return this}},Ho=class extends If{static[h]=\"PgSelect\";_prepare(e){let{session:r,config:n,dialect:i,joinsNotNullableMap:a,authToken:s}=this;if(!r)throw new Error(\"Cannot execute a query on a query builder. Please use a database instance instead.\");return ee.startActiveSpan(\"drizzle.prepareQuery\",()=>{let o=gt(n.fields),u=r.prepareQuery(i.sqlToQuery(this.getSQL()),o,e,!0);return u.joinsNotNullableMap=a,u.setToken(s)})}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>ee.startActiveSpan(\"drizzle.operation\",()=>this._prepare().execute(e,this.authToken))};$1(Ho,[je]);function ci(t,e){return(r,n,...i)=>{let a=[n,...i].map(s=>({type:t,isAll:e,rightSelect:s}));for(let s of a)if(!va(r.getSelectedFields(),s.rightSelect.getSelectedFields()))throw new Error(\"Set operator error (union / intersect / except): selected fields are not the same or are in a different order\");return r.addSetOperators(a)}}var MI=()=>({union:FI,unionAll:$I,intersect:UI,intersectAll:BI,except:zI,exceptAll:HI}),FI=ci(\"union\",!1),$I=ci(\"union\",!0),UI=ci(\"intersect\",!1),BI=ci(\"intersect\",!0),zI=ci(\"except\",!1),HI=ci(\"except\",!0);var ui=class{static[h]=\"PgQueryBuilder\";dialect;dialectConfig;constructor(e){this.dialect=b(e,br)?e:void 0,this.dialectConfig=b(e,br)?void 0:e}$with=(e,r)=>{let n=this;return{as:a=>(typeof a==\"function\"&&(a=a(n)),new Proxy(new ni(a.getSQL(),r??(\"getSelectedFields\"in a?a.getSelectedFields()??{}:{}),e,!0),new de({alias:e,sqlAliasedBehavior:\"alias\",sqlBehavior:\"error\"})))}};with(...e){let r=this;function n(s){return new De({fields:s??void 0,session:void 0,dialect:r.getDialect(),withList:e})}function i(s){return new De({fields:s??void 0,session:void 0,dialect:r.getDialect(),distinct:!0})}function a(s,o){return new De({fields:o??void 0,session:void 0,dialect:r.getDialect(),distinct:{on:s}})}return{select:n,selectDistinct:i,selectDistinctOn:a}}select(e){return new De({fields:e??void 0,session:void 0,dialect:this.getDialect()})}selectDistinct(e){return new De({fields:e??void 0,session:void 0,dialect:this.getDialect(),distinct:!0})}selectDistinctOn(e,r){return new De({fields:r??void 0,session:void 0,dialect:this.getDialect(),distinct:{on:e}})}getDialect(){return this.dialect||(this.dialect=new br(this.dialectConfig)),this.dialect}};var Ra=class{constructor(e,r,n,i,a){this.table=e,this.session=r,this.dialect=n,this.withList=i,this.overridingSystemValue_=a}static[h]=\"PgInsertBuilder\";authToken;setToken(e){return this.authToken=e,this}overridingSystemValue(){return this.overridingSystemValue_=!0,this}values(e){if(e=Array.isArray(e)?e:[e],e.length===0)throw new Error(\"values() must be called with at least one value\");let r=e.map(n=>{let i={},a=this.table[A.Symbol.Columns];for(let s of Object.keys(n)){let o=n[s];i[s]=b(o,O)?o:new Ge(o,a[s])}return i});return new Qo(this.table,r,this.session,this.dialect,this.withList,!1,this.overridingSystemValue_).setToken(this.authToken)}select(e){let r=typeof e==\"function\"?e(new ui):e;if(!b(r,O)&&!va(this.table[Io],r._.selectedFields))throw new Error(\"Insert select error: selected fields are not the same or are in a different order compared to the table definition\");return new Qo(this.table,r,this.session,this.dialect,this.withList,!0)}},Qo=class extends je{constructor(e,r,n,i,a,s,o){super(),this.session=n,this.dialect=i,this.config={table:e,values:r,withList:a,select:s,overridingSystemValue_:o}}static[h]=\"PgInsert\";config;returning(e=this.config.table[A.Symbol.Columns]){return this.config.returningFields=e,this.config.returning=gt(e),this}onConflictDoNothing(e={}){if(e.target===void 0)this.config.onConflict=g`do nothing`;else{let r=\"\";r=Array.isArray(e.target)?e.target.map(i=>this.dialect.escapeName(this.dialect.casing.getColumnCasing(i))).join(\",\"):this.dialect.escapeName(this.dialect.casing.getColumnCasing(e.target));let n=e.where?g` where ${e.where}`:void 0;this.config.onConflict=g`(${g.raw(r)})${n} do nothing`}return this}onConflictDoUpdate(e){if(e.where&&(e.targetWhere||e.setWhere))throw new Error('You cannot use both \"where\" and \"targetWhere\"/\"setWhere\" at the same time - \"where\" is deprecated, use \"targetWhere\" or \"setWhere\" instead.');let r=e.where?g` where ${e.where}`:void 0,n=e.targetWhere?g` where ${e.targetWhere}`:void 0,i=e.setWhere?g` where ${e.setWhere}`:void 0,a=this.dialect.buildUpdateSet(this.config.table,No(this.config.table,e.set)),s=\"\";return s=Array.isArray(e.target)?e.target.map(o=>this.dialect.escapeName(this.dialect.casing.getColumnCasing(o))).join(\",\"):this.dialect.escapeName(this.dialect.casing.getColumnCasing(e.target)),this.config.onConflict=g`(${g.raw(s)})${n} do update set ${a}${r}${i}`,this}getSQL(){return this.dialect.buildInsertQuery(this.config)}toSQL(){let{typings:e,...r}=this.dialect.sqlToQuery(this.getSQL());return r}_prepare(e){return ee.startActiveSpan(\"drizzle.prepareQuery\",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,e,!0))}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>ee.startActiveSpan(\"drizzle.operation\",()=>this._prepare().execute(e,this.authToken));getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new de({alias:We(this.config.table),sqlAliasedBehavior:\"alias\",sqlBehavior:\"error\"})):void 0}$dynamic(){return this}};var Vo=class extends je{constructor(e,r,n){super(),this.session=r,this.dialect=n,this.config={view:e}}static[h]=\"PgRefreshMaterializedView\";config;concurrently(){if(this.config.withNoData!==void 0)throw new Error(\"Cannot use concurrently and withNoData together\");return this.config.concurrently=!0,this}withNoData(){if(this.config.concurrently!==void 0)throw new Error(\"Cannot use concurrently and withNoData together\");return this.config.withNoData=!0,this}getSQL(){return this.dialect.buildRefreshMaterializedViewQuery(this.config)}toSQL(){let{typings:e,...r}=this.dialect.sqlToQuery(this.getSQL());return r}_prepare(e){return ee.startActiveSpan(\"drizzle.prepareQuery\",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),void 0,e,!0))}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>ee.startActiveSpan(\"drizzle.operation\",()=>this._prepare().execute(e,this.authToken))};var Ia=class{constructor(e,r,n,i){this.table=e,this.session=r,this.dialect=n,this.withList=i}static[h]=\"PgUpdateBuilder\";authToken;setToken(e){return this.authToken=e,this}set(e){return new Nf(this.table,No(this.table,e),this.session,this.dialect,this.withList).setToken(this.authToken)}},Nf=class extends je{constructor(e,r,n,i,a){super(),this.session=n,this.dialect=i,this.config={set:r,table:e,withList:a,joins:[]},this.tableName=er(e),this.joinsNotNullableMap=typeof this.tableName==\"string\"?{[this.tableName]:!0}:{}}static[h]=\"PgUpdate\";config;tableName;joinsNotNullableMap;from(e){let r=e,n=er(r);return typeof n==\"string\"&&(this.joinsNotNullableMap[n]=!0),this.config.from=r,this}getTableLikeFields(e){return b(e,Te)?e[A.Symbol.Columns]:b(e,ye)?e._.selectedFields:e[te].selectedFields}createJoin(e){return(r,n)=>{let i=er(r);if(typeof i==\"string\"&&this.config.joins.some(a=>a.alias===i))throw new Error(`Alias \"${i}\" is already used in this query`);if(typeof n==\"function\"){let a=this.config.from&&!b(this.config.from,O)?this.getTableLikeFields(this.config.from):void 0;n=n(new Proxy(this.config.table[A.Symbol.Columns],new de({sqlAliasedBehavior:\"sql\",sqlBehavior:\"sql\"})),a&&new Proxy(a,new de({sqlAliasedBehavior:\"sql\",sqlBehavior:\"sql\"})))}if(this.config.joins.push({on:n,table:r,joinType:e,alias:i}),typeof i==\"string\")switch(e){case\"left\":{this.joinsNotNullableMap[i]=!1;break}case\"right\":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([a])=>[a,!1])),this.joinsNotNullableMap[i]=!0;break}case\"inner\":{this.joinsNotNullableMap[i]=!0;break}case\"full\":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([a])=>[a,!1])),this.joinsNotNullableMap[i]=!1;break}}return this}}leftJoin=this.createJoin(\"left\");rightJoin=this.createJoin(\"right\");innerJoin=this.createJoin(\"inner\");fullJoin=this.createJoin(\"full\");where(e){return this.config.where=e,this}returning(e){if(!e&&(e=Object.assign({},this.config.table[A.Symbol.Columns]),this.config.from)){let r=er(this.config.from);if(typeof r==\"string\"&&this.config.from&&!b(this.config.from,O)){let n=this.getTableLikeFields(this.config.from);e[r]=n}for(let n of this.config.joins){let i=er(n.table);if(typeof i==\"string\"&&!b(n.table,O)){let a=this.getTableLikeFields(n.table);e[i]=a}}}return this.config.returningFields=e,this.config.returning=gt(e),this}getSQL(){return this.dialect.buildUpdateQuery(this.config)}toSQL(){let{typings:e,...r}=this.dialect.sqlToQuery(this.getSQL());return r}_prepare(e){let r=this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,e,!0);return r.joinsNotNullableMap=this.joinsNotNullableMap,r}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>this._prepare().execute(e,this.authToken);getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new de({alias:We(this.config.table),sqlAliasedBehavior:\"alias\",sqlBehavior:\"error\"})):void 0}$dynamic(){return this}};var Ko=class t extends O{constructor(e){super(t.buildEmbeddedCount(e.source,e.filters).queryChunks),this.params=e,this.mapWith(Number),this.session=e.session,this.sql=t.buildCount(e.source,e.filters)}sql;token;static[h]=\"PgCountBuilder\";[Symbol.toStringTag]=\"PgCountBuilder\";session;static buildEmbeddedCount(e,r){return g`(select count(*) from ${e}${g.raw(\" where \").if(r)}${r})`}static buildCount(e,r){return g`select count(*) as count from ${e}${g.raw(\" where \").if(r)}${r};`}setToken(e){return this.token=e,this}then(e,r){return Promise.resolve(this.session.count(this.sql,this.token)).then(e,r)}catch(e){return this.then(void 0,e)}finally(e){return this.then(r=>(e?.(),r),r=>{throw e?.(),r})}};var Wo=class{constructor(e,r,n,i,a,s,o){this.fullSchema=e,this.schema=r,this.tableNamesMap=n,this.table=i,this.tableConfig=a,this.dialect=s,this.session=o}static[h]=\"PgRelationalQueryBuilder\";findMany(e){return new Go(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,e||{},\"many\")}findFirst(e){return new Go(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,e?{...e,limit:1}:{limit:1},\"first\")}},Go=class extends je{constructor(e,r,n,i,a,s,o,u,c){super(),this.fullSchema=e,this.schema=r,this.tableNamesMap=n,this.table=i,this.tableConfig=a,this.dialect=s,this.session=o,this.config=u,this.mode=c}static[h]=\"PgRelationalQuery\";_prepare(e){return ee.startActiveSpan(\"drizzle.prepareQuery\",()=>{let{query:r,builtQuery:n}=this._toSQL();return this.session.prepareQuery(n,void 0,e,!0,(i,a)=>{let s=i.map(o=>Bo(this.schema,this.tableConfig,o,r.selection,a));return this.mode===\"first\"?s[0]:s})})}prepare(e){return this._prepare(e)}_getQuery(){return this.dialect.buildRelationalQueryWithoutPK({fullSchema:this.fullSchema,schema:this.schema,tableNamesMap:this.tableNamesMap,table:this.table,tableConfig:this.tableConfig,queryConfig:this.config,tableAlias:this.tableConfig.tsName})}getSQL(){return this._getQuery().sql}_toSQL(){let e=this._getQuery(),r=this.dialect.sqlToQuery(e.sql);return{query:e,builtQuery:r}}toSQL(){return this._toSQL().builtQuery}authToken;setToken(e){return this.authToken=e,this}execute(){return ee.startActiveSpan(\"drizzle.operation\",()=>this._prepare().execute(void 0,this.authToken))}};var Jo=class extends je{constructor(e,r,n,i){super(),this.execute=e,this.sql=r,this.query=n,this.mapBatchResult=i}static[h]=\"PgRaw\";getSQL(){return this.sql}getQuery(){return this.query}mapResult(e,r){return r?this.mapBatchResult(e):e}_prepare(){return this}isResponseInArrayMode(){return!1}};var li=class{constructor(e,r,n){if(this.dialect=e,this.session=r,this._=n?{schema:n.schema,fullSchema:n.fullSchema,tableNamesMap:n.tableNamesMap,session:r}:{schema:void 0,fullSchema:{},tableNamesMap:{},session:r},this.query={},this._.schema)for(let[i,a]of Object.entries(this._.schema))this.query[i]=new Wo(n.fullSchema,this._.schema,this._.tableNamesMap,n.fullSchema[i],a,e,r)}static[h]=\"PgDatabase\";query;$with=(e,r)=>{let n=this;return{as:a=>(typeof a==\"function\"&&(a=a(new ui(n.dialect))),new Proxy(new ni(a.getSQL(),r??(\"getSelectedFields\"in a?a.getSelectedFields()??{}:{}),e,!0),new de({alias:e,sqlAliasedBehavior:\"alias\",sqlBehavior:\"error\"})))}};$count(e,r){return new Ko({source:e,filters:r,session:this.session})}with(...e){let r=this;function n(c){return new De({fields:c??void 0,session:r.session,dialect:r.dialect,withList:e})}function i(c){return new De({fields:c??void 0,session:r.session,dialect:r.dialect,withList:e,distinct:!0})}function a(c,l){return new De({fields:l??void 0,session:r.session,dialect:r.dialect,withList:e,distinct:{on:c}})}function s(c){return new Ia(c,r.session,r.dialect,e)}function o(c){return new Ra(c,r.session,r.dialect,e)}function u(c){return new ya(c,r.session,r.dialect,e)}return{select:n,selectDistinct:i,selectDistinctOn:a,update:s,insert:o,delete:u}}select(e){return new De({fields:e??void 0,session:this.session,dialect:this.dialect})}selectDistinct(e){return new De({fields:e??void 0,session:this.session,dialect:this.dialect,distinct:!0})}selectDistinctOn(e,r){return new De({fields:r??void 0,session:this.session,dialect:this.dialect,distinct:{on:e}})}update(e){return new Ia(e,this.session,this.dialect)}insert(e){return new Ra(e,this.session,this.dialect)}delete(e){return new ya(e,this.session,this.dialect)}refreshMaterializedView(e){return new Vo(e,this.session,this.dialect)}authToken;execute(e){let r=typeof e==\"string\"?g.raw(e):e.getSQL(),n=this.dialect.sqlToQuery(r),i=this.session.prepareQuery(n,void 0,void 0,!1);return new Jo(()=>i.execute(void 0,this.authToken),r,n,a=>i.mapResult(a,!0))}transaction(e,r){return this.session.transaction(e,r)}};var qf=class{constructor(e,r){this.unique=e,this.name=r}static[h]=\"PgIndexBuilderOn\";on(...e){return new Na(e.map(r=>{if(b(r,O))return r;r=r;let n=new ri(r.name,!!r.keyAsName,r.columnType,r.indexConfig);return r.indexConfig=JSON.parse(JSON.stringify(r.defaultConfig)),n}),this.unique,!1,this.name)}onOnly(...e){return new Na(e.map(r=>{if(b(r,O))return r;r=r;let n=new ri(r.name,!!r.keyAsName,r.columnType,r.indexConfig);return r.indexConfig=r.defaultConfig,n}),this.unique,!0,this.name)}using(e,...r){return new Na(r.map(n=>{if(b(n,O))return n;n=n;let i=new ri(n.name,!!n.keyAsName,n.columnType,n.indexConfig);return n.indexConfig=JSON.parse(JSON.stringify(n.defaultConfig)),i}),this.unique,!0,this.name,e)}},Na=class{static[h]=\"PgIndexBuilder\";config;constructor(e,r,n,i,a=\"btree\"){this.config={name:i,columns:e,unique:r,only:n,method:a}}concurrently(){return this.config.concurrently=!0,this}with(e){return this.config.with=e,this}where(e){return this.config.where=e,this}build(e){return new jf(this.config,e)}},jf=class{static[h]=\"PgIndex\";config;constructor(e,r){this.config={...e,table:r}}};function H_(t){return new qf(!1,t)}var Zo=class{constructor(e){this.query=e}authToken;getQuery(){return this.query}mapResult(e,r){return e}setToken(e){return this.authToken=e,this}static[h]=\"PgPreparedQuery\";joinsNotNullableMap},Xo=class{constructor(e){this.dialect=e}static[h]=\"PgSession\";execute(e,r){return ee.startActiveSpan(\"drizzle.operation\",()=>ee.startActiveSpan(\"drizzle.prepareQuery\",()=>this.prepareQuery(this.dialect.sqlToQuery(e),void 0,void 0,!1)).setToken(r).execute(void 0,r))}all(e){return this.prepareQuery(this.dialect.sqlToQuery(e),void 0,void 0,!1).all()}async count(e,r){let n=await this.execute(e,r);return Number(n[0].count)}},Yo=class extends li{constructor(e,r,n,i=0){super(e,r,n),this.schema=n,this.nestedIndex=i}static[h]=\"PgTransaction\";rollback(){throw new Do}getTransactionConfigSQL(e){let r=[];return e.isolationLevel&&r.push(`isolation level ${e.isolationLevel}`),e.accessMode&&r.push(e.accessMode),typeof e.deferrable==\"boolean\"&&r.push(e.deferrable?\"deferrable\":\"not deferrable\"),g.raw(r.join(\" \"))}setTransaction(e){return this.session.execute(g`set transaction ${this.getTransactionConfigSQL(e)}`)}};var{Pool:Q_,types:Mt}=yr,Df=class extends Zo{constructor(e,r,n,i,a,s,o,u){super({sql:r,params:n}),this.client=e,this.params=n,this.logger=i,this.fields=a,this._isResponseInArrayMode=o,this.customResultMapper=u,this.rawQueryConfig={name:s,text:r,types:{getTypeParser:(c,l)=>c===Mt.builtins.TIMESTAMPTZ?p=>p:c===Mt.builtins.TIMESTAMP?p=>p:c===Mt.builtins.DATE?p=>p:c===Mt.builtins.INTERVAL?p=>p:Mt.getTypeParser(c,l)}},this.queryConfig={name:s,text:r,rowMode:\"array\",types:{getTypeParser:(c,l)=>c===Mt.builtins.TIMESTAMPTZ?p=>p:c===Mt.builtins.TIMESTAMP?p=>p:c===Mt.builtins.DATE?p=>p:c===Mt.builtins.INTERVAL?p=>p:Mt.getTypeParser(c,l)}}}static[h]=\"NodePgPreparedQuery\";rawQueryConfig;queryConfig;async execute(e={}){return ee.startActiveSpan(\"drizzle.execute\",async()=>{let r=ld(this.params,e);this.logger.logQuery(this.rawQueryConfig.text,r);let{fields:n,rawQueryConfig:i,client:a,queryConfig:s,joinsNotNullableMap:o,customResultMapper:u}=this;if(!n&&!u)return ee.startActiveSpan(\"drizzle.driver.execute\",async l=>(l?.setAttributes({\"drizzle.query.name\":i.name,\"drizzle.query.text\":i.text,\"drizzle.query.params\":JSON.stringify(r)}),a.query(i,r)));let c=await ee.startActiveSpan(\"drizzle.driver.execute\",l=>(l?.setAttributes({\"drizzle.query.name\":s.name,\"drizzle.query.text\":s.text,\"drizzle.query.params\":JSON.stringify(r)}),a.query(s,r)));return ee.startActiveSpan(\"drizzle.mapResponse\",()=>u?u(c.rows):c.rows.map(l=>F1(n,l,o)))})}all(e={}){return ee.startActiveSpan(\"drizzle.execute\",()=>{let r=ld(this.params,e);return this.logger.logQuery(this.rawQueryConfig.text,r),ee.startActiveSpan(\"drizzle.driver.execute\",n=>(n?.setAttributes({\"drizzle.query.name\":this.rawQueryConfig.name,\"drizzle.query.text\":this.rawQueryConfig.text,\"drizzle.query.params\":JSON.stringify(r)}),this.client.query(this.rawQueryConfig,r).then(i=>i.rows)))})}isResponseInArrayMode(){return this._isResponseInArrayMode}},ec=class t extends Xo{constructor(e,r,n,i={}){super(r),this.client=e,this.schema=n,this.options=i,this.logger=i.logger??new Ao}static[h]=\"NodePgSession\";logger;prepareQuery(e,r,n,i,a){return new Df(this.client,e.sql,e.params,this.logger,r,n,i,a)}async transaction(e,r){let n=this.client instanceof Q_?new t(await this.client.connect(),this.dialect,this.schema,this.options):this,i=new Lf(this.dialect,n,this.schema);await i.execute(g`begin${r?g` ${i.getTransactionConfigSQL(r)}`:void 0}`);try{let a=await e(i);return await i.execute(g`commit`),a}catch(a){throw await i.execute(g`rollback`),a}finally{this.client instanceof Q_&&n.client.release()}}async count(e){let r=await this.execute(e);return Number(r.rows[0].count)}},Lf=class t extends Yo{static[h]=\"NodePgTransaction\";async transaction(e){let r=`sp${this.nestedIndex+1}`,n=new t(this.dialect,this.session,this.schema,this.nestedIndex+1);await n.execute(g.raw(`savepoint ${r}`));try{let i=await e(n);return await n.execute(g.raw(`release savepoint ${r}`)),i}catch(i){throw await n.execute(g.raw(`rollback to savepoint ${r}`)),i}}};var Mf=class{constructor(e,r,n={}){this.client=e,this.dialect=r,this.options=n}static[h]=\"NodePgDriver\";createSession(e){return new ec(this.client,this.dialect,e,{logger:this.options.logger})}},Ff=class extends li{static[h]=\"NodePgDatabase\"};function qa(t,e={}){let r=new br({casing:e.casing}),n;e.logger===!0?n=new ko:e.logger!==!1&&(n=e.logger);let i;if(e.schema){let u=U_(e.schema,z_);i={fullSchema:e.schema,schema:u.tables,tableNamesMap:u.tableNamesMap}}let s=new Mf(t,r,{logger:n}).createSession(i),o=new Ff(r,s,i);return o.$client=t,o}function tc(...t){if(typeof t[0]==\"string\"){let e=new yr.Pool({connectionString:t[0]});return qa(e,t[1])}if(B1(t[0])){let{connection:e,client:r,...n}=t[0];if(r)return qa(r,n);let i=typeof e==\"string\"?new yr.Pool({connectionString:e}):new yr.Pool(e);return qa(i,n)}return qa(t[0],t[1])}(t=>{function e(r){return qa({},r)}t.mock=e})(tc||(tc={}));var oc={};Rc(oc,{inquiries:()=>at,insertInquirySchema:()=>Hf,insertUserSchema:()=>lN,sessions:()=>uN,users:()=>Tr});var Ie={};Rc(Ie,{BRAND:()=>g9,DIRTY:()=>Vr,EMPTY_PATH:()=>WI,INVALID:()=>D,NEVER:()=>eN,OK:()=>Le,ParseStatus:()=>Re,Schema:()=>H,ZodAny:()=>Sr,ZodArray:()=>ar,ZodBigInt:()=>Wr,ZodBoolean:()=>Gr,ZodBranded:()=>Da,ZodCatch:()=>on,ZodDate:()=>Jr,ZodDefault:()=>sn,ZodDiscriminatedUnion:()=>ic,ZodEffects:()=>bt,ZodEnum:()=>nn,ZodError:()=>Ze,ZodFirstPartyTypeKind:()=>M,ZodFunction:()=>sc,ZodIntersection:()=>en,ZodIssueCode:()=>_,ZodLazy:()=>tn,ZodLiteral:()=>rn,ZodMap:()=>gi,ZodNaN:()=>yi,ZodNativeEnum:()=>an,ZodNever:()=>At,ZodNull:()=>Xr,ZodNullable:()=>Ut,ZodNumber:()=>Kr,ZodObject:()=>Xe,ZodOptional:()=>yt,ZodParsedType:()=>P,ZodPipeline:()=>La,ZodPromise:()=>Er,ZodReadonly:()=>cn,ZodRecord:()=>ac,ZodSchema:()=>H,ZodSet:()=>vi,ZodString:()=>_r,ZodSymbol:()=>hi,ZodTransformer:()=>bt,ZodTuple:()=>$t,ZodType:()=>H,ZodUndefined:()=>Zr,ZodUnion:()=>Yr,ZodUnknown:()=>ir,ZodVoid:()=>mi,addIssueToContext:()=>k,any:()=>T9,array:()=>P9,bigint:()=>b9,boolean:()=>rS,coerce:()=>Y9,custom:()=>Y_,date:()=>w9,datetimeRegex:()=>Z_,defaultErrorMap:()=>rr,discriminatedUnion:()=>N9,effect:()=>Q9,enum:()=>B9,function:()=>F9,getErrorMap:()=>pi,getParsedType:()=>Ft,instanceof:()=>y9,intersection:()=>q9,isAborted:()=>rc,isAsync:()=>di,isDirty:()=>nc,isValid:()=>wr,late:()=>v9,lazy:()=>$9,literal:()=>U9,makeIssue:()=>ja,map:()=>L9,nan:()=>x9,nativeEnum:()=>z9,never:()=>A9,null:()=>E9,nullable:()=>K9,number:()=>tS,object:()=>O9,objectUtil:()=>$f,oboolean:()=>X9,onumber:()=>Z9,optional:()=>V9,ostring:()=>J9,pipeline:()=>G9,preprocess:()=>W9,promise:()=>H9,quotelessJson:()=>QI,record:()=>D9,set:()=>M9,setErrorMap:()=>KI,strictObject:()=>R9,string:()=>eS,symbol:()=>_9,transformer:()=>Q9,tuple:()=>j9,undefined:()=>S9,union:()=>I9,unknown:()=>k9,util:()=>K,void:()=>C9});var K;(function(t){t.assertEqual=i=>{};function e(i){}t.assertIs=e;function r(i){throw new Error}t.assertNever=r,t.arrayToEnum=i=>{let a={};for(let s of i)a[s]=s;return a},t.getValidEnumValues=i=>{let a=t.objectKeys(i).filter(o=>typeof i[i[o]]!=\"number\"),s={};for(let o of a)s[o]=i[o];return t.objectValues(s)},t.objectValues=i=>t.objectKeys(i).map(function(a){return i[a]}),t.objectKeys=typeof Object.keys==\"function\"?i=>Object.keys(i):i=>{let a=[];for(let s in i)Object.prototype.hasOwnProperty.call(i,s)&&a.push(s);return a},t.find=(i,a)=>{for(let s of i)if(a(s))return s},t.isInteger=typeof Number.isInteger==\"function\"?i=>Number.isInteger(i):i=>typeof i==\"number\"&&Number.isFinite(i)&&Math.floor(i)===i;function n(i,a=\" | \"){return i.map(s=>typeof s==\"string\"?`'${s}'`:s).join(a)}t.joinValues=n,t.jsonStringifyReplacer=(i,a)=>typeof a==\"bigint\"?a.toString():a})(K||(K={}));var $f;(function(t){t.mergeShapes=(e,r)=>({...e,...r})})($f||($f={}));var P=K.arrayToEnum([\"string\",\"nan\",\"number\",\"integer\",\"float\",\"boolean\",\"date\",\"bigint\",\"symbol\",\"function\",\"undefined\",\"null\",\"array\",\"object\",\"unknown\",\"promise\",\"void\",\"never\",\"map\",\"set\"]),Ft=t=>{switch(typeof t){case\"undefined\":return P.undefined;case\"string\":return P.string;case\"number\":return Number.isNaN(t)?P.nan:P.number;case\"boolean\":return P.boolean;case\"function\":return P.function;case\"bigint\":return P.bigint;case\"symbol\":return P.symbol;case\"object\":return Array.isArray(t)?P.array:t===null?P.null:t.then&&typeof t.then==\"function\"&&t.catch&&typeof t.catch==\"function\"?P.promise:typeof Map<\"u\"&&t instanceof Map?P.map:typeof Set<\"u\"&&t instanceof Set?P.set:typeof Date<\"u\"&&t instanceof Date?P.date:P.object;default:return P.unknown}};var _=K.arrayToEnum([\"invalid_type\",\"invalid_literal\",\"custom\",\"invalid_union\",\"invalid_union_discriminator\",\"invalid_enum_value\",\"unrecognized_keys\",\"invalid_arguments\",\"invalid_return_type\",\"invalid_date\",\"invalid_string\",\"too_small\",\"too_big\",\"invalid_intersection_types\",\"not_multiple_of\",\"not_finite\"]),QI=t=>JSON.stringify(t,null,2).replace(/\"([^\"]+)\":/g,\"$1:\"),Ze=class t extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};let r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name=\"ZodError\",this.issues=e}format(e){let r=e||function(a){return a.message},n={_errors:[]},i=a=>{for(let s of a.issues)if(s.code===\"invalid_union\")s.unionErrors.map(i);else if(s.code===\"invalid_return_type\")i(s.returnTypeError);else if(s.code===\"invalid_arguments\")i(s.argumentsError);else if(s.path.length===0)n._errors.push(r(s));else{let o=n,u=0;for(;u<s.path.length;){let c=s.path[u];u===s.path.length-1?(o[c]=o[c]||{_errors:[]},o[c]._errors.push(r(s))):o[c]=o[c]||{_errors:[]},o=o[c],u++}}};return i(this),n}static assert(e){if(!(e instanceof t))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,K.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=r=>r.message){let r={},n=[];for(let i of this.issues)if(i.path.length>0){let a=i.path[0];r[a]=r[a]||[],r[a].push(e(i))}else n.push(e(i));return{formErrors:n,fieldErrors:r}}get formErrors(){return this.flatten()}};Ze.create=t=>new Ze(t);var VI=(t,e)=>{let r;switch(t.code){case _.invalid_type:t.received===P.undefined?r=\"Required\":r=`Expected ${t.expected}, received ${t.received}`;break;case _.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(t.expected,K.jsonStringifyReplacer)}`;break;case _.unrecognized_keys:r=`Unrecognized key(s) in object: ${K.joinValues(t.keys,\", \")}`;break;case _.invalid_union:r=\"Invalid input\";break;case _.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${K.joinValues(t.options)}`;break;case _.invalid_enum_value:r=`Invalid enum value. Expected ${K.joinValues(t.options)}, received '${t.received}'`;break;case _.invalid_arguments:r=\"Invalid function arguments\";break;case _.invalid_return_type:r=\"Invalid function return type\";break;case _.invalid_date:r=\"Invalid date\";break;case _.invalid_string:typeof t.validation==\"object\"?\"includes\"in t.validation?(r=`Invalid input: must include \"${t.validation.includes}\"`,typeof t.validation.position==\"number\"&&(r=`${r} at one or more positions greater than or equal to ${t.validation.position}`)):\"startsWith\"in t.validation?r=`Invalid input: must start with \"${t.validation.startsWith}\"`:\"endsWith\"in t.validation?r=`Invalid input: must end with \"${t.validation.endsWith}\"`:K.assertNever(t.validation):t.validation!==\"regex\"?r=`Invalid ${t.validation}`:r=\"Invalid\";break;case _.too_small:t.type===\"array\"?r=`Array must contain ${t.exact?\"exactly\":t.inclusive?\"at least\":\"more than\"} ${t.minimum} element(s)`:t.type===\"string\"?r=`String must contain ${t.exact?\"exactly\":t.inclusive?\"at least\":\"over\"} ${t.minimum} character(s)`:t.type===\"number\"?r=`Number must be ${t.exact?\"exactly equal to \":t.inclusive?\"greater than or equal to \":\"greater than \"}${t.minimum}`:t.type===\"bigint\"?r=`Number must be ${t.exact?\"exactly equal to \":t.inclusive?\"greater than or equal to \":\"greater than \"}${t.minimum}`:t.type===\"date\"?r=`Date must be ${t.exact?\"exactly equal to \":t.inclusive?\"greater than or equal to \":\"greater than \"}${new Date(Number(t.minimum))}`:r=\"Invalid input\";break;case _.too_big:t.type===\"array\"?r=`Array must contain ${t.exact?\"exactly\":t.inclusive?\"at most\":\"less than\"} ${t.maximum} element(s)`:t.type===\"string\"?r=`String must contain ${t.exact?\"exactly\":t.inclusive?\"at most\":\"under\"} ${t.maximum} character(s)`:t.type===\"number\"?r=`Number must be ${t.exact?\"exactly\":t.inclusive?\"less than or equal to\":\"less than\"} ${t.maximum}`:t.type===\"bigint\"?r=`BigInt must be ${t.exact?\"exactly\":t.inclusive?\"less than or equal to\":\"less than\"} ${t.maximum}`:t.type===\"date\"?r=`Date must be ${t.exact?\"exactly\":t.inclusive?\"smaller than or equal to\":\"smaller than\"} ${new Date(Number(t.maximum))}`:r=\"Invalid input\";break;case _.custom:r=\"Invalid input\";break;case _.invalid_intersection_types:r=\"Intersection results could not be merged\";break;case _.not_multiple_of:r=`Number must be a multiple of ${t.multipleOf}`;break;case _.not_finite:r=\"Number must be finite\";break;default:r=e.defaultError,K.assertNever(t)}return{message:r}},rr=VI;var V_=rr;function KI(t){V_=t}function pi(){return V_}var ja=t=>{let{data:e,path:r,errorMaps:n,issueData:i}=t,a=[...r,...i.path||[]],s={...i,path:a};if(i.message!==void 0)return{...i,path:a,message:i.message};let o=\"\",u=n.filter(c=>!!c).slice().reverse();for(let c of u)o=c(s,{data:e,defaultError:o}).message;return{...i,path:a,message:o}},WI=[];function k(t,e){let r=pi(),n=ja({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,r,r===rr?void 0:rr].filter(i=>!!i)});t.common.issues.push(n)}var Re=class t{constructor(){this.value=\"valid\"}dirty(){this.value===\"valid\"&&(this.value=\"dirty\")}abort(){this.value!==\"aborted\"&&(this.value=\"aborted\")}static mergeArray(e,r){let n=[];for(let i of r){if(i.status===\"aborted\")return D;i.status===\"dirty\"&&e.dirty(),n.push(i.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,r){let n=[];for(let i of r){let a=await i.key,s=await i.value;n.push({key:a,value:s})}return t.mergeObjectSync(e,n)}static mergeObjectSync(e,r){let n={};for(let i of r){let{key:a,value:s}=i;if(a.status===\"aborted\"||s.status===\"aborted\")return D;a.status===\"dirty\"&&e.dirty(),s.status===\"dirty\"&&e.dirty(),a.value!==\"__proto__\"&&(typeof s.value<\"u\"||i.alwaysSet)&&(n[a.value]=s.value)}return{status:e.value,value:n}}},D=Object.freeze({status:\"aborted\"}),Vr=t=>({status:\"dirty\",value:t}),Le=t=>({status:\"valid\",value:t}),rc=t=>t.status===\"aborted\",nc=t=>t.status===\"dirty\",wr=t=>t.status===\"valid\",di=t=>typeof Promise<\"u\"&&t instanceof Promise;var q;(function(t){t.errToObj=e=>typeof e==\"string\"?{message:e}:e||{},t.toString=e=>typeof e==\"string\"?e:e?.message})(q||(q={}));var xt=class{constructor(e,r,n,i){this._cachedPath=[],this.parent=e,this.data=r,this._path=n,this._key=i}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}},K_=(t,e)=>{if(wr(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error(\"Validation failed but no issues detected.\");return{success:!1,get error(){if(this._error)return this._error;let r=new Ze(t.common.issues);return this._error=r,this._error}}};function z(t){if(!t)return{};let{errorMap:e,invalid_type_error:r,required_error:n,description:i}=t;if(e&&(r||n))throw new Error(`Can't use \"invalid_type_error\" or \"required_error\" in conjunction with custom error map.`);return e?{errorMap:e,description:i}:{errorMap:(s,o)=>{let{message:u}=t;return s.code===\"invalid_enum_value\"?{message:u??o.defaultError}:typeof o.data>\"u\"?{message:u??n??o.defaultError}:s.code!==\"invalid_type\"?{message:o.defaultError}:{message:u??r??o.defaultError}},description:i}}var H=class{get description(){return this._def.description}_getType(e){return Ft(e.data)}_getOrReturnCtx(e,r){return r||{common:e.parent.common,data:e.data,parsedType:Ft(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Re,ctx:{common:e.parent.common,data:e.data,parsedType:Ft(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let r=this._parse(e);if(di(r))throw new Error(\"Synchronous parse encountered promise.\");return r}_parseAsync(e){let r=this._parse(e);return Promise.resolve(r)}parse(e,r){let n=this.safeParse(e,r);if(n.success)return n.data;throw n.error}safeParse(e,r){let n={common:{issues:[],async:r?.async??!1,contextualErrorMap:r?.errorMap},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ft(e)},i=this._parseSync({data:e,path:n.path,parent:n});return K_(n,i)}\"~validate\"(e){let r={common:{issues:[],async:!!this[\"~standard\"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ft(e)};if(!this[\"~standard\"].async)try{let n=this._parseSync({data:e,path:[],parent:r});return wr(n)?{value:n.value}:{issues:r.common.issues}}catch(n){n?.message?.toLowerCase()?.includes(\"encountered\")&&(this[\"~standard\"].async=!0),r.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:r}).then(n=>wr(n)?{value:n.value}:{issues:r.common.issues})}async parseAsync(e,r){let n=await this.safeParseAsync(e,r);if(n.success)return n.data;throw n.error}async safeParseAsync(e,r){let n={common:{issues:[],contextualErrorMap:r?.errorMap,async:!0},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ft(e)},i=this._parse({data:e,path:n.path,parent:n}),a=await(di(i)?i:Promise.resolve(i));return K_(n,a)}refine(e,r){let n=i=>typeof r==\"string\"||typeof r>\"u\"?{message:r}:typeof r==\"function\"?r(i):r;return this._refinement((i,a)=>{let s=e(i),o=()=>a.addIssue({code:_.custom,...n(i)});return typeof Promise<\"u\"&&s instanceof Promise?s.then(u=>u?!0:(o(),!1)):s?!0:(o(),!1)})}refinement(e,r){return this._refinement((n,i)=>e(n)?!0:(i.addIssue(typeof r==\"function\"?r(n,i):r),!1))}_refinement(e){return new bt({schema:this,typeName:M.ZodEffects,effect:{type:\"refinement\",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this[\"~standard\"]={version:1,vendor:\"zod\",validate:r=>this[\"~validate\"](r)}}optional(){return yt.create(this,this._def)}nullable(){return Ut.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return ar.create(this)}promise(){return Er.create(this,this._def)}or(e){return Yr.create([this,e],this._def)}and(e){return en.create(this,e,this._def)}transform(e){return new bt({...z(this._def),schema:this,typeName:M.ZodEffects,effect:{type:\"transform\",transform:e}})}default(e){let r=typeof e==\"function\"?e:()=>e;return new sn({...z(this._def),innerType:this,defaultValue:r,typeName:M.ZodDefault})}brand(){return new Da({typeName:M.ZodBranded,type:this,...z(this._def)})}catch(e){let r=typeof e==\"function\"?e:()=>e;return new on({...z(this._def),innerType:this,catchValue:r,typeName:M.ZodCatch})}describe(e){let r=this.constructor;return new r({...this._def,description:e})}pipe(e){return La.create(this,e)}readonly(){return cn.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}},GI=/^c[^\\s-]{8,}$/i,JI=/^[0-9a-z]+$/,ZI=/^[0-9A-HJKMNP-TV-Z]{26}$/i,XI=/^[0-9a-fA-F]{8}\\b-[0-9a-fA-F]{4}\\b-[0-9a-fA-F]{4}\\b-[0-9a-fA-F]{4}\\b-[0-9a-fA-F]{12}$/i,YI=/^[a-z0-9_-]{21}$/i,e9=/^[A-Za-z0-9-_]+\\.[A-Za-z0-9-_]+\\.[A-Za-z0-9-_]*$/,t9=/^[-+]?P(?!$)(?:(?:[-+]?\\d+Y)|(?:[-+]?\\d+[.,]\\d+Y$))?(?:(?:[-+]?\\d+M)|(?:[-+]?\\d+[.,]\\d+M$))?(?:(?:[-+]?\\d+W)|(?:[-+]?\\d+[.,]\\d+W$))?(?:(?:[-+]?\\d+D)|(?:[-+]?\\d+[.,]\\d+D$))?(?:T(?=[\\d+-])(?:(?:[-+]?\\d+H)|(?:[-+]?\\d+[.,]\\d+H$))?(?:(?:[-+]?\\d+M)|(?:[-+]?\\d+[.,]\\d+M$))?(?:[-+]?\\d+(?:[.,]\\d+)?S)?)??$/,r9=/^(?!\\.)(?!.*\\.\\.)([A-Z0-9_'+\\-\\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\\-]*\\.)+[A-Z]{2,}$/i,n9=\"^(\\\\p{Extended_Pictographic}|\\\\p{Emoji_Component})+$\",Uf,i9=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,a9=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\\/(3[0-2]|[12]?[0-9])$/,s9=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,o9=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,c9=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,u9=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,G_=\"((\\\\d\\\\d[2468][048]|\\\\d\\\\d[13579][26]|\\\\d\\\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\\\d|30)|(02)-(0[1-9]|1\\\\d|2[0-8])))\",l9=new RegExp(`^${G_}$`);function J_(t){let e=\"[0-5]\\\\d\";t.precision?e=`${e}\\\\.\\\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\\\.\\\\d+)?`);let r=t.precision?\"+\":\"?\";return`([01]\\\\d|2[0-3]):[0-5]\\\\d(:${e})${r}`}function p9(t){return new RegExp(`^${J_(t)}$`)}function Z_(t){let e=`${G_}T${J_(t)}`,r=[];return r.push(t.local?\"Z?\":\"Z\"),t.offset&&r.push(\"([+-]\\\\d{2}:?\\\\d{2})\"),e=`${e}(${r.join(\"|\")})`,new RegExp(`^${e}$`)}function d9(t,e){return!!((e===\"v4\"||!e)&&i9.test(t)||(e===\"v6\"||!e)&&s9.test(t))}function f9(t,e){if(!e9.test(t))return!1;try{let[r]=t.split(\".\");if(!r)return!1;let n=r.replace(/-/g,\"+\").replace(/_/g,\"/\").padEnd(r.length+(4-r.length%4)%4,\"=\"),i=JSON.parse(atob(n));return!(typeof i!=\"object\"||i===null||\"typ\"in i&&i?.typ!==\"JWT\"||!i.alg||e&&i.alg!==e)}catch{return!1}}function h9(t,e){return!!((e===\"v4\"||!e)&&a9.test(t)||(e===\"v6\"||!e)&&o9.test(t))}var _r=class t extends H{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==P.string){let a=this._getOrReturnCtx(e);return k(a,{code:_.invalid_type,expected:P.string,received:a.parsedType}),D}let n=new Re,i;for(let a of this._def.checks)if(a.kind===\"min\")e.data.length<a.value&&(i=this._getOrReturnCtx(e,i),k(i,{code:_.too_small,minimum:a.value,type:\"string\",inclusive:!0,exact:!1,message:a.message}),n.dirty());else if(a.kind===\"max\")e.data.length>a.value&&(i=this._getOrReturnCtx(e,i),k(i,{code:_.too_big,maximum:a.value,type:\"string\",inclusive:!0,exact:!1,message:a.message}),n.dirty());else if(a.kind===\"length\"){let s=e.data.length>a.value,o=e.data.length<a.value;(s||o)&&(i=this._getOrReturnCtx(e,i),s?k(i,{code:_.too_big,maximum:a.value,type:\"string\",inclusive:!0,exact:!0,message:a.message}):o&&k(i,{code:_.too_small,minimum:a.value,type:\"string\",inclusive:!0,exact:!0,message:a.message}),n.dirty())}else if(a.kind===\"email\")r9.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"email\",code:_.invalid_string,message:a.message}),n.dirty());else if(a.kind===\"emoji\")Uf||(Uf=new RegExp(n9,\"u\")),Uf.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"emoji\",code:_.invalid_string,message:a.message}),n.dirty());else if(a.kind===\"uuid\")XI.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"uuid\",code:_.invalid_string,message:a.message}),n.dirty());else if(a.kind===\"nanoid\")YI.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"nanoid\",code:_.invalid_string,message:a.message}),n.dirty());else if(a.kind===\"cuid\")GI.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"cuid\",code:_.invalid_string,message:a.message}),n.dirty());else if(a.kind===\"cuid2\")JI.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"cuid2\",code:_.invalid_string,message:a.message}),n.dirty());else if(a.kind===\"ulid\")ZI.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"ulid\",code:_.invalid_string,message:a.message}),n.dirty());else if(a.kind===\"url\")try{new URL(e.data)}catch{i=this._getOrReturnCtx(e,i),k(i,{validation:\"url\",code:_.invalid_string,message:a.message}),n.dirty()}else a.kind===\"regex\"?(a.regex.lastIndex=0,a.regex.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"regex\",code:_.invalid_string,message:a.message}),n.dirty())):a.kind===\"trim\"?e.data=e.data.trim():a.kind===\"includes\"?e.data.includes(a.value,a.position)||(i=this._getOrReturnCtx(e,i),k(i,{code:_.invalid_string,validation:{includes:a.value,position:a.position},message:a.message}),n.dirty()):a.kind===\"toLowerCase\"?e.data=e.data.toLowerCase():a.kind===\"toUpperCase\"?e.data=e.data.toUpperCase():a.kind===\"startsWith\"?e.data.startsWith(a.value)||(i=this._getOrReturnCtx(e,i),k(i,{code:_.invalid_string,validation:{startsWith:a.value},message:a.message}),n.dirty()):a.kind===\"endsWith\"?e.data.endsWith(a.value)||(i=this._getOrReturnCtx(e,i),k(i,{code:_.invalid_string,validation:{endsWith:a.value},message:a.message}),n.dirty()):a.kind===\"datetime\"?Z_(a).test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{code:_.invalid_string,validation:\"datetime\",message:a.message}),n.dirty()):a.kind===\"date\"?l9.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{code:_.invalid_string,validation:\"date\",message:a.message}),n.dirty()):a.kind===\"time\"?p9(a).test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{code:_.invalid_string,validation:\"time\",message:a.message}),n.dirty()):a.kind===\"duration\"?t9.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"duration\",code:_.invalid_string,message:a.message}),n.dirty()):a.kind===\"ip\"?d9(e.data,a.version)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"ip\",code:_.invalid_string,message:a.message}),n.dirty()):a.kind===\"jwt\"?f9(e.data,a.alg)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"jwt\",code:_.invalid_string,message:a.message}),n.dirty()):a.kind===\"cidr\"?h9(e.data,a.version)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"cidr\",code:_.invalid_string,message:a.message}),n.dirty()):a.kind===\"base64\"?c9.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"base64\",code:_.invalid_string,message:a.message}),n.dirty()):a.kind===\"base64url\"?u9.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"base64url\",code:_.invalid_string,message:a.message}),n.dirty()):K.assertNever(a);return{status:n.value,value:e.data}}_regex(e,r,n){return this.refinement(i=>e.test(i),{validation:r,code:_.invalid_string,...q.errToObj(n)})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:\"email\",...q.errToObj(e)})}url(e){return this._addCheck({kind:\"url\",...q.errToObj(e)})}emoji(e){return this._addCheck({kind:\"emoji\",...q.errToObj(e)})}uuid(e){return this._addCheck({kind:\"uuid\",...q.errToObj(e)})}nanoid(e){return this._addCheck({kind:\"nanoid\",...q.errToObj(e)})}cuid(e){return this._addCheck({kind:\"cuid\",...q.errToObj(e)})}cuid2(e){return this._addCheck({kind:\"cuid2\",...q.errToObj(e)})}ulid(e){return this._addCheck({kind:\"ulid\",...q.errToObj(e)})}base64(e){return this._addCheck({kind:\"base64\",...q.errToObj(e)})}base64url(e){return this._addCheck({kind:\"base64url\",...q.errToObj(e)})}jwt(e){return this._addCheck({kind:\"jwt\",...q.errToObj(e)})}ip(e){return this._addCheck({kind:\"ip\",...q.errToObj(e)})}cidr(e){return this._addCheck({kind:\"cidr\",...q.errToObj(e)})}datetime(e){return typeof e==\"string\"?this._addCheck({kind:\"datetime\",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:\"datetime\",precision:typeof e?.precision>\"u\"?null:e?.precision,offset:e?.offset??!1,local:e?.local??!1,...q.errToObj(e?.message)})}date(e){return this._addCheck({kind:\"date\",message:e})}time(e){return typeof e==\"string\"?this._addCheck({kind:\"time\",precision:null,message:e}):this._addCheck({kind:\"time\",precision:typeof e?.precision>\"u\"?null:e?.precision,...q.errToObj(e?.message)})}duration(e){return this._addCheck({kind:\"duration\",...q.errToObj(e)})}regex(e,r){return this._addCheck({kind:\"regex\",regex:e,...q.errToObj(r)})}includes(e,r){return this._addCheck({kind:\"includes\",value:e,position:r?.position,...q.errToObj(r?.message)})}startsWith(e,r){return this._addCheck({kind:\"startsWith\",value:e,...q.errToObj(r)})}endsWith(e,r){return this._addCheck({kind:\"endsWith\",value:e,...q.errToObj(r)})}min(e,r){return this._addCheck({kind:\"min\",value:e,...q.errToObj(r)})}max(e,r){return this._addCheck({kind:\"max\",value:e,...q.errToObj(r)})}length(e,r){return this._addCheck({kind:\"length\",value:e,...q.errToObj(r)})}nonempty(e){return this.min(1,q.errToObj(e))}trim(){return new t({...this._def,checks:[...this._def.checks,{kind:\"trim\"}]})}toLowerCase(){return new t({...this._def,checks:[...this._def.checks,{kind:\"toLowerCase\"}]})}toUpperCase(){return new t({...this._def,checks:[...this._def.checks,{kind:\"toUpperCase\"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind===\"datetime\")}get isDate(){return!!this._def.checks.find(e=>e.kind===\"date\")}get isTime(){return!!this._def.checks.find(e=>e.kind===\"time\")}get isDuration(){return!!this._def.checks.find(e=>e.kind===\"duration\")}get isEmail(){return!!this._def.checks.find(e=>e.kind===\"email\")}get isURL(){return!!this._def.checks.find(e=>e.kind===\"url\")}get isEmoji(){return!!this._def.checks.find(e=>e.kind===\"emoji\")}get isUUID(){return!!this._def.checks.find(e=>e.kind===\"uuid\")}get isNANOID(){return!!this._def.checks.find(e=>e.kind===\"nanoid\")}get isCUID(){return!!this._def.checks.find(e=>e.kind===\"cuid\")}get isCUID2(){return!!this._def.checks.find(e=>e.kind===\"cuid2\")}get isULID(){return!!this._def.checks.find(e=>e.kind===\"ulid\")}get isIP(){return!!this._def.checks.find(e=>e.kind===\"ip\")}get isCIDR(){return!!this._def.checks.find(e=>e.kind===\"cidr\")}get isBase64(){return!!this._def.checks.find(e=>e.kind===\"base64\")}get isBase64url(){return!!this._def.checks.find(e=>e.kind===\"base64url\")}get minLength(){let e=null;for(let r of this._def.checks)r.kind===\"min\"&&(e===null||r.value>e)&&(e=r.value);return e}get maxLength(){let e=null;for(let r of this._def.checks)r.kind===\"max\"&&(e===null||r.value<e)&&(e=r.value);return e}};_r.create=t=>new _r({checks:[],typeName:M.ZodString,coerce:t?.coerce??!1,...z(t)});function m9(t,e){let r=(t.toString().split(\".\")[1]||\"\").length,n=(e.toString().split(\".\")[1]||\"\").length,i=r>n?r:n,a=Number.parseInt(t.toFixed(i).replace(\".\",\"\")),s=Number.parseInt(e.toFixed(i).replace(\".\",\"\"));return a%s/10**i}var Kr=class t extends H{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==P.number){let a=this._getOrReturnCtx(e);return k(a,{code:_.invalid_type,expected:P.number,received:a.parsedType}),D}let n,i=new Re;for(let a of this._def.checks)a.kind===\"int\"?K.isInteger(e.data)||(n=this._getOrReturnCtx(e,n),k(n,{code:_.invalid_type,expected:\"integer\",received:\"float\",message:a.message}),i.dirty()):a.kind===\"min\"?(a.inclusive?e.data<a.value:e.data<=a.value)&&(n=this._getOrReturnCtx(e,n),k(n,{code:_.too_small,minimum:a.value,type:\"number\",inclusive:a.inclusive,exact:!1,message:a.message}),i.dirty()):a.kind===\"max\"?(a.inclusive?e.data>a.value:e.data>=a.value)&&(n=this._getOrReturnCtx(e,n),k(n,{code:_.too_big,maximum:a.value,type:\"number\",inclusive:a.inclusive,exact:!1,message:a.message}),i.dirty()):a.kind===\"multipleOf\"?m9(e.data,a.value)!==0&&(n=this._getOrReturnCtx(e,n),k(n,{code:_.not_multiple_of,multipleOf:a.value,message:a.message}),i.dirty()):a.kind===\"finite\"?Number.isFinite(e.data)||(n=this._getOrReturnCtx(e,n),k(n,{code:_.not_finite,message:a.message}),i.dirty()):K.assertNever(a);return{status:i.value,value:e.data}}gte(e,r){return this.setLimit(\"min\",e,!0,q.toString(r))}gt(e,r){return this.setLimit(\"min\",e,!1,q.toString(r))}lte(e,r){return this.setLimit(\"max\",e,!0,q.toString(r))}lt(e,r){return this.setLimit(\"max\",e,!1,q.toString(r))}setLimit(e,r,n,i){return new t({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:n,message:q.toString(i)}]})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:\"int\",message:q.toString(e)})}positive(e){return this._addCheck({kind:\"min\",value:0,inclusive:!1,message:q.toString(e)})}negative(e){return this._addCheck({kind:\"max\",value:0,inclusive:!1,message:q.toString(e)})}nonpositive(e){return this._addCheck({kind:\"max\",value:0,inclusive:!0,message:q.toString(e)})}nonnegative(e){return this._addCheck({kind:\"min\",value:0,inclusive:!0,message:q.toString(e)})}multipleOf(e,r){return this._addCheck({kind:\"multipleOf\",value:e,message:q.toString(r)})}finite(e){return this._addCheck({kind:\"finite\",message:q.toString(e)})}safe(e){return this._addCheck({kind:\"min\",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:q.toString(e)})._addCheck({kind:\"max\",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:q.toString(e)})}get minValue(){let e=null;for(let r of this._def.checks)r.kind===\"min\"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(let r of this._def.checks)r.kind===\"max\"&&(e===null||r.value<e)&&(e=r.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind===\"int\"||e.kind===\"multipleOf\"&&K.isInteger(e.value))}get isFinite(){let e=null,r=null;for(let n of this._def.checks){if(n.kind===\"finite\"||n.kind===\"int\"||n.kind===\"multipleOf\")return!0;n.kind===\"min\"?(r===null||n.value>r)&&(r=n.value):n.kind===\"max\"&&(e===null||n.value<e)&&(e=n.value)}return Number.isFinite(r)&&NumberThu, 29 Jan 2026 21:34:53 GMT express-session deprecated req.secret; provide secret option at node:internal/modules/cjs/loader:1706:14","attributes":{"level":"error"},"tags":{"project":"29c6c2c4-ea10-4fe6-8901-1198a13520db","environment":"9a47f9fb-0d50-4031-a85e-16db1d46fb86","service":"09a1965e-88d6-44ee-9836-14176d4bb0b5","deployment":"e78c90dd-bc00-48f5-9312-8a8fa977b2c2","replica":"68b779c1-91b1-4ca6-88f4-a907899be5f1"},"timestamp":"2026-01-29T21:34:53.259114445Z"},{"message":"/app/dist/index.cjs:71","attributes":{"level":"error"},"tags":{"project":"29c6c2c4-ea10-4fe6-8901-1198a13520db","environment":"9a47f9fb-0d50-4031-a85e-16db1d46fb86","service":"09a1965e-88d6-44ee-9836-14176d4bb0b5","deployment":"e78c90dd-bc00-48f5-9312-8a8fa977b2c2","replica":"68b779c1-91b1-4ca6-88f4-a907899be5f1"},"timestamp":"2026-01-29T21:34:53.266179084Z"},{"message":"\t\t`;await r.execute(g`CREATE SCHEMA IF NOT EXISTS ${g.identifier(a)}`),await r.execute(s);let u=(await r.all(g`select id, hash, created_at from ${g.identifier(a)}.${g.identifier(i)} order by created_at desc limit 1`))[0];await r.transaction(async c=>{for await(let l of e)if(!u||Number(u.created_at)<l.folderMillis){for(let p of l.sql)await c.execute(g.raw(p));await c.execute(g`insert into ${g.identifier(a)}.${g.identifier(i)} (\"hash\", \"created_at\") values(${l.hash}, ${l.folderMillis})`)}})}escapeName(e){return`\"${e}\"`}escapeParam(e){return`$${e+1}`}escapeString(e){return`'${e.replace(/'/g,\"''\")}'`}buildWithCTE(e){if(!e?.length)return;let r=[g`with `];for(let[n,i]of e.entries())r.push(g`${g.identifier(i._.alias)} as (${i._.sql})`),n<e.length-1&&r.push(g`, `);return r.push(g` `),g.join(r)}buildDeleteQuery({table:e,where:r,returning:n,withList:i}){let a=this.buildWithCTE(i),s=n?g` returning ${this.buildSelection(n,{isSingleTable:!0})}`:void 0,o=r?g` where ${r}`:void 0;return g`${a}delete from ${e}${o}${s}`}buildUpdateSet(e,r){let n=e[A.Symbol.Columns],i=Object.keys(n).filter(s=>r[s]!==void 0||n[s]?.onUpdateFn!==void 0),a=i.length;return g.join(i.flatMap((s,o)=>{let u=n[s],c=r[s]??g.param(u.onUpdateFn(),u),l=g`${g.identifier(this.casing.getColumnCasing(u))} = ${c}`;return o<a-1?[l,g.raw(\", \")]:[l]}))}buildUpdateQuery({table:e,set:r,where:n,returning:i,withList:a,from:s,joins:o}){let u=this.buildWithCTE(a),c=e[Te.Symbol.Name],l=e[Te.Symbol.Schema],p=e[Te.Symbol.OriginalName],d=c===p?void 0:c,f=g`${l?g`${g.identifier(l)}.`:void 0}${g.identifier(p)}${d&&g` ${g.identifier(d)}`}`,y=this.buildUpdateSet(e,r),m=s&&g.join([g.raw(\" from \"),this.buildFromTable(s)]),x=this.buildJoins(o),w=i?g` returning ${this.buildSelection(i,{isSingleTable:!s})}`:void 0,T=n?g` where ${n}`:void 0;return g`${u}update ${f} set ${y}${m}${x}${T}${w}`}buildSelection(e,{isSingleTable:r=!1}={}){let n=e.length,i=e.flatMap(({field:a},s)=>{let o=[];if(b(a,O.Aliased)&&a.isSelectionField)o.push(g.identifier(a.fieldAlias));else if(b(a,O.Aliased)||b(a,O)){let u=b(a,O.Aliased)?a.sql:a;r?o.push(new O(u.queryChunks.map(c=>b(c,E)?g.identifier(this.casing.getColumnCasing(c)):c))):o.push(u),b(a,O.Aliased)&&o.push(g` as ${g.identifier(a.fieldAlias)}`)}else b(a,J)&&(r?o.push(g.identifier(this.casing.getColumnCasing(a))):o.push(a));return s<n-1&&o.push(g`, `),o});return g.join(i)}buildJoins(e){if(!e||e.length===0)return;let r=[];for(let[n,i]of e.entries()){n===0&&r.push(g` `);let a=i.table,s=i.lateral?g` lateral`:void 0;if(b(a,Te)){let o=a[Te.Symbol.Name],u=a[Te.Symbol.Schema],c=a[Te.Symbol.OriginalName],l=o===c?void 0:i.alias;r.push(g`${g.raw(i.joinType)} join${s} ${u?g`${g.identifier(u)}.`:void 0}${g.identifier(c)}${l&&g` ${g.identifier(l)}`} on ${i.on}`)}else if(b(a,Ue)){let o=a[te].name,u=a[te].schema,c=a[te].originalName,l=o===c?void 0:i.alias;r.push(g`${g.raw(i.joinType)} join${s} ${u?g`${g.identifier(u)}.`:void 0}${g.identifier(c)}${l&&g` ${g.identifier(l)}`} on ${i.on}`)}else r.push(g`${g.raw(i.joinType)} join${s} ${a} on ${i.on}`);n<e.length-1&&r.push(g` `)}return g.join(r)}buildFromTable(e){if(b(e,A)&&e[A.Symbol.OriginalName]!==e[A.Symbol.Name]){let r=g`${g.identifier(e[A.Symbol.OriginalName])}`;return e[A.Symbol.Schema]&&(r=g`${g.identifier(e[A.Symbol.Schema])}.${r}`),g`${r} ${g.identifier(e[A.Symbol.Name])}`}return e}buildSelectQuery({withList:e,fields:r,fieldsFlat:n,where:i,having:a,table:s,joins:o,orderBy:u,groupBy:c,limit:l,offset:p,lockingClause:d,distinct:f,setOperators:y}){let m=n??gt(r);for(let ne of m)if(b(ne.field,J)&&We(ne.field.table)!==(b(s,ye)?s._.alias:b(s,oi)?s[te].name:b(s,O)?void 0:We(s))&&!(he=>o?.some(({alias:et})=>et===(he[A.Symbol.IsAlias]?We(he):he[A.Symbol.BaseName])))(ne.field.table)){let he=We(ne.field.table);throw new Error(`Your \"${ne.path.join(\"->\")}\" field references a column \"${he}\".\"${ne.field.name}\", but the table \"${he}\" is not part of the query! Did you forget to join it?`)}let x=!o||o.length===0,w=this.buildWithCTE(e),T;f&&(T=f===!0?g` distinct`:g` distinct on (${g.join(f.on,g`, `)})`);let S=this.buildSelection(m,{isSingleTable:x}),C=this.buildFromTable(s),L=this.buildJoins(o),j=i?g` where ${i}`:void 0,R=a?g` having ${a}`:void 0,N;u&&u.length>0&&(N=g` order by ${g.join(u,g`, `)}`);let Q;c&&c.length>0&&(Q=g` group by ${g.join(c,g`, `)}`);let fe=typeof l==\"object\"||typeof l==\"number\"&&l>=0?g` limit ${l}`:void 0,_t=p?g` offset ${p}`:void 0,qe=g.empty();if(d){let ne=g` for ${g.raw(d.strength)}`;d.config.of&&ne.append(g` of ${g.join(Array.isArray(d.config.of)?d.config.of:[d.config.of],g`, `)}`),d.config.noWait?ne.append(g` no wait`):d.config.skipLocked&&ne.append(g` skip locked`),qe.append(ne)}let se=g`${w}select${T} ${S} from ${C}${L}${j}${Q}${R}${N}${fe}${_t}${qe}`;return y.length>0?this.buildSetOperations(se,y):se}buildSetOperations(e,r){let[n,...i]=r;if(!n)throw new Error(\"Cannot pass undefined values to any set operator\");return i.length===0?this.buildSetOperationQuery({leftSelect:e,setOperator:n}):this.buildSetOperations(this.buildSetOperationQuery({leftSelect:e,setOperator:n}),i)}buildSetOperationQuery({leftSelect:e,setOperator:{type:r,isAll:n,rightSelect:i,limit:a,orderBy:s,offset:o}}){let u=g`(${e.getSQL()}) `,c=g`(${i.getSQL()})`,l;if(s&&s.length>0){let y=[];for(let m of s)if(b(m,E))y.push(g.identifier(m.name));else if(b(m,O)){for(let x=0;x<m.queryChunks.length;x++){let w=m.queryChunks[x];b(w,E)&&(m.queryChunks[x]=g.identifier(w.name))}y.push(g`${m}`)}else y.push(g`${m}`);l=g` order by ${g.join(y,g`, `)} `}let p=typeof a==\"object\"||typeof a==\"number\"&&a>=0?g` limit ${a}`:void 0,d=g.raw(`${r} ${n?\"all \":\"\"}`),f=o?g` offset ${o}`:void 0;return g`${u}${d}${c}${l}${p}${f}`}buildInsertQuery({table:e,values:r,onConflict:n,returning:i,withList:a,select:s,overridingSystemValue_:o}){let u=[],c=e[A.Symbol.Columns],l=Object.entries(c).filter(([w,T])=>!T.shouldDisableInsert()),p=l.map(([,w])=>g.identifier(this.casing.getColumnCasing(w)));if(s){let w=r;b(w,O)?u.push(w):u.push(w.getSQL())}else{let w=r;u.push(g.raw(\"values \"));for(let[T,S]of w.entries()){let C=[];for(let[L,j]of l){let R=S[L];if(R===void 0||b(R,Ge)&&R.value===void 0)if(j.defaultFn!==void 0){let N=j.defaultFn(),Q=b(N,O)?N:g.param(N,j);C.push(Q)}else if(!j.default&&j.onUpdateFn!==void 0){let N=j.onUpdateFn(),Q=b(N,O)?N:g.param(N,j);C.push(Q)}else C.push(g`default`);else C.push(R)}u.push(C),T<w.length-1&&u.push(g`, `)}}let d=this.buildWithCTE(a),f=g.join(u),y=i?g` returning ${this.buildSelection(i,{isSingleTable:!0})}`:void 0,m=n?g` on conflict ${n}`:void 0,x=o===!0?g`overriding system value `:void 0;return g`${d}insert into ${e} ${p} ${x}${f}${m}${y}`}buildRefreshMaterializedViewQuery({view:e,concurrently:r,withNoData:n}){let i=r?g` concurrently`:void 0,a=n?g` with no data`:void 0;return g`refresh materialized view${i} ${e}${a}`}prepareTyping(e){return b(e,Sa)||b(e,_a)?\"json\":b(e,Ea)?\"decimal\":b(e,Ta)?\"time\":b(e,ka)||b(e,Aa)?\"timestamp\":b(e,ba)||b(e,wa)?\"date\":b(e,Ca)?\"uuid\":\"none\"}sqlToQuery(e,r){return e.toQuery({casing:this.casing,escapeName:this.escapeName,escapeParam:this.escapeParam,escapeString:this.escapeString,prepareTyping:this.prepareTyping,invokeSource:r})}buildRelationalQueryWithoutPK({fullSchema:e,schema:r,tableNamesMap:n,table:i,tableConfig:a,queryConfig:s,tableAlias:o,nestedQueryRelation:u,joinOn:c}){let l=[],p,d,f=[],y,m=[];if(s===!0)l=Object.entries(a.columns).map(([T,S])=>({dbKey:S.name,tsKey:T,field:Dt(S,o),relationTableTsKey:void 0,isJson:!1,selection:[]}));else{let w=Object.fromEntries(Object.entries(a.columns).map(([R,N])=>[R,Dt(N,o)]));if(s.where){let R=typeof s.where==\"function\"?s.where(w,F_()):s.where;y=R&&ga(R,o)}let T=[],S=[];if(s.columns){let R=!1;for(let[N,Q]of Object.entries(s.columns))Q!==void 0&&N in a.columns&&(!R&&Q===!0&&(R=!0),S.push(N));S.length>0&&(S=R?S.filter(N=>s.columns?.[N]===!0):Object.keys(a.columns).filter(N=>!S.includes(N)))}else S=Object.keys(a.columns);for(let R of S){let N=a.columns[R];T.push({tsKey:R,value:N})}let C=[];s.with&&(C=Object.entries(s.with).filter(R=>!!R[1]).map(([R,N])=>({tsKey:R,queryConfig:N,relation:a.relations[R]})));let L;if(s.extras){L=typeof s.extras==\"function\"?s.extras(w,{sql:g}):s.extras;for(let[R,N]of Object.entries(L))T.push({tsKey:R,value:pd(N,o)})}for(let{tsKey:R,value:N}of T)l.push({dbKey:b(N,O.Aliased)?N.fieldAlias:a.columns[R].name,tsKey:R,field:b(N,J)?Dt(N,o):N,relationTableTsKey:void 0,isJson:!1,selection:[]});let j=typeof s.orderBy==\"function\"?s.orderBy(w,$_()):s.orderBy??[];Array.isArray(j)||(j=[j]),f=j.map(R=>b(R,J)?Dt(R,o):ga(R,o)),p=s.limit,d=s.offset;for(let{tsKey:R,queryConfig:N,relation:Q}of C){let fe=B_(r,n,Q),_t=Hr(Q.referencedTable),qe=n[_t],se=`${o}_${R}`,ne=Pa(...fe.fields.map((Ht,qi)=>kt(Dt(fe.references[qi],se),Dt(Ht,o)))),he=this.buildRelationalQueryWithoutPK({fullSchema:e,schema:r,tableNamesMap:n,table:e[qe],tableConfig:r[qe],queryConfig:b(Q,xr)?N===!0?{limit:1}:{...N,limit:1}:N,tableAlias:se,joinOn:ne,nestedQueryRelation:Q}),et=g`${g.identifier(se)}.${g.identifier(\"data\")}`.as(R);m.push({on:g`true`,table:new ye(he.sql,{},se),alias:se,joinType:\"left\",lateral:!0}),l.push({dbKey:R,tsKey:R,field:et,relationTableTsKey:qe,isJson:!0,selection:he.selection})}}if(l.length===0)throw new xa({message:`No fields selected for table \"${a.tsName}\" (\"${o}\")`});let x;if(y=Pa(c,y),u){let w=g`json_build_array(${g.join(l.map(({field:C,tsKey:L,isJson:j})=>j?g`${g.identifier(`${o}_${L}`)}.${g.identifier(\"data\")}`:b(C,O.Aliased)?C.sql:C),g`, `)})`;b(u,Oa)&&(w=g`coalesce(json_agg(${w}${f.length>0?g` order by ${g.join(f,g`, `)}`:void 0}), '[]'::json)`);let T=[{dbKey:\"data\",tsKey:\"data\",field:w.as(\"data\"),isJson:!0,relationTableTsKey:a.tsName,selection:l}];p!==void 0||d!==void 0||f.length>0?(x=this.buildSelectQuery({table:ma(i,o),fields:{},fieldsFlat:[{path:[],field:g.raw(\"*\")}],where:y,limit:p,offset:d,orderBy:f,setOperators:[]}),y=void 0,p=void 0,d=void 0,f=[]):x=ma(i,o),x=this.buildSelectQuery({table:b(x,Te)?x:new ye(x,{},o),fields:{},fieldsFlat:T.map(({field:C})=>({path:[],field:b(C,J)?Dt(C,o):C})),joins:m,where:y,limit:p,offset:d,orderBy:f,setOperators:[]})}else x=this.buildSelectQuery({table:ma(i,o),fields:{},fieldsFlat:l.map(({field:w})=>({path:[],field:b(w,J)?Dt(w,o):w})),joins:m,where:y,limit:p,offset:d,orderBy:f,setOperators:[]});return{tableTsKey:a.tsName,sql:x,selection:l}}};var zo=class{static[h]=\"TypedQueryBuilder\";getSelectedFields(){return this._.selectedFields}};var De=class{static[h]=\"PgSelectBuilder\";fields;session;dialect;withList=[];distinct;constructor(e){this.fields=e.fields,this.session=e.session,this.dialect=e.dialect,e.withList&&(this.withList=e.withList),this.distinct=e.distinct}authToken;setToken(e){return this.authToken=e,this}from(e){let r=!!this.fields,n=e,i;return this.fields?i=this.fields:b(n,ye)?i=Object.fromEntries(Object.keys(n._.selectedFields).map(a=>[a,n[a]])):b(n,oi)?i=n[te].selectedFields:b(n,O)?i={}:i=qo(n),new Ho({table:n,fields:i,isPartialSelect:r,session:this.session,dialect:this.dialect,withList:this.withList,distinct:this.distinct}).setToken(this.authToken)}},If=class extends zo{static[h]=\"PgSelectQueryBuilder\";_;config;joinsNotNullableMap;tableName;isPartialSelect;session;dialect;constructor({table:e,fields:r,isPartialSelect:n,session:i,dialect:a,withList:s,distinct:o}){super(),this.config={withList:s,table:e,fields:{...r},distinct:o,setOperators:[]},this.isPartialSelect=n,this.session=i,this.dialect=a,this._={selectedFields:r},this.tableName=er(e),this.joinsNotNullableMap=typeof this.tableName==\"string\"?{[this.tableName]:!0}:{}}createJoin(e){return(r,n)=>{let i=this.tableName,a=er(r);if(typeof a==\"string\"&&this.config.joins?.some(s=>s.alias===a))throw new Error(`Alias \"${a}\" is already used in this query`);if(!this.isPartialSelect&&(Object.keys(this.joinsNotNullableMap).length===1&&typeof i==\"string\"&&(this.config.fields={[i]:this.config.fields}),typeof a==\"string\"&&!b(r,O))){let s=b(r,ye)?r._.selectedFields:b(r,Ue)?r[te].selectedFields:r[A.Symbol.Columns];this.config.fields[a]=s}if(typeof n==\"function\"&&(n=n(new Proxy(this.config.fields,new de({sqlAliasedBehavior:\"sql\",sqlBehavior:\"sql\"})))),this.config.joins||(this.config.joins=[]),this.config.joins.push({on:n,table:r,joinType:e,alias:a}),typeof a==\"string\")switch(e){case\"left\":{this.joinsNotNullableMap[a]=!1;break}case\"right\":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([s])=>[s,!1])),this.joinsNotNullableMap[a]=!0;break}case\"inner\":{this.joinsNotNullableMap[a]=!0;break}case\"full\":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([s])=>[s,!1])),this.joinsNotNullableMap[a]=!1;break}}return this}}leftJoin=this.createJoin(\"left\");rightJoin=this.createJoin(\"right\");innerJoin=this.createJoin(\"inner\");fullJoin=this.createJoin(\"full\");createSetOperator(e,r){return n=>{let i=typeof n==\"function\"?n(MI()):n;if(!va(this.getSelectedFields(),i.getSelectedFields()))throw new Error(\"Set operator error (union / intersect / except): selected fields are not the same or are in a different order\");return this.config.setOperators.push({type:e,isAll:r,rightSelect:i}),this}}union=this.createSetOperator(\"union\",!1);unionAll=this.createSetOperator(\"union\",!0);intersect=this.createSetOperator(\"intersect\",!1);intersectAll=this.createSetOperator(\"intersect\",!0);except=this.createSetOperator(\"except\",!1);exceptAll=this.createSetOperator(\"except\",!0);addSetOperators(e){return this.config.setOperators.push(...e),this}where(e){return typeof e==\"function\"&&(e=e(new Proxy(this.config.fields,new de({sqlAliasedBehavior:\"sql\",sqlBehavior:\"sql\"})))),this.config.where=e,this}having(e){return typeof e==\"function\"&&(e=e(new Proxy(this.config.fields,new de({sqlAliasedBehavior:\"sql\",sqlBehavior:\"sql\"})))),this.config.having=e,this}groupBy(...e){if(typeof e[0]==\"function\"){let r=e[0](new Proxy(this.config.fields,new de({sqlAliasedBehavior:\"alias\",sqlBehavior:\"sql\"})));this.config.groupBy=Array.isArray(r)?r:[r]}else this.config.groupBy=e;return this}orderBy(...e){if(typeof e[0]==\"function\"){let r=e[0](new Proxy(this.config.fields,new de({sqlAliasedBehavior:\"alias\",sqlBehavior:\"sql\"}))),n=Array.isArray(r)?r:[r];this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=n:this.config.orderBy=n}else{let r=e;this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=r:this.config.orderBy=r}return this}limit(e){return this.config.setOperators.length>0?this.config.setOperators.at(-1).limit=e:this.config.limit=e,this}offset(e){return this.config.setOperators.length>0?this.config.setOperators.at(-1).offset=e:this.config.offset=e,this}for(e,r={}){return this.config.lockingClause={strength:e,config:r},this}getSQL(){return this.dialect.buildSelectQuery(this.config)}toSQL(){let{typings:e,...r}=this.dialect.sqlToQuery(this.getSQL());return r}as(e){return new Proxy(new ye(this.getSQL(),this.config.fields,e),new de({alias:e,sqlAliasedBehavior:\"alias\",sqlBehavior:\"error\"}))}getSelectedFields(){return new Proxy(this.config.fields,new de({alias:this.tableName,sqlAliasedBehavior:\"alias\",sqlBehavior:\"error\"}))}$dynamic(){return this}},Ho=class extends If{static[h]=\"PgSelect\";_prepare(e){let{session:r,config:n,dialect:i,joinsNotNullableMap:a,authToken:s}=this;if(!r)throw new Error(\"Cannot execute a query on a query builder. Please use a database instance instead.\");return ee.startActiveSpan(\"drizzle.prepareQuery\",()=>{let o=gt(n.fields),u=r.prepareQuery(i.sqlToQuery(this.getSQL()),o,e,!0);return u.joinsNotNullableMap=a,u.setToken(s)})}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>ee.startActiveSpan(\"drizzle.operation\",()=>this._prepare().execute(e,this.authToken))};$1(Ho,[je]);function ci(t,e){return(r,n,...i)=>{let a=[n,...i].map(s=>({type:t,isAll:e,rightSelect:s}));for(let s of a)if(!va(r.getSelectedFields(),s.rightSelect.getSelectedFields()))throw new Error(\"Set operator error (union / intersect / except): selected fields are not the same or are in a different order\");return r.addSetOperators(a)}}var MI=()=>({union:FI,unionAll:$I,intersect:UI,intersectAll:BI,except:zI,exceptAll:HI}),FI=ci(\"union\",!1),$I=ci(\"union\",!0),UI=ci(\"intersect\",!1),BI=ci(\"intersect\",!0),zI=ci(\"except\",!1),HI=ci(\"except\",!0);var ui=class{static[h]=\"PgQueryBuilder\";dialect;dialectConfig;constructor(e){this.dialect=b(e,br)?e:void 0,this.dialectConfig=b(e,br)?void 0:e}$with=(e,r)=>{let n=this;return{as:a=>(typeof a==\"function\"&&(a=a(n)),new Proxy(new ni(a.getSQL(),r??(\"getSelectedFields\"in a?a.getSelectedFields()??{}:{}),e,!0),new de({alias:e,sqlAliasedBehavior:\"alias\",sqlBehavior:\"error\"})))}};with(...e){let r=this;function n(s){return new De({fields:s??void 0,session:void 0,dialect:r.getDialect(),withList:e})}function i(s){return new De({fields:s??void 0,session:void 0,dialect:r.getDialect(),distinct:!0})}function a(s,o){return new De({fields:o??void 0,session:void 0,dialect:r.getDialect(),distinct:{on:s}})}return{select:n,selectDistinct:i,selectDistinctOn:a}}select(e){return new De({fields:e??void 0,session:void 0,dialect:this.getDialect()})}selectDistinct(e){return new De({fields:e??void 0,session:void 0,dialect:this.getDialect(),distinct:!0})}selectDistinctOn(e,r){return new De({fields:r??void 0,session:void 0,dialect:this.getDialect(),distinct:{on:e}})}getDialect(){return this.dialect||(this.dialect=new br(this.dialectConfig)),this.dialect}};var Ra=class{constructor(e,r,n,i,a){this.table=e,this.session=r,this.dialect=n,this.withList=i,this.overridingSystemValue_=a}static[h]=\"PgInsertBuilder\";authToken;setToken(e){return this.authToken=e,this}overridingSystemValue(){return this.overridingSystemValue_=!0,this}values(e){if(e=Array.isArray(e)?e:[e],e.length===0)throw new Error(\"values() must be called with at least one value\");let r=e.map(n=>{let i={},a=this.table[A.Symbol.Columns];for(let s of Object.keys(n)){let o=n[s];i[s]=b(o,O)?o:new Ge(o,a[s])}return i});return new Qo(this.table,r,this.session,this.dialect,this.withList,!1,this.overridingSystemValue_).setToken(this.authToken)}select(e){let r=typeof e==\"function\"?e(new ui):e;if(!b(r,O)&&!va(this.table[Io],r._.selectedFields))throw new Error(\"Insert select error: selected fields are not the same or are in a different order compared to the table definition\");return new Qo(this.table,r,this.session,this.dialect,this.withList,!0)}},Qo=class extends je{constructor(e,r,n,i,a,s,o){super(),this.session=n,this.dialect=i,this.config={table:e,values:r,withList:a,select:s,overridingSystemValue_:o}}static[h]=\"PgInsert\";config;returning(e=this.config.table[A.Symbol.Columns]){return this.config.returningFields=e,this.config.returning=gt(e),this}onConflictDoNothing(e={}){if(e.target===void 0)this.config.onConflict=g`do nothing`;else{let r=\"\";r=Array.isArray(e.target)?e.target.map(i=>this.dialect.escapeName(this.dialect.casing.getColumnCasing(i))).join(\",\"):this.dialect.escapeName(this.dialect.casing.getColumnCasing(e.target));let n=e.where?g` where ${e.where}`:void 0;this.config.onConflict=g`(${g.raw(r)})${n} do nothing`}return this}onConflictDoUpdate(e){if(e.where&&(e.targetWhere||e.setWhere))throw new Error('You cannot use both \"where\" and \"targetWhere\"/\"setWhere\" at the same time - \"where\" is deprecated, use \"targetWhere\" or \"setWhere\" instead.');let r=e.where?g` where ${e.where}`:void 0,n=e.targetWhere?g` where ${e.targetWhere}`:void 0,i=e.setWhere?g` where ${e.setWhere}`:void 0,a=this.dialect.buildUpdateSet(this.config.table,No(this.config.table,e.set)),s=\"\";return s=Array.isArray(e.target)?e.target.map(o=>this.dialect.escapeName(this.dialect.casing.getColumnCasing(o))).join(\",\"):this.dialect.escapeName(this.dialect.casing.getColumnCasing(e.target)),this.config.onConflict=g`(${g.raw(s)})${n} do update set ${a}${r}${i}`,this}getSQL(){return this.dialect.buildInsertQuery(this.config)}toSQL(){let{typings:e,...r}=this.dialect.sqlToQuery(this.getSQL());return r}_prepare(e){return ee.startActiveSpan(\"drizzle.prepareQuery\",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,e,!0))}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>ee.startActiveSpan(\"drizzle.operation\",()=>this._prepare().execute(e,this.authToken));getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new de({alias:We(this.config.table),sqlAliasedBehavior:\"alias\",sqlBehavior:\"error\"})):void 0}$dynamic(){return this}};var Vo=class extends je{constructor(e,r,n){super(),this.session=r,this.dialect=n,this.config={view:e}}static[h]=\"PgRefreshMaterializedView\";config;concurrently(){if(this.config.withNoData!==void 0)throw new Error(\"Cannot use concurrently and withNoData together\");return this.config.concurrently=!0,this}withNoData(){if(this.config.concurrently!==void 0)throw new Error(\"Cannot use concurrently and withNoData together\");return this.config.withNoData=!0,this}getSQL(){return this.dialect.buildRefreshMaterializedViewQuery(this.config)}toSQL(){let{typings:e,...r}=this.dialect.sqlToQuery(this.getSQL());return r}_prepare(e){return ee.startActiveSpan(\"drizzle.prepareQuery\",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),void 0,e,!0))}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>ee.startActiveSpan(\"drizzle.operation\",()=>this._prepare().execute(e,this.authToken))};var Ia=class{constructor(e,r,n,i){this.table=e,this.session=r,this.dialect=n,this.withList=i}static[h]=\"PgUpdateBuilder\";authToken;setToken(e){return this.authToken=e,this}set(e){return new Nf(this.table,No(this.table,e),this.session,this.dialect,this.withList).setToken(this.authToken)}},Nf=class extends je{constructor(e,r,n,i,a){super(),this.session=n,this.dialect=i,this.config={set:r,table:e,withList:a,joins:[]},this.tableName=er(e),this.joinsNotNullableMap=typeof this.tableName==\"string\"?{[this.tableName]:!0}:{}}static[h]=\"PgUpdate\";config;tableName;joinsNotNullableMap;from(e){let r=e,n=er(r);return typeof n==\"string\"&&(this.joinsNotNullableMap[n]=!0),this.config.from=r,this}getTableLikeFields(e){return b(e,Te)?e[A.Symbol.Columns]:b(e,ye)?e._.selectedFields:e[te].selectedFields}createJoin(e){return(r,n)=>{let i=er(r);if(typeof i==\"string\"&&this.config.joins.some(a=>a.alias===i))throw new Error(`Alias \"${i}\" is already used in this query`);if(typeof n==\"function\"){let a=this.config.from&&!b(this.config.from,O)?this.getTableLikeFields(this.config.from):void 0;n=n(new Proxy(this.config.table[A.Symbol.Columns],new de({sqlAliasedBehavior:\"sql\",sqlBehavior:\"sql\"})),a&&new Proxy(a,new de({sqlAliasedBehavior:\"sql\",sqlBehavior:\"sql\"})))}if(this.config.joins.push({on:n,table:r,joinType:e,alias:i}),typeof i==\"string\")switch(e){case\"left\":{this.joinsNotNullableMap[i]=!1;break}case\"right\":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([a])=>[a,!1])),this.joinsNotNullableMap[i]=!0;break}case\"inner\":{this.joinsNotNullableMap[i]=!0;break}case\"full\":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([a])=>[a,!1])),this.joinsNotNullableMap[i]=!1;break}}return this}}leftJoin=this.createJoin(\"left\");rightJoin=this.createJoin(\"right\");innerJoin=this.createJoin(\"inner\");fullJoin=this.createJoin(\"full\");where(e){return this.config.where=e,this}returning(e){if(!e&&(e=Object.assign({},this.config.table[A.Symbol.Columns]),this.config.from)){let r=er(this.config.from);if(typeof r==\"string\"&&this.config.from&&!b(this.config.from,O)){let n=this.getTableLikeFields(this.config.from);e[r]=n}for(let n of this.config.joins){let i=er(n.table);if(typeof i==\"string\"&&!b(n.table,O)){let a=this.getTableLikeFields(n.table);e[i]=a}}}return this.config.returningFields=e,this.config.returning=gt(e),this}getSQL(){return this.dialect.buildUpdateQuery(this.config)}toSQL(){let{typings:e,...r}=this.dialect.sqlToQuery(this.getSQL());return r}_prepare(e){let r=this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,e,!0);return r.joinsNotNullableMap=this.joinsNotNullableMap,r}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>this._prepare().execute(e,this.authToken);getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new de({alias:We(this.config.table),sqlAliasedBehavior:\"alias\",sqlBehavior:\"error\"})):void 0}$dynamic(){return this}};var Ko=class t extends O{constructor(e){super(t.buildEmbeddedCount(e.source,e.filters).queryChunks),this.params=e,this.mapWith(Number),this.session=e.session,this.sql=t.buildCount(e.source,e.filters)}sql;token;static[h]=\"PgCountBuilder\";[Symbol.toStringTag]=\"PgCountBuilder\";session;static buildEmbeddedCount(e,r){return g`(select count(*) from ${e}${g.raw(\" where \").if(r)}${r})`}static buildCount(e,r){return g`select count(*) as count from ${e}${g.raw(\" where \").if(r)}${r};`}setToken(e){return this.token=e,this}then(e,r){return Promise.resolve(this.session.count(this.sql,this.token)).then(e,r)}catch(e){return this.then(void 0,e)}finally(e){return this.then(r=>(e?.(),r),r=>{throw e?.(),r})}};var Wo=class{constructor(e,r,n,i,a,s,o){this.fullSchema=e,this.schema=r,this.tableNamesMap=n,this.table=i,this.tableConfig=a,this.dialect=s,this.session=o}static[h]=\"PgRelationalQueryBuilder\";findMany(e){return new Go(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,e||{},\"many\")}findFirst(e){return new Go(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,e?{...e,limit:1}:{limit:1},\"first\")}},Go=class extends je{constructor(e,r,n,i,a,s,o,u,c){super(),this.fullSchema=e,this.schema=r,this.tableNamesMap=n,this.table=i,this.tableConfig=a,this.dialect=s,this.session=o,this.config=u,this.mode=c}static[h]=\"PgRelationalQuery\";_prepare(e){return ee.startActiveSpan(\"drizzle.prepareQuery\",()=>{let{query:r,builtQuery:n}=this._toSQL();return this.session.prepareQuery(n,void 0,e,!0,(i,a)=>{let s=i.map(o=>Bo(this.schema,this.tableConfig,o,r.selection,a));return this.mode===\"first\"?s[0]:s})})}prepare(e){return this._prepare(e)}_getQuery(){return this.dialect.buildRelationalQueryWithoutPK({fullSchema:this.fullSchema,schema:this.schema,tableNamesMap:this.tableNamesMap,table:this.table,tableConfig:this.tableConfig,queryConfig:this.config,tableAlias:this.tableConfig.tsName})}getSQL(){return this._getQuery().sql}_toSQL(){let e=this._getQuery(),r=this.dialect.sqlToQuery(e.sql);return{query:e,builtQuery:r}}toSQL(){return this._toSQL().builtQuery}authToken;setToken(e){return this.authToken=e,this}execute(){return ee.startActiveSpan(\"drizzle.operation\",()=>this._prepare().execute(void 0,this.authToken))}};var Jo=class extends je{constructor(e,r,n,i){super(),this.execute=e,this.sql=r,this.query=n,this.mapBatchResult=i}static[h]=\"PgRaw\";getSQL(){return this.sql}getQuery(){return this.query}mapResult(e,r){return r?this.mapBatchResult(e):e}_prepare(){return this}isResponseInArrayMode(){return!1}};var li=class{constructor(e,r,n){if(this.dialect=e,this.session=r,this._=n?{schema:n.schema,fullSchema:n.fullSchema,tableNamesMap:n.tableNamesMap,session:r}:{schema:void 0,fullSchema:{},tableNamesMap:{},session:r},this.query={},this._.schema)for(let[i,a]of Object.entries(this._.schema))this.query[i]=new Wo(n.fullSchema,this._.schema,this._.tableNamesMap,n.fullSchema[i],a,e,r)}static[h]=\"PgDatabase\";query;$with=(e,r)=>{let n=this;return{as:a=>(typeof a==\"function\"&&(a=a(new ui(n.dialect))),new Proxy(new ni(a.getSQL(),r??(\"getSelectedFields\"in a?a.getSelectedFields()??{}:{}),e,!0),new de({alias:e,sqlAliasedBehavior:\"alias\",sqlBehavior:\"error\"})))}};$count(e,r){return new Ko({source:e,filters:r,session:this.session})}with(...e){let r=this;function n(c){return new De({fields:c??void 0,session:r.session,dialect:r.dialect,withList:e})}function i(c){return new De({fields:c??void 0,session:r.session,dialect:r.dialect,withList:e,distinct:!0})}function a(c,l){return new De({fields:l??void 0,session:r.session,dialect:r.dialect,withList:e,distinct:{on:c}})}function s(c){return new Ia(c,r.session,r.dialect,e)}function o(c){return new Ra(c,r.session,r.dialect,e)}function u(c){return new ya(c,r.session,r.dialect,e)}return{select:n,selectDistinct:i,selectDistinctOn:a,update:s,insert:o,delete:u}}select(e){return new De({fields:e??void 0,session:this.session,dialect:this.dialect})}selectDistinct(e){return new De({fields:e??void 0,session:this.session,dialect:this.dialect,distinct:!0})}selectDistinctOn(e,r){return new De({fields:r??void 0,session:this.session,dialect:this.dialect,distinct:{on:e}})}update(e){return new Ia(e,this.session,this.dialect)}insert(e){return new Ra(e,this.session,this.dialect)}delete(e){return new ya(e,this.session,this.dialect)}refreshMaterializedView(e){return new Vo(e,this.session,this.dialect)}authToken;execute(e){let r=typeof e==\"string\"?g.raw(e):e.getSQL(),n=this.dialect.sqlToQuery(r),i=this.session.prepareQuery(n,void 0,void 0,!1);return new Jo(()=>i.execute(void 0,this.authToken),r,n,a=>i.mapResult(a,!0))}transaction(e,r){return this.session.transaction(e,r)}};var qf=class{constructor(e,r){this.unique=e,this.name=r}static[h]=\"PgIndexBuilderOn\";on(...e){return new Na(e.map(r=>{if(b(r,O))return r;r=r;let n=new ri(r.name,!!r.keyAsName,r.columnType,r.indexConfig);return r.indexConfig=JSON.parse(JSON.stringify(r.defaultConfig)),n}),this.unique,!1,this.name)}onOnly(...e){return new Na(e.map(r=>{if(b(r,O))return r;r=r;let n=new ri(r.name,!!r.keyAsName,r.columnType,r.indexConfig);return r.indexConfig=r.defaultConfig,n}),this.unique,!0,this.name)}using(e,...r){return new Na(r.map(n=>{if(b(n,O))return n;n=n;let i=new ri(n.name,!!n.keyAsName,n.columnType,n.indexConfig);return n.indexConfig=JSON.parse(JSON.stringify(n.defaultConfig)),i}),this.unique,!0,this.name,e)}},Na=class{static[h]=\"PgIndexBuilder\";config;constructor(e,r,n,i,a=\"btree\"){this.config={name:i,columns:e,unique:r,only:n,method:a}}concurrently(){return this.config.concurrently=!0,this}with(e){return this.config.with=e,this}where(e){return this.config.where=e,this}build(e){return new jf(this.config,e)}},jf=class{static[h]=\"PgIndex\";config;constructor(e,r){this.config={...e,table:r}}};function H_(t){return new qf(!1,t)}var Zo=class{constructor(e){this.query=e}authToken;getQuery(){return this.query}mapResult(e,r){return e}setToken(e){return this.authToken=e,this}static[h]=\"PgPreparedQuery\";joinsNotNullableMap},Xo=class{constructor(e){this.dialect=e}static[h]=\"PgSession\";execute(e,r){return ee.startActiveSpan(\"drizzle.operation\",()=>ee.startActiveSpan(\"drizzle.prepareQuery\",()=>this.prepareQuery(this.dialect.sqlToQuery(e),void 0,void 0,!1)).setToken(r).execute(void 0,r))}all(e){return this.prepareQuery(this.dialect.sqlToQuery(e),void 0,void 0,!1).all()}async count(e,r){let n=await this.execute(e,r);return Number(n[0].count)}},Yo=class extends li{constructor(e,r,n,i=0){super(e,r,n),this.schema=n,this.nestedIndex=i}static[h]=\"PgTransaction\";rollback(){throw new Do}getTransactionConfigSQL(e){let r=[];return e.isolationLevel&&r.push(`isolation level ${e.isolationLevel}`),e.accessMode&&r.push(e.accessMode),typeof e.deferrable==\"boolean\"&&r.push(e.deferrable?\"deferrable\":\"not deferrable\"),g.raw(r.join(\" \"))}setTransaction(e){return this.session.execute(g`set transaction ${this.getTransactionConfigSQL(e)}`)}};var{Pool:Q_,types:Mt}=yr,Df=class extends Zo{constructor(e,r,n,i,a,s,o,u){super({sql:r,params:n}),this.client=e,this.params=n,this.logger=i,this.fields=a,this._isResponseInArrayMode=o,this.customResultMapper=u,this.rawQueryConfig={name:s,text:r,types:{getTypeParser:(c,l)=>c===Mt.builtins.TIMESTAMPTZ?p=>p:c===Mt.builtins.TIMESTAMP?p=>p:c===Mt.builtins.DATE?p=>p:c===Mt.builtins.INTERVAL?p=>p:Mt.getTypeParser(c,l)}},this.queryConfig={name:s,text:r,rowMode:\"array\",types:{getTypeParser:(c,l)=>c===Mt.builtins.TIMESTAMPTZ?p=>p:c===Mt.builtins.TIMESTAMP?p=>p:c===Mt.builtins.DATE?p=>p:c===Mt.builtins.INTERVAL?p=>p:Mt.getTypeParser(c,l)}}}static[h]=\"NodePgPreparedQuery\";rawQueryConfig;queryConfig;async execute(e={}){return ee.startActiveSpan(\"drizzle.execute\",async()=>{let r=ld(this.params,e);this.logger.logQuery(this.rawQueryConfig.text,r);let{fields:n,rawQueryConfig:i,client:a,queryConfig:s,joinsNotNullableMap:o,customResultMapper:u}=this;if(!n&&!u)return ee.startActiveSpan(\"drizzle.driver.execute\",async l=>(l?.setAttributes({\"drizzle.query.name\":i.name,\"drizzle.query.text\":i.text,\"drizzle.query.params\":JSON.stringify(r)}),a.query(i,r)));let c=await ee.startActiveSpan(\"drizzle.driver.execute\",l=>(l?.setAttributes({\"drizzle.query.name\":s.name,\"drizzle.query.text\":s.text,\"drizzle.query.params\":JSON.stringify(r)}),a.query(s,r)));return ee.startActiveSpan(\"drizzle.mapResponse\",()=>u?u(c.rows):c.rows.map(l=>F1(n,l,o)))})}all(e={}){return ee.startActiveSpan(\"drizzle.execute\",()=>{let r=ld(this.params,e);return this.logger.logQuery(this.rawQueryConfig.text,r),ee.startActiveSpan(\"drizzle.driver.execute\",n=>(n?.setAttributes({\"drizzle.query.name\":this.rawQueryConfig.name,\"drizzle.query.text\":this.rawQueryConfig.text,\"drizzle.query.params\":JSON.stringify(r)}),this.client.query(this.rawQueryConfig,r).then(i=>i.rows)))})}isResponseInArrayMode(){return this._isResponseInArrayMode}},ec=class t extends Xo{constructor(e,r,n,i={}){super(r),this.client=e,this.schema=n,this.options=i,this.logger=i.logger??new Ao}static[h]=\"NodePgSession\";logger;prepareQuery(e,r,n,i,a){return new Df(this.client,e.sql,e.params,this.logger,r,n,i,a)}async transaction(e,r){let n=this.client instanceof Q_?new t(await this.client.connect(),this.dialect,this.schema,this.options):this,i=new Lf(this.dialect,n,this.schema);await i.execute(g`begin${r?g` ${i.getTransactionConfigSQL(r)}`:void 0}`);try{let a=await e(i);return await i.execute(g`commit`),a}catch(a){throw await i.execute(g`rollback`),a}finally{this.client instanceof Q_&&n.client.release()}}async count(e){let r=await this.execute(e);return Number(r.rows[0].count)}},Lf=class t extends Yo{static[h]=\"NodePgTransaction\";async transaction(e){let r=`sp${this.nestedIndex+1}`,n=new t(this.dialect,this.session,this.schema,this.nestedIndex+1);await n.execute(g.raw(`savepoint ${r}`));try{let i=await e(n);return await n.execute(g.raw(`release savepoint ${r}`)),i}catch(i){throw await n.execute(g.raw(`rollback to savepoint ${r}`)),i}}};var Mf=class{constructor(e,r,n={}){this.client=e,this.dialect=r,this.options=n}static[h]=\"NodePgDriver\";createSession(e){return new ec(this.client,this.dialect,e,{logger:this.options.logger})}},Ff=class extends li{static[h]=\"NodePgDatabase\"};function qa(t,e={}){let r=new br({casing:e.casing}),n;e.logger===!0?n=new ko:e.logger!==!1&&(n=e.logger);let i;if(e.schema){let u=U_(e.schema,z_);i={fullSchema:e.schema,schema:u.tables,tableNamesMap:u.tableNamesMap}}let s=new Mf(t,r,{logger:n}).createSession(i),o=new Ff(r,s,i);return o.$client=t,o}function tc(...t){if(typeof t[0]==\"string\"){let e=new yr.Pool({connectionString:t[0]});return qa(e,t[1])}if(B1(t[0])){let{connection:e,client:r,...n}=t[0];if(r)return qa(r,n);let i=typeof e==\"string\"?new yr.Pool({connectionString:e}):new yr.Pool(e);return qa(i,n)}return qa(t[0],t[1])}(t=>{function e(r){return qa({},r)}t.mock=e})(tc||(tc={}));var oc={};Rc(oc,{inquiries:()=>at,insertInquirySchema:()=>Hf,insertUserSchema:()=>lN,sessions:()=>uN,users:()=>Tr});var Ie={};Rc(Ie,{BRAND:()=>g9,DIRTY:()=>Vr,EMPTY_PATH:()=>WI,INVALID:()=>D,NEVER:()=>eN,OK:()=>Le,ParseStatus:()=>Re,Schema:()=>H,ZodAny:()=>Sr,ZodArray:()=>ar,ZodBigInt:()=>Wr,ZodBoolean:()=>Gr,ZodBranded:()=>Da,ZodCatch:()=>on,ZodDate:()=>Jr,ZodDefault:()=>sn,ZodDiscriminatedUnion:()=>ic,ZodEffects:()=>bt,ZodEnum:()=>nn,ZodError:()=>Ze,ZodFirstPartyTypeKind:()=>M,ZodFunction:()=>sc,ZodIntersection:()=>en,ZodIssueCode:()=>_,ZodLazy:()=>tn,ZodLiteral:()=>rn,ZodMap:()=>gi,ZodNaN:()=>yi,ZodNativeEnum:()=>an,ZodNever:()=>At,ZodNull:()=>Xr,ZodNullable:()=>Ut,ZodNumber:()=>Kr,ZodObject:()=>Xe,ZodOptional:()=>yt,ZodParsedType:()=>P,ZodPipeline:()=>La,ZodPromise:()=>Er,ZodReadonly:()=>cn,ZodRecord:()=>ac,ZodSchema:()=>H,ZodSet:()=>vi,ZodString:()=>_r,ZodSymbol:()=>hi,ZodTransformer:()=>bt,ZodTuple:()=>$t,ZodType:()=>H,ZodUndefined:()=>Zr,ZodUnion:()=>Yr,ZodUnknown:()=>ir,ZodVoid:()=>mi,addIssueToContext:()=>k,any:()=>T9,array:()=>P9,bigint:()=>b9,boolean:()=>rS,coerce:()=>Y9,custom:()=>Y_,date:()=>w9,datetimeRegex:()=>Z_,defaultErrorMap:()=>rr,discriminatedUnion:()=>N9,effect:()=>Q9,enum:()=>B9,function:()=>F9,getErrorMap:()=>pi,getParsedType:()=>Ft,instanceof:()=>y9,intersection:()=>q9,isAborted:()=>rc,isAsync:()=>di,isDirty:()=>nc,isValid:()=>wr,late:()=>v9,lazy:()=>$9,literal:()=>U9,makeIssue:()=>ja,map:()=>L9,nan:()=>x9,nativeEnum:()=>z9,never:()=>A9,null:()=>E9,nullable:()=>K9,number:()=>tS,object:()=>O9,objectUtil:()=>$f,oboolean:()=>X9,onumber:()=>Z9,optional:()=>V9,ostring:()=>J9,pipeline:()=>G9,preprocess:()=>W9,promise:()=>H9,quotelessJson:()=>QI,record:()=>D9,set:()=>M9,setErrorMap:()=>KI,strictObject:()=>R9,string:()=>eS,symbol:()=>_9,transformer:()=>Q9,tuple:()=>j9,undefined:()=>S9,union:()=>I9,unknown:()=>k9,util:()=>K,void:()=>C9});var K;(function(t){t.assertEqual=i=>{};function e(i){}t.assertIs=e;function r(i){throw new Error}t.assertNever=r,t.arrayToEnum=i=>{let a={};for(let s of i)a[s]=s;return a},t.getValidEnumValues=i=>{let a=t.objectKeys(i).filter(o=>typeof i[i[o]]!=\"number\"),s={};for(let o of a)s[o]=i[o];return t.objectValues(s)},t.objectValues=i=>t.objectKeys(i).map(function(a){return i[a]}),t.objectKeys=typeof Object.keys==\"function\"?i=>Object.keys(i):i=>{let a=[];for(let s in i)Object.prototype.hasOwnProperty.call(i,s)&&a.push(s);return a},t.find=(i,a)=>{for(let s of i)if(a(s))return s},t.isInteger=typeof Number.isInteger==\"function\"?i=>Number.isInteger(i):i=>typeof i==\"number\"&&Number.isFinite(i)&&Math.floor(i)===i;function n(i,a=\" | \"){return i.map(s=>typeof s==\"string\"?`'${s}'`:s).join(a)}t.joinValues=n,t.jsonStringifyReplacer=(i,a)=>typeof a==\"bigint\"?a.toString():a})(K||(K={}));var $f;(function(t){t.mergeShapes=(e,r)=>({...e,...r})})($f||($f={}));var P=K.arrayToEnum([\"string\",\"nan\",\"number\",\"integer\",\"float\",\"boolean\",\"date\",\"bigint\",\"symbol\",\"function\",\"undefined\",\"null\",\"array\",\"object\",\"unknown\",\"promise\",\"void\",\"never\",\"map\",\"set\"]),Ft=t=>{switch(typeof t){case\"undefined\":return P.undefined;case\"string\":return P.string;case\"number\":return Number.isNaN(t)?P.nan:P.number;case\"boolean\":return P.boolean;case\"function\":return P.function;case\"bigint\":return P.bigint;case\"symbol\":return P.symbol;case\"object\":return Array.isArray(t)?P.array:t===null?P.null:t.then&&typeof t.then==\"function\"&&t.catch&&typeof t.catch==\"function\"?P.promise:typeof Map<\"u\"&&t instanceof Map?P.map:typeof Set<\"u\"&&t instanceof Set?P.set:typeof Date<\"u\"&&t instanceof Date?P.date:P.object;default:return P.unknown}};var _=K.arrayToEnum([\"invalid_type\",\"invalid_literal\",\"custom\",\"invalid_union\",\"invalid_union_discriminator\",\"invalid_enum_value\",\"unrecognized_keys\",\"invalid_arguments\",\"invalid_return_type\",\"invalid_date\",\"invalid_string\",\"too_small\",\"too_big\",\"invalid_intersection_types\",\"not_multiple_of\",\"not_finite\"]),QI=t=>JSON.stringify(t,null,2).replace(/\"([^\"]+)\":/g,\"$1:\"),Ze=class t extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};let r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name=\"ZodError\",this.issues=e}format(e){let r=e||function(a){return a.message},n={_errors:[]},i=a=>{for(let s of a.issues)if(s.code===\"invalid_union\")s.unionErrors.map(i);else if(s.code===\"invalid_return_type\")i(s.returnTypeError);else if(s.code===\"invalid_arguments\")i(s.argumentsError);else if(s.path.length===0)n._errors.push(r(s));else{let o=n,u=0;for(;u<s.path.length;){let c=s.path[u];u===s.path.length-1?(o[c]=o[c]||{_errors:[]},o[c]._errors.push(r(s))):o[c]=o[c]||{_errors:[]},o=o[c],u++}}};return i(this),n}static assert(e){if(!(e instanceof t))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,K.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=r=>r.message){let r={},n=[];for(let i of this.issues)if(i.path.length>0){let a=i.path[0];r[a]=r[a]||[],r[a].push(e(i))}else n.push(e(i));return{formErrors:n,fieldErrors:r}}get formErrors(){return this.flatten()}};Ze.create=t=>new Ze(t);var VI=(t,e)=>{let r;switch(t.code){case _.invalid_type:t.received===P.undefined?r=\"Required\":r=`Expected ${t.expected}, received ${t.received}`;break;case _.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(t.expected,K.jsonStringifyReplacer)}`;break;case _.unrecognized_keys:r=`Unrecognized key(s) in object: ${K.joinValues(t.keys,\", \")}`;break;case _.invalid_union:r=\"Invalid input\";break;case _.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${K.joinValues(t.options)}`;break;case _.invalid_enum_value:r=`Invalid enum value. Expected ${K.joinValues(t.options)}, received '${t.received}'`;break;case _.invalid_arguments:r=\"Invalid function arguments\";break;case _.invalid_return_type:r=\"Invalid function return type\";break;case _.invalid_date:r=\"Invalid date\";break;case _.invalid_string:typeof t.validation==\"object\"?\"includes\"in t.validation?(r=`Invalid input: must include \"${t.validation.includes}\"`,typeof t.validation.position==\"number\"&&(r=`${r} at one or more positions greater than or equal to ${t.validation.position}`)):\"startsWith\"in t.validation?r=`Invalid input: must start with \"${t.validation.startsWith}\"`:\"endsWith\"in t.validation?r=`Invalid input: must end with \"${t.validation.endsWith}\"`:K.assertNever(t.validation):t.validation!==\"regex\"?r=`Invalid ${t.validation}`:r=\"Invalid\";break;case _.too_small:t.type===\"array\"?r=`Array must contain ${t.exact?\"exactly\":t.inclusive?\"at least\":\"more than\"} ${t.minimum} element(s)`:t.type===\"string\"?r=`String must contain ${t.exact?\"exactly\":t.inclusive?\"at least\":\"over\"} ${t.minimum} character(s)`:t.type===\"number\"?r=`Number must be ${t.exact?\"exactly equal to \":t.inclusive?\"greater than or equal to \":\"greater than \"}${t.minimum}`:t.type===\"bigint\"?r=`Number must be ${t.exact?\"exactly equal to \":t.inclusive?\"greater than or equal to \":\"greater than \"}${t.minimum}`:t.type===\"date\"?r=`Date must be ${t.exact?\"exactly equal to \":t.inclusive?\"greater than or equal to \":\"greater than \"}${new Date(Number(t.minimum))}`:r=\"Invalid input\";break;case _.too_big:t.type===\"array\"?r=`Array must contain ${t.exact?\"exactly\":t.inclusive?\"at most\":\"less than\"} ${t.maximum} element(s)`:t.type===\"string\"?r=`String must contain ${t.exact?\"exactly\":t.inclusive?\"at most\":\"under\"} ${t.maximum} character(s)`:t.type===\"number\"?r=`Number must be ${t.exact?\"exactly\":t.inclusive?\"less than or equal to\":\"less than\"} ${t.maximum}`:t.type===\"bigint\"?r=`BigInt must be ${t.exact?\"exactly\":t.inclusive?\"less than or equal to\":\"less than\"} ${t.maximum}`:t.type===\"date\"?r=`Date must be ${t.exact?\"exactly\":t.inclusive?\"smaller than or equal to\":\"smaller than\"} ${new Date(Number(t.maximum))}`:r=\"Invalid input\";break;case _.custom:r=\"Invalid input\";break;case _.invalid_intersection_types:r=\"Intersection results could not be merged\";break;case _.not_multiple_of:r=`Number must be a multiple of ${t.multipleOf}`;break;case _.not_finite:r=\"Number must be finite\";break;default:r=e.defaultError,K.assertNever(t)}return{message:r}},rr=VI;var V_=rr;function KI(t){V_=t}function pi(){return V_}var ja=t=>{let{data:e,path:r,errorMaps:n,issueData:i}=t,a=[...r,...i.path||[]],s={...i,path:a};if(i.message!==void 0)return{...i,path:a,message:i.message};let o=\"\",u=n.filter(c=>!!c).slice().reverse();for(let c of u)o=c(s,{data:e,defaultError:o}).message;return{...i,path:a,message:o}},WI=[];function k(t,e){let r=pi(),n=ja({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,r,r===rr?void 0:rr].filter(i=>!!i)});t.common.issues.push(n)}var Re=class t{constructor(){this.value=\"valid\"}dirty(){this.value===\"valid\"&&(this.value=\"dirty\")}abort(){this.value!==\"aborted\"&&(this.value=\"aborted\")}static mergeArray(e,r){let n=[];for(let i of r){if(i.status===\"aborted\")return D;i.status===\"dirty\"&&e.dirty(),n.push(i.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,r){let n=[];for(let i of r){let a=await i.key,s=await i.value;n.push({key:a,value:s})}return t.mergeObjectSync(e,n)}static mergeObjectSync(e,r){let n={};for(let i of r){let{key:a,value:s}=i;if(a.status===\"aborted\"||s.status===\"aborted\")return D;a.status===\"dirty\"&&e.dirty(),s.status===\"dirty\"&&e.dirty(),a.value!==\"__proto__\"&&(typeof s.value<\"u\"||i.alwaysSet)&&(n[a.value]=s.value)}return{status:e.value,value:n}}},D=Object.freeze({status:\"aborted\"}),Vr=t=>({status:\"dirty\",value:t}),Le=t=>({status:\"valid\",value:t}),rc=t=>t.status===\"aborted\",nc=t=>t.status===\"dirty\",wr=t=>t.status===\"valid\",di=t=>typeof Promise<\"u\"&&t instanceof Promise;var q;(function(t){t.errToObj=e=>typeof e==\"string\"?{message:e}:e||{},t.toString=e=>typeof e==\"string\"?e:e?.message})(q||(q={}));var xt=class{constructor(e,r,n,i){this._cachedPath=[],this.parent=e,this.data=r,this._path=n,this._key=i}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}},K_=(t,e)=>{if(wr(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error(\"Validation failed but no issues detected.\");return{success:!1,get error(){if(this._error)return this._error;let r=new Ze(t.common.issues);return this._error=r,this._error}}};function z(t){if(!t)return{};let{errorMap:e,invalid_type_error:r,required_error:n,description:i}=t;if(e&&(r||n))throw new Error(`Can't use \"invalid_type_error\" or \"required_error\" in conjunction with custom error map.`);return e?{errorMap:e,description:i}:{errorMap:(s,o)=>{let{message:u}=t;return s.code===\"invalid_enum_value\"?{message:u??o.defaultError}:typeof o.data>\"u\"?{message:u??n??o.defaultError}:s.code!==\"invalid_type\"?{message:o.defaultError}:{message:u??r??o.defaultError}},description:i}}var H=class{get description(){return this._def.description}_getType(e){return Ft(e.data)}_getOrReturnCtx(e,r){return r||{common:e.parent.common,data:e.data,parsedType:Ft(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Re,ctx:{common:e.parent.common,data:e.data,parsedType:Ft(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let r=this._parse(e);if(di(r))throw new Error(\"Synchronous parse encountered promise.\");return r}_parseAsync(e){let r=this._parse(e);return Promise.resolve(r)}parse(e,r){let n=this.safeParse(e,r);if(n.success)return n.data;throw n.error}safeParse(e,r){let n={common:{issues:[],async:r?.async??!1,contextualErrorMap:r?.errorMap},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ft(e)},i=this._parseSync({data:e,path:n.path,parent:n});return K_(n,i)}\"~validate\"(e){let r={common:{issues:[],async:!!this[\"~standard\"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ft(e)};if(!this[\"~standard\"].async)try{let n=this._parseSync({data:e,path:[],parent:r});return wr(n)?{value:n.value}:{issues:r.common.issues}}catch(n){n?.message?.toLowerCase()?.includes(\"encountered\")&&(this[\"~standard\"].async=!0),r.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:r}).then(n=>wr(n)?{value:n.value}:{issues:r.common.issues})}async parseAsync(e,r){let n=await this.safeParseAsync(e,r);if(n.success)return n.data;throw n.error}async safeParseAsync(e,r){let n={common:{issues:[],contextualErrorMap:r?.errorMap,async:!0},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ft(e)},i=this._parse({data:e,path:n.path,parent:n}),a=await(di(i)?i:Promise.resolve(i));return K_(n,a)}refine(e,r){let n=i=>typeof r==\"string\"||typeof r>\"u\"?{message:r}:typeof r==\"function\"?r(i):r;return this._refinement((i,a)=>{let s=e(i),o=()=>a.addIssue({code:_.custom,...n(i)});return typeof Promise<\"u\"&&s instanceof Promise?s.then(u=>u?!0:(o(),!1)):s?!0:(o(),!1)})}refinement(e,r){return this._refinement((n,i)=>e(n)?!0:(i.addIssue(typeof r==\"function\"?r(n,i):r),!1))}_refinement(e){return new bt({schema:this,typeName:M.ZodEffects,effect:{type:\"refinement\",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this[\"~standard\"]={version:1,vendor:\"zod\",validate:r=>this[\"~validate\"](r)}}optional(){return yt.create(this,this._def)}nullable(){return Ut.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return ar.create(this)}promise(){return Er.create(this,this._def)}or(e){return Yr.create([this,e],this._def)}and(e){return en.create(this,e,this._def)}transform(e){return new bt({...z(this._def),schema:this,typeName:M.ZodEffects,effect:{type:\"transform\",transform:e}})}default(e){let r=typeof e==\"function\"?e:()=>e;return new sn({...z(this._def),innerType:this,defaultValue:r,typeName:M.ZodDefault})}brand(){return new Da({typeName:M.ZodBranded,type:this,...z(this._def)})}catch(e){let r=typeof e==\"function\"?e:()=>e;return new on({...z(this._def),innerType:this,catchValue:r,typeName:M.ZodCatch})}describe(e){let r=this.constructor;return new r({...this._def,description:e})}pipe(e){return La.create(this,e)}readonly(){return cn.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}},GI=/^c[^\\s-]{8,}$/i,JI=/^[0-9a-z]+$/,ZI=/^[0-9A-HJKMNP-TV-Z]{26}$/i,XI=/^[0-9a-fA-F]{8}\\b-[0-9a-fA-F]{4}\\b-[0-9a-fA-F]{4}\\b-[0-9a-fA-F]{4}\\b-[0-9a-fA-F]{12}$/i,YI=/^[a-z0-9_-]{21}$/i,e9=/^[A-Za-z0-9-_]+\\.[A-Za-z0-9-_]+\\.[A-Za-z0-9-_]*$/,t9=/^[-+]?P(?!$)(?:(?:[-+]?\\d+Y)|(?:[-+]?\\d+[.,]\\d+Y$))?(?:(?:[-+]?\\d+M)|(?:[-+]?\\d+[.,]\\d+M$))?(?:(?:[-+]?\\d+W)|(?:[-+]?\\d+[.,]\\d+W$))?(?:(?:[-+]?\\d+D)|(?:[-+]?\\d+[.,]\\d+D$))?(?:T(?=[\\d+-])(?:(?:[-+]?\\d+H)|(?:[-+]?\\d+[.,]\\d+H$))?(?:(?:[-+]?\\d+M)|(?:[-+]?\\d+[.,]\\d+M$))?(?:[-+]?\\d+(?:[.,]\\d+)?S)?)??$/,r9=/^(?!\\.)(?!.*\\.\\.)([A-Z0-9_'+\\-\\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\\-]*\\.)+[A-Z]{2,}$/i,n9=\"^(\\\\p{Extended_Pictographic}|\\\\p{Emoji_Component})+$\",Uf,i9=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,a9=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\\/(3[0-2]|[12]?[0-9])$/,s9=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,o9=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,c9=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,u9=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,G_=\"((\\\\d\\\\d[2468][048]|\\\\d\\\\d[13579][26]|\\\\d\\\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\\\d|30)|(02)-(0[1-9]|1\\\\d|2[0-8])))\",l9=new RegExp(`^${G_}$`);function J_(t){let e=\"[0-5]\\\\d\";t.precision?e=`${e}\\\\.\\\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\\\.\\\\d+)?`);let r=t.precision?\"+\":\"?\";return`([01]\\\\d|2[0-3]):[0-5]\\\\d(:${e})${r}`}function p9(t){return new RegExp(`^${J_(t)}$`)}function Z_(t){let e=`${G_}T${J_(t)}`,r=[];return r.push(t.local?\"Z?\":\"Z\"),t.offset&&r.push(\"([+-]\\\\d{2}:?\\\\d{2})\"),e=`${e}(${r.join(\"|\")})`,new RegExp(`^${e}$`)}function d9(t,e){return!!((e===\"v4\"||!e)&&i9.test(t)||(e===\"v6\"||!e)&&s9.test(t))}function f9(t,e){if(!e9.test(t))return!1;try{let[r]=t.split(\".\");if(!r)return!1;let n=r.replace(/-/g,\"+\").replace(/_/g,\"/\").padEnd(r.length+(4-r.length%4)%4,\"=\"),i=JSON.parse(atob(n));return!(typeof i!=\"object\"||i===null||\"typ\"in i&&i?.typ!==\"JWT\"||!i.alg||e&&i.alg!==e)}catch{return!1}}function h9(t,e){return!!((e===\"v4\"||!e)&&a9.test(t)||(e===\"v6\"||!e)&&o9.test(t))}var _r=class t extends H{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==P.string){let a=this._getOrReturnCtx(e);return k(a,{code:_.invalid_type,expected:P.string,received:a.parsedType}),D}let n=new Re,i;for(let a of this._def.checks)if(a.kind===\"min\")e.data.length<a.value&&(i=this._getOrReturnCtx(e,i),k(i,{code:_.too_small,minimum:a.value,type:\"string\",inclusive:!0,exact:!1,message:a.message}),n.dirty());else if(a.kind===\"max\")e.data.length>a.value&&(i=this._getOrReturnCtx(e,i),k(i,{code:_.too_big,maximum:a.value,type:\"string\",inclusive:!0,exact:!1,message:a.message}),n.dirty());else if(a.kind===\"length\"){let s=e.data.length>a.value,o=e.data.length<a.value;(s||o)&&(i=this._getOrReturnCtx(e,i),s?k(i,{code:_.too_big,maximum:a.value,type:\"string\",inclusive:!0,exact:!0,message:a.message}):o&&k(i,{code:_.too_small,minimum:a.value,type:\"string\",inclusive:!0,exact:!0,message:a.message}),n.dirty())}else if(a.kind===\"email\")r9.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"email\",code:_.invalid_string,message:a.message}),n.dirty());else if(a.kind===\"emoji\")Uf||(Uf=new RegExp(n9,\"u\")),Uf.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"emoji\",code:_.invalid_string,message:a.message}),n.dirty());else if(a.kind===\"uuid\")XI.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"uuid\",code:_.invalid_string,message:a.message}),n.dirty());else if(a.kind===\"nanoid\")YI.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"nanoid\",code:_.invalid_string,message:a.message}),n.dirty());else if(a.kind===\"cuid\")GI.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"cuid\",code:_.invalid_string,message:a.message}),n.dirty());else if(a.kind===\"cuid2\")JI.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"cuid2\",code:_.invalid_string,message:a.message}),n.dirty());else if(a.kind===\"ulid\")ZI.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"ulid\",code:_.invalid_string,message:a.message}),n.dirty());else if(a.kind===\"url\")try{new URL(e.data)}catch{i=this._getOrReturnCtx(e,i),k(i,{validation:\"url\",code:_.invalid_string,message:a.message}),n.dirty()}else a.kind===\"regex\"?(a.regex.lastIndex=0,a.regex.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"regex\",code:_.invalid_string,message:a.message}),n.dirty())):a.kind===\"trim\"?e.data=e.data.trim():a.kind===\"includes\"?e.data.includes(a.value,a.position)||(i=this._getOrReturnCtx(e,i),k(i,{code:_.invalid_string,validation:{includes:a.value,position:a.position},message:a.message}),n.dirty()):a.kind===\"toLowerCase\"?e.data=e.data.toLowerCase():a.kind===\"toUpperCase\"?e.data=e.data.toUpperCase():a.kind===\"startsWith\"?e.data.startsWith(a.value)||(i=this._getOrReturnCtx(e,i),k(i,{code:_.invalid_string,validation:{startsWith:a.value},message:a.message}),n.dirty()):a.kind===\"endsWith\"?e.data.endsWith(a.value)||(i=this._getOrReturnCtx(e,i),k(i,{code:_.invalid_string,validation:{endsWith:a.value},message:a.message}),n.dirty()):a.kind===\"datetime\"?Z_(a).test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{code:_.invalid_string,validation:\"datetime\",message:a.message}),n.dirty()):a.kind===\"date\"?l9.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{code:_.invalid_string,validation:\"date\",message:a.message}),n.dirty()):a.kind===\"time\"?p9(a).test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{code:_.invalid_string,validation:\"time\",message:a.message}),n.dirty()):a.kind===\"duration\"?t9.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"duration\",code:_.invalid_string,message:a.message}),n.dirty()):a.kind===\"ip\"?d9(e.data,a.version)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"ip\",code:_.invalid_string,message:a.message}),n.dirty()):a.kind===\"jwt\"?f9(e.data,a.alg)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"jwt\",code:_.invalid_string,message:a.message}),n.dirty()):a.kind===\"cidr\"?h9(e.data,a.version)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"cidr\",code:_.invalid_string,message:a.message}),n.dirty()):a.kind===\"base64\"?c9.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"base64\",code:_.invalid_string,message:a.message}),n.dirty()):a.kind===\"base64url\"?u9.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"base64url\",code:_.invalid_string,message:a.message}),n.dirty()):K.assertNever(a);return{status:n.value,value:e.data}}_regex(e,r,n){return this.refinement(i=>e.test(i),{validation:r,code:_.invalid_string,...q.errToObj(n)})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:\"email\",...q.errToObj(e)})}url(e){return this._addCheck({kind:\"url\",...q.errToObj(e)})}emoji(e){return this._addCheck({kind:\"emoji\",...q.errToObj(e)})}uuid(e){return this._addCheck({kind:\"uuid\",...q.errToObj(e)})}nanoid(e){return this._addCheck({kind:\"nanoid\",...q.errToObj(e)})}cuid(e){return this._addCheck({kind:\"cuid\",...q.errToObj(e)})}cuid2(e){return this._addCheck({kind:\"cuid2\",...q.errToObj(e)})}ulid(e){return this._addCheck({kind:\"ulid\",...q.errToObj(e)})}base64(e){return this._addCheck({kind:\"base64\",...q.errToObj(e)})}base64url(e){return this._addCheck({kind:\"base64url\",...q.errToObj(e)})}jwt(e){return this._addCheck({kind:\"jwt\",...q.errToObj(e)})}ip(e){return this._addCheck({kind:\"ip\",...q.errToObj(e)})}cidr(e){return this._addCheck({kind:\"cidr\",...q.errToObj(e)})}datetime(e){return typeof e==\"string\"?this._addCheck({kind:\"datetime\",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:\"datetime\",precision:typeof e?.precision>\"u\"?null:e?.precision,offset:e?.offset??!1,local:e?.local??!1,...q.errToObj(e?.message)})}date(e){return this._addCheck({kind:\"date\",message:e})}time(e){return typeof e==\"string\"?this._addCheck({kind:\"time\",precision:null,message:e}):this._addCheck({kind:\"time\",precision:typeof e?.precision>\"u\"?null:e?.precision,...q.errToObj(e?.message)})}duration(e){return this._addCheck({kind:\"duration\",...q.errToObj(e)})}regex(e,r){return this._addCheck({kind:\"regex\",regex:e,...q.errToObj(r)})}includes(e,r){return this._addCheck({kind:\"includes\",value:e,position:r?.position,...q.errToObj(r?.message)})}startsWith(e,r){return this._addCheck({kind:\"startsWith\",value:e,...q.errToObj(r)})}endsWith(e,r){return this._addCheck({kind:\"endsWith\",value:e,...q.errToObj(r)})}min(e,r){return this._addCheck({kind:\"min\",value:e,...q.errToObj(r)})}max(e,r){return this._addCheck({kind:\"max\",value:e,...q.errToObj(r)})}length(e,r){return this._addCheck({kind:\"length\",value:e,...q.errToObj(r)})}nonempty(e){return this.min(1,q.errToObj(e))}trim(){return new t({...this._def,checks:[...this._def.checks,{kind:\"trim\"}]})}toLowerCase(){return new t({...this._def,checks:[...this._def.checks,{kind:\"toLowerCase\"}]})}toUpperCase(){return new t({...this._def,checks:[...this._def.checks,{kind:\"toUpperCase\"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind===\"datetime\")}get isDate(){return!!this._def.checks.find(e=>e.kind===\"date\")}get isTime(){return!!this._def.checks.find(e=>e.kind===\"time\")}get isDuration(){return!!this._def.checks.find(e=>e.kind===\"duration\")}get isEmail(){return!!this._def.checks.find(e=>e.kind===\"email\")}get isURL(){return!!this._def.checks.find(e=>e.kind===\"url\")}get isEmoji(){return!!this._def.checks.find(e=>e.kind===\"emoji\")}get isUUID(){return!!this._def.checks.find(e=>e.kind===\"uuid\")}get isNANOID(){return!!this._def.checks.find(e=>e.kind===\"nanoid\")}get isCUID(){return!!this._def.checks.find(e=>e.kind===\"cuid\")}get isCUID2(){return!!this._def.checks.find(e=>e.kind===\"cuid2\")}get isULID(){return!!this._def.checks.find(e=>e.kind===\"ulid\")}get isIP(){return!!this._def.checks.find(e=>e.kind===\"ip\")}get isCIDR(){return!!this._def.checks.find(e=>e.kind===\"cidr\")}get isBase64(){return!!this._def.checks.find(e=>e.kind===\"base64\")}get isBase64url(){return!!this._def.checks.find(e=>e.kind===\"base64url\")}get minLength(){let e=null;for(let r of this._def.checks)r.kind===\"min\"&&(e===null||r.value>e)&&(e=r.value);return e}get maxLength(){let e=null;for(let r of this._def.checks)r.kind===\"max\"&&(e===null||r.value<e)&&(e=r.value);return e}};_r.create=t=>new _r({checks:[],typeName:M.ZodString,coerce:t?.coerce??!1,...z(t)});function m9(t,e){let r=(t.toString().split(\".\")[1]||\"\").length,n=(e.toString().split(\".\")[1]||\"\").length,i=r>n?r:n,a=Number.parseInt(t.toFixed(i).replace(\".\",\"\")),s=Number.parseInt(e.toFixed(i).replace(\".\",\"\"));return a%s/10**i}var Kr=class t extends H{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==P.number){let a=this._getOrReturnCtx(e);return k(a,{code:_.invalid_type,expected:P.number,received:a.parsedType}),D}let n,i=new Re;for(let a of this._def.checks)a.kind===\"int\"?K.isInteger(e.data)||(n=this._getOrReturnCtx(e,n),k(n,{code:_.invalid_type,expected:\"integer\",received:\"float\",message:a.message}),i.dirty()):a.kind===\"min\"?(a.inclusive?e.data<a.value:e.data<=a.value)&&(n=this._getOrReturnCtx(e,n),k(n,{code:_.too_small,minimum:a.value,type:\"number\",inclusive:a.inclusive,exact:!1,message:a.message}),i.dirty()):a.kind===\"max\"?(a.inclusive?e.data>a.value:e.data>=a.value)&&(n=this._getOrReturnCtx(e,n),k(n,{code:_.too_big,maximum:a.value,type:\"number\",inclusive:a.inclusive,exact:!1,message:a.message}),i.dirty()):a.kind===\"multipleOf\"?m9(e.data,a.value)!==0&&(n=this._getOrReturnCtx(e,n),k(n,{code:_.not_multiple_of,multipleOf:a.value,message:a.message}),i.dirty()):a.kind===\"finite\"?Number.isFinite(e.data)||(n=this._getOrReturnCtx(e,n),k(n,{code:_.not_finite,message:a.message}),i.dirty()):K.assertNever(a);return{status:i.value,value:e.data}}gte(e,r){return this.setLimit(\"min\",e,!0,q.toString(r))}gt(e,r){return this.setLimit(\"min\",e,!1,q.toString(r))}lte(e,r){return this.setLimit(\"max\",e,!0,q.toString(r))}lt(e,r){return this.setLimit(\"max\",e,!1,q.toString(r))}setLimit(e,r,n,i){return new t({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:n,message:q.toString(i)}]})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:\"int\",message:q.toString(e)})}positive(e){return this._addCheck({kind:\"min\",value:0,inclusive:!1,message:q.toString(e)})}negative(e){return this._addCheck({kind:\"max\",value:0,inclusive:!1,message:q.toString(e)})}nonpositive(e){return this._addCheck({kind:\"max\",value:0,inclusive:!0,message:q.toString(e)})}nonnegative(e){return this._addCheck({kind:\"min\",value:0,inclusive:!0,message:q.toString(e)})}multipleOf(e,r){return this._addCheck({kind:\"multipleOf\",value:e,message:q.toString(r)})}finite(e){return this._addCheck({kind:\"finite\",message:q.toString(e)})}safe(e){return this._addCheck({kind:\"min\",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:q.toString(e)})._addCheck({kind:\"max\",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:q.toString(e)})}get minValue(){let e=null;for(let r of this._def.checks)r.kind===\"min\"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(let r of this._def.checks)r.kind===\"max\"&&(e===null||r.value<e)&&(e=r.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind===\"int\"||e.kind===\"multipleOf\"&&K.isInteger(e.value))}get isFinite(){let e=null,r=null;for(let n of this._def.checks){if(n.kind===\"finite\"||n.kind===\"int\"||n.kind===\"multipleOf\")return!0;n.kind===\"min\"?(r===null||n.value>r)&&(r=n.value):n.kind===\"max\"&&(e===null||n.value<e)&&(e=n.value)}return Number.isFinite(r)&&NumberThu, 29 Jan 2026 21:34:56 GMT express-session deprecated req.secret; provide secret option at node:internal/modules/cjs/loader:1706:14","attributes":{"level":"error"},"tags":{"project":"29c6c2c4-ea10-4fe6-8901-1198a13520db","environment":"9a47f9fb-0d50-4031-a85e-16db1d46fb86","service":"09a1965e-88d6-44ee-9836-14176d4bb0b5","deployment":"e78c90dd-bc00-48f5-9312-8a8fa977b2c2","replica":"68b779c1-91b1-4ca6-88f4-a907899be5f1"},"timestamp":"2026-01-29T21:34:56.412832633Z"},{"message":"/app/dist/index.cjs:71","attributes":{"level":"error"},"tags":{"project":"29c6c2c4-ea10-4fe6-8901-1198a13520db","environment":"9a47f9fb-0d50-4031-a85e-16db1d46fb86","service":"09a1965e-88d6-44ee-9836-14176d4bb0b5","deployment":"e78c90dd-bc00-48f5-9312-8a8fa977b2c2","replica":"68b779c1-91b1-4ca6-88f4-a907899be5f1"},"timestamp":"2026-01-29T21:34:56.412841365Z"},{"message":"\t\t`;await r.execute(g`CREATE SCHEMA IF NOT EXISTS ${g.identifier(a)}`),await r.execute(s);let u=(await r.all(g`select id, hash, created_at from ${g.identifier(a)}.${g.identifier(i)} order by created_at desc limit 1`))[0];await r.transaction(async c=>{for await(let l of e)if(!u||Number(u.created_at)<l.folderMillis){for(let p of l.sql)await c.execute(g.raw(p));await c.execute(g`insert into ${g.identifier(a)}.${g.identifier(i)} (\"hash\", \"created_at\") values(${l.hash}, ${l.folderMillis})`)}})}escapeName(e){return`\"${e}\"`}escapeParam(e){return`$${e+1}`}escapeString(e){return`'${e.replace(/'/g,\"''\")}'`}buildWithCTE(e){if(!e?.length)return;let r=[g`with `];for(let[n,i]of e.entries())r.push(g`${g.identifier(i._.alias)} as (${i._.sql})`),n<e.length-1&&r.push(g`, `);return r.push(g` `),g.join(r)}buildDeleteQuery({table:e,where:r,returning:n,withList:i}){let a=this.buildWithCTE(i),s=n?g` returning ${this.buildSelection(n,{isSingleTable:!0})}`:void 0,o=r?g` where ${r}`:void 0;return g`${a}delete from ${e}${o}${s}`}buildUpdateSet(e,r){let n=e[A.Symbol.Columns],i=Object.keys(n).filter(s=>r[s]!==void 0||n[s]?.onUpdateFn!==void 0),a=i.length;return g.join(i.flatMap((s,o)=>{let u=n[s],c=r[s]??g.param(u.onUpdateFn(),u),l=g`${g.identifier(this.casing.getColumnCasing(u))} = ${c}`;return o<a-1?[l,g.raw(\", \")]:[l]}))}buildUpdateQuery({table:e,set:r,where:n,returning:i,withList:a,from:s,joins:o}){let u=this.buildWithCTE(a),c=e[Te.Symbol.Name],l=e[Te.Symbol.Schema],p=e[Te.Symbol.OriginalName],d=c===p?void 0:c,f=g`${l?g`${g.identifier(l)}.`:void 0}${g.identifier(p)}${d&&g` ${g.identifier(d)}`}`,y=this.buildUpdateSet(e,r),m=s&&g.join([g.raw(\" from \"),this.buildFromTable(s)]),x=this.buildJoins(o),w=i?g` returning ${this.buildSelection(i,{isSingleTable:!s})}`:void 0,T=n?g` where ${n}`:void 0;return g`${u}update ${f} set ${y}${m}${x}${T}${w}`}buildSelection(e,{isSingleTable:r=!1}={}){let n=e.length,i=e.flatMap(({field:a},s)=>{let o=[];if(b(a,O.Aliased)&&a.isSelectionField)o.push(g.identifier(a.fieldAlias));else if(b(a,O.Aliased)||b(a,O)){let u=b(a,O.Aliased)?a.sql:a;r?o.push(new O(u.queryChunks.map(c=>b(c,E)?g.identifier(this.casing.getColumnCasing(c)):c))):o.push(u),b(a,O.Aliased)&&o.push(g` as ${g.identifier(a.fieldAlias)}`)}else b(a,J)&&(r?o.push(g.identifier(this.casing.getColumnCasing(a))):o.push(a));return s<n-1&&o.push(g`, `),o});return g.join(i)}buildJoins(e){if(!e||e.length===0)return;let r=[];for(let[n,i]of e.entries()){n===0&&r.push(g` `);let a=i.table,s=i.lateral?g` lateral`:void 0;if(b(a,Te)){let o=a[Te.Symbol.Name],u=a[Te.Symbol.Schema],c=a[Te.Symbol.OriginalName],l=o===c?void 0:i.alias;r.push(g`${g.raw(i.joinType)} join${s} ${u?g`${g.identifier(u)}.`:void 0}${g.identifier(c)}${l&&g` ${g.identifier(l)}`} on ${i.on}`)}else if(b(a,Ue)){let o=a[te].name,u=a[te].schema,c=a[te].originalName,l=o===c?void 0:i.alias;r.push(g`${g.raw(i.joinType)} join${s} ${u?g`${g.identifier(u)}.`:void 0}${g.identifier(c)}${l&&g` ${g.identifier(l)}`} on ${i.on}`)}else r.push(g`${g.raw(i.joinType)} join${s} ${a} on ${i.on}`);n<e.length-1&&r.push(g` `)}return g.join(r)}buildFromTable(e){if(b(e,A)&&e[A.Symbol.OriginalName]!==e[A.Symbol.Name]){let r=g`${g.identifier(e[A.Symbol.OriginalName])}`;return e[A.Symbol.Schema]&&(r=g`${g.identifier(e[A.Symbol.Schema])}.${r}`),g`${r} ${g.identifier(e[A.Symbol.Name])}`}return e}buildSelectQuery({withList:e,fields:r,fieldsFlat:n,where:i,having:a,table:s,joins:o,orderBy:u,groupBy:c,limit:l,offset:p,lockingClause:d,distinct:f,setOperators:y}){let m=n??gt(r);for(let ne of m)if(b(ne.field,J)&&We(ne.field.table)!==(b(s,ye)?s._.alias:b(s,oi)?s[te].name:b(s,O)?void 0:We(s))&&!(he=>o?.some(({alias:et})=>et===(he[A.Symbol.IsAlias]?We(he):he[A.Symbol.BaseName])))(ne.field.table)){let he=We(ne.field.table);throw new Error(`Your \"${ne.path.join(\"->\")}\" field references a column \"${he}\".\"${ne.field.name}\", but the table \"${he}\" is not part of the query! Did you forget to join it?`)}let x=!o||o.length===0,w=this.buildWithCTE(e),T;f&&(T=f===!0?g` distinct`:g` distinct on (${g.join(f.on,g`, `)})`);let S=this.buildSelection(m,{isSingleTable:x}),C=this.buildFromTable(s),L=this.buildJoins(o),j=i?g` where ${i}`:void 0,R=a?g` having ${a}`:void 0,N;u&&u.length>0&&(N=g` order by ${g.join(u,g`, `)}`);let Q;c&&c.length>0&&(Q=g` group by ${g.join(c,g`, `)}`);let fe=typeof l==\"object\"||typeof l==\"number\"&&l>=0?g` limit ${l}`:void 0,_t=p?g` offset ${p}`:void 0,qe=g.empty();if(d){let ne=g` for ${g.raw(d.strength)}`;d.config.of&&ne.append(g` of ${g.join(Array.isArray(d.config.of)?d.config.of:[d.config.of],g`, `)}`),d.config.noWait?ne.append(g` no wait`):d.config.skipLocked&&ne.append(g` skip locked`),qe.append(ne)}let se=g`${w}select${T} ${S} from ${C}${L}${j}${Q}${R}${N}${fe}${_t}${qe}`;return y.length>0?this.buildSetOperations(se,y):se}buildSetOperations(e,r){let[n,...i]=r;if(!n)throw new Error(\"Cannot pass undefined values to any set operator\");return i.length===0?this.buildSetOperationQuery({leftSelect:e,setOperator:n}):this.buildSetOperations(this.buildSetOperationQuery({leftSelect:e,setOperator:n}),i)}buildSetOperationQuery({leftSelect:e,setOperator:{type:r,isAll:n,rightSelect:i,limit:a,orderBy:s,offset:o}}){let u=g`(${e.getSQL()}) `,c=g`(${i.getSQL()})`,l;if(s&&s.length>0){let y=[];for(let m of s)if(b(m,E))y.push(g.identifier(m.name));else if(b(m,O)){for(let x=0;x<m.queryChunks.length;x++){let w=m.queryChunks[x];b(w,E)&&(m.queryChunks[x]=g.identifier(w.name))}y.push(g`${m}`)}else y.push(g`${m}`);l=g` order by ${g.join(y,g`, `)} `}let p=typeof a==\"object\"||typeof a==\"number\"&&a>=0?g` limit ${a}`:void 0,d=g.raw(`${r} ${n?\"all \":\"\"}`),f=o?g` offset ${o}`:void 0;return g`${u}${d}${c}${l}${p}${f}`}buildInsertQuery({table:e,values:r,onConflict:n,returning:i,withList:a,select:s,overridingSystemValue_:o}){let u=[],c=e[A.Symbol.Columns],l=Object.entries(c).filter(([w,T])=>!T.shouldDisableInsert()),p=l.map(([,w])=>g.identifier(this.casing.getColumnCasing(w)));if(s){let w=r;b(w,O)?u.push(w):u.push(w.getSQL())}else{let w=r;u.push(g.raw(\"values \"));for(let[T,S]of w.entries()){let C=[];for(let[L,j]of l){let R=S[L];if(R===void 0||b(R,Ge)&&R.value===void 0)if(j.defaultFn!==void 0){let N=j.defaultFn(),Q=b(N,O)?N:g.param(N,j);C.push(Q)}else if(!j.default&&j.onUpdateFn!==void 0){let N=j.onUpdateFn(),Q=b(N,O)?N:g.param(N,j);C.push(Q)}else C.push(g`default`);else C.push(R)}u.push(C),T<w.length-1&&u.push(g`, `)}}let d=this.buildWithCTE(a),f=g.join(u),y=i?g` returning ${this.buildSelection(i,{isSingleTable:!0})}`:void 0,m=n?g` on conflict ${n}`:void 0,x=o===!0?g`overriding system value `:void 0;return g`${d}insert into ${e} ${p} ${x}${f}${m}${y}`}buildRefreshMaterializedViewQuery({view:e,concurrently:r,withNoData:n}){let i=r?g` concurrently`:void 0,a=n?g` with no data`:void 0;return g`refresh materialized view${i} ${e}${a}`}prepareTyping(e){return b(e,Sa)||b(e,_a)?\"json\":b(e,Ea)?\"decimal\":b(e,Ta)?\"time\":b(e,ka)||b(e,Aa)?\"timestamp\":b(e,ba)||b(e,wa)?\"date\":b(e,Ca)?\"uuid\":\"none\"}sqlToQuery(e,r){return e.toQuery({casing:this.casing,escapeName:this.escapeName,escapeParam:this.escapeParam,escapeString:this.escapeString,prepareTyping:this.prepareTyping,invokeSource:r})}buildRelationalQueryWithoutPK({fullSchema:e,schema:r,tableNamesMap:n,table:i,tableConfig:a,queryConfig:s,tableAlias:o,nestedQueryRelation:u,joinOn:c}){let l=[],p,d,f=[],y,m=[];if(s===!0)l=Object.entries(a.columns).map(([T,S])=>({dbKey:S.name,tsKey:T,field:Dt(S,o),relationTableTsKey:void 0,isJson:!1,selection:[]}));else{let w=Object.fromEntries(Object.entries(a.columns).map(([R,N])=>[R,Dt(N,o)]));if(s.where){let R=typeof s.where==\"function\"?s.where(w,F_()):s.where;y=R&&ga(R,o)}let T=[],S=[];if(s.columns){let R=!1;for(let[N,Q]of Object.entries(s.columns))Q!==void 0&&N in a.columns&&(!R&&Q===!0&&(R=!0),S.push(N));S.length>0&&(S=R?S.filter(N=>s.columns?.[N]===!0):Object.keys(a.columns).filter(N=>!S.includes(N)))}else S=Object.keys(a.columns);for(let R of S){let N=a.columns[R];T.push({tsKey:R,value:N})}let C=[];s.with&&(C=Object.entries(s.with).filter(R=>!!R[1]).map(([R,N])=>({tsKey:R,queryConfig:N,relation:a.relations[R]})));let L;if(s.extras){L=typeof s.extras==\"function\"?s.extras(w,{sql:g}):s.extras;for(let[R,N]of Object.entries(L))T.push({tsKey:R,value:pd(N,o)})}for(let{tsKey:R,value:N}of T)l.push({dbKey:b(N,O.Aliased)?N.fieldAlias:a.columns[R].name,tsKey:R,field:b(N,J)?Dt(N,o):N,relationTableTsKey:void 0,isJson:!1,selection:[]});let j=typeof s.orderBy==\"function\"?s.orderBy(w,$_()):s.orderBy??[];Array.isArray(j)||(j=[j]),f=j.map(R=>b(R,J)?Dt(R,o):ga(R,o)),p=s.limit,d=s.offset;for(let{tsKey:R,queryConfig:N,relation:Q}of C){let fe=B_(r,n,Q),_t=Hr(Q.referencedTable),qe=n[_t],se=`${o}_${R}`,ne=Pa(...fe.fields.map((Ht,qi)=>kt(Dt(fe.references[qi],se),Dt(Ht,o)))),he=this.buildRelationalQueryWithoutPK({fullSchema:e,schema:r,tableNamesMap:n,table:e[qe],tableConfig:r[qe],queryConfig:b(Q,xr)?N===!0?{limit:1}:{...N,limit:1}:N,tableAlias:se,joinOn:ne,nestedQueryRelation:Q}),et=g`${g.identifier(se)}.${g.identifier(\"data\")}`.as(R);m.push({on:g`true`,table:new ye(he.sql,{},se),alias:se,joinType:\"left\",lateral:!0}),l.push({dbKey:R,tsKey:R,field:et,relationTableTsKey:qe,isJson:!0,selection:he.selection})}}if(l.length===0)throw new xa({message:`No fields selected for table \"${a.tsName}\" (\"${o}\")`});let x;if(y=Pa(c,y),u){let w=g`json_build_array(${g.join(l.map(({field:C,tsKey:L,isJson:j})=>j?g`${g.identifier(`${o}_${L}`)}.${g.identifier(\"data\")}`:b(C,O.Aliased)?C.sql:C),g`, `)})`;b(u,Oa)&&(w=g`coalesce(json_agg(${w}${f.length>0?g` order by ${g.join(f,g`, `)}`:void 0}), '[]'::json)`);let T=[{dbKey:\"data\",tsKey:\"data\",field:w.as(\"data\"),isJson:!0,relationTableTsKey:a.tsName,selection:l}];p!==void 0||d!==void 0||f.length>0?(x=this.buildSelectQuery({table:ma(i,o),fields:{},fieldsFlat:[{path:[],field:g.raw(\"*\")}],where:y,limit:p,offset:d,orderBy:f,setOperators:[]}),y=void 0,p=void 0,d=void 0,f=[]):x=ma(i,o),x=this.buildSelectQuery({table:b(x,Te)?x:new ye(x,{},o),fields:{},fieldsFlat:T.map(({field:C})=>({path:[],field:b(C,J)?Dt(C,o):C})),joins:m,where:y,limit:p,offset:d,orderBy:f,setOperators:[]})}else x=this.buildSelectQuery({table:ma(i,o),fields:{},fieldsFlat:l.map(({field:w})=>({path:[],field:b(w,J)?Dt(w,o):w})),joins:m,where:y,limit:p,offset:d,orderBy:f,setOperators:[]});return{tableTsKey:a.tsName,sql:x,selection:l}}};var zo=class{static[h]=\"TypedQueryBuilder\";getSelectedFields(){return this._.selectedFields}};var De=class{static[h]=\"PgSelectBuilder\";fields;session;dialect;withList=[];distinct;constructor(e){this.fields=e.fields,this.session=e.session,this.dialect=e.dialect,e.withList&&(this.withList=e.withList),this.distinct=e.distinct}authToken;setToken(e){return this.authToken=e,this}from(e){let r=!!this.fields,n=e,i;return this.fields?i=this.fields:b(n,ye)?i=Object.fromEntries(Object.keys(n._.selectedFields).map(a=>[a,n[a]])):b(n,oi)?i=n[te].selectedFields:b(n,O)?i={}:i=qo(n),new Ho({table:n,fields:i,isPartialSelect:r,session:this.session,dialect:this.dialect,withList:this.withList,distinct:this.distinct}).setToken(this.authToken)}},If=class extends zo{static[h]=\"PgSelectQueryBuilder\";_;config;joinsNotNullableMap;tableName;isPartialSelect;session;dialect;constructor({table:e,fields:r,isPartialSelect:n,session:i,dialect:a,withList:s,distinct:o}){super(),this.config={withList:s,table:e,fields:{...r},distinct:o,setOperators:[]},this.isPartialSelect=n,this.session=i,this.dialect=a,this._={selectedFields:r},this.tableName=er(e),this.joinsNotNullableMap=typeof this.tableName==\"string\"?{[this.tableName]:!0}:{}}createJoin(e){return(r,n)=>{let i=this.tableName,a=er(r);if(typeof a==\"string\"&&this.config.joins?.some(s=>s.alias===a))throw new Error(`Alias \"${a}\" is already used in this query`);if(!this.isPartialSelect&&(Object.keys(this.joinsNotNullableMap).length===1&&typeof i==\"string\"&&(this.config.fields={[i]:this.config.fields}),typeof a==\"string\"&&!b(r,O))){let s=b(r,ye)?r._.selectedFields:b(r,Ue)?r[te].selectedFields:r[A.Symbol.Columns];this.config.fields[a]=s}if(typeof n==\"function\"&&(n=n(new Proxy(this.config.fields,new de({sqlAliasedBehavior:\"sql\",sqlBehavior:\"sql\"})))),this.config.joins||(this.config.joins=[]),this.config.joins.push({on:n,table:r,joinType:e,alias:a}),typeof a==\"string\")switch(e){case\"left\":{this.joinsNotNullableMap[a]=!1;break}case\"right\":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([s])=>[s,!1])),this.joinsNotNullableMap[a]=!0;break}case\"inner\":{this.joinsNotNullableMap[a]=!0;break}case\"full\":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([s])=>[s,!1])),this.joinsNotNullableMap[a]=!1;break}}return this}}leftJoin=this.createJoin(\"left\");rightJoin=this.createJoin(\"right\");innerJoin=this.createJoin(\"inner\");fullJoin=this.createJoin(\"full\");createSetOperator(e,r){return n=>{let i=typeof n==\"function\"?n(MI()):n;if(!va(this.getSelectedFields(),i.getSelectedFields()))throw new Error(\"Set operator error (union / intersect / except): selected fields are not the same or are in a different order\");return this.config.setOperators.push({type:e,isAll:r,rightSelect:i}),this}}union=this.createSetOperator(\"union\",!1);unionAll=this.createSetOperator(\"union\",!0);intersect=this.createSetOperator(\"intersect\",!1);intersectAll=this.createSetOperator(\"intersect\",!0);except=this.createSetOperator(\"except\",!1);exceptAll=this.createSetOperator(\"except\",!0);addSetOperators(e){return this.config.setOperators.push(...e),this}where(e){return typeof e==\"function\"&&(e=e(new Proxy(this.config.fields,new de({sqlAliasedBehavior:\"sql\",sqlBehavior:\"sql\"})))),this.config.where=e,this}having(e){return typeof e==\"function\"&&(e=e(new Proxy(this.config.fields,new de({sqlAliasedBehavior:\"sql\",sqlBehavior:\"sql\"})))),this.config.having=e,this}groupBy(...e){if(typeof e[0]==\"function\"){let r=e[0](new Proxy(this.config.fields,new de({sqlAliasedBehavior:\"alias\",sqlBehavior:\"sql\"})));this.config.groupBy=Array.isArray(r)?r:[r]}else this.config.groupBy=e;return this}orderBy(...e){if(typeof e[0]==\"function\"){let r=e[0](new Proxy(this.config.fields,new de({sqlAliasedBehavior:\"alias\",sqlBehavior:\"sql\"}))),n=Array.isArray(r)?r:[r];this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=n:this.config.orderBy=n}else{let r=e;this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=r:this.config.orderBy=r}return this}limit(e){return this.config.setOperators.length>0?this.config.setOperators.at(-1).limit=e:this.config.limit=e,this}offset(e){return this.config.setOperators.length>0?this.config.setOperators.at(-1).offset=e:this.config.offset=e,this}for(e,r={}){return this.config.lockingClause={strength:e,config:r},this}getSQL(){return this.dialect.buildSelectQuery(this.config)}toSQL(){let{typings:e,...r}=this.dialect.sqlToQuery(this.getSQL());return r}as(e){return new Proxy(new ye(this.getSQL(),this.config.fields,e),new de({alias:e,sqlAliasedBehavior:\"alias\",sqlBehavior:\"error\"}))}getSelectedFields(){return new Proxy(this.config.fields,new de({alias:this.tableName,sqlAliasedBehavior:\"alias\",sqlBehavior:\"error\"}))}$dynamic(){return this}},Ho=class extends If{static[h]=\"PgSelect\";_prepare(e){let{session:r,config:n,dialect:i,joinsNotNullableMap:a,authToken:s}=this;if(!r)throw new Error(\"Cannot execute a query on a query builder. Please use a database instance instead.\");return ee.startActiveSpan(\"drizzle.prepareQuery\",()=>{let o=gt(n.fields),u=r.prepareQuery(i.sqlToQuery(this.getSQL()),o,e,!0);return u.joinsNotNullableMap=a,u.setToken(s)})}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>ee.startActiveSpan(\"drizzle.operation\",()=>this._prepare().execute(e,this.authToken))};$1(Ho,[je]);function ci(t,e){return(r,n,...i)=>{let a=[n,...i].map(s=>({type:t,isAll:e,rightSelect:s}));for(let s of a)if(!va(r.getSelectedFields(),s.rightSelect.getSelectedFields()))throw new Error(\"Set operator error (union / intersect / except): selected fields are not the same or are in a different order\");return r.addSetOperators(a)}}var MI=()=>({union:FI,unionAll:$I,intersect:UI,intersectAll:BI,except:zI,exceptAll:HI}),FI=ci(\"union\",!1),$I=ci(\"union\",!0),UI=ci(\"intersect\",!1),BI=ci(\"intersect\",!0),zI=ci(\"except\",!1),HI=ci(\"except\",!0);var ui=class{static[h]=\"PgQueryBuilder\";dialect;dialectConfig;constructor(e){this.dialect=b(e,br)?e:void 0,this.dialectConfig=b(e,br)?void 0:e}$with=(e,r)=>{let n=this;return{as:a=>(typeof a==\"function\"&&(a=a(n)),new Proxy(new ni(a.getSQL(),r??(\"getSelectedFields\"in a?a.getSelectedFields()??{}:{}),e,!0),new de({alias:e,sqlAliasedBehavior:\"alias\",sqlBehavior:\"error\"})))}};with(...e){let r=this;function n(s){return new De({fields:s??void 0,session:void 0,dialect:r.getDialect(),withList:e})}function i(s){return new De({fields:s??void 0,session:void 0,dialect:r.getDialect(),distinct:!0})}function a(s,o){return new De({fields:o??void 0,session:void 0,dialect:r.getDialect(),distinct:{on:s}})}return{select:n,selectDistinct:i,selectDistinctOn:a}}select(e){return new De({fields:e??void 0,session:void 0,dialect:this.getDialect()})}selectDistinct(e){return new De({fields:e??void 0,session:void 0,dialect:this.getDialect(),distinct:!0})}selectDistinctOn(e,r){return new De({fields:r??void 0,session:void 0,dialect:this.getDialect(),distinct:{on:e}})}getDialect(){return this.dialect||(this.dialect=new br(this.dialectConfig)),this.dialect}};var Ra=class{constructor(e,r,n,i,a){this.table=e,this.session=r,this.dialect=n,this.withList=i,this.overridingSystemValue_=a}static[h]=\"PgInsertBuilder\";authToken;setToken(e){return this.authToken=e,this}overridingSystemValue(){return this.overridingSystemValue_=!0,this}values(e){if(e=Array.isArray(e)?e:[e],e.length===0)throw new Error(\"values() must be called with at least one value\");let r=e.map(n=>{let i={},a=this.table[A.Symbol.Columns];for(let s of Object.keys(n)){let o=n[s];i[s]=b(o,O)?o:new Ge(o,a[s])}return i});return new Qo(this.table,r,this.session,this.dialect,this.withList,!1,this.overridingSystemValue_).setToken(this.authToken)}select(e){let r=typeof e==\"function\"?e(new ui):e;if(!b(r,O)&&!va(this.table[Io],r._.selectedFields))throw new Error(\"Insert select error: selected fields are not the same or are in a different order compared to the table definition\");return new Qo(this.table,r,this.session,this.dialect,this.withList,!0)}},Qo=class extends je{constructor(e,r,n,i,a,s,o){super(),this.session=n,this.dialect=i,this.config={table:e,values:r,withList:a,select:s,overridingSystemValue_:o}}static[h]=\"PgInsert\";config;returning(e=this.config.table[A.Symbol.Columns]){return this.config.returningFields=e,this.config.returning=gt(e),this}onConflictDoNothing(e={}){if(e.target===void 0)this.config.onConflict=g`do nothing`;else{let r=\"\";r=Array.isArray(e.target)?e.target.map(i=>this.dialect.escapeName(this.dialect.casing.getColumnCasing(i))).join(\",\"):this.dialect.escapeName(this.dialect.casing.getColumnCasing(e.target));let n=e.where?g` where ${e.where}`:void 0;this.config.onConflict=g`(${g.raw(r)})${n} do nothing`}return this}onConflictDoUpdate(e){if(e.where&&(e.targetWhere||e.setWhere))throw new Error('You cannot use both \"where\" and \"targetWhere\"/\"setWhere\" at the same time - \"where\" is deprecated, use \"targetWhere\" or \"setWhere\" instead.');let r=e.where?g` where ${e.where}`:void 0,n=e.targetWhere?g` where ${e.targetWhere}`:void 0,i=e.setWhere?g` where ${e.setWhere}`:void 0,a=this.dialect.buildUpdateSet(this.config.table,No(this.config.table,e.set)),s=\"\";return s=Array.isArray(e.target)?e.target.map(o=>this.dialect.escapeName(this.dialect.casing.getColumnCasing(o))).join(\",\"):this.dialect.escapeName(this.dialect.casing.getColumnCasing(e.target)),this.config.onConflict=g`(${g.raw(s)})${n} do update set ${a}${r}${i}`,this}getSQL(){return this.dialect.buildInsertQuery(this.config)}toSQL(){let{typings:e,...r}=this.dialect.sqlToQuery(this.getSQL());return r}_prepare(e){return ee.startActiveSpan(\"drizzle.prepareQuery\",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,e,!0))}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>ee.startActiveSpan(\"drizzle.operation\",()=>this._prepare().execute(e,this.authToken));getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new de({alias:We(this.config.table),sqlAliasedBehavior:\"alias\",sqlBehavior:\"error\"})):void 0}$dynamic(){return this}};var Vo=class extends je{constructor(e,r,n){super(),this.session=r,this.dialect=n,this.config={view:e}}static[h]=\"PgRefreshMaterializedView\";config;concurrently(){if(this.config.withNoData!==void 0)throw new Error(\"Cannot use concurrently and withNoData together\");return this.config.concurrently=!0,this}withNoData(){if(this.config.concurrently!==void 0)throw new Error(\"Cannot use concurrently and withNoData together\");return this.config.withNoData=!0,this}getSQL(){return this.dialect.buildRefreshMaterializedViewQuery(this.config)}toSQL(){let{typings:e,...r}=this.dialect.sqlToQuery(this.getSQL());return r}_prepare(e){return ee.startActiveSpan(\"drizzle.prepareQuery\",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),void 0,e,!0))}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>ee.startActiveSpan(\"drizzle.operation\",()=>this._prepare().execute(e,this.authToken))};var Ia=class{constructor(e,r,n,i){this.table=e,this.session=r,this.dialect=n,this.withList=i}static[h]=\"PgUpdateBuilder\";authToken;setToken(e){return this.authToken=e,this}set(e){return new Nf(this.table,No(this.table,e),this.session,this.dialect,this.withList).setToken(this.authToken)}},Nf=class extends je{constructor(e,r,n,i,a){super(),this.session=n,this.dialect=i,this.config={set:r,table:e,withList:a,joins:[]},this.tableName=er(e),this.joinsNotNullableMap=typeof this.tableName==\"string\"?{[this.tableName]:!0}:{}}static[h]=\"PgUpdate\";config;tableName;joinsNotNullableMap;from(e){let r=e,n=er(r);return typeof n==\"string\"&&(this.joinsNotNullableMap[n]=!0),this.config.from=r,this}getTableLikeFields(e){return b(e,Te)?e[A.Symbol.Columns]:b(e,ye)?e._.selectedFields:e[te].selectedFields}createJoin(e){return(r,n)=>{let i=er(r);if(typeof i==\"string\"&&this.config.joins.some(a=>a.alias===i))throw new Error(`Alias \"${i}\" is already used in this query`);if(typeof n==\"function\"){let a=this.config.from&&!b(this.config.from,O)?this.getTableLikeFields(this.config.from):void 0;n=n(new Proxy(this.config.table[A.Symbol.Columns],new de({sqlAliasedBehavior:\"sql\",sqlBehavior:\"sql\"})),a&&new Proxy(a,new de({sqlAliasedBehavior:\"sql\",sqlBehavior:\"sql\"})))}if(this.config.joins.push({on:n,table:r,joinType:e,alias:i}),typeof i==\"string\")switch(e){case\"left\":{this.joinsNotNullableMap[i]=!1;break}case\"right\":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([a])=>[a,!1])),this.joinsNotNullableMap[i]=!0;break}case\"inner\":{this.joinsNotNullableMap[i]=!0;break}case\"full\":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([a])=>[a,!1])),this.joinsNotNullableMap[i]=!1;break}}return this}}leftJoin=this.createJoin(\"left\");rightJoin=this.createJoin(\"right\");innerJoin=this.createJoin(\"inner\");fullJoin=this.createJoin(\"full\");where(e){return this.config.where=e,this}returning(e){if(!e&&(e=Object.assign({},this.config.table[A.Symbol.Columns]),this.config.from)){let r=er(this.config.from);if(typeof r==\"string\"&&this.config.from&&!b(this.config.from,O)){let n=this.getTableLikeFields(this.config.from);e[r]=n}for(let n of this.config.joins){let i=er(n.table);if(typeof i==\"string\"&&!b(n.table,O)){let a=this.getTableLikeFields(n.table);e[i]=a}}}return this.config.returningFields=e,this.config.returning=gt(e),this}getSQL(){return this.dialect.buildUpdateQuery(this.config)}toSQL(){let{typings:e,...r}=this.dialect.sqlToQuery(this.getSQL());return r}_prepare(e){let r=this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,e,!0);return r.joinsNotNullableMap=this.joinsNotNullableMap,r}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>this._prepare().execute(e,this.authToken);getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new de({alias:We(this.config.table),sqlAliasedBehavior:\"alias\",sqlBehavior:\"error\"})):void 0}$dynamic(){return this}};var Ko=class t extends O{constructor(e){super(t.buildEmbeddedCount(e.source,e.filters).queryChunks),this.params=e,this.mapWith(Number),this.session=e.session,this.sql=t.buildCount(e.source,e.filters)}sql;token;static[h]=\"PgCountBuilder\";[Symbol.toStringTag]=\"PgCountBuilder\";session;static buildEmbeddedCount(e,r){return g`(select count(*) from ${e}${g.raw(\" where \").if(r)}${r})`}static buildCount(e,r){return g`select count(*) as count from ${e}${g.raw(\" where \").if(r)}${r};`}setToken(e){return this.token=e,this}then(e,r){return Promise.resolve(this.session.count(this.sql,this.token)).then(e,r)}catch(e){return this.then(void 0,e)}finally(e){return this.then(r=>(e?.(),r),r=>{throw e?.(),r})}};var Wo=class{constructor(e,r,n,i,a,s,o){this.fullSchema=e,this.schema=r,this.tableNamesMap=n,this.table=i,this.tableConfig=a,this.dialect=s,this.session=o}static[h]=\"PgRelationalQueryBuilder\";findMany(e){return new Go(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,e||{},\"many\")}findFirst(e){return new Go(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,e?{...e,limit:1}:{limit:1},\"first\")}},Go=class extends je{constructor(e,r,n,i,a,s,o,u,c){super(),this.fullSchema=e,this.schema=r,this.tableNamesMap=n,this.table=i,this.tableConfig=a,this.dialect=s,this.session=o,this.config=u,this.mode=c}static[h]=\"PgRelationalQuery\";_prepare(e){return ee.startActiveSpan(\"drizzle.prepareQuery\",()=>{let{query:r,builtQuery:n}=this._toSQL();return this.session.prepareQuery(n,void 0,e,!0,(i,a)=>{let s=i.map(o=>Bo(this.schema,this.tableConfig,o,r.selection,a));return this.mode===\"first\"?s[0]:s})})}prepare(e){return this._prepare(e)}_getQuery(){return this.dialect.buildRelationalQueryWithoutPK({fullSchema:this.fullSchema,schema:this.schema,tableNamesMap:this.tableNamesMap,table:this.table,tableConfig:this.tableConfig,queryConfig:this.config,tableAlias:this.tableConfig.tsName})}getSQL(){return this._getQuery().sql}_toSQL(){let e=this._getQuery(),r=this.dialect.sqlToQuery(e.sql);return{query:e,builtQuery:r}}toSQL(){return this._toSQL().builtQuery}authToken;setToken(e){return this.authToken=e,this}execute(){return ee.startActiveSpan(\"drizzle.operation\",()=>this._prepare().execute(void 0,this.authToken))}};var Jo=class extends je{constructor(e,r,n,i){super(),this.execute=e,this.sql=r,this.query=n,this.mapBatchResult=i}static[h]=\"PgRaw\";getSQL(){return this.sql}getQuery(){return this.query}mapResult(e,r){return r?this.mapBatchResult(e):e}_prepare(){return this}isResponseInArrayMode(){return!1}};var li=class{constructor(e,r,n){if(this.dialect=e,this.session=r,this._=n?{schema:n.schema,fullSchema:n.fullSchema,tableNamesMap:n.tableNamesMap,session:r}:{schema:void 0,fullSchema:{},tableNamesMap:{},session:r},this.query={},this._.schema)for(let[i,a]of Object.entries(this._.schema))this.query[i]=new Wo(n.fullSchema,this._.schema,this._.tableNamesMap,n.fullSchema[i],a,e,r)}static[h]=\"PgDatabase\";query;$with=(e,r)=>{let n=this;return{as:a=>(typeof a==\"function\"&&(a=a(new ui(n.dialect))),new Proxy(new ni(a.getSQL(),r??(\"getSelectedFields\"in a?a.getSelectedFields()??{}:{}),e,!0),new de({alias:e,sqlAliasedBehavior:\"alias\",sqlBehavior:\"error\"})))}};$count(e,r){return new Ko({source:e,filters:r,session:this.session})}with(...e){let r=this;function n(c){return new De({fields:c??void 0,session:r.session,dialect:r.dialect,withList:e})}function i(c){return new De({fields:c??void 0,session:r.session,dialect:r.dialect,withList:e,distinct:!0})}function a(c,l){return new De({fields:l??void 0,session:r.session,dialect:r.dialect,withList:e,distinct:{on:c}})}function s(c){return new Ia(c,r.session,r.dialect,e)}function o(c){return new Ra(c,r.session,r.dialect,e)}function u(c){return new ya(c,r.session,r.dialect,e)}return{select:n,selectDistinct:i,selectDistinctOn:a,update:s,insert:o,delete:u}}select(e){return new De({fields:e??void 0,session:this.session,dialect:this.dialect})}selectDistinct(e){return new De({fields:e??void 0,session:this.session,dialect:this.dialect,distinct:!0})}selectDistinctOn(e,r){return new De({fields:r??void 0,session:this.session,dialect:this.dialect,distinct:{on:e}})}update(e){return new Ia(e,this.session,this.dialect)}insert(e){return new Ra(e,this.session,this.dialect)}delete(e){return new ya(e,this.session,this.dialect)}refreshMaterializedView(e){return new Vo(e,this.session,this.dialect)}authToken;execute(e){let r=typeof e==\"string\"?g.raw(e):e.getSQL(),n=this.dialect.sqlToQuery(r),i=this.session.prepareQuery(n,void 0,void 0,!1);return new Jo(()=>i.execute(void 0,this.authToken),r,n,a=>i.mapResult(a,!0))}transaction(e,r){return this.session.transaction(e,r)}};var qf=class{constructor(e,r){this.unique=e,this.name=r}static[h]=\"PgIndexBuilderOn\";on(...e){return new Na(e.map(r=>{if(b(r,O))return r;r=r;let n=new ri(r.name,!!r.keyAsName,r.columnType,r.indexConfig);return r.indexConfig=JSON.parse(JSON.stringify(r.defaultConfig)),n}),this.unique,!1,this.name)}onOnly(...e){return new Na(e.map(r=>{if(b(r,O))return r;r=r;let n=new ri(r.name,!!r.keyAsName,r.columnType,r.indexConfig);return r.indexConfig=r.defaultConfig,n}),this.unique,!0,this.name)}using(e,...r){return new Na(r.map(n=>{if(b(n,O))return n;n=n;let i=new ri(n.name,!!n.keyAsName,n.columnType,n.indexConfig);return n.indexConfig=JSON.parse(JSON.stringify(n.defaultConfig)),i}),this.unique,!0,this.name,e)}},Na=class{static[h]=\"PgIndexBuilder\";config;constructor(e,r,n,i,a=\"btree\"){this.config={name:i,columns:e,unique:r,only:n,method:a}}concurrently(){return this.config.concurrently=!0,this}with(e){return this.config.with=e,this}where(e){return this.config.where=e,this}build(e){return new jf(this.config,e)}},jf=class{static[h]=\"PgIndex\";config;constructor(e,r){this.config={...e,table:r}}};function H_(t){return new qf(!1,t)}var Zo=class{constructor(e){this.query=e}authToken;getQuery(){return this.query}mapResult(e,r){return e}setToken(e){return this.authToken=e,this}static[h]=\"PgPreparedQuery\";joinsNotNullableMap},Xo=class{constructor(e){this.dialect=e}static[h]=\"PgSession\";execute(e,r){return ee.startActiveSpan(\"drizzle.operation\",()=>ee.startActiveSpan(\"drizzle.prepareQuery\",()=>this.prepareQuery(this.dialect.sqlToQuery(e),void 0,void 0,!1)).setToken(r).execute(void 0,r))}all(e){return this.prepareQuery(this.dialect.sqlToQuery(e),void 0,void 0,!1).all()}async count(e,r){let n=await this.execute(e,r);return Number(n[0].count)}},Yo=class extends li{constructor(e,r,n,i=0){super(e,r,n),this.schema=n,this.nestedIndex=i}static[h]=\"PgTransaction\";rollback(){throw new Do}getTransactionConfigSQL(e){let r=[];return e.isolationLevel&&r.push(`isolation level ${e.isolationLevel}`),e.accessMode&&r.push(e.accessMode),typeof e.deferrable==\"boolean\"&&r.push(e.deferrable?\"deferrable\":\"not deferrable\"),g.raw(r.join(\" \"))}setTransaction(e){return this.session.execute(g`set transaction ${this.getTransactionConfigSQL(e)}`)}};var{Pool:Q_,types:Mt}=yr,Df=class extends Zo{constructor(e,r,n,i,a,s,o,u){super({sql:r,params:n}),this.client=e,this.params=n,this.logger=i,this.fields=a,this._isResponseInArrayMode=o,this.customResultMapper=u,this.rawQueryConfig={name:s,text:r,types:{getTypeParser:(c,l)=>c===Mt.builtins.TIMESTAMPTZ?p=>p:c===Mt.builtins.TIMESTAMP?p=>p:c===Mt.builtins.DATE?p=>p:c===Mt.builtins.INTERVAL?p=>p:Mt.getTypeParser(c,l)}},this.queryConfig={name:s,text:r,rowMode:\"array\",types:{getTypeParser:(c,l)=>c===Mt.builtins.TIMESTAMPTZ?p=>p:c===Mt.builtins.TIMESTAMP?p=>p:c===Mt.builtins.DATE?p=>p:c===Mt.builtins.INTERVAL?p=>p:Mt.getTypeParser(c,l)}}}static[h]=\"NodePgPreparedQuery\";rawQueryConfig;queryConfig;async execute(e={}){return ee.startActiveSpan(\"drizzle.execute\",async()=>{let r=ld(this.params,e);this.logger.logQuery(this.rawQueryConfig.text,r);let{fields:n,rawQueryConfig:i,client:a,queryConfig:s,joinsNotNullableMap:o,customResultMapper:u}=this;if(!n&&!u)return ee.startActiveSpan(\"drizzle.driver.execute\",async l=>(l?.setAttributes({\"drizzle.query.name\":i.name,\"drizzle.query.text\":i.text,\"drizzle.query.params\":JSON.stringify(r)}),a.query(i,r)));let c=await ee.startActiveSpan(\"drizzle.driver.execute\",l=>(l?.setAttributes({\"drizzle.query.name\":s.name,\"drizzle.query.text\":s.text,\"drizzle.query.params\":JSON.stringify(r)}),a.query(s,r)));return ee.startActiveSpan(\"drizzle.mapResponse\",()=>u?u(c.rows):c.rows.map(l=>F1(n,l,o)))})}all(e={}){return ee.startActiveSpan(\"drizzle.execute\",()=>{let r=ld(this.params,e);return this.logger.logQuery(this.rawQueryConfig.text,r),ee.startActiveSpan(\"drizzle.driver.execute\",n=>(n?.setAttributes({\"drizzle.query.name\":this.rawQueryConfig.name,\"drizzle.query.text\":this.rawQueryConfig.text,\"drizzle.query.params\":JSON.stringify(r)}),this.client.query(this.rawQueryConfig,r).then(i=>i.rows)))})}isResponseInArrayMode(){return this._isResponseInArrayMode}},ec=class t extends Xo{constructor(e,r,n,i={}){super(r),this.client=e,this.schema=n,this.options=i,this.logger=i.logger??new Ao}static[h]=\"NodePgSession\";logger;prepareQuery(e,r,n,i,a){return new Df(this.client,e.sql,e.params,this.logger,r,n,i,a)}async transaction(e,r){let n=this.client instanceof Q_?new t(await this.client.connect(),this.dialect,this.schema,this.options):this,i=new Lf(this.dialect,n,this.schema);await i.execute(g`begin${r?g` ${i.getTransactionConfigSQL(r)}`:void 0}`);try{let a=await e(i);return await i.execute(g`commit`),a}catch(a){throw await i.execute(g`rollback`),a}finally{this.client instanceof Q_&&n.client.release()}}async count(e){let r=await this.execute(e);return Number(r.rows[0].count)}},Lf=class t extends Yo{static[h]=\"NodePgTransaction\";async transaction(e){let r=`sp${this.nestedIndex+1}`,n=new t(this.dialect,this.session,this.schema,this.nestedIndex+1);await n.execute(g.raw(`savepoint ${r}`));try{let i=await e(n);return await n.execute(g.raw(`release savepoint ${r}`)),i}catch(i){throw await n.execute(g.raw(`rollback to savepoint ${r}`)),i}}};var Mf=class{constructor(e,r,n={}){this.client=e,this.dialect=r,this.options=n}static[h]=\"NodePgDriver\";createSession(e){return new ec(this.client,this.dialect,e,{logger:this.options.logger})}},Ff=class extends li{static[h]=\"NodePgDatabase\"};function qa(t,e={}){let r=new br({casing:e.casing}),n;e.logger===!0?n=new ko:e.logger!==!1&&(n=e.logger);let i;if(e.schema){let u=U_(e.schema,z_);i={fullSchema:e.schema,schema:u.tables,tableNamesMap:u.tableNamesMap}}let s=new Mf(t,r,{logger:n}).createSession(i),o=new Ff(r,s,i);return o.$client=t,o}function tc(...t){if(typeof t[0]==\"string\"){let e=new yr.Pool({connectionString:t[0]});return qa(e,t[1])}if(B1(t[0])){let{connection:e,client:r,...n}=t[0];if(r)return qa(r,n);let i=typeof e==\"string\"?new yr.Pool({connectionString:e}):new yr.Pool(e);return qa(i,n)}return qa(t[0],t[1])}(t=>{function e(r){return qa({},r)}t.mock=e})(tc||(tc={}));var oc={};Rc(oc,{inquiries:()=>at,insertInquirySchema:()=>Hf,insertUserSchema:()=>lN,sessions:()=>uN,users:()=>Tr});var Ie={};Rc(Ie,{BRAND:()=>g9,DIRTY:()=>Vr,EMPTY_PATH:()=>WI,INVALID:()=>D,NEVER:()=>eN,OK:()=>Le,ParseStatus:()=>Re,Schema:()=>H,ZodAny:()=>Sr,ZodArray:()=>ar,ZodBigInt:()=>Wr,ZodBoolean:()=>Gr,ZodBranded:()=>Da,ZodCatch:()=>on,ZodDate:()=>Jr,ZodDefault:()=>sn,ZodDiscriminatedUnion:()=>ic,ZodEffects:()=>bt,ZodEnum:()=>nn,ZodError:()=>Ze,ZodFirstPartyTypeKind:()=>M,ZodFunction:()=>sc,ZodIntersection:()=>en,ZodIssueCode:()=>_,ZodLazy:()=>tn,ZodLiteral:()=>rn,ZodMap:()=>gi,ZodNaN:()=>yi,ZodNativeEnum:()=>an,ZodNever:()=>At,ZodNull:()=>Xr,ZodNullable:()=>Ut,ZodNumber:()=>Kr,ZodObject:()=>Xe,ZodOptional:()=>yt,ZodParsedType:()=>P,ZodPipeline:()=>La,ZodPromise:()=>Er,ZodReadonly:()=>cn,ZodRecord:()=>ac,ZodSchema:()=>H,ZodSet:()=>vi,ZodString:()=>_r,ZodSymbol:()=>hi,ZodTransformer:()=>bt,ZodTuple:()=>$t,ZodType:()=>H,ZodUndefined:()=>Zr,ZodUnion:()=>Yr,ZodUnknown:()=>ir,ZodVoid:()=>mi,addIssueToContext:()=>k,any:()=>T9,array:()=>P9,bigint:()=>b9,boolean:()=>rS,coerce:()=>Y9,custom:()=>Y_,date:()=>w9,datetimeRegex:()=>Z_,defaultErrorMap:()=>rr,discriminatedUnion:()=>N9,effect:()=>Q9,enum:()=>B9,function:()=>F9,getErrorMap:()=>pi,getParsedType:()=>Ft,instanceof:()=>y9,intersection:()=>q9,isAborted:()=>rc,isAsync:()=>di,isDirty:()=>nc,isValid:()=>wr,late:()=>v9,lazy:()=>$9,literal:()=>U9,makeIssue:()=>ja,map:()=>L9,nan:()=>x9,nativeEnum:()=>z9,never:()=>A9,null:()=>E9,nullable:()=>K9,number:()=>tS,object:()=>O9,objectUtil:()=>$f,oboolean:()=>X9,onumber:()=>Z9,optional:()=>V9,ostring:()=>J9,pipeline:()=>G9,preprocess:()=>W9,promise:()=>H9,quotelessJson:()=>QI,record:()=>D9,set:()=>M9,setErrorMap:()=>KI,strictObject:()=>R9,string:()=>eS,symbol:()=>_9,transformer:()=>Q9,tuple:()=>j9,undefined:()=>S9,union:()=>I9,unknown:()=>k9,util:()=>K,void:()=>C9});var K;(function(t){t.assertEqual=i=>{};function e(i){}t.assertIs=e;function r(i){throw new Error}t.assertNever=r,t.arrayToEnum=i=>{let a={};for(let s of i)a[s]=s;return a},t.getValidEnumValues=i=>{let a=t.objectKeys(i).filter(o=>typeof i[i[o]]!=\"number\"),s={};for(let o of a)s[o]=i[o];return t.objectValues(s)},t.objectValues=i=>t.objectKeys(i).map(function(a){return i[a]}),t.objectKeys=typeof Object.keys==\"function\"?i=>Object.keys(i):i=>{let a=[];for(let s in i)Object.prototype.hasOwnProperty.call(i,s)&&a.push(s);return a},t.find=(i,a)=>{for(let s of i)if(a(s))return s},t.isInteger=typeof Number.isInteger==\"function\"?i=>Number.isInteger(i):i=>typeof i==\"number\"&&Number.isFinite(i)&&Math.floor(i)===i;function n(i,a=\" | \"){return i.map(s=>typeof s==\"string\"?`'${s}'`:s).join(a)}t.joinValues=n,t.jsonStringifyReplacer=(i,a)=>typeof a==\"bigint\"?a.toString():a})(K||(K={}));var $f;(function(t){t.mergeShapes=(e,r)=>({...e,...r})})($f||($f={}));var P=K.arrayToEnum([\"string\",\"nan\",\"number\",\"integer\",\"float\",\"boolean\",\"date\",\"bigint\",\"symbol\",\"function\",\"undefined\",\"null\",\"array\",\"object\",\"unknown\",\"promise\",\"void\",\"never\",\"map\",\"set\"]),Ft=t=>{switch(typeof t){case\"undefined\":return P.undefined;case\"string\":return P.string;case\"number\":return Number.isNaN(t)?P.nan:P.number;case\"boolean\":return P.boolean;case\"function\":return P.function;case\"bigint\":return P.bigint;case\"symbol\":return P.symbol;case\"object\":return Array.isArray(t)?P.array:t===null?P.null:t.then&&typeof t.then==\"function\"&&t.catch&&typeof t.catch==\"function\"?P.promise:typeof Map<\"u\"&&t instanceof Map?P.map:typeof Set<\"u\"&&t instanceof Set?P.set:typeof Date<\"u\"&&t instanceof Date?P.date:P.object;default:return P.unknown}};var _=K.arrayToEnum([\"invalid_type\",\"invalid_literal\",\"custom\",\"invalid_union\",\"invalid_union_discriminator\",\"invalid_enum_value\",\"unrecognized_keys\",\"invalid_arguments\",\"invalid_return_type\",\"invalid_date\",\"invalid_string\",\"too_small\",\"too_big\",\"invalid_intersection_types\",\"not_multiple_of\",\"not_finite\"]),QI=t=>JSON.stringify(t,null,2).replace(/\"([^\"]+)\":/g,\"$1:\"),Ze=class t extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};let r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name=\"ZodError\",this.issues=e}format(e){let r=e||function(a){return a.message},n={_errors:[]},i=a=>{for(let s of a.issues)if(s.code===\"invalid_union\")s.unionErrors.map(i);else if(s.code===\"invalid_return_type\")i(s.returnTypeError);else if(s.code===\"invalid_arguments\")i(s.argumentsError);else if(s.path.length===0)n._errors.push(r(s));else{let o=n,u=0;for(;u<s.path.length;){let c=s.path[u];u===s.path.length-1?(o[c]=o[c]||{_errors:[]},o[c]._errors.push(r(s))):o[c]=o[c]||{_errors:[]},o=o[c],u++}}};return i(this),n}static assert(e){if(!(e instanceof t))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,K.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=r=>r.message){let r={},n=[];for(let i of this.issues)if(i.path.length>0){let a=i.path[0];r[a]=r[a]||[],r[a].push(e(i))}else n.push(e(i));return{formErrors:n,fieldErrors:r}}get formErrors(){return this.flatten()}};Ze.create=t=>new Ze(t);var VI=(t,e)=>{let r;switch(t.code){case _.invalid_type:t.received===P.undefined?r=\"Required\":r=`Expected ${t.expected}, received ${t.received}`;break;case _.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(t.expected,K.jsonStringifyReplacer)}`;break;case _.unrecognized_keys:r=`Unrecognized key(s) in object: ${K.joinValues(t.keys,\", \")}`;break;case _.invalid_union:r=\"Invalid input\";break;case _.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${K.joinValues(t.options)}`;break;case _.invalid_enum_value:r=`Invalid enum value. Expected ${K.joinValues(t.options)}, received '${t.received}'`;break;case _.invalid_arguments:r=\"Invalid function arguments\";break;case _.invalid_return_type:r=\"Invalid function return type\";break;case _.invalid_date:r=\"Invalid date\";break;case _.invalid_string:typeof t.validation==\"object\"?\"includes\"in t.validation?(r=`Invalid input: must include \"${t.validation.includes}\"`,typeof t.validation.position==\"number\"&&(r=`${r} at one or more positions greater than or equal to ${t.validation.position}`)):\"startsWith\"in t.validation?r=`Invalid input: must start with \"${t.validation.startsWith}\"`:\"endsWith\"in t.validation?r=`Invalid input: must end with \"${t.validation.endsWith}\"`:K.assertNever(t.validation):t.validation!==\"regex\"?r=`Invalid ${t.validation}`:r=\"Invalid\";break;case _.too_small:t.type===\"array\"?r=`Array must contain ${t.exact?\"exactly\":t.inclusive?\"at least\":\"more than\"} ${t.minimum} element(s)`:t.type===\"string\"?r=`String must contain ${t.exact?\"exactly\":t.inclusive?\"at least\":\"over\"} ${t.minimum} character(s)`:t.type===\"number\"?r=`Number must be ${t.exact?\"exactly equal to \":t.inclusive?\"greater than or equal to \":\"greater than \"}${t.minimum}`:t.type===\"bigint\"?r=`Number must be ${t.exact?\"exactly equal to \":t.inclusive?\"greater than or equal to \":\"greater than \"}${t.minimum}`:t.type===\"date\"?r=`Date must be ${t.exact?\"exactly equal to \":t.inclusive?\"greater than or equal to \":\"greater than \"}${new Date(Number(t.minimum))}`:r=\"Invalid input\";break;case _.too_big:t.type===\"array\"?r=`Array must contain ${t.exact?\"exactly\":t.inclusive?\"at most\":\"less than\"} ${t.maximum} element(s)`:t.type===\"string\"?r=`String must contain ${t.exact?\"exactly\":t.inclusive?\"at most\":\"under\"} ${t.maximum} character(s)`:t.type===\"number\"?r=`Number must be ${t.exact?\"exactly\":t.inclusive?\"less than or equal to\":\"less than\"} ${t.maximum}`:t.type===\"bigint\"?r=`BigInt must be ${t.exact?\"exactly\":t.inclusive?\"less than or equal to\":\"less than\"} ${t.maximum}`:t.type===\"date\"?r=`Date must be ${t.exact?\"exactly\":t.inclusive?\"smaller than or equal to\":\"smaller than\"} ${new Date(Number(t.maximum))}`:r=\"Invalid input\";break;case _.custom:r=\"Invalid input\";break;case _.invalid_intersection_types:r=\"Intersection results could not be merged\";break;case _.not_multiple_of:r=`Number must be a multiple of ${t.multipleOf}`;break;case _.not_finite:r=\"Number must be finite\";break;default:r=e.defaultError,K.assertNever(t)}return{message:r}},rr=VI;var V_=rr;function KI(t){V_=t}function pi(){return V_}var ja=t=>{let{data:e,path:r,errorMaps:n,issueData:i}=t,a=[...r,...i.path||[]],s={...i,path:a};if(i.message!==void 0)return{...i,path:a,message:i.message};let o=\"\",u=n.filter(c=>!!c).slice().reverse();for(let c of u)o=c(s,{data:e,defaultError:o}).message;return{...i,path:a,message:o}},WI=[];function k(t,e){let r=pi(),n=ja({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,r,r===rr?void 0:rr].filter(i=>!!i)});t.common.issues.push(n)}var Re=class t{constructor(){this.value=\"valid\"}dirty(){this.value===\"valid\"&&(this.value=\"dirty\")}abort(){this.value!==\"aborted\"&&(this.value=\"aborted\")}static mergeArray(e,r){let n=[];for(let i of r){if(i.status===\"aborted\")return D;i.status===\"dirty\"&&e.dirty(),n.push(i.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,r){let n=[];for(let i of r){let a=await i.key,s=await i.value;n.push({key:a,value:s})}return t.mergeObjectSync(e,n)}static mergeObjectSync(e,r){let n={};for(let i of r){let{key:a,value:s}=i;if(a.status===\"aborted\"||s.status===\"aborted\")return D;a.status===\"dirty\"&&e.dirty(),s.status===\"dirty\"&&e.dirty(),a.value!==\"__proto__\"&&(typeof s.value<\"u\"||i.alwaysSet)&&(n[a.value]=s.value)}return{status:e.value,value:n}}},D=Object.freeze({status:\"aborted\"}),Vr=t=>({status:\"dirty\",value:t}),Le=t=>({status:\"valid\",value:t}),rc=t=>t.status===\"aborted\",nc=t=>t.status===\"dirty\",wr=t=>t.status===\"valid\",di=t=>typeof Promise<\"u\"&&t instanceof Promise;var q;(function(t){t.errToObj=e=>typeof e==\"string\"?{message:e}:e||{},t.toString=e=>typeof e==\"string\"?e:e?.message})(q||(q={}));var xt=class{constructor(e,r,n,i){this._cachedPath=[],this.parent=e,this.data=r,this._path=n,this._key=i}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}},K_=(t,e)=>{if(wr(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error(\"Validation failed but no issues detected.\");return{success:!1,get error(){if(this._error)return this._error;let r=new Ze(t.common.issues);return this._error=r,this._error}}};function z(t){if(!t)return{};let{errorMap:e,invalid_type_error:r,required_error:n,description:i}=t;if(e&&(r||n))throw new Error(`Can't use \"invalid_type_error\" or \"required_error\" in conjunction with custom error map.`);return e?{errorMap:e,description:i}:{errorMap:(s,o)=>{let{message:u}=t;return s.code===\"invalid_enum_value\"?{message:u??o.defaultError}:typeof o.data>\"u\"?{message:u??n??o.defaultError}:s.code!==\"invalid_type\"?{message:o.defaultError}:{message:u??r??o.defaultError}},description:i}}var H=class{get description(){return this._def.description}_getType(e){return Ft(e.data)}_getOrReturnCtx(e,r){return r||{common:e.parent.common,data:e.data,parsedType:Ft(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Re,ctx:{common:e.parent.common,data:e.data,parsedType:Ft(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let r=this._parse(e);if(di(r))throw new Error(\"Synchronous parse encountered promise.\");return r}_parseAsync(e){let r=this._parse(e);return Promise.resolve(r)}parse(e,r){let n=this.safeParse(e,r);if(n.success)return n.data;throw n.error}safeParse(e,r){let n={common:{issues:[],async:r?.async??!1,contextualErrorMap:r?.errorMap},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ft(e)},i=this._parseSync({data:e,path:n.path,parent:n});return K_(n,i)}\"~validate\"(e){let r={common:{issues:[],async:!!this[\"~standard\"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ft(e)};if(!this[\"~standard\"].async)try{let n=this._parseSync({data:e,path:[],parent:r});return wr(n)?{value:n.value}:{issues:r.common.issues}}catch(n){n?.message?.toLowerCase()?.includes(\"encountered\")&&(this[\"~standard\"].async=!0),r.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:r}).then(n=>wr(n)?{value:n.value}:{issues:r.common.issues})}async parseAsync(e,r){let n=await this.safeParseAsync(e,r);if(n.success)return n.data;throw n.error}async safeParseAsync(e,r){let n={common:{issues:[],contextualErrorMap:r?.errorMap,async:!0},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ft(e)},i=this._parse({data:e,path:n.path,parent:n}),a=await(di(i)?i:Promise.resolve(i));return K_(n,a)}refine(e,r){let n=i=>typeof r==\"string\"||typeof r>\"u\"?{message:r}:typeof r==\"function\"?r(i):r;return this._refinement((i,a)=>{let s=e(i),o=()=>a.addIssue({code:_.custom,...n(i)});return typeof Promise<\"u\"&&s instanceof Promise?s.then(u=>u?!0:(o(),!1)):s?!0:(o(),!1)})}refinement(e,r){return this._refinement((n,i)=>e(n)?!0:(i.addIssue(typeof r==\"function\"?r(n,i):r),!1))}_refinement(e){return new bt({schema:this,typeName:M.ZodEffects,effect:{type:\"refinement\",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this[\"~standard\"]={version:1,vendor:\"zod\",validate:r=>this[\"~validate\"](r)}}optional(){return yt.create(this,this._def)}nullable(){return Ut.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return ar.create(this)}promise(){return Er.create(this,this._def)}or(e){return Yr.create([this,e],this._def)}and(e){return en.create(this,e,this._def)}transform(e){return new bt({...z(this._def),schema:this,typeName:M.ZodEffects,effect:{type:\"transform\",transform:e}})}default(e){let r=typeof e==\"function\"?e:()=>e;return new sn({...z(this._def),innerType:this,defaultValue:r,typeName:M.ZodDefault})}brand(){return new Da({typeName:M.ZodBranded,type:this,...z(this._def)})}catch(e){let r=typeof e==\"function\"?e:()=>e;return new on({...z(this._def),innerType:this,catchValue:r,typeName:M.ZodCatch})}describe(e){let r=this.constructor;return new r({...this._def,description:e})}pipe(e){return La.create(this,e)}readonly(){return cn.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}},GI=/^c[^\\s-]{8,}$/i,JI=/^[0-9a-z]+$/,ZI=/^[0-9A-HJKMNP-TV-Z]{26}$/i,XI=/^[0-9a-fA-F]{8}\\b-[0-9a-fA-F]{4}\\b-[0-9a-fA-F]{4}\\b-[0-9a-fA-F]{4}\\b-[0-9a-fA-F]{12}$/i,YI=/^[a-z0-9_-]{21}$/i,e9=/^[A-Za-z0-9-_]+\\.[A-Za-z0-9-_]+\\.[A-Za-z0-9-_]*$/,t9=/^[-+]?P(?!$)(?:(?:[-+]?\\d+Y)|(?:[-+]?\\d+[.,]\\d+Y$))?(?:(?:[-+]?\\d+M)|(?:[-+]?\\d+[.,]\\d+M$))?(?:(?:[-+]?\\d+W)|(?:[-+]?\\d+[.,]\\d+W$))?(?:(?:[-+]?\\d+D)|(?:[-+]?\\d+[.,]\\d+D$))?(?:T(?=[\\d+-])(?:(?:[-+]?\\d+H)|(?:[-+]?\\d+[.,]\\d+H$))?(?:(?:[-+]?\\d+M)|(?:[-+]?\\d+[.,]\\d+M$))?(?:[-+]?\\d+(?:[.,]\\d+)?S)?)??$/,r9=/^(?!\\.)(?!.*\\.\\.)([A-Z0-9_'+\\-\\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\\-]*\\.)+[A-Z]{2,}$/i,n9=\"^(\\\\p{Extended_Pictographic}|\\\\p{Emoji_Component})+$\",Uf,i9=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,a9=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\\/(3[0-2]|[12]?[0-9])$/,s9=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,o9=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,c9=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,u9=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,G_=\"((\\\\d\\\\d[2468][048]|\\\\d\\\\d[13579][26]|\\\\d\\\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\\\d|30)|(02)-(0[1-9]|1\\\\d|2[0-8])))\",l9=new RegExp(`^${G_}$`);function J_(t){let e=\"[0-5]\\\\d\";t.precision?e=`${e}\\\\.\\\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\\\.\\\\d+)?`);let r=t.precision?\"+\":\"?\";return`([01]\\\\d|2[0-3]):[0-5]\\\\d(:${e})${r}`}function p9(t){return new RegExp(`^${J_(t)}$`)}function Z_(t){let e=`${G_}T${J_(t)}`,r=[];return r.push(t.local?\"Z?\":\"Z\"),t.offset&&r.push(\"([+-]\\\\d{2}:?\\\\d{2})\"),e=`${e}(${r.join(\"|\")})`,new RegExp(`^${e}$`)}function d9(t,e){return!!((e===\"v4\"||!e)&&i9.test(t)||(e===\"v6\"||!e)&&s9.test(t))}function f9(t,e){if(!e9.test(t))return!1;try{let[r]=t.split(\".\");if(!r)return!1;let n=r.replace(/-/g,\"+\").replace(/_/g,\"/\").padEnd(r.length+(4-r.length%4)%4,\"=\"),i=JSON.parse(atob(n));return!(typeof i!=\"object\"||i===null||\"typ\"in i&&i?.typ!==\"JWT\"||!i.alg||e&&i.alg!==e)}catch{return!1}}function h9(t,e){return!!((e===\"v4\"||!e)&&a9.test(t)||(e===\"v6\"||!e)&&o9.test(t))}var _r=class t extends H{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==P.string){let a=this._getOrReturnCtx(e);return k(a,{code:_.invalid_type,expected:P.string,received:a.parsedType}),D}let n=new Re,i;for(let a of this._def.checks)if(a.kind===\"min\")e.data.length<a.value&&(i=this._getOrReturnCtx(e,i),k(i,{code:_.too_small,minimum:a.value,type:\"string\",inclusive:!0,exact:!1,message:a.message}),n.dirty());else if(a.kind===\"max\")e.data.length>a.value&&(i=this._getOrReturnCtx(e,i),k(i,{code:_.too_big,maximum:a.value,type:\"string\",inclusive:!0,exact:!1,message:a.message}),n.dirty());else if(a.kind===\"length\"){let s=e.data.length>a.value,o=e.data.length<a.value;(s||o)&&(i=this._getOrReturnCtx(e,i),s?k(i,{code:_.too_big,maximum:a.value,type:\"string\",inclusive:!0,exact:!0,message:a.message}):o&&k(i,{code:_.too_small,minimum:a.value,type:\"string\",inclusive:!0,exact:!0,message:a.message}),n.dirty())}else if(a.kind===\"email\")r9.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"email\",code:_.invalid_string,message:a.message}),n.dirty());else if(a.kind===\"emoji\")Uf||(Uf=new RegExp(n9,\"u\")),Uf.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"emoji\",code:_.invalid_string,message:a.message}),n.dirty());else if(a.kind===\"uuid\")XI.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"uuid\",code:_.invalid_string,message:a.message}),n.dirty());else if(a.kind===\"nanoid\")YI.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"nanoid\",code:_.invalid_string,message:a.message}),n.dirty());else if(a.kind===\"cuid\")GI.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"cuid\",code:_.invalid_string,message:a.message}),n.dirty());else if(a.kind===\"cuid2\")JI.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"cuid2\",code:_.invalid_string,message:a.message}),n.dirty());else if(a.kind===\"ulid\")ZI.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"ulid\",code:_.invalid_string,message:a.message}),n.dirty());else if(a.kind===\"url\")try{new URL(e.data)}catch{i=this._getOrReturnCtx(e,i),k(i,{validation:\"url\",code:_.invalid_string,message:a.message}),n.dirty()}else a.kind===\"regex\"?(a.regex.lastIndex=0,a.regex.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"regex\",code:_.invalid_string,message:a.message}),n.dirty())):a.kind===\"trim\"?e.data=e.data.trim():a.kind===\"includes\"?e.data.includes(a.value,a.position)||(i=this._getOrReturnCtx(e,i),k(i,{code:_.invalid_string,validation:{includes:a.value,position:a.position},message:a.message}),n.dirty()):a.kind===\"toLowerCase\"?e.data=e.data.toLowerCase():a.kind===\"toUpperCase\"?e.data=e.data.toUpperCase():a.kind===\"startsWith\"?e.data.startsWith(a.value)||(i=this._getOrReturnCtx(e,i),k(i,{code:_.invalid_string,validation:{startsWith:a.value},message:a.message}),n.dirty()):a.kind===\"endsWith\"?e.data.endsWith(a.value)||(i=this._getOrReturnCtx(e,i),k(i,{code:_.invalid_string,validation:{endsWith:a.value},message:a.message}),n.dirty()):a.kind===\"datetime\"?Z_(a).test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{code:_.invalid_string,validation:\"datetime\",message:a.message}),n.dirty()):a.kind===\"date\"?l9.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{code:_.invalid_string,validation:\"date\",message:a.message}),n.dirty()):a.kind===\"time\"?p9(a).test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{code:_.invalid_string,validation:\"time\",message:a.message}),n.dirty()):a.kind===\"duration\"?t9.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"duration\",code:_.invalid_string,message:a.message}),n.dirty()):a.kind===\"ip\"?d9(e.data,a.version)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"ip\",code:_.invalid_string,message:a.message}),n.dirty()):a.kind===\"jwt\"?f9(e.data,a.alg)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"jwt\",code:_.invalid_string,message:a.message}),n.dirty()):a.kind===\"cidr\"?h9(e.data,a.version)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"cidr\",code:_.invalid_string,message:a.message}),n.dirty()):a.kind===\"base64\"?c9.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"base64\",code:_.invalid_string,message:a.message}),n.dirty()):a.kind===\"base64url\"?u9.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"base64url\",code:_.invalid_string,message:a.message}),n.dirty()):K.assertNever(a);return{status:n.value,value:e.data}}_regex(e,r,n){return this.refinement(i=>e.test(i),{validation:r,code:_.invalid_string,...q.errToObj(n)})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:\"email\",...q.errToObj(e)})}url(e){return this._addCheck({kind:\"url\",...q.errToObj(e)})}emoji(e){return this._addCheck({kind:\"emoji\",...q.errToObj(e)})}uuid(e){return this._addCheck({kind:\"uuid\",...q.errToObj(e)})}nanoid(e){return this._addCheck({kind:\"nanoid\",...q.errToObj(e)})}cuid(e){return this._addCheck({kind:\"cuid\",...q.errToObj(e)})}cuid2(e){return this._addCheck({kind:\"cuid2\",...q.errToObj(e)})}ulid(e){return this._addCheck({kind:\"ulid\",...q.errToObj(e)})}base64(e){return this._addCheck({kind:\"base64\",...q.errToObj(e)})}base64url(e){return this._addCheck({kind:\"base64url\",...q.errToObj(e)})}jwt(e){return this._addCheck({kind:\"jwt\",...q.errToObj(e)})}ip(e){return this._addCheck({kind:\"ip\",...q.errToObj(e)})}cidr(e){return this._addCheck({kind:\"cidr\",...q.errToObj(e)})}datetime(e){return typeof e==\"string\"?this._addCheck({kind:\"datetime\",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:\"datetime\",precision:typeof e?.precision>\"u\"?null:e?.precision,offset:e?.offset??!1,local:e?.local??!1,...q.errToObj(e?.message)})}date(e){return this._addCheck({kind:\"date\",message:e})}time(e){return typeof e==\"string\"?this._addCheck({kind:\"time\",precision:null,message:e}):this._addCheck({kind:\"time\",precision:typeof e?.precision>\"u\"?null:e?.precision,...q.errToObj(e?.message)})}duration(e){return this._addCheck({kind:\"duration\",...q.errToObj(e)})}regex(e,r){return this._addCheck({kind:\"regex\",regex:e,...q.errToObj(r)})}includes(e,r){return this._addCheck({kind:\"includes\",value:e,position:r?.position,...q.errToObj(r?.message)})}startsWith(e,r){return this._addCheck({kind:\"startsWith\",value:e,...q.errToObj(r)})}endsWith(e,r){return this._addCheck({kind:\"endsWith\",value:e,...q.errToObj(r)})}min(e,r){return this._addCheck({kind:\"min\",value:e,...q.errToObj(r)})}max(e,r){return this._addCheck({kind:\"max\",value:e,...q.errToObj(r)})}length(e,r){return this._addCheck({kind:\"length\",value:e,...q.errToObj(r)})}nonempty(e){return this.min(1,q.errToObj(e))}trim(){return new t({...this._def,checks:[...this._def.checks,{kind:\"trim\"}]})}toLowerCase(){return new t({...this._def,checks:[...this._def.checks,{kind:\"toLowerCase\"}]})}toUpperCase(){return new t({...this._def,checks:[...this._def.checks,{kind:\"toUpperCase\"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind===\"datetime\")}get isDate(){return!!this._def.checks.find(e=>e.kind===\"date\")}get isTime(){return!!this._def.checks.find(e=>e.kind===\"time\")}get isDuration(){return!!this._def.checks.find(e=>e.kind===\"duration\")}get isEmail(){return!!this._def.checks.find(e=>e.kind===\"email\")}get isURL(){return!!this._def.checks.find(e=>e.kind===\"url\")}get isEmoji(){return!!this._def.checks.find(e=>e.kind===\"emoji\")}get isUUID(){return!!this._def.checks.find(e=>e.kind===\"uuid\")}get isNANOID(){return!!this._def.checks.find(e=>e.kind===\"nanoid\")}get isCUID(){return!!this._def.checks.find(e=>e.kind===\"cuid\")}get isCUID2(){return!!this._def.checks.find(e=>e.kind===\"cuid2\")}get isULID(){return!!this._def.checks.find(e=>e.kind===\"ulid\")}get isIP(){return!!this._def.checks.find(e=>e.kind===\"ip\")}get isCIDR(){return!!this._def.checks.find(e=>e.kind===\"cidr\")}get isBase64(){return!!this._def.checks.find(e=>e.kind===\"base64\")}get isBase64url(){return!!this._def.checks.find(e=>e.kind===\"base64url\")}get minLength(){let e=null;for(let r of this._def.checks)r.kind===\"min\"&&(e===null||r.value>e)&&(e=r.value);return e}get maxLength(){let e=null;for(let r of this._def.checks)r.kind===\"max\"&&(e===null||r.value<e)&&(e=r.value);return e}};_r.create=t=>new _r({checks:[],typeName:M.ZodString,coerce:t?.coerce??!1,...z(t)});function m9(t,e){let r=(t.toString().split(\".\")[1]||\"\").length,n=(e.toString().split(\".\")[1]||\"\").length,i=r>n?r:n,a=Number.parseInt(t.toFixed(i).replace(\".\",\"\")),s=Number.parseInt(e.toFixed(i).replace(\".\",\"\"));return a%s/10**i}var Kr=class t extends H{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==P.number){let a=this._getOrReturnCtx(e);return k(a,{code:_.invalid_type,expected:P.number,received:a.parsedType}),D}let n,i=new Re;for(let a of this._def.checks)a.kind===\"int\"?K.isInteger(e.data)||(n=this._getOrReturnCtx(e,n),k(n,{code:_.invalid_type,expected:\"integer\",received:\"float\",message:a.message}),i.dirty()):a.kind===\"min\"?(a.inclusive?e.data<a.value:e.data<=a.value)&&(n=this._getOrReturnCtx(e,n),k(n,{code:_.too_small,minimum:a.value,type:\"number\",inclusive:a.inclusive,exact:!1,message:a.message}),i.dirty()):a.kind===\"max\"?(a.inclusive?e.data>a.value:e.data>=a.value)&&(n=this._getOrReturnCtx(e,n),k(n,{code:_.too_big,maximum:a.value,type:\"number\",inclusive:a.inclusive,exact:!1,message:a.message}),i.dirty()):a.kind===\"multipleOf\"?m9(e.data,a.value)!==0&&(n=this._getOrReturnCtx(e,n),k(n,{code:_.not_multiple_of,multipleOf:a.value,message:a.message}),i.dirty()):a.kind===\"finite\"?Number.isFinite(e.data)||(n=this._getOrReturnCtx(e,n),k(n,{code:_.not_finite,message:a.message}),i.dirty()):K.assertNever(a);return{status:i.value,value:e.data}}gte(e,r){return this.setLimit(\"min\",e,!0,q.toString(r))}gt(e,r){return this.setLimit(\"min\",e,!1,q.toString(r))}lte(e,r){return this.setLimit(\"max\",e,!0,q.toString(r))}lt(e,r){return this.setLimit(\"max\",e,!1,q.toString(r))}setLimit(e,r,n,i){return new t({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:n,message:q.toString(i)}]})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:\"int\",message:q.toString(e)})}positive(e){return this._addCheck({kind:\"min\",value:0,inclusive:!1,message:q.toString(e)})}negative(e){return this._addCheck({kind:\"max\",value:0,inclusive:!1,message:q.toString(e)})}nonpositive(e){return this._addCheck({kind:\"max\",value:0,inclusive:!0,message:q.toString(e)})}nonnegative(e){return this._addCheck({kind:\"min\",value:0,inclusive:!0,message:q.toString(e)})}multipleOf(e,r){return this._addCheck({kind:\"multipleOf\",value:e,message:q.toString(r)})}finite(e){return this._addCheck({kind:\"finite\",message:q.toString(e)})}safe(e){return this._addCheck({kind:\"min\",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:q.toString(e)})._addCheck({kind:\"max\",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:q.toString(e)})}get minValue(){let e=null;for(let r of this._def.checks)r.kind===\"min\"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(let r of this._def.checks)r.kind===\"max\"&&(e===null||r.value<e)&&(e=r.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind===\"int\"||e.kind===\"multipleOf\"&&K.isInteger(e.value))}get isFinite(){let e=null,r=null;for(let n of this._def.checks){if(n.kind===\"finite\"||n.kind===\"int\"||n.kind===\"multipleOf\")return!0;n.kind===\"min\"?(r===null||n.value>r)&&(r=n.value):n.kind===\"max\"&&(e===null||n.value<e)&&(e=n.value)}return Number.isFinite(r)&&NumberThu, 29 Jan 2026 21:34:58 GMT express-session deprecated req.secret; provide secret option at node:internal/modules/cjs/loader:1706:14","attributes":{"level":"error"},"tags":{"project":"29c6c2c4-ea10-4fe6-8901-1198a13520db","environment":"9a47f9fb-0d50-4031-a85e-16db1d46fb86","service":"09a1965e-88d6-44ee-9836-14176d4bb0b5","deployment":"e78c90dd-bc00-48f5-9312-8a8fa977b2c2","replica":"68b779c1-91b1-4ca6-88f4-a907899be5f1"},"timestamp":"2026-01-29T21:34:59.426441746Z"},{"message":"/app/dist/index.cjs:71","attributes":{"level":"error"},"tags":{"project":"29c6c2c4-ea10-4fe6-8901-1198a13520db","environment":"9a47f9fb-0d50-4031-a85e-16db1d46fb86","service":"09a1965e-88d6-44ee-9836-14176d4bb0b5","deployment":"e78c90dd-bc00-48f5-9312-8a8fa977b2c2","replica":"68b779c1-91b1-4ca6-88f4-a907899be5f1"},"timestamp":"2026-01-29T21:34:59.426449034Z"},{"message":"\t\t`;await r.execute(g`CREATE SCHEMA IF NOT EXISTS ${g.identifier(a)}`),await r.execute(s);let u=(await r.all(g`select id, hash, created_at from ${g.identifier(a)}.${g.identifier(i)} order by created_at desc limit 1`))[0];await r.transaction(async c=>{for await(let l of e)if(!u||Number(u.created_at)<l.folderMillis){for(let p of l.sql)await c.execute(g.raw(p));await c.execute(g`insert into ${g.identifier(a)}.${g.identifier(i)} (\"hash\", \"created_at\") values(${l.hash}, ${l.folderMillis})`)}})}escapeName(e){return`\"${e}\"`}escapeParam(e){return`$${e+1}`}escapeString(e){return`'${e.replace(/'/g,\"''\")}'`}buildWithCTE(e){if(!e?.length)return;let r=[g`with `];for(let[n,i]of e.entries())r.push(g`${g.identifier(i._.alias)} as (${i._.sql})`),n<e.length-1&&r.push(g`, `);return r.push(g` `),g.join(r)}buildDeleteQuery({table:e,where:r,returning:n,withList:i}){let a=this.buildWithCTE(i),s=n?g` returning ${this.buildSelection(n,{isSingleTable:!0})}`:void 0,o=r?g` where ${r}`:void 0;return g`${a}delete from ${e}${o}${s}`}buildUpdateSet(e,r){let n=e[A.Symbol.Columns],i=Object.keys(n).filter(s=>r[s]!==void 0||n[s]?.onUpdateFn!==void 0),a=i.length;return g.join(i.flatMap((s,o)=>{let u=n[s],c=r[s]??g.param(u.onUpdateFn(),u),l=g`${g.identifier(this.casing.getColumnCasing(u))} = ${c}`;return o<a-1?[l,g.raw(\", \")]:[l]}))}buildUpdateQuery({table:e,set:r,where:n,returning:i,withList:a,from:s,joins:o}){let u=this.buildWithCTE(a),c=e[Te.Symbol.Name],l=e[Te.Symbol.Schema],p=e[Te.Symbol.OriginalName],d=c===p?void 0:c,f=g`${l?g`${g.identifier(l)}.`:void 0}${g.identifier(p)}${d&&g` ${g.identifier(d)}`}`,y=this.buildUpdateSet(e,r),m=s&&g.join([g.raw(\" from \"),this.buildFromTable(s)]),x=this.buildJoins(o),w=i?g` returning ${this.buildSelection(i,{isSingleTable:!s})}`:void 0,T=n?g` where ${n}`:void 0;return g`${u}update ${f} set ${y}${m}${x}${T}${w}`}buildSelection(e,{isSingleTable:r=!1}={}){let n=e.length,i=e.flatMap(({field:a},s)=>{let o=[];if(b(a,O.Aliased)&&a.isSelectionField)o.push(g.identifier(a.fieldAlias));else if(b(a,O.Aliased)||b(a,O)){let u=b(a,O.Aliased)?a.sql:a;r?o.push(new O(u.queryChunks.map(c=>b(c,E)?g.identifier(this.casing.getColumnCasing(c)):c))):o.push(u),b(a,O.Aliased)&&o.push(g` as ${g.identifier(a.fieldAlias)}`)}else b(a,J)&&(r?o.push(g.identifier(this.casing.getColumnCasing(a))):o.push(a));return s<n-1&&o.push(g`, `),o});return g.join(i)}buildJoins(e){if(!e||e.length===0)return;let r=[];for(let[n,i]of e.entries()){n===0&&r.push(g` `);let a=i.table,s=i.lateral?g` lateral`:void 0;if(b(a,Te)){let o=a[Te.Symbol.Name],u=a[Te.Symbol.Schema],c=a[Te.Symbol.OriginalName],l=o===c?void 0:i.alias;r.push(g`${g.raw(i.joinType)} join${s} ${u?g`${g.identifier(u)}.`:void 0}${g.identifier(c)}${l&&g` ${g.identifier(l)}`} on ${i.on}`)}else if(b(a,Ue)){let o=a[te].name,u=a[te].schema,c=a[te].originalName,l=o===c?void 0:i.alias;r.push(g`${g.raw(i.joinType)} join${s} ${u?g`${g.identifier(u)}.`:void 0}${g.identifier(c)}${l&&g` ${g.identifier(l)}`} on ${i.on}`)}else r.push(g`${g.raw(i.joinType)} join${s} ${a} on ${i.on}`);n<e.length-1&&r.push(g` `)}return g.join(r)}buildFromTable(e){if(b(e,A)&&e[A.Symbol.OriginalName]!==e[A.Symbol.Name]){let r=g`${g.identifier(e[A.Symbol.OriginalName])}`;return e[A.Symbol.Schema]&&(r=g`${g.identifier(e[A.Symbol.Schema])}.${r}`),g`${r} ${g.identifier(e[A.Symbol.Name])}`}return e}buildSelectQuery({withList:e,fields:r,fieldsFlat:n,where:i,having:a,table:s,joins:o,orderBy:u,groupBy:c,limit:l,offset:p,lockingClause:d,distinct:f,setOperators:y}){let m=n??gt(r);for(let ne of m)if(b(ne.field,J)&&We(ne.field.table)!==(b(s,ye)?s._.alias:b(s,oi)?s[te].name:b(s,O)?void 0:We(s))&&!(he=>o?.some(({alias:et})=>et===(he[A.Symbol.IsAlias]?We(he):he[A.Symbol.BaseName])))(ne.field.table)){let he=We(ne.field.table);throw new Error(`Your \"${ne.path.join(\"->\")}\" field references a column \"${he}\".\"${ne.field.name}\", but the table \"${he}\" is not part of the query! Did you forget to join it?`)}let x=!o||o.length===0,w=this.buildWithCTE(e),T;f&&(T=f===!0?g` distinct`:g` distinct on (${g.join(f.on,g`, `)})`);let S=this.buildSelection(m,{isSingleTable:x}),C=this.buildFromTable(s),L=this.buildJoins(o),j=i?g` where ${i}`:void 0,R=a?g` having ${a}`:void 0,N;u&&u.length>0&&(N=g` order by ${g.join(u,g`, `)}`);let Q;c&&c.length>0&&(Q=g` group by ${g.join(c,g`, `)}`);let fe=typeof l==\"object\"||typeof l==\"number\"&&l>=0?g` limit ${l}`:void 0,_t=p?g` offset ${p}`:void 0,qe=g.empty();if(d){let ne=g` for ${g.raw(d.strength)}`;d.config.of&&ne.append(g` of ${g.join(Array.isArray(d.config.of)?d.config.of:[d.config.of],g`, `)}`),d.config.noWait?ne.append(g` no wait`):d.config.skipLocked&&ne.append(g` skip locked`),qe.append(ne)}let se=g`${w}select${T} ${S} from ${C}${L}${j}${Q}${R}${N}${fe}${_t}${qe}`;return y.length>0?this.buildSetOperations(se,y):se}buildSetOperations(e,r){let[n,...i]=r;if(!n)throw new Error(\"Cannot pass undefined values to any set operator\");return i.length===0?this.buildSetOperationQuery({leftSelect:e,setOperator:n}):this.buildSetOperations(this.buildSetOperationQuery({leftSelect:e,setOperator:n}),i)}buildSetOperationQuery({leftSelect:e,setOperator:{type:r,isAll:n,rightSelect:i,limit:a,orderBy:s,offset:o}}){let u=g`(${e.getSQL()}) `,c=g`(${i.getSQL()})`,l;if(s&&s.length>0){let y=[];for(let m of s)if(b(m,E))y.push(g.identifier(m.name));else if(b(m,O)){for(let x=0;x<m.queryChunks.length;x++){let w=m.queryChunks[x];b(w,E)&&(m.queryChunks[x]=g.identifier(w.name))}y.push(g`${m}`)}else y.push(g`${m}`);l=g` order by ${g.join(y,g`, `)} `}let p=typeof a==\"object\"||typeof a==\"number\"&&a>=0?g` limit ${a}`:void 0,d=g.raw(`${r} ${n?\"all \":\"\"}`),f=o?g` offset ${o}`:void 0;return g`${u}${d}${c}${l}${p}${f}`}buildInsertQuery({table:e,values:r,onConflict:n,returning:i,withList:a,select:s,overridingSystemValue_:o}){let u=[],c=e[A.Symbol.Columns],l=Object.entries(c).filter(([w,T])=>!T.shouldDisableInsert()),p=l.map(([,w])=>g.identifier(this.casing.getColumnCasing(w)));if(s){let w=r;b(w,O)?u.push(w):u.push(w.getSQL())}else{let w=r;u.push(g.raw(\"values \"));for(let[T,S]of w.entries()){let C=[];for(let[L,j]of l){let R=S[L];if(R===void 0||b(R,Ge)&&R.value===void 0)if(j.defaultFn!==void 0){let N=j.defaultFn(),Q=b(N,O)?N:g.param(N,j);C.push(Q)}else if(!j.default&&j.onUpdateFn!==void 0){let N=j.onUpdateFn(),Q=b(N,O)?N:g.param(N,j);C.push(Q)}else C.push(g`default`);else C.push(R)}u.push(C),T<w.length-1&&u.push(g`, `)}}let d=this.buildWithCTE(a),f=g.join(u),y=i?g` returning ${this.buildSelection(i,{isSingleTable:!0})}`:void 0,m=n?g` on conflict ${n}`:void 0,x=o===!0?g`overriding system value `:void 0;return g`${d}insert into ${e} ${p} ${x}${f}${m}${y}`}buildRefreshMaterializedViewQuery({view:e,concurrently:r,withNoData:n}){let i=r?g` concurrently`:void 0,a=n?g` with no data`:void 0;return g`refresh materialized view${i} ${e}${a}`}prepareTyping(e){return b(e,Sa)||b(e,_a)?\"json\":b(e,Ea)?\"decimal\":b(e,Ta)?\"time\":b(e,ka)||b(e,Aa)?\"timestamp\":b(e,ba)||b(e,wa)?\"date\":b(e,Ca)?\"uuid\":\"none\"}sqlToQuery(e,r){return e.toQuery({casing:this.casing,escapeName:this.escapeName,escapeParam:this.escapeParam,escapeString:this.escapeString,prepareTyping:this.prepareTyping,invokeSource:r})}buildRelationalQueryWithoutPK({fullSchema:e,schema:r,tableNamesMap:n,table:i,tableConfig:a,queryConfig:s,tableAlias:o,nestedQueryRelation:u,joinOn:c}){let l=[],p,d,f=[],y,m=[];if(s===!0)l=Object.entries(a.columns).map(([T,S])=>({dbKey:S.name,tsKey:T,field:Dt(S,o),relationTableTsKey:void 0,isJson:!1,selection:[]}));else{let w=Object.fromEntries(Object.entries(a.columns).map(([R,N])=>[R,Dt(N,o)]));if(s.where){let R=typeof s.where==\"function\"?s.where(w,F_()):s.where;y=R&&ga(R,o)}let T=[],S=[];if(s.columns){let R=!1;for(let[N,Q]of Object.entries(s.columns))Q!==void 0&&N in a.columns&&(!R&&Q===!0&&(R=!0),S.push(N));S.length>0&&(S=R?S.filter(N=>s.columns?.[N]===!0):Object.keys(a.columns).filter(N=>!S.includes(N)))}else S=Object.keys(a.columns);for(let R of S){let N=a.columns[R];T.push({tsKey:R,value:N})}let C=[];s.with&&(C=Object.entries(s.with).filter(R=>!!R[1]).map(([R,N])=>({tsKey:R,queryConfig:N,relation:a.relations[R]})));let L;if(s.extras){L=typeof s.extras==\"function\"?s.extras(w,{sql:g}):s.extras;for(let[R,N]of Object.entries(L))T.push({tsKey:R,value:pd(N,o)})}for(let{tsKey:R,value:N}of T)l.push({dbKey:b(N,O.Aliased)?N.fieldAlias:a.columns[R].name,tsKey:R,field:b(N,J)?Dt(N,o):N,relationTableTsKey:void 0,isJson:!1,selection:[]});let j=typeof s.orderBy==\"function\"?s.orderBy(w,$_()):s.orderBy??[];Array.isArray(j)||(j=[j]),f=j.map(R=>b(R,J)?Dt(R,o):ga(R,o)),p=s.limit,d=s.offset;for(let{tsKey:R,queryConfig:N,relation:Q}of C){let fe=B_(r,n,Q),_t=Hr(Q.referencedTable),qe=n[_t],se=`${o}_${R}`,ne=Pa(...fe.fields.map((Ht,qi)=>kt(Dt(fe.references[qi],se),Dt(Ht,o)))),he=this.buildRelationalQueryWithoutPK({fullSchema:e,schema:r,tableNamesMap:n,table:e[qe],tableConfig:r[qe],queryConfig:b(Q,xr)?N===!0?{limit:1}:{...N,limit:1}:N,tableAlias:se,joinOn:ne,nestedQueryRelation:Q}),et=g`${g.identifier(se)}.${g.identifier(\"data\")}`.as(R);m.push({on:g`true`,table:new ye(he.sql,{},se),alias:se,joinType:\"left\",lateral:!0}),l.push({dbKey:R,tsKey:R,field:et,relationTableTsKey:qe,isJson:!0,selection:he.selection})}}if(l.length===0)throw new xa({message:`No fields selected for table \"${a.tsName}\" (\"${o}\")`});let x;if(y=Pa(c,y),u){let w=g`json_build_array(${g.join(l.map(({field:C,tsKey:L,isJson:j})=>j?g`${g.identifier(`${o}_${L}`)}.${g.identifier(\"data\")}`:b(C,O.Aliased)?C.sql:C),g`, `)})`;b(u,Oa)&&(w=g`coalesce(json_agg(${w}${f.length>0?g` order by ${g.join(f,g`, `)}`:void 0}), '[]'::json)`);let T=[{dbKey:\"data\",tsKey:\"data\",field:w.as(\"data\"),isJson:!0,relationTableTsKey:a.tsName,selection:l}];p!==void 0||d!==void 0||f.length>0?(x=this.buildSelectQuery({table:ma(i,o),fields:{},fieldsFlat:[{path:[],field:g.raw(\"*\")}],where:y,limit:p,offset:d,orderBy:f,setOperators:[]}),y=void 0,p=void 0,d=void 0,f=[]):x=ma(i,o),x=this.buildSelectQuery({table:b(x,Te)?x:new ye(x,{},o),fields:{},fieldsFlat:T.map(({field:C})=>({path:[],field:b(C,J)?Dt(C,o):C})),joins:m,where:y,limit:p,offset:d,orderBy:f,setOperators:[]})}else x=this.buildSelectQuery({table:ma(i,o),fields:{},fieldsFlat:l.map(({field:w})=>({path:[],field:b(w,J)?Dt(w,o):w})),joins:m,where:y,limit:p,offset:d,orderBy:f,setOperators:[]});return{tableTsKey:a.tsName,sql:x,selection:l}}};var zo=class{static[h]=\"TypedQueryBuilder\";getSelectedFields(){return this._.selectedFields}};var De=class{static[h]=\"PgSelectBuilder\";fields;session;dialect;withList=[];distinct;constructor(e){this.fields=e.fields,this.session=e.session,this.dialect=e.dialect,e.withList&&(this.withList=e.withList),this.distinct=e.distinct}authToken;setToken(e){return this.authToken=e,this}from(e){let r=!!this.fields,n=e,i;return this.fields?i=this.fields:b(n,ye)?i=Object.fromEntries(Object.keys(n._.selectedFields).map(a=>[a,n[a]])):b(n,oi)?i=n[te].selectedFields:b(n,O)?i={}:i=qo(n),new Ho({table:n,fields:i,isPartialSelect:r,session:this.session,dialect:this.dialect,withList:this.withList,distinct:this.distinct}).setToken(this.authToken)}},If=class extends zo{static[h]=\"PgSelectQueryBuilder\";_;config;joinsNotNullableMap;tableName;isPartialSelect;session;dialect;constructor({table:e,fields:r,isPartialSelect:n,session:i,dialect:a,withList:s,distinct:o}){super(),this.config={withList:s,table:e,fields:{...r},distinct:o,setOperators:[]},this.isPartialSelect=n,this.session=i,this.dialect=a,this._={selectedFields:r},this.tableName=er(e),this.joinsNotNullableMap=typeof this.tableName==\"string\"?{[this.tableName]:!0}:{}}createJoin(e){return(r,n)=>{let i=this.tableName,a=er(r);if(typeof a==\"string\"&&this.config.joins?.some(s=>s.alias===a))throw new Error(`Alias \"${a}\" is already used in this query`);if(!this.isPartialSelect&&(Object.keys(this.joinsNotNullableMap).length===1&&typeof i==\"string\"&&(this.config.fields={[i]:this.config.fields}),typeof a==\"string\"&&!b(r,O))){let s=b(r,ye)?r._.selectedFields:b(r,Ue)?r[te].selectedFields:r[A.Symbol.Columns];this.config.fields[a]=s}if(typeof n==\"function\"&&(n=n(new Proxy(this.config.fields,new de({sqlAliasedBehavior:\"sql\",sqlBehavior:\"sql\"})))),this.config.joins||(this.config.joins=[]),this.config.joins.push({on:n,table:r,joinType:e,alias:a}),typeof a==\"string\")switch(e){case\"left\":{this.joinsNotNullableMap[a]=!1;break}case\"right\":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([s])=>[s,!1])),this.joinsNotNullableMap[a]=!0;break}case\"inner\":{this.joinsNotNullableMap[a]=!0;break}case\"full\":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([s])=>[s,!1])),this.joinsNotNullableMap[a]=!1;break}}return this}}leftJoin=this.createJoin(\"left\");rightJoin=this.createJoin(\"right\");innerJoin=this.createJoin(\"inner\");fullJoin=this.createJoin(\"full\");createSetOperator(e,r){return n=>{let i=typeof n==\"function\"?n(MI()):n;if(!va(this.getSelectedFields(),i.getSelectedFields()))throw new Error(\"Set operator error (union / intersect / except): selected fields are not the same or are in a different order\");return this.config.setOperators.push({type:e,isAll:r,rightSelect:i}),this}}union=this.createSetOperator(\"union\",!1);unionAll=this.createSetOperator(\"union\",!0);intersect=this.createSetOperator(\"intersect\",!1);intersectAll=this.createSetOperator(\"intersect\",!0);except=this.createSetOperator(\"except\",!1);exceptAll=this.createSetOperator(\"except\",!0);addSetOperators(e){return this.config.setOperators.push(...e),this}where(e){return typeof e==\"function\"&&(e=e(new Proxy(this.config.fields,new de({sqlAliasedBehavior:\"sql\",sqlBehavior:\"sql\"})))),this.config.where=e,this}having(e){return typeof e==\"function\"&&(e=e(new Proxy(this.config.fields,new de({sqlAliasedBehavior:\"sql\",sqlBehavior:\"sql\"})))),this.config.having=e,this}groupBy(...e){if(typeof e[0]==\"function\"){let r=e[0](new Proxy(this.config.fields,new de({sqlAliasedBehavior:\"alias\",sqlBehavior:\"sql\"})));this.config.groupBy=Array.isArray(r)?r:[r]}else this.config.groupBy=e;return this}orderBy(...e){if(typeof e[0]==\"function\"){let r=e[0](new Proxy(this.config.fields,new de({sqlAliasedBehavior:\"alias\",sqlBehavior:\"sql\"}))),n=Array.isArray(r)?r:[r];this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=n:this.config.orderBy=n}else{let r=e;this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=r:this.config.orderBy=r}return this}limit(e){return this.config.setOperators.length>0?this.config.setOperators.at(-1).limit=e:this.config.limit=e,this}offset(e){return this.config.setOperators.length>0?this.config.setOperators.at(-1).offset=e:this.config.offset=e,this}for(e,r={}){return this.config.lockingClause={strength:e,config:r},this}getSQL(){return this.dialect.buildSelectQuery(this.config)}toSQL(){let{typings:e,...r}=this.dialect.sqlToQuery(this.getSQL());return r}as(e){return new Proxy(new ye(this.getSQL(),this.config.fields,e),new de({alias:e,sqlAliasedBehavior:\"alias\",sqlBehavior:\"error\"}))}getSelectedFields(){return new Proxy(this.config.fields,new de({alias:this.tableName,sqlAliasedBehavior:\"alias\",sqlBehavior:\"error\"}))}$dynamic(){return this}},Ho=class extends If{static[h]=\"PgSelect\";_prepare(e){let{session:r,config:n,dialect:i,joinsNotNullableMap:a,authToken:s}=this;if(!r)throw new Error(\"Cannot execute a query on a query builder. Please use a database instance instead.\");return ee.startActiveSpan(\"drizzle.prepareQuery\",()=>{let o=gt(n.fields),u=r.prepareQuery(i.sqlToQuery(this.getSQL()),o,e,!0);return u.joinsNotNullableMap=a,u.setToken(s)})}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>ee.startActiveSpan(\"drizzle.operation\",()=>this._prepare().execute(e,this.authToken))};$1(Ho,[je]);function ci(t,e){return(r,n,...i)=>{let a=[n,...i].map(s=>({type:t,isAll:e,rightSelect:s}));for(let s of a)if(!va(r.getSelectedFields(),s.rightSelect.getSelectedFields()))throw new Error(\"Set operator error (union / intersect / except): selected fields are not the same or are in a different order\");return r.addSetOperators(a)}}var MI=()=>({union:FI,unionAll:$I,intersect:UI,intersectAll:BI,except:zI,exceptAll:HI}),FI=ci(\"union\",!1),$I=ci(\"union\",!0),UI=ci(\"intersect\",!1),BI=ci(\"intersect\",!0),zI=ci(\"except\",!1),HI=ci(\"except\",!0);var ui=class{static[h]=\"PgQueryBuilder\";dialect;dialectConfig;constructor(e){this.dialect=b(e,br)?e:void 0,this.dialectConfig=b(e,br)?void 0:e}$with=(e,r)=>{let n=this;return{as:a=>(typeof a==\"function\"&&(a=a(n)),new Proxy(new ni(a.getSQL(),r??(\"getSelectedFields\"in a?a.getSelectedFields()??{}:{}),e,!0),new de({alias:e,sqlAliasedBehavior:\"alias\",sqlBehavior:\"error\"})))}};with(...e){let r=this;function n(s){return new De({fields:s??void 0,session:void 0,dialect:r.getDialect(),withList:e})}function i(s){return new De({fields:s??void 0,session:void 0,dialect:r.getDialect(),distinct:!0})}function a(s,o){return new De({fields:o??void 0,session:void 0,dialect:r.getDialect(),distinct:{on:s}})}return{select:n,selectDistinct:i,selectDistinctOn:a}}select(e){return new De({fields:e??void 0,session:void 0,dialect:this.getDialect()})}selectDistinct(e){return new De({fields:e??void 0,session:void 0,dialect:this.getDialect(),distinct:!0})}selectDistinctOn(e,r){return new De({fields:r??void 0,session:void 0,dialect:this.getDialect(),distinct:{on:e}})}getDialect(){return this.dialect||(this.dialect=new br(this.dialectConfig)),this.dialect}};var Ra=class{constructor(e,r,n,i,a){this.table=e,this.session=r,this.dialect=n,this.withList=i,this.overridingSystemValue_=a}static[h]=\"PgInsertBuilder\";authToken;setToken(e){return this.authToken=e,this}overridingSystemValue(){return this.overridingSystemValue_=!0,this}values(e){if(e=Array.isArray(e)?e:[e],e.length===0)throw new Error(\"values() must be called with at least one value\");let r=e.map(n=>{let i={},a=this.table[A.Symbol.Columns];for(let s of Object.keys(n)){let o=n[s];i[s]=b(o,O)?o:new Ge(o,a[s])}return i});return new Qo(this.table,r,this.session,this.dialect,this.withList,!1,this.overridingSystemValue_).setToken(this.authToken)}select(e){let r=typeof e==\"function\"?e(new ui):e;if(!b(r,O)&&!va(this.table[Io],r._.selectedFields))throw new Error(\"Insert select error: selected fields are not the same or are in a different order compared to the table definition\");return new Qo(this.table,r,this.session,this.dialect,this.withList,!0)}},Qo=class extends je{constructor(e,r,n,i,a,s,o){super(),this.session=n,this.dialect=i,this.config={table:e,values:r,withList:a,select:s,overridingSystemValue_:o}}static[h]=\"PgInsert\";config;returning(e=this.config.table[A.Symbol.Columns]){return this.config.returningFields=e,this.config.returning=gt(e),this}onConflictDoNothing(e={}){if(e.target===void 0)this.config.onConflict=g`do nothing`;else{let r=\"\";r=Array.isArray(e.target)?e.target.map(i=>this.dialect.escapeName(this.dialect.casing.getColumnCasing(i))).join(\",\"):this.dialect.escapeName(this.dialect.casing.getColumnCasing(e.target));let n=e.where?g` where ${e.where}`:void 0;this.config.onConflict=g`(${g.raw(r)})${n} do nothing`}return this}onConflictDoUpdate(e){if(e.where&&(e.targetWhere||e.setWhere))throw new Error('You cannot use both \"where\" and \"targetWhere\"/\"setWhere\" at the same time - \"where\" is deprecated, use \"targetWhere\" or \"setWhere\" instead.');let r=e.where?g` where ${e.where}`:void 0,n=e.targetWhere?g` where ${e.targetWhere}`:void 0,i=e.setWhere?g` where ${e.setWhere}`:void 0,a=this.dialect.buildUpdateSet(this.config.table,No(this.config.table,e.set)),s=\"\";return s=Array.isArray(e.target)?e.target.map(o=>this.dialect.escapeName(this.dialect.casing.getColumnCasing(o))).join(\",\"):this.dialect.escapeName(this.dialect.casing.getColumnCasing(e.target)),this.config.onConflict=g`(${g.raw(s)})${n} do update set ${a}${r}${i}`,this}getSQL(){return this.dialect.buildInsertQuery(this.config)}toSQL(){let{typings:e,...r}=this.dialect.sqlToQuery(this.getSQL());return r}_prepare(e){return ee.startActiveSpan(\"drizzle.prepareQuery\",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,e,!0))}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>ee.startActiveSpan(\"drizzle.operation\",()=>this._prepare().execute(e,this.authToken));getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new de({alias:We(this.config.table),sqlAliasedBehavior:\"alias\",sqlBehavior:\"error\"})):void 0}$dynamic(){return this}};var Vo=class extends je{constructor(e,r,n){super(),this.session=r,this.dialect=n,this.config={view:e}}static[h]=\"PgRefreshMaterializedView\";config;concurrently(){if(this.config.withNoData!==void 0)throw new Error(\"Cannot use concurrently and withNoData together\");return this.config.concurrently=!0,this}withNoData(){if(this.config.concurrently!==void 0)throw new Error(\"Cannot use concurrently and withNoData together\");return this.config.withNoData=!0,this}getSQL(){return this.dialect.buildRefreshMaterializedViewQuery(this.config)}toSQL(){let{typings:e,...r}=this.dialect.sqlToQuery(this.getSQL());return r}_prepare(e){return ee.startActiveSpan(\"drizzle.prepareQuery\",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),void 0,e,!0))}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>ee.startActiveSpan(\"drizzle.operation\",()=>this._prepare().execute(e,this.authToken))};var Ia=class{constructor(e,r,n,i){this.table=e,this.session=r,this.dialect=n,this.withList=i}static[h]=\"PgUpdateBuilder\";authToken;setToken(e){return this.authToken=e,this}set(e){return new Nf(this.table,No(this.table,e),this.session,this.dialect,this.withList).setToken(this.authToken)}},Nf=class extends je{constructor(e,r,n,i,a){super(),this.session=n,this.dialect=i,this.config={set:r,table:e,withList:a,joins:[]},this.tableName=er(e),this.joinsNotNullableMap=typeof this.tableName==\"string\"?{[this.tableName]:!0}:{}}static[h]=\"PgUpdate\";config;tableName;joinsNotNullableMap;from(e){let r=e,n=er(r);return typeof n==\"string\"&&(this.joinsNotNullableMap[n]=!0),this.config.from=r,this}getTableLikeFields(e){return b(e,Te)?e[A.Symbol.Columns]:b(e,ye)?e._.selectedFields:e[te].selectedFields}createJoin(e){return(r,n)=>{let i=er(r);if(typeof i==\"string\"&&this.config.joins.some(a=>a.alias===i))throw new Error(`Alias \"${i}\" is already used in this query`);if(typeof n==\"function\"){let a=this.config.from&&!b(this.config.from,O)?this.getTableLikeFields(this.config.from):void 0;n=n(new Proxy(this.config.table[A.Symbol.Columns],new de({sqlAliasedBehavior:\"sql\",sqlBehavior:\"sql\"})),a&&new Proxy(a,new de({sqlAliasedBehavior:\"sql\",sqlBehavior:\"sql\"})))}if(this.config.joins.push({on:n,table:r,joinType:e,alias:i}),typeof i==\"string\")switch(e){case\"left\":{this.joinsNotNullableMap[i]=!1;break}case\"right\":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([a])=>[a,!1])),this.joinsNotNullableMap[i]=!0;break}case\"inner\":{this.joinsNotNullableMap[i]=!0;break}case\"full\":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([a])=>[a,!1])),this.joinsNotNullableMap[i]=!1;break}}return this}}leftJoin=this.createJoin(\"left\");rightJoin=this.createJoin(\"right\");innerJoin=this.createJoin(\"inner\");fullJoin=this.createJoin(\"full\");where(e){return this.config.where=e,this}returning(e){if(!e&&(e=Object.assign({},this.config.table[A.Symbol.Columns]),this.config.from)){let r=er(this.config.from);if(typeof r==\"string\"&&this.config.from&&!b(this.config.from,O)){let n=this.getTableLikeFields(this.config.from);e[r]=n}for(let n of this.config.joins){let i=er(n.table);if(typeof i==\"string\"&&!b(n.table,O)){let a=this.getTableLikeFields(n.table);e[i]=a}}}return this.config.returningFields=e,this.config.returning=gt(e),this}getSQL(){return this.dialect.buildUpdateQuery(this.config)}toSQL(){let{typings:e,...r}=this.dialect.sqlToQuery(this.getSQL());return r}_prepare(e){let r=this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,e,!0);return r.joinsNotNullableMap=this.joinsNotNullableMap,r}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>this._prepare().execute(e,this.authToken);getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new de({alias:We(this.config.table),sqlAliasedBehavior:\"alias\",sqlBehavior:\"error\"})):void 0}$dynamic(){return this}};var Ko=class t extends O{constructor(e){super(t.buildEmbeddedCount(e.source,e.filters).queryChunks),this.params=e,this.mapWith(Number),this.session=e.session,this.sql=t.buildCount(e.source,e.filters)}sql;token;static[h]=\"PgCountBuilder\";[Symbol.toStringTag]=\"PgCountBuilder\";session;static buildEmbeddedCount(e,r){return g`(select count(*) from ${e}${g.raw(\" where \").if(r)}${r})`}static buildCount(e,r){return g`select count(*) as count from ${e}${g.raw(\" where \").if(r)}${r};`}setToken(e){return this.token=e,this}then(e,r){return Promise.resolve(this.session.count(this.sql,this.token)).then(e,r)}catch(e){return this.then(void 0,e)}finally(e){return this.then(r=>(e?.(),r),r=>{throw e?.(),r})}};var Wo=class{constructor(e,r,n,i,a,s,o){this.fullSchema=e,this.schema=r,this.tableNamesMap=n,this.table=i,this.tableConfig=a,this.dialect=s,this.session=o}static[h]=\"PgRelationalQueryBuilder\";findMany(e){return new Go(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,e||{},\"many\")}findFirst(e){return new Go(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,e?{...e,limit:1}:{limit:1},\"first\")}},Go=class extends je{constructor(e,r,n,i,a,s,o,u,c){super(),this.fullSchema=e,this.schema=r,this.tableNamesMap=n,this.table=i,this.tableConfig=a,this.dialect=s,this.session=o,this.config=u,this.mode=c}static[h]=\"PgRelationalQuery\";_prepare(e){return ee.startActiveSpan(\"drizzle.prepareQuery\",()=>{let{query:r,builtQuery:n}=this._toSQL();return this.session.prepareQuery(n,void 0,e,!0,(i,a)=>{let s=i.map(o=>Bo(this.schema,this.tableConfig,o,r.selection,a));return this.mode===\"first\"?s[0]:s})})}prepare(e){return this._prepare(e)}_getQuery(){return this.dialect.buildRelationalQueryWithoutPK({fullSchema:this.fullSchema,schema:this.schema,tableNamesMap:this.tableNamesMap,table:this.table,tableConfig:this.tableConfig,queryConfig:this.config,tableAlias:this.tableConfig.tsName})}getSQL(){return this._getQuery().sql}_toSQL(){let e=this._getQuery(),r=this.dialect.sqlToQuery(e.sql);return{query:e,builtQuery:r}}toSQL(){return this._toSQL().builtQuery}authToken;setToken(e){return this.authToken=e,this}execute(){return ee.startActiveSpan(\"drizzle.operation\",()=>this._prepare().execute(void 0,this.authToken))}};var Jo=class extends je{constructor(e,r,n,i){super(),this.execute=e,this.sql=r,this.query=n,this.mapBatchResult=i}static[h]=\"PgRaw\";getSQL(){return this.sql}getQuery(){return this.query}mapResult(e,r){return r?this.mapBatchResult(e):e}_prepare(){return this}isResponseInArrayMode(){return!1}};var li=class{constructor(e,r,n){if(this.dialect=e,this.session=r,this._=n?{schema:n.schema,fullSchema:n.fullSchema,tableNamesMap:n.tableNamesMap,session:r}:{schema:void 0,fullSchema:{},tableNamesMap:{},session:r},this.query={},this._.schema)for(let[i,a]of Object.entries(this._.schema))this.query[i]=new Wo(n.fullSchema,this._.schema,this._.tableNamesMap,n.fullSchema[i],a,e,r)}static[h]=\"PgDatabase\";query;$with=(e,r)=>{let n=this;return{as:a=>(typeof a==\"function\"&&(a=a(new ui(n.dialect))),new Proxy(new ni(a.getSQL(),r??(\"getSelectedFields\"in a?a.getSelectedFields()??{}:{}),e,!0),new de({alias:e,sqlAliasedBehavior:\"alias\",sqlBehavior:\"error\"})))}};$count(e,r){return new Ko({source:e,filters:r,session:this.session})}with(...e){let r=this;function n(c){return new De({fields:c??void 0,session:r.session,dialect:r.dialect,withList:e})}function i(c){return new De({fields:c??void 0,session:r.session,dialect:r.dialect,withList:e,distinct:!0})}function a(c,l){return new De({fields:l??void 0,session:r.session,dialect:r.dialect,withList:e,distinct:{on:c}})}function s(c){return new Ia(c,r.session,r.dialect,e)}function o(c){return new Ra(c,r.session,r.dialect,e)}function u(c){return new ya(c,r.session,r.dialect,e)}return{select:n,selectDistinct:i,selectDistinctOn:a,update:s,insert:o,delete:u}}select(e){return new De({fields:e??void 0,session:this.session,dialect:this.dialect})}selectDistinct(e){return new De({fields:e??void 0,session:this.session,dialect:this.dialect,distinct:!0})}selectDistinctOn(e,r){return new De({fields:r??void 0,session:this.session,dialect:this.dialect,distinct:{on:e}})}update(e){return new Ia(e,this.session,this.dialect)}insert(e){return new Ra(e,this.session,this.dialect)}delete(e){return new ya(e,this.session,this.dialect)}refreshMaterializedView(e){return new Vo(e,this.session,this.dialect)}authToken;execute(e){let r=typeof e==\"string\"?g.raw(e):e.getSQL(),n=this.dialect.sqlToQuery(r),i=this.session.prepareQuery(n,void 0,void 0,!1);return new Jo(()=>i.execute(void 0,this.authToken),r,n,a=>i.mapResult(a,!0))}transaction(e,r){return this.session.transaction(e,r)}};var qf=class{constructor(e,r){this.unique=e,this.name=r}static[h]=\"PgIndexBuilderOn\";on(...e){return new Na(e.map(r=>{if(b(r,O))return r;r=r;let n=new ri(r.name,!!r.keyAsName,r.columnType,r.indexConfig);return r.indexConfig=JSON.parse(JSON.stringify(r.defaultConfig)),n}),this.unique,!1,this.name)}onOnly(...e){return new Na(e.map(r=>{if(b(r,O))return r;r=r;let n=new ri(r.name,!!r.keyAsName,r.columnType,r.indexConfig);return r.indexConfig=r.defaultConfig,n}),this.unique,!0,this.name)}using(e,...r){return new Na(r.map(n=>{if(b(n,O))return n;n=n;let i=new ri(n.name,!!n.keyAsName,n.columnType,n.indexConfig);return n.indexConfig=JSON.parse(JSON.stringify(n.defaultConfig)),i}),this.unique,!0,this.name,e)}},Na=class{static[h]=\"PgIndexBuilder\";config;constructor(e,r,n,i,a=\"btree\"){this.config={name:i,columns:e,unique:r,only:n,method:a}}concurrently(){return this.config.concurrently=!0,this}with(e){return this.config.with=e,this}where(e){return this.config.where=e,this}build(e){return new jf(this.config,e)}},jf=class{static[h]=\"PgIndex\";config;constructor(e,r){this.config={...e,table:r}}};function H_(t){return new qf(!1,t)}var Zo=class{constructor(e){this.query=e}authToken;getQuery(){return this.query}mapResult(e,r){return e}setToken(e){return this.authToken=e,this}static[h]=\"PgPreparedQuery\";joinsNotNullableMap},Xo=class{constructor(e){this.dialect=e}static[h]=\"PgSession\";execute(e,r){return ee.startActiveSpan(\"drizzle.operation\",()=>ee.startActiveSpan(\"drizzle.prepareQuery\",()=>this.prepareQuery(this.dialect.sqlToQuery(e),void 0,void 0,!1)).setToken(r).execute(void 0,r))}all(e){return this.prepareQuery(this.dialect.sqlToQuery(e),void 0,void 0,!1).all()}async count(e,r){let n=await this.execute(e,r);return Number(n[0].count)}},Yo=class extends li{constructor(e,r,n,i=0){super(e,r,n),this.schema=n,this.nestedIndex=i}static[h]=\"PgTransaction\";rollback(){throw new Do}getTransactionConfigSQL(e){let r=[];return e.isolationLevel&&r.push(`isolation level ${e.isolationLevel}`),e.accessMode&&r.push(e.accessMode),typeof e.deferrable==\"boolean\"&&r.push(e.deferrable?\"deferrable\":\"not deferrable\"),g.raw(r.join(\" \"))}setTransaction(e){return this.session.execute(g`set transaction ${this.getTransactionConfigSQL(e)}`)}};var{Pool:Q_,types:Mt}=yr,Df=class extends Zo{constructor(e,r,n,i,a,s,o,u){super({sql:r,params:n}),this.client=e,this.params=n,this.logger=i,this.fields=a,this._isResponseInArrayMode=o,this.customResultMapper=u,this.rawQueryConfig={name:s,text:r,types:{getTypeParser:(c,l)=>c===Mt.builtins.TIMESTAMPTZ?p=>p:c===Mt.builtins.TIMESTAMP?p=>p:c===Mt.builtins.DATE?p=>p:c===Mt.builtins.INTERVAL?p=>p:Mt.getTypeParser(c,l)}},this.queryConfig={name:s,text:r,rowMode:\"array\",types:{getTypeParser:(c,l)=>c===Mt.builtins.TIMESTAMPTZ?p=>p:c===Mt.builtins.TIMESTAMP?p=>p:c===Mt.builtins.DATE?p=>p:c===Mt.builtins.INTERVAL?p=>p:Mt.getTypeParser(c,l)}}}static[h]=\"NodePgPreparedQuery\";rawQueryConfig;queryConfig;async execute(e={}){return ee.startActiveSpan(\"drizzle.execute\",async()=>{let r=ld(this.params,e);this.logger.logQuery(this.rawQueryConfig.text,r);let{fields:n,rawQueryConfig:i,client:a,queryConfig:s,joinsNotNullableMap:o,customResultMapper:u}=this;if(!n&&!u)return ee.startActiveSpan(\"drizzle.driver.execute\",async l=>(l?.setAttributes({\"drizzle.query.name\":i.name,\"drizzle.query.text\":i.text,\"drizzle.query.params\":JSON.stringify(r)}),a.query(i,r)));let c=await ee.startActiveSpan(\"drizzle.driver.execute\",l=>(l?.setAttributes({\"drizzle.query.name\":s.name,\"drizzle.query.text\":s.text,\"drizzle.query.params\":JSON.stringify(r)}),a.query(s,r)));return ee.startActiveSpan(\"drizzle.mapResponse\",()=>u?u(c.rows):c.rows.map(l=>F1(n,l,o)))})}all(e={}){return ee.startActiveSpan(\"drizzle.execute\",()=>{let r=ld(this.params,e);return this.logger.logQuery(this.rawQueryConfig.text,r),ee.startActiveSpan(\"drizzle.driver.execute\",n=>(n?.setAttributes({\"drizzle.query.name\":this.rawQueryConfig.name,\"drizzle.query.text\":this.rawQueryConfig.text,\"drizzle.query.params\":JSON.stringify(r)}),this.client.query(this.rawQueryConfig,r).then(i=>i.rows)))})}isResponseInArrayMode(){return this._isResponseInArrayMode}},ec=class t extends Xo{constructor(e,r,n,i={}){super(r),this.client=e,this.schema=n,this.options=i,this.logger=i.logger??new Ao}static[h]=\"NodePgSession\";logger;prepareQuery(e,r,n,i,a){return new Df(this.client,e.sql,e.params,this.logger,r,n,i,a)}async transaction(e,r){let n=this.client instanceof Q_?new t(await this.client.connect(),this.dialect,this.schema,this.options):this,i=new Lf(this.dialect,n,this.schema);await i.execute(g`begin${r?g` ${i.getTransactionConfigSQL(r)}`:void 0}`);try{let a=await e(i);return await i.execute(g`commit`),a}catch(a){throw await i.execute(g`rollback`),a}finally{this.client instanceof Q_&&n.client.release()}}async count(e){let r=await this.execute(e);return Number(r.rows[0].count)}},Lf=class t extends Yo{static[h]=\"NodePgTransaction\";async transaction(e){let r=`sp${this.nestedIndex+1}`,n=new t(this.dialect,this.session,this.schema,this.nestedIndex+1);await n.execute(g.raw(`savepoint ${r}`));try{let i=await e(n);return await n.execute(g.raw(`release savepoint ${r}`)),i}catch(i){throw await n.execute(g.raw(`rollback to savepoint ${r}`)),i}}};var Mf=class{constructor(e,r,n={}){this.client=e,this.dialect=r,this.options=n}static[h]=\"NodePgDriver\";createSession(e){return new ec(this.client,this.dialect,e,{logger:this.options.logger})}},Ff=class extends li{static[h]=\"NodePgDatabase\"};function qa(t,e={}){let r=new br({casing:e.casing}),n;e.logger===!0?n=new ko:e.logger!==!1&&(n=e.logger);let i;if(e.schema){let u=U_(e.schema,z_);i={fullSchema:e.schema,schema:u.tables,tableNamesMap:u.tableNamesMap}}let s=new Mf(t,r,{logger:n}).createSession(i),o=new Ff(r,s,i);return o.$client=t,o}function tc(...t){if(typeof t[0]==\"string\"){let e=new yr.Pool({connectionString:t[0]});return qa(e,t[1])}if(B1(t[0])){let{connection:e,client:r,...n}=t[0];if(r)return qa(r,n);let i=typeof e==\"string\"?new yr.Pool({connectionString:e}):new yr.Pool(e);return qa(i,n)}return qa(t[0],t[1])}(t=>{function e(r){return qa({},r)}t.mock=e})(tc||(tc={}));var oc={};Rc(oc,{inquiries:()=>at,insertInquirySchema:()=>Hf,insertUserSchema:()=>lN,sessions:()=>uN,users:()=>Tr});var Ie={};Rc(Ie,{BRAND:()=>g9,DIRTY:()=>Vr,EMPTY_PATH:()=>WI,INVALID:()=>D,NEVER:()=>eN,OK:()=>Le,ParseStatus:()=>Re,Schema:()=>H,ZodAny:()=>Sr,ZodArray:()=>ar,ZodBigInt:()=>Wr,ZodBoolean:()=>Gr,ZodBranded:()=>Da,ZodCatch:()=>on,ZodDate:()=>Jr,ZodDefault:()=>sn,ZodDiscriminatedUnion:()=>ic,ZodEffects:()=>bt,ZodEnum:()=>nn,ZodError:()=>Ze,ZodFirstPartyTypeKind:()=>M,ZodFunction:()=>sc,ZodIntersection:()=>en,ZodIssueCode:()=>_,ZodLazy:()=>tn,ZodLiteral:()=>rn,ZodMap:()=>gi,ZodNaN:()=>yi,ZodNativeEnum:()=>an,ZodNever:()=>At,ZodNull:()=>Xr,ZodNullable:()=>Ut,ZodNumber:()=>Kr,ZodObject:()=>Xe,ZodOptional:()=>yt,ZodParsedType:()=>P,ZodPipeline:()=>La,ZodPromise:()=>Er,ZodReadonly:()=>cn,ZodRecord:()=>ac,ZodSchema:()=>H,ZodSet:()=>vi,ZodString:()=>_r,ZodSymbol:()=>hi,ZodTransformer:()=>bt,ZodTuple:()=>$t,ZodType:()=>H,ZodUndefined:()=>Zr,ZodUnion:()=>Yr,ZodUnknown:()=>ir,ZodVoid:()=>mi,addIssueToContext:()=>k,any:()=>T9,array:()=>P9,bigint:()=>b9,boolean:()=>rS,coerce:()=>Y9,custom:()=>Y_,date:()=>w9,datetimeRegex:()=>Z_,defaultErrorMap:()=>rr,discriminatedUnion:()=>N9,effect:()=>Q9,enum:()=>B9,function:()=>F9,getErrorMap:()=>pi,getParsedType:()=>Ft,instanceof:()=>y9,intersection:()=>q9,isAborted:()=>rc,isAsync:()=>di,isDirty:()=>nc,isValid:()=>wr,late:()=>v9,lazy:()=>$9,literal:()=>U9,makeIssue:()=>ja,map:()=>L9,nan:()=>x9,nativeEnum:()=>z9,never:()=>A9,null:()=>E9,nullable:()=>K9,number:()=>tS,object:()=>O9,objectUtil:()=>$f,oboolean:()=>X9,onumber:()=>Z9,optional:()=>V9,ostring:()=>J9,pipeline:()=>G9,preprocess:()=>W9,promise:()=>H9,quotelessJson:()=>QI,record:()=>D9,set:()=>M9,setErrorMap:()=>KI,strictObject:()=>R9,string:()=>eS,symbol:()=>_9,transformer:()=>Q9,tuple:()=>j9,undefined:()=>S9,union:()=>I9,unknown:()=>k9,util:()=>K,void:()=>C9});var K;(function(t){t.assertEqual=i=>{};function e(i){}t.assertIs=e;function r(i){throw new Error}t.assertNever=r,t.arrayToEnum=i=>{let a={};for(let s of i)a[s]=s;return a},t.getValidEnumValues=i=>{let a=t.objectKeys(i).filter(o=>typeof i[i[o]]!=\"number\"),s={};for(let o of a)s[o]=i[o];return t.objectValues(s)},t.objectValues=i=>t.objectKeys(i).map(function(a){return i[a]}),t.objectKeys=typeof Object.keys==\"function\"?i=>Object.keys(i):i=>{let a=[];for(let s in i)Object.prototype.hasOwnProperty.call(i,s)&&a.push(s);return a},t.find=(i,a)=>{for(let s of i)if(a(s))return s},t.isInteger=typeof Number.isInteger==\"function\"?i=>Number.isInteger(i):i=>typeof i==\"number\"&&Number.isFinite(i)&&Math.floor(i)===i;function n(i,a=\" | \"){return i.map(s=>typeof s==\"string\"?`'${s}'`:s).join(a)}t.joinValues=n,t.jsonStringifyReplacer=(i,a)=>typeof a==\"bigint\"?a.toString():a})(K||(K={}));var $f;(function(t){t.mergeShapes=(e,r)=>({...e,...r})})($f||($f={}));var P=K.arrayToEnum([\"string\",\"nan\",\"number\",\"integer\",\"float\",\"boolean\",\"date\",\"bigint\",\"symbol\",\"function\",\"undefined\",\"null\",\"array\",\"object\",\"unknown\",\"promise\",\"void\",\"never\",\"map\",\"set\"]),Ft=t=>{switch(typeof t){case\"undefined\":return P.undefined;case\"string\":return P.string;case\"number\":return Number.isNaN(t)?P.nan:P.number;case\"boolean\":return P.boolean;case\"function\":return P.function;case\"bigint\":return P.bigint;case\"symbol\":return P.symbol;case\"object\":return Array.isArray(t)?P.array:t===null?P.null:t.then&&typeof t.then==\"function\"&&t.catch&&typeof t.catch==\"function\"?P.promise:typeof Map<\"u\"&&t instanceof Map?P.map:typeof Set<\"u\"&&t instanceof Set?P.set:typeof Date<\"u\"&&t instanceof Date?P.date:P.object;default:return P.unknown}};var _=K.arrayToEnum([\"invalid_type\",\"invalid_literal\",\"custom\",\"invalid_union\",\"invalid_union_discriminator\",\"invalid_enum_value\",\"unrecognized_keys\",\"invalid_arguments\",\"invalid_return_type\",\"invalid_date\",\"invalid_string\",\"too_small\",\"too_big\",\"invalid_intersection_types\",\"not_multiple_of\",\"not_finite\"]),QI=t=>JSON.stringify(t,null,2).replace(/\"([^\"]+)\":/g,\"$1:\"),Ze=class t extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};let r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name=\"ZodError\",this.issues=e}format(e){let r=e||function(a){return a.message},n={_errors:[]},i=a=>{for(let s of a.issues)if(s.code===\"invalid_union\")s.unionErrors.map(i);else if(s.code===\"invalid_return_type\")i(s.returnTypeError);else if(s.code===\"invalid_arguments\")i(s.argumentsError);else if(s.path.length===0)n._errors.push(r(s));else{let o=n,u=0;for(;u<s.path.length;){let c=s.path[u];u===s.path.length-1?(o[c]=o[c]||{_errors:[]},o[c]._errors.push(r(s))):o[c]=o[c]||{_errors:[]},o=o[c],u++}}};return i(this),n}static assert(e){if(!(e instanceof t))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,K.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=r=>r.message){let r={},n=[];for(let i of this.issues)if(i.path.length>0){let a=i.path[0];r[a]=r[a]||[],r[a].push(e(i))}else n.push(e(i));return{formErrors:n,fieldErrors:r}}get formErrors(){return this.flatten()}};Ze.create=t=>new Ze(t);var VI=(t,e)=>{let r;switch(t.code){case _.invalid_type:t.received===P.undefined?r=\"Required\":r=`Expected ${t.expected}, received ${t.received}`;break;case _.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(t.expected,K.jsonStringifyReplacer)}`;break;case _.unrecognized_keys:r=`Unrecognized key(s) in object: ${K.joinValues(t.keys,\", \")}`;break;case _.invalid_union:r=\"Invalid input\";break;case _.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${K.joinValues(t.options)}`;break;case _.invalid_enum_value:r=`Invalid enum value. Expected ${K.joinValues(t.options)}, received '${t.received}'`;break;case _.invalid_arguments:r=\"Invalid function arguments\";break;case _.invalid_return_type:r=\"Invalid function return type\";break;case _.invalid_date:r=\"Invalid date\";break;case _.invalid_string:typeof t.validation==\"object\"?\"includes\"in t.validation?(r=`Invalid input: must include \"${t.validation.includes}\"`,typeof t.validation.position==\"number\"&&(r=`${r} at one or more positions greater than or equal to ${t.validation.position}`)):\"startsWith\"in t.validation?r=`Invalid input: must start with \"${t.validation.startsWith}\"`:\"endsWith\"in t.validation?r=`Invalid input: must end with \"${t.validation.endsWith}\"`:K.assertNever(t.validation):t.validation!==\"regex\"?r=`Invalid ${t.validation}`:r=\"Invalid\";break;case _.too_small:t.type===\"array\"?r=`Array must contain ${t.exact?\"exactly\":t.inclusive?\"at least\":\"more than\"} ${t.minimum} element(s)`:t.type===\"string\"?r=`String must contain ${t.exact?\"exactly\":t.inclusive?\"at least\":\"over\"} ${t.minimum} character(s)`:t.type===\"number\"?r=`Number must be ${t.exact?\"exactly equal to \":t.inclusive?\"greater than or equal to \":\"greater than \"}${t.minimum}`:t.type===\"bigint\"?r=`Number must be ${t.exact?\"exactly equal to \":t.inclusive?\"greater than or equal to \":\"greater than \"}${t.minimum}`:t.type===\"date\"?r=`Date must be ${t.exact?\"exactly equal to \":t.inclusive?\"greater than or equal to \":\"greater than \"}${new Date(Number(t.minimum))}`:r=\"Invalid input\";break;case _.too_big:t.type===\"array\"?r=`Array must contain ${t.exact?\"exactly\":t.inclusive?\"at most\":\"less than\"} ${t.maximum} element(s)`:t.type===\"string\"?r=`String must contain ${t.exact?\"exactly\":t.inclusive?\"at most\":\"under\"} ${t.maximum} character(s)`:t.type===\"number\"?r=`Number must be ${t.exact?\"exactly\":t.inclusive?\"less than or equal to\":\"less than\"} ${t.maximum}`:t.type===\"bigint\"?r=`BigInt must be ${t.exact?\"exactly\":t.inclusive?\"less than or equal to\":\"less than\"} ${t.maximum}`:t.type===\"date\"?r=`Date must be ${t.exact?\"exactly\":t.inclusive?\"smaller than or equal to\":\"smaller than\"} ${new Date(Number(t.maximum))}`:r=\"Invalid input\";break;case _.custom:r=\"Invalid input\";break;case _.invalid_intersection_types:r=\"Intersection results could not be merged\";break;case _.not_multiple_of:r=`Number must be a multiple of ${t.multipleOf}`;break;case _.not_finite:r=\"Number must be finite\";break;default:r=e.defaultError,K.assertNever(t)}return{message:r}},rr=VI;var V_=rr;function KI(t){V_=t}function pi(){return V_}var ja=t=>{let{data:e,path:r,errorMaps:n,issueData:i}=t,a=[...r,...i.path||[]],s={...i,path:a};if(i.message!==void 0)return{...i,path:a,message:i.message};let o=\"\",u=n.filter(c=>!!c).slice().reverse();for(let c of u)o=c(s,{data:e,defaultError:o}).message;return{...i,path:a,message:o}},WI=[];function k(t,e){let r=pi(),n=ja({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,r,r===rr?void 0:rr].filter(i=>!!i)});t.common.issues.push(n)}var Re=class t{constructor(){this.value=\"valid\"}dirty(){this.value===\"valid\"&&(this.value=\"dirty\")}abort(){this.value!==\"aborted\"&&(this.value=\"aborted\")}static mergeArray(e,r){let n=[];for(let i of r){if(i.status===\"aborted\")return D;i.status===\"dirty\"&&e.dirty(),n.push(i.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,r){let n=[];for(let i of r){let a=await i.key,s=await i.value;n.push({key:a,value:s})}return t.mergeObjectSync(e,n)}static mergeObjectSync(e,r){let n={};for(let i of r){let{key:a,value:s}=i;if(a.status===\"aborted\"||s.status===\"aborted\")return D;a.status===\"dirty\"&&e.dirty(),s.status===\"dirty\"&&e.dirty(),a.value!==\"__proto__\"&&(typeof s.value<\"u\"||i.alwaysSet)&&(n[a.value]=s.value)}return{status:e.value,value:n}}},D=Object.freeze({status:\"aborted\"}),Vr=t=>({status:\"dirty\",value:t}),Le=t=>({status:\"valid\",value:t}),rc=t=>t.status===\"aborted\",nc=t=>t.status===\"dirty\",wr=t=>t.status===\"valid\",di=t=>typeof Promise<\"u\"&&t instanceof Promise;var q;(function(t){t.errToObj=e=>typeof e==\"string\"?{message:e}:e||{},t.toString=e=>typeof e==\"string\"?e:e?.message})(q||(q={}));var xt=class{constructor(e,r,n,i){this._cachedPath=[],this.parent=e,this.data=r,this._path=n,this._key=i}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}},K_=(t,e)=>{if(wr(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error(\"Validation failed but no issues detected.\");return{success:!1,get error(){if(this._error)return this._error;let r=new Ze(t.common.issues);return this._error=r,this._error}}};function z(t){if(!t)return{};let{errorMap:e,invalid_type_error:r,required_error:n,description:i}=t;if(e&&(r||n))throw new Error(`Can't use \"invalid_type_error\" or \"required_error\" in conjunction with custom error map.`);return e?{errorMap:e,description:i}:{errorMap:(s,o)=>{let{message:u}=t;return s.code===\"invalid_enum_value\"?{message:u??o.defaultError}:typeof o.data>\"u\"?{message:u??n??o.defaultError}:s.code!==\"invalid_type\"?{message:o.defaultError}:{message:u??r??o.defaultError}},description:i}}var H=class{get description(){return this._def.description}_getType(e){return Ft(e.data)}_getOrReturnCtx(e,r){return r||{common:e.parent.common,data:e.data,parsedType:Ft(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Re,ctx:{common:e.parent.common,data:e.data,parsedType:Ft(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let r=this._parse(e);if(di(r))throw new Error(\"Synchronous parse encountered promise.\");return r}_parseAsync(e){let r=this._parse(e);return Promise.resolve(r)}parse(e,r){let n=this.safeParse(e,r);if(n.success)return n.data;throw n.error}safeParse(e,r){let n={common:{issues:[],async:r?.async??!1,contextualErrorMap:r?.errorMap},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ft(e)},i=this._parseSync({data:e,path:n.path,parent:n});return K_(n,i)}\"~validate\"(e){let r={common:{issues:[],async:!!this[\"~standard\"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ft(e)};if(!this[\"~standard\"].async)try{let n=this._parseSync({data:e,path:[],parent:r});return wr(n)?{value:n.value}:{issues:r.common.issues}}catch(n){n?.message?.toLowerCase()?.includes(\"encountered\")&&(this[\"~standard\"].async=!0),r.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:r}).then(n=>wr(n)?{value:n.value}:{issues:r.common.issues})}async parseAsync(e,r){let n=await this.safeParseAsync(e,r);if(n.success)return n.data;throw n.error}async safeParseAsync(e,r){let n={common:{issues:[],contextualErrorMap:r?.errorMap,async:!0},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ft(e)},i=this._parse({data:e,path:n.path,parent:n}),a=await(di(i)?i:Promise.resolve(i));return K_(n,a)}refine(e,r){let n=i=>typeof r==\"string\"||typeof r>\"u\"?{message:r}:typeof r==\"function\"?r(i):r;return this._refinement((i,a)=>{let s=e(i),o=()=>a.addIssue({code:_.custom,...n(i)});return typeof Promise<\"u\"&&s instanceof Promise?s.then(u=>u?!0:(o(),!1)):s?!0:(o(),!1)})}refinement(e,r){return this._refinement((n,i)=>e(n)?!0:(i.addIssue(typeof r==\"function\"?r(n,i):r),!1))}_refinement(e){return new bt({schema:this,typeName:M.ZodEffects,effect:{type:\"refinement\",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this[\"~standard\"]={version:1,vendor:\"zod\",validate:r=>this[\"~validate\"](r)}}optional(){return yt.create(this,this._def)}nullable(){return Ut.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return ar.create(this)}promise(){return Er.create(this,this._def)}or(e){return Yr.create([this,e],this._def)}and(e){return en.create(this,e,this._def)}transform(e){return new bt({...z(this._def),schema:this,typeName:M.ZodEffects,effect:{type:\"transform\",transform:e}})}default(e){let r=typeof e==\"function\"?e:()=>e;return new sn({...z(this._def),innerType:this,defaultValue:r,typeName:M.ZodDefault})}brand(){return new Da({typeName:M.ZodBranded,type:this,...z(this._def)})}catch(e){let r=typeof e==\"function\"?e:()=>e;return new on({...z(this._def),innerType:this,catchValue:r,typeName:M.ZodCatch})}describe(e){let r=this.constructor;return new r({...this._def,description:e})}pipe(e){return La.create(this,e)}readonly(){return cn.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}},GI=/^c[^\\s-]{8,}$/i,JI=/^[0-9a-z]+$/,ZI=/^[0-9A-HJKMNP-TV-Z]{26}$/i,XI=/^[0-9a-fA-F]{8}\\b-[0-9a-fA-F]{4}\\b-[0-9a-fA-F]{4}\\b-[0-9a-fA-F]{4}\\b-[0-9a-fA-F]{12}$/i,YI=/^[a-z0-9_-]{21}$/i,e9=/^[A-Za-z0-9-_]+\\.[A-Za-z0-9-_]+\\.[A-Za-z0-9-_]*$/,t9=/^[-+]?P(?!$)(?:(?:[-+]?\\d+Y)|(?:[-+]?\\d+[.,]\\d+Y$))?(?:(?:[-+]?\\d+M)|(?:[-+]?\\d+[.,]\\d+M$))?(?:(?:[-+]?\\d+W)|(?:[-+]?\\d+[.,]\\d+W$))?(?:(?:[-+]?\\d+D)|(?:[-+]?\\d+[.,]\\d+D$))?(?:T(?=[\\d+-])(?:(?:[-+]?\\d+H)|(?:[-+]?\\d+[.,]\\d+H$))?(?:(?:[-+]?\\d+M)|(?:[-+]?\\d+[.,]\\d+M$))?(?:[-+]?\\d+(?:[.,]\\d+)?S)?)??$/,r9=/^(?!\\.)(?!.*\\.\\.)([A-Z0-9_'+\\-\\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\\-]*\\.)+[A-Z]{2,}$/i,n9=\"^(\\\\p{Extended_Pictographic}|\\\\p{Emoji_Component})+$\",Uf,i9=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,a9=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\\/(3[0-2]|[12]?[0-9])$/,s9=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,o9=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,c9=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,u9=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,G_=\"((\\\\d\\\\d[2468][048]|\\\\d\\\\d[13579][26]|\\\\d\\\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\\\d|30)|(02)-(0[1-9]|1\\\\d|2[0-8])))\",l9=new RegExp(`^${G_}$`);function J_(t){let e=\"[0-5]\\\\d\";t.precision?e=`${e}\\\\.\\\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\\\.\\\\d+)?`);let r=t.precision?\"+\":\"?\";return`([01]\\\\d|2[0-3]):[0-5]\\\\d(:${e})${r}`}function p9(t){return new RegExp(`^${J_(t)}$`)}function Z_(t){let e=`${G_}T${J_(t)}`,r=[];return r.push(t.local?\"Z?\":\"Z\"),t.offset&&r.push(\"([+-]\\\\d{2}:?\\\\d{2})\"),e=`${e}(${r.join(\"|\")})`,new RegExp(`^${e}$`)}function d9(t,e){return!!((e===\"v4\"||!e)&&i9.test(t)||(e===\"v6\"||!e)&&s9.test(t))}function f9(t,e){if(!e9.test(t))return!1;try{let[r]=t.split(\".\");if(!r)return!1;let n=r.replace(/-/g,\"+\").replace(/_/g,\"/\").padEnd(r.length+(4-r.length%4)%4,\"=\"),i=JSON.parse(atob(n));return!(typeof i!=\"object\"||i===null||\"typ\"in i&&i?.typ!==\"JWT\"||!i.alg||e&&i.alg!==e)}catch{return!1}}function h9(t,e){return!!((e===\"v4\"||!e)&&a9.test(t)||(e===\"v6\"||!e)&&o9.test(t))}var _r=class t extends H{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==P.string){let a=this._getOrReturnCtx(e);return k(a,{code:_.invalid_type,expected:P.string,received:a.parsedType}),D}let n=new Re,i;for(let a of this._def.checks)if(a.kind===\"min\")e.data.length<a.value&&(i=this._getOrReturnCtx(e,i),k(i,{code:_.too_small,minimum:a.value,type:\"string\",inclusive:!0,exact:!1,message:a.message}),n.dirty());else if(a.kind===\"max\")e.data.length>a.value&&(i=this._getOrReturnCtx(e,i),k(i,{code:_.too_big,maximum:a.value,type:\"string\",inclusive:!0,exact:!1,message:a.message}),n.dirty());else if(a.kind===\"length\"){let s=e.data.length>a.value,o=e.data.length<a.value;(s||o)&&(i=this._getOrReturnCtx(e,i),s?k(i,{code:_.too_big,maximum:a.value,type:\"string\",inclusive:!0,exact:!0,message:a.message}):o&&k(i,{code:_.too_small,minimum:a.value,type:\"string\",inclusive:!0,exact:!0,message:a.message}),n.dirty())}else if(a.kind===\"email\")r9.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"email\",code:_.invalid_string,message:a.message}),n.dirty());else if(a.kind===\"emoji\")Uf||(Uf=new RegExp(n9,\"u\")),Uf.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"emoji\",code:_.invalid_string,message:a.message}),n.dirty());else if(a.kind===\"uuid\")XI.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"uuid\",code:_.invalid_string,message:a.message}),n.dirty());else if(a.kind===\"nanoid\")YI.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"nanoid\",code:_.invalid_string,message:a.message}),n.dirty());else if(a.kind===\"cuid\")GI.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"cuid\",code:_.invalid_string,message:a.message}),n.dirty());else if(a.kind===\"cuid2\")JI.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"cuid2\",code:_.invalid_string,message:a.message}),n.dirty());else if(a.kind===\"ulid\")ZI.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"ulid\",code:_.invalid_string,message:a.message}),n.dirty());else if(a.kind===\"url\")try{new URL(e.data)}catch{i=this._getOrReturnCtx(e,i),k(i,{validation:\"url\",code:_.invalid_string,message:a.message}),n.dirty()}else a.kind===\"regex\"?(a.regex.lastIndex=0,a.regex.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"regex\",code:_.invalid_string,message:a.message}),n.dirty())):a.kind===\"trim\"?e.data=e.data.trim():a.kind===\"includes\"?e.data.includes(a.value,a.position)||(i=this._getOrReturnCtx(e,i),k(i,{code:_.invalid_string,validation:{includes:a.value,position:a.position},message:a.message}),n.dirty()):a.kind===\"toLowerCase\"?e.data=e.data.toLowerCase():a.kind===\"toUpperCase\"?e.data=e.data.toUpperCase():a.kind===\"startsWith\"?e.data.startsWith(a.value)||(i=this._getOrReturnCtx(e,i),k(i,{code:_.invalid_string,validation:{startsWith:a.value},message:a.message}),n.dirty()):a.kind===\"endsWith\"?e.data.endsWith(a.value)||(i=this._getOrReturnCtx(e,i),k(i,{code:_.invalid_string,validation:{endsWith:a.value},message:a.message}),n.dirty()):a.kind===\"datetime\"?Z_(a).test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{code:_.invalid_string,validation:\"datetime\",message:a.message}),n.dirty()):a.kind===\"date\"?l9.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{code:_.invalid_string,validation:\"date\",message:a.message}),n.dirty()):a.kind===\"time\"?p9(a).test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{code:_.invalid_string,validation:\"time\",message:a.message}),n.dirty()):a.kind===\"duration\"?t9.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"duration\",code:_.invalid_string,message:a.message}),n.dirty()):a.kind===\"ip\"?d9(e.data,a.version)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"ip\",code:_.invalid_string,message:a.message}),n.dirty()):a.kind===\"jwt\"?f9(e.data,a.alg)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"jwt\",code:_.invalid_string,message:a.message}),n.dirty()):a.kind===\"cidr\"?h9(e.data,a.version)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"cidr\",code:_.invalid_string,message:a.message}),n.dirty()):a.kind===\"base64\"?c9.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"base64\",code:_.invalid_string,message:a.message}),n.dirty()):a.kind===\"base64url\"?u9.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"base64url\",code:_.invalid_string,message:a.message}),n.dirty()):K.assertNever(a);return{status:n.value,value:e.data}}_regex(e,r,n){return this.refinement(i=>e.test(i),{validation:r,code:_.invalid_string,...q.errToObj(n)})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:\"email\",...q.errToObj(e)})}url(e){return this._addCheck({kind:\"url\",...q.errToObj(e)})}emoji(e){return this._addCheck({kind:\"emoji\",...q.errToObj(e)})}uuid(e){return this._addCheck({kind:\"uuid\",...q.errToObj(e)})}nanoid(e){return this._addCheck({kind:\"nanoid\",...q.errToObj(e)})}cuid(e){return this._addCheck({kind:\"cuid\",...q.errToObj(e)})}cuid2(e){return this._addCheck({kind:\"cuid2\",...q.errToObj(e)})}ulid(e){return this._addCheck({kind:\"ulid\",...q.errToObj(e)})}base64(e){return this._addCheck({kind:\"base64\",...q.errToObj(e)})}base64url(e){return this._addCheck({kind:\"base64url\",...q.errToObj(e)})}jwt(e){return this._addCheck({kind:\"jwt\",...q.errToObj(e)})}ip(e){return this._addCheck({kind:\"ip\",...q.errToObj(e)})}cidr(e){return this._addCheck({kind:\"cidr\",...q.errToObj(e)})}datetime(e){return typeof e==\"string\"?this._addCheck({kind:\"datetime\",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:\"datetime\",precision:typeof e?.precision>\"u\"?null:e?.precision,offset:e?.offset??!1,local:e?.local??!1,...q.errToObj(e?.message)})}date(e){return this._addCheck({kind:\"date\",message:e})}time(e){return typeof e==\"string\"?this._addCheck({kind:\"time\",precision:null,message:e}):this._addCheck({kind:\"time\",precision:typeof e?.precision>\"u\"?null:e?.precision,...q.errToObj(e?.message)})}duration(e){return this._addCheck({kind:\"duration\",...q.errToObj(e)})}regex(e,r){return this._addCheck({kind:\"regex\",regex:e,...q.errToObj(r)})}includes(e,r){return this._addCheck({kind:\"includes\",value:e,position:r?.position,...q.errToObj(r?.message)})}startsWith(e,r){return this._addCheck({kind:\"startsWith\",value:e,...q.errToObj(r)})}endsWith(e,r){return this._addCheck({kind:\"endsWith\",value:e,...q.errToObj(r)})}min(e,r){return this._addCheck({kind:\"min\",value:e,...q.errToObj(r)})}max(e,r){return this._addCheck({kind:\"max\",value:e,...q.errToObj(r)})}length(e,r){return this._addCheck({kind:\"length\",value:e,...q.errToObj(r)})}nonempty(e){return this.min(1,q.errToObj(e))}trim(){return new t({...this._def,checks:[...this._def.checks,{kind:\"trim\"}]})}toLowerCase(){return new t({...this._def,checks:[...this._def.checks,{kind:\"toLowerCase\"}]})}toUpperCase(){return new t({...this._def,checks:[...this._def.checks,{kind:\"toUpperCase\"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind===\"datetime\")}get isDate(){return!!this._def.checks.find(e=>e.kind===\"date\")}get isTime(){return!!this._def.checks.find(e=>e.kind===\"time\")}get isDuration(){return!!this._def.checks.find(e=>e.kind===\"duration\")}get isEmail(){return!!this._def.checks.find(e=>e.kind===\"email\")}get isURL(){return!!this._def.checks.find(e=>e.kind===\"url\")}get isEmoji(){return!!this._def.checks.find(e=>e.kind===\"emoji\")}get isUUID(){return!!this._def.checks.find(e=>e.kind===\"uuid\")}get isNANOID(){return!!this._def.checks.find(e=>e.kind===\"nanoid\")}get isCUID(){return!!this._def.checks.find(e=>e.kind===\"cuid\")}get isCUID2(){return!!this._def.checks.find(e=>e.kind===\"cuid2\")}get isULID(){return!!this._def.checks.find(e=>e.kind===\"ulid\")}get isIP(){return!!this._def.checks.find(e=>e.kind===\"ip\")}get isCIDR(){return!!this._def.checks.find(e=>e.kind===\"cidr\")}get isBase64(){return!!this._def.checks.find(e=>e.kind===\"base64\")}get isBase64url(){return!!this._def.checks.find(e=>e.kind===\"base64url\")}get minLength(){let e=null;for(let r of this._def.checks)r.kind===\"min\"&&(e===null||r.value>e)&&(e=r.value);return e}get maxLength(){let e=null;for(let r of this._def.checks)r.kind===\"max\"&&(e===null||r.value<e)&&(e=r.value);return e}};_r.create=t=>new _r({checks:[],typeName:M.ZodString,coerce:t?.coerce??!1,...z(t)});function m9(t,e){let r=(t.toString().split(\".\")[1]||\"\").length,n=(e.toString().split(\".\")[1]||\"\").length,i=r>n?r:n,a=Number.parseInt(t.toFixed(i).replace(\".\",\"\")),s=Number.parseInt(e.toFixed(i).replace(\".\",\"\"));return a%s/10**i}var Kr=class t extends H{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==P.number){let a=this._getOrReturnCtx(e);return k(a,{code:_.invalid_type,expected:P.number,received:a.parsedType}),D}let n,i=new Re;for(let a of this._def.checks)a.kind===\"int\"?K.isInteger(e.data)||(n=this._getOrReturnCtx(e,n),k(n,{code:_.invalid_type,expected:\"integer\",received:\"float\",message:a.message}),i.dirty()):a.kind===\"min\"?(a.inclusive?e.data<a.value:e.data<=a.value)&&(n=this._getOrReturnCtx(e,n),k(n,{code:_.too_small,minimum:a.value,type:\"number\",inclusive:a.inclusive,exact:!1,message:a.message}),i.dirty()):a.kind===\"max\"?(a.inclusive?e.data>a.value:e.data>=a.value)&&(n=this._getOrReturnCtx(e,n),k(n,{code:_.too_big,maximum:a.value,type:\"number\",inclusive:a.inclusive,exact:!1,message:a.message}),i.dirty()):a.kind===\"multipleOf\"?m9(e.data,a.value)!==0&&(n=this._getOrReturnCtx(e,n),k(n,{code:_.not_multiple_of,multipleOf:a.value,message:a.message}),i.dirty()):a.kind===\"finite\"?Number.isFinite(e.data)||(n=this._getOrReturnCtx(e,n),k(n,{code:_.not_finite,message:a.message}),i.dirty()):K.assertNever(a);return{status:i.value,value:e.data}}gte(e,r){return this.setLimit(\"min\",e,!0,q.toString(r))}gt(e,r){return this.setLimit(\"min\",e,!1,q.toString(r))}lte(e,r){return this.setLimit(\"max\",e,!0,q.toString(r))}lt(e,r){return this.setLimit(\"max\",e,!1,q.toString(r))}setLimit(e,r,n,i){return new t({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:n,message:q.toString(i)}]})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:\"int\",message:q.toString(e)})}positive(e){return this._addCheck({kind:\"min\",value:0,inclusive:!1,message:q.toString(e)})}negative(e){return this._addCheck({kind:\"max\",value:0,inclusive:!1,message:q.toString(e)})}nonpositive(e){return this._addCheck({kind:\"max\",value:0,inclusive:!0,message:q.toString(e)})}nonnegative(e){return this._addCheck({kind:\"min\",value:0,inclusive:!0,message:q.toString(e)})}multipleOf(e,r){return this._addCheck({kind:\"multipleOf\",value:e,message:q.toString(r)})}finite(e){return this._addCheck({kind:\"finite\",message:q.toString(e)})}safe(e){return this._addCheck({kind:\"min\",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:q.toString(e)})._addCheck({kind:\"max\",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:q.toString(e)})}get minValue(){let e=null;for(let r of this._def.checks)r.kind===\"min\"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(let r of this._def.checks)r.kind===\"max\"&&(e===null||r.value<e)&&(e=r.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind===\"int\"||e.kind===\"multipleOf\"&&K.isInteger(e.value))}get isFinite(){let e=null,r=null;for(let n of this._def.checks){if(n.kind===\"finite\"||n.kind===\"int\"||n.kind===\"multipleOf\")return!0;n.kind===\"min\"?(r===null||n.value>r)&&(r=n.value):n.kind===\"max\"&&(e===null||n.value<e)&&(e=n.value)}return Number.isFinite(r)&&NumberThu, 29 Jan 2026 21:35:00 GMT express-session deprecated req.secret; provide secret option at node:internal/modules/cjs/loader:1706:14","attributes":{"level":"error"},"tags":{"project":"29c6c2c4-ea10-4fe6-8901-1198a13520db","environment":"9a47f9fb-0d50-4031-a85e-16db1d46fb86","service":"09a1965e-88d6-44ee-9836-14176d4bb0b5","deployment":"e78c90dd-bc00-48f5-9312-8a8fa977b2c2","replica":"68b779c1-91b1-4ca6-88f4-a907899be5f1"},"timestamp":"2026-01-29T21:35:00.715012966Z"},{"message":"/app/dist/index.cjs:71","attributes":{"level":"error"},"tags":{"project":"29c6c2c4-ea10-4fe6-8901-1198a13520db","environment":"9a47f9fb-0d50-4031-a85e-16db1d46fb86","service":"09a1965e-88d6-44ee-9836-14176d4bb0b5","deployment":"e78c90dd-bc00-48f5-9312-8a8fa977b2c2","replica":"68b779c1-91b1-4ca6-88f4-a907899be5f1"},"timestamp":"2026-01-29T21:35:01.422518782Z"},{"message":"\t\t`;await r.execute(g`CREATE SCHEMA IF NOT EXISTS ${g.identifier(a)}`),await r.execute(s);let u=(await r.all(g`select id, hash, created_at from ${g.identifier(a)}.${g.identifier(i)} order by created_at desc limit 1`))[0];await r.transaction(async c=>{for await(let l of e)if(!u||Number(u.created_at)<l.folderMillis){for(let p of l.sql)await c.execute(g.raw(p));await c.execute(g`insert into ${g.identifier(a)}.${g.identifier(i)} (\"hash\", \"created_at\") values(${l.hash}, ${l.folderMillis})`)}})}escapeName(e){return`\"${e}\"`}escapeParam(e){return`$${e+1}`}escapeString(e){return`'${e.replace(/'/g,\"''\")}'`}buildWithCTE(e){if(!e?.length)return;let r=[g`with `];for(let[n,i]of e.entries())r.push(g`${g.identifier(i._.alias)} as (${i._.sql})`),n<e.length-1&&r.push(g`, `);return r.push(g` `),g.join(r)}buildDeleteQuery({table:e,where:r,returning:n,withList:i}){let a=this.buildWithCTE(i),s=n?g` returning ${this.buildSelection(n,{isSingleTable:!0})}`:void 0,o=r?g` where ${r}`:void 0;return g`${a}delete from ${e}${o}${s}`}buildUpdateSet(e,r){let n=e[A.Symbol.Columns],i=Object.keys(n).filter(s=>r[s]!==void 0||n[s]?.onUpdateFn!==void 0),a=i.length;return g.join(i.flatMap((s,o)=>{let u=n[s],c=r[s]??g.param(u.onUpdateFn(),u),l=g`${g.identifier(this.casing.getColumnCasing(u))} = ${c}`;return o<a-1?[l,g.raw(\", \")]:[l]}))}buildUpdateQuery({table:e,set:r,where:n,returning:i,withList:a,from:s,joins:o}){let u=this.buildWithCTE(a),c=e[Te.Symbol.Name],l=e[Te.Symbol.Schema],p=e[Te.Symbol.OriginalName],d=c===p?void 0:c,f=g`${l?g`${g.identifier(l)}.`:void 0}${g.identifier(p)}${d&&g` ${g.identifier(d)}`}`,y=this.buildUpdateSet(e,r),m=s&&g.join([g.raw(\" from \"),this.buildFromTable(s)]),x=this.buildJoins(o),w=i?g` returning ${this.buildSelection(i,{isSingleTable:!s})}`:void 0,T=n?g` where ${n}`:void 0;return g`${u}update ${f} set ${y}${m}${x}${T}${w}`}buildSelection(e,{isSingleTable:r=!1}={}){let n=e.length,i=e.flatMap(({field:a},s)=>{let o=[];if(b(a,O.Aliased)&&a.isSelectionField)o.push(g.identifier(a.fieldAlias));else if(b(a,O.Aliased)||b(a,O)){let u=b(a,O.Aliased)?a.sql:a;r?o.push(new O(u.queryChunks.map(c=>b(c,E)?g.identifier(this.casing.getColumnCasing(c)):c))):o.push(u),b(a,O.Aliased)&&o.push(g` as ${g.identifier(a.fieldAlias)}`)}else b(a,J)&&(r?o.push(g.identifier(this.casing.getColumnCasing(a))):o.push(a));return s<n-1&&o.push(g`, `),o});return g.join(i)}buildJoins(e){if(!e||e.length===0)return;let r=[];for(let[n,i]of e.entries()){n===0&&r.push(g` `);let a=i.table,s=i.lateral?g` lateral`:void 0;if(b(a,Te)){let o=a[Te.Symbol.Name],u=a[Te.Symbol.Schema],c=a[Te.Symbol.OriginalName],l=o===c?void 0:i.alias;r.push(g`${g.raw(i.joinType)} join${s} ${u?g`${g.identifier(u)}.`:void 0}${g.identifier(c)}${l&&g` ${g.identifier(l)}`} on ${i.on}`)}else if(b(a,Ue)){let o=a[te].name,u=a[te].schema,c=a[te].originalName,l=o===c?void 0:i.alias;r.push(g`${g.raw(i.joinType)} join${s} ${u?g`${g.identifier(u)}.`:void 0}${g.identifier(c)}${l&&g` ${g.identifier(l)}`} on ${i.on}`)}else r.push(g`${g.raw(i.joinType)} join${s} ${a} on ${i.on}`);n<e.length-1&&r.push(g` `)}return g.join(r)}buildFromTable(e){if(b(e,A)&&e[A.Symbol.OriginalName]!==e[A.Symbol.Name]){let r=g`${g.identifier(e[A.Symbol.OriginalName])}`;return e[A.Symbol.Schema]&&(r=g`${g.identifier(e[A.Symbol.Schema])}.${r}`),g`${r} ${g.identifier(e[A.Symbol.Name])}`}return e}buildSelectQuery({withList:e,fields:r,fieldsFlat:n,where:i,having:a,table:s,joins:o,orderBy:u,groupBy:c,limit:l,offset:p,lockingClause:d,distinct:f,setOperators:y}){let m=n??gt(r);for(let ne of m)if(b(ne.field,J)&&We(ne.field.table)!==(b(s,ye)?s._.alias:b(s,oi)?s[te].name:b(s,O)?void 0:We(s))&&!(he=>o?.some(({alias:et})=>et===(he[A.Symbol.IsAlias]?We(he):he[A.Symbol.BaseName])))(ne.field.table)){let he=We(ne.field.table);throw new Error(`Your \"${ne.path.join(\"->\")}\" field references a column \"${he}\".\"${ne.field.name}\", but the table \"${he}\" is not part of the query! Did you forget to join it?`)}let x=!o||o.length===0,w=this.buildWithCTE(e),T;f&&(T=f===!0?g` distinct`:g` distinct on (${g.join(f.on,g`, `)})`);let S=this.buildSelection(m,{isSingleTable:x}),C=this.buildFromTable(s),L=this.buildJoins(o),j=i?g` where ${i}`:void 0,R=a?g` having ${a}`:void 0,N;u&&u.length>0&&(N=g` order by ${g.join(u,g`, `)}`);let Q;c&&c.length>0&&(Q=g` group by ${g.join(c,g`, `)}`);let fe=typeof l==\"object\"||typeof l==\"number\"&&l>=0?g` limit ${l}`:void 0,_t=p?g` offset ${p}`:void 0,qe=g.empty();if(d){let ne=g` for ${g.raw(d.strength)}`;d.config.of&&ne.append(g` of ${g.join(Array.isArray(d.config.of)?d.config.of:[d.config.of],g`, `)}`),d.config.noWait?ne.append(g` no wait`):d.config.skipLocked&&ne.append(g` skip locked`),qe.append(ne)}let se=g`${w}select${T} ${S} from ${C}${L}${j}${Q}${R}${N}${fe}${_t}${qe}`;return y.length>0?this.buildSetOperations(se,y):se}buildSetOperations(e,r){let[n,...i]=r;if(!n)throw new Error(\"Cannot pass undefined values to any set operator\");return i.length===0?this.buildSetOperationQuery({leftSelect:e,setOperator:n}):this.buildSetOperations(this.buildSetOperationQuery({leftSelect:e,setOperator:n}),i)}buildSetOperationQuery({leftSelect:e,setOperator:{type:r,isAll:n,rightSelect:i,limit:a,orderBy:s,offset:o}}){let u=g`(${e.getSQL()}) `,c=g`(${i.getSQL()})`,l;if(s&&s.length>0){let y=[];for(let m of s)if(b(m,E))y.push(g.identifier(m.name));else if(b(m,O)){for(let x=0;x<m.queryChunks.length;x++){let w=m.queryChunks[x];b(w,E)&&(m.queryChunks[x]=g.identifier(w.name))}y.push(g`${m}`)}else y.push(g`${m}`);l=g` order by ${g.join(y,g`, `)} `}let p=typeof a==\"object\"||typeof a==\"number\"&&a>=0?g` limit ${a}`:void 0,d=g.raw(`${r} ${n?\"all \":\"\"}`),f=o?g` offset ${o}`:void 0;return g`${u}${d}${c}${l}${p}${f}`}buildInsertQuery({table:e,values:r,onConflict:n,returning:i,withList:a,select:s,overridingSystemValue_:o}){let u=[],c=e[A.Symbol.Columns],l=Object.entries(c).filter(([w,T])=>!T.shouldDisableInsert()),p=l.map(([,w])=>g.identifier(this.casing.getColumnCasing(w)));if(s){let w=r;b(w,O)?u.push(w):u.push(w.getSQL())}else{let w=r;u.push(g.raw(\"values \"));for(let[T,S]of w.entries()){let C=[];for(let[L,j]of l){let R=S[L];if(R===void 0||b(R,Ge)&&R.value===void 0)if(j.defaultFn!==void 0){let N=j.defaultFn(),Q=b(N,O)?N:g.param(N,j);C.push(Q)}else if(!j.default&&j.onUpdateFn!==void 0){let N=j.onUpdateFn(),Q=b(N,O)?N:g.param(N,j);C.push(Q)}else C.push(g`default`);else C.push(R)}u.push(C),T<w.length-1&&u.push(g`, `)}}let d=this.buildWithCTE(a),f=g.join(u),y=i?g` returning ${this.buildSelection(i,{isSingleTable:!0})}`:void 0,m=n?g` on conflict ${n}`:void 0,x=o===!0?g`overriding system value `:void 0;return g`${d}insert into ${e} ${p} ${x}${f}${m}${y}`}buildRefreshMaterializedViewQuery({view:e,concurrently:r,withNoData:n}){let i=r?g` concurrently`:void 0,a=n?g` with no data`:void 0;return g`refresh materialized view${i} ${e}${a}`}prepareTyping(e){return b(e,Sa)||b(e,_a)?\"json\":b(e,Ea)?\"decimal\":b(e,Ta)?\"time\":b(e,ka)||b(e,Aa)?\"timestamp\":b(e,ba)||b(e,wa)?\"date\":b(e,Ca)?\"uuid\":\"none\"}sqlToQuery(e,r){return e.toQuery({casing:this.casing,escapeName:this.escapeName,escapeParam:this.escapeParam,escapeString:this.escapeString,prepareTyping:this.prepareTyping,invokeSource:r})}buildRelationalQueryWithoutPK({fullSchema:e,schema:r,tableNamesMap:n,table:i,tableConfig:a,queryConfig:s,tableAlias:o,nestedQueryRelation:u,joinOn:c}){let l=[],p,d,f=[],y,m=[];if(s===!0)l=Object.entries(a.columns).map(([T,S])=>({dbKey:S.name,tsKey:T,field:Dt(S,o),relationTableTsKey:void 0,isJson:!1,selection:[]}));else{let w=Object.fromEntries(Object.entries(a.columns).map(([R,N])=>[R,Dt(N,o)]));if(s.where){let R=typeof s.where==\"function\"?s.where(w,F_()):s.where;y=R&&ga(R,o)}let T=[],S=[];if(s.columns){let R=!1;for(let[N,Q]of Object.entries(s.columns))Q!==void 0&&N in a.columns&&(!R&&Q===!0&&(R=!0),S.push(N));S.length>0&&(S=R?S.filter(N=>s.columns?.[N]===!0):Object.keys(a.columns).filter(N=>!S.includes(N)))}else S=Object.keys(a.columns);for(let R of S){let N=a.columns[R];T.push({tsKey:R,value:N})}let C=[];s.with&&(C=Object.entries(s.with).filter(R=>!!R[1]).map(([R,N])=>({tsKey:R,queryConfig:N,relation:a.relations[R]})));let L;if(s.extras){L=typeof s.extras==\"function\"?s.extras(w,{sql:g}):s.extras;for(let[R,N]of Object.entries(L))T.push({tsKey:R,value:pd(N,o)})}for(let{tsKey:R,value:N}of T)l.push({dbKey:b(N,O.Aliased)?N.fieldAlias:a.columns[R].name,tsKey:R,field:b(N,J)?Dt(N,o):N,relationTableTsKey:void 0,isJson:!1,selection:[]});let j=typeof s.orderBy==\"function\"?s.orderBy(w,$_()):s.orderBy??[];Array.isArray(j)||(j=[j]),f=j.map(R=>b(R,J)?Dt(R,o):ga(R,o)),p=s.limit,d=s.offset;for(let{tsKey:R,queryConfig:N,relation:Q}of C){let fe=B_(r,n,Q),_t=Hr(Q.referencedTable),qe=n[_t],se=`${o}_${R}`,ne=Pa(...fe.fields.map((Ht,qi)=>kt(Dt(fe.references[qi],se),Dt(Ht,o)))),he=this.buildRelationalQueryWithoutPK({fullSchema:e,schema:r,tableNamesMap:n,table:e[qe],tableConfig:r[qe],queryConfig:b(Q,xr)?N===!0?{limit:1}:{...N,limit:1}:N,tableAlias:se,joinOn:ne,nestedQueryRelation:Q}),et=g`${g.identifier(se)}.${g.identifier(\"data\")}`.as(R);m.push({on:g`true`,table:new ye(he.sql,{},se),alias:se,joinType:\"left\",lateral:!0}),l.push({dbKey:R,tsKey:R,field:et,relationTableTsKey:qe,isJson:!0,selection:he.selection})}}if(l.length===0)throw new xa({message:`No fields selected for table \"${a.tsName}\" (\"${o}\")`});let x;if(y=Pa(c,y),u){let w=g`json_build_array(${g.join(l.map(({field:C,tsKey:L,isJson:j})=>j?g`${g.identifier(`${o}_${L}`)}.${g.identifier(\"data\")}`:b(C,O.Aliased)?C.sql:C),g`, `)})`;b(u,Oa)&&(w=g`coalesce(json_agg(${w}${f.length>0?g` order by ${g.join(f,g`, `)}`:void 0}), '[]'::json)`);let T=[{dbKey:\"data\",tsKey:\"data\",field:w.as(\"data\"),isJson:!0,relationTableTsKey:a.tsName,selection:l}];p!==void 0||d!==void 0||f.length>0?(x=this.buildSelectQuery({table:ma(i,o),fields:{},fieldsFlat:[{path:[],field:g.raw(\"*\")}],where:y,limit:p,offset:d,orderBy:f,setOperators:[]}),y=void 0,p=void 0,d=void 0,f=[]):x=ma(i,o),x=this.buildSelectQuery({table:b(x,Te)?x:new ye(x,{},o),fields:{},fieldsFlat:T.map(({field:C})=>({path:[],field:b(C,J)?Dt(C,o):C})),joins:m,where:y,limit:p,offset:d,orderBy:f,setOperators:[]})}else x=this.buildSelectQuery({table:ma(i,o),fields:{},fieldsFlat:l.map(({field:w})=>({path:[],field:b(w,J)?Dt(w,o):w})),joins:m,where:y,limit:p,offset:d,orderBy:f,setOperators:[]});return{tableTsKey:a.tsName,sql:x,selection:l}}};var zo=class{static[h]=\"TypedQueryBuilder\";getSelectedFields(){return this._.selectedFields}};var De=class{static[h]=\"PgSelectBuilder\";fields;session;dialect;withList=[];distinct;constructor(e){this.fields=e.fields,this.session=e.session,this.dialect=e.dialect,e.withList&&(this.withList=e.withList),this.distinct=e.distinct}authToken;setToken(e){return this.authToken=e,this}from(e){let r=!!this.fields,n=e,i;return this.fields?i=this.fields:b(n,ye)?i=Object.fromEntries(Object.keys(n._.selectedFields).map(a=>[a,n[a]])):b(n,oi)?i=n[te].selectedFields:b(n,O)?i={}:i=qo(n),new Ho({table:n,fields:i,isPartialSelect:r,session:this.session,dialect:this.dialect,withList:this.withList,distinct:this.distinct}).setToken(this.authToken)}},If=class extends zo{static[h]=\"PgSelectQueryBuilder\";_;config;joinsNotNullableMap;tableName;isPartialSelect;session;dialect;constructor({table:e,fields:r,isPartialSelect:n,session:i,dialect:a,withList:s,distinct:o}){super(),this.config={withList:s,table:e,fields:{...r},distinct:o,setOperators:[]},this.isPartialSelect=n,this.session=i,this.dialect=a,this._={selectedFields:r},this.tableName=er(e),this.joinsNotNullableMap=typeof this.tableName==\"string\"?{[this.tableName]:!0}:{}}createJoin(e){return(r,n)=>{let i=this.tableName,a=er(r);if(typeof a==\"string\"&&this.config.joins?.some(s=>s.alias===a))throw new Error(`Alias \"${a}\" is already used in this query`);if(!this.isPartialSelect&&(Object.keys(this.joinsNotNullableMap).length===1&&typeof i==\"string\"&&(this.config.fields={[i]:this.config.fields}),typeof a==\"string\"&&!b(r,O))){let s=b(r,ye)?r._.selectedFields:b(r,Ue)?r[te].selectedFields:r[A.Symbol.Columns];this.config.fields[a]=s}if(typeof n==\"function\"&&(n=n(new Proxy(this.config.fields,new de({sqlAliasedBehavior:\"sql\",sqlBehavior:\"sql\"})))),this.config.joins||(this.config.joins=[]),this.config.joins.push({on:n,table:r,joinType:e,alias:a}),typeof a==\"string\")switch(e){case\"left\":{this.joinsNotNullableMap[a]=!1;break}case\"right\":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([s])=>[s,!1])),this.joinsNotNullableMap[a]=!0;break}case\"inner\":{this.joinsNotNullableMap[a]=!0;break}case\"full\":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([s])=>[s,!1])),this.joinsNotNullableMap[a]=!1;break}}return this}}leftJoin=this.createJoin(\"left\");rightJoin=this.createJoin(\"right\");innerJoin=this.createJoin(\"inner\");fullJoin=this.createJoin(\"full\");createSetOperator(e,r){return n=>{let i=typeof n==\"function\"?n(MI()):n;if(!va(this.getSelectedFields(),i.getSelectedFields()))throw new Error(\"Set operator error (union / intersect / except): selected fields are not the same or are in a different order\");return this.config.setOperators.push({type:e,isAll:r,rightSelect:i}),this}}union=this.createSetOperator(\"union\",!1);unionAll=this.createSetOperator(\"union\",!0);intersect=this.createSetOperator(\"intersect\",!1);intersectAll=this.createSetOperator(\"intersect\",!0);except=this.createSetOperator(\"except\",!1);exceptAll=this.createSetOperator(\"except\",!0);addSetOperators(e){return this.config.setOperators.push(...e),this}where(e){return typeof e==\"function\"&&(e=e(new Proxy(this.config.fields,new de({sqlAliasedBehavior:\"sql\",sqlBehavior:\"sql\"})))),this.config.where=e,this}having(e){return typeof e==\"function\"&&(e=e(new Proxy(this.config.fields,new de({sqlAliasedBehavior:\"sql\",sqlBehavior:\"sql\"})))),this.config.having=e,this}groupBy(...e){if(typeof e[0]==\"function\"){let r=e[0](new Proxy(this.config.fields,new de({sqlAliasedBehavior:\"alias\",sqlBehavior:\"sql\"})));this.config.groupBy=Array.isArray(r)?r:[r]}else this.config.groupBy=e;return this}orderBy(...e){if(typeof e[0]==\"function\"){let r=e[0](new Proxy(this.config.fields,new de({sqlAliasedBehavior:\"alias\",sqlBehavior:\"sql\"}))),n=Array.isArray(r)?r:[r];this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=n:this.config.orderBy=n}else{let r=e;this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=r:this.config.orderBy=r}return this}limit(e){return this.config.setOperators.length>0?this.config.setOperators.at(-1).limit=e:this.config.limit=e,this}offset(e){return this.config.setOperators.length>0?this.config.setOperators.at(-1).offset=e:this.config.offset=e,this}for(e,r={}){return this.config.lockingClause={strength:e,config:r},this}getSQL(){return this.dialect.buildSelectQuery(this.config)}toSQL(){let{typings:e,...r}=this.dialect.sqlToQuery(this.getSQL());return r}as(e){return new Proxy(new ye(this.getSQL(),this.config.fields,e),new de({alias:e,sqlAliasedBehavior:\"alias\",sqlBehavior:\"error\"}))}getSelectedFields(){return new Proxy(this.config.fields,new de({alias:this.tableName,sqlAliasedBehavior:\"alias\",sqlBehavior:\"error\"}))}$dynamic(){return this}},Ho=class extends If{static[h]=\"PgSelect\";_prepare(e){let{session:r,config:n,dialect:i,joinsNotNullableMap:a,authToken:s}=this;if(!r)throw new Error(\"Cannot execute a query on a query builder. Please use a database instance instead.\");return ee.startActiveSpan(\"drizzle.prepareQuery\",()=>{let o=gt(n.fields),u=r.prepareQuery(i.sqlToQuery(this.getSQL()),o,e,!0);return u.joinsNotNullableMap=a,u.setToken(s)})}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>ee.startActiveSpan(\"drizzle.operation\",()=>this._prepare().execute(e,this.authToken))};$1(Ho,[je]);function ci(t,e){return(r,n,...i)=>{let a=[n,...i].map(s=>({type:t,isAll:e,rightSelect:s}));for(let s of a)if(!va(r.getSelectedFields(),s.rightSelect.getSelectedFields()))throw new Error(\"Set operator error (union / intersect / except): selected fields are not the same or are in a different order\");return r.addSetOperators(a)}}var MI=()=>({union:FI,unionAll:$I,intersect:UI,intersectAll:BI,except:zI,exceptAll:HI}),FI=ci(\"union\",!1),$I=ci(\"union\",!0),UI=ci(\"intersect\",!1),BI=ci(\"intersect\",!0),zI=ci(\"except\",!1),HI=ci(\"except\",!0);var ui=class{static[h]=\"PgQueryBuilder\";dialect;dialectConfig;constructor(e){this.dialect=b(e,br)?e:void 0,this.dialectConfig=b(e,br)?void 0:e}$with=(e,r)=>{let n=this;return{as:a=>(typeof a==\"function\"&&(a=a(n)),new Proxy(new ni(a.getSQL(),r??(\"getSelectedFields\"in a?a.getSelectedFields()??{}:{}),e,!0),new de({alias:e,sqlAliasedBehavior:\"alias\",sqlBehavior:\"error\"})))}};with(...e){let r=this;function n(s){return new De({fields:s??void 0,session:void 0,dialect:r.getDialect(),withList:e})}function i(s){return new De({fields:s??void 0,session:void 0,dialect:r.getDialect(),distinct:!0})}function a(s,o){return new De({fields:o??void 0,session:void 0,dialect:r.getDialect(),distinct:{on:s}})}return{select:n,selectDistinct:i,selectDistinctOn:a}}select(e){return new De({fields:e??void 0,session:void 0,dialect:this.getDialect()})}selectDistinct(e){return new De({fields:e??void 0,session:void 0,dialect:this.getDialect(),distinct:!0})}selectDistinctOn(e,r){return new De({fields:r??void 0,session:void 0,dialect:this.getDialect(),distinct:{on:e}})}getDialect(){return this.dialect||(this.dialect=new br(this.dialectConfig)),this.dialect}};var Ra=class{constructor(e,r,n,i,a){this.table=e,this.session=r,this.dialect=n,this.withList=i,this.overridingSystemValue_=a}static[h]=\"PgInsertBuilder\";authToken;setToken(e){return this.authToken=e,this}overridingSystemValue(){return this.overridingSystemValue_=!0,this}values(e){if(e=Array.isArray(e)?e:[e],e.length===0)throw new Error(\"values() must be called with at least one value\");let r=e.map(n=>{let i={},a=this.table[A.Symbol.Columns];for(let s of Object.keys(n)){let o=n[s];i[s]=b(o,O)?o:new Ge(o,a[s])}return i});return new Qo(this.table,r,this.session,this.dialect,this.withList,!1,this.overridingSystemValue_).setToken(this.authToken)}select(e){let r=typeof e==\"function\"?e(new ui):e;if(!b(r,O)&&!va(this.table[Io],r._.selectedFields))throw new Error(\"Insert select error: selected fields are not the same or are in a different order compared to the table definition\");return new Qo(this.table,r,this.session,this.dialect,this.withList,!0)}},Qo=class extends je{constructor(e,r,n,i,a,s,o){super(),this.session=n,this.dialect=i,this.config={table:e,values:r,withList:a,select:s,overridingSystemValue_:o}}static[h]=\"PgInsert\";config;returning(e=this.config.table[A.Symbol.Columns]){return this.config.returningFields=e,this.config.returning=gt(e),this}onConflictDoNothing(e={}){if(e.target===void 0)this.config.onConflict=g`do nothing`;else{let r=\"\";r=Array.isArray(e.target)?e.target.map(i=>this.dialect.escapeName(this.dialect.casing.getColumnCasing(i))).join(\",\"):this.dialect.escapeName(this.dialect.casing.getColumnCasing(e.target));let n=e.where?g` where ${e.where}`:void 0;this.config.onConflict=g`(${g.raw(r)})${n} do nothing`}return this}onConflictDoUpdate(e){if(e.where&&(e.targetWhere||e.setWhere))throw new Error('You cannot use both \"where\" and \"targetWhere\"/\"setWhere\" at the same time - \"where\" is deprecated, use \"targetWhere\" or \"setWhere\" instead.');let r=e.where?g` where ${e.where}`:void 0,n=e.targetWhere?g` where ${e.targetWhere}`:void 0,i=e.setWhere?g` where ${e.setWhere}`:void 0,a=this.dialect.buildUpdateSet(this.config.table,No(this.config.table,e.set)),s=\"\";return s=Array.isArray(e.target)?e.target.map(o=>this.dialect.escapeName(this.dialect.casing.getColumnCasing(o))).join(\",\"):this.dialect.escapeName(this.dialect.casing.getColumnCasing(e.target)),this.config.onConflict=g`(${g.raw(s)})${n} do update set ${a}${r}${i}`,this}getSQL(){return this.dialect.buildInsertQuery(this.config)}toSQL(){let{typings:e,...r}=this.dialect.sqlToQuery(this.getSQL());return r}_prepare(e){return ee.startActiveSpan(\"drizzle.prepareQuery\",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,e,!0))}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>ee.startActiveSpan(\"drizzle.operation\",()=>this._prepare().execute(e,this.authToken));getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new de({alias:We(this.config.table),sqlAliasedBehavior:\"alias\",sqlBehavior:\"error\"})):void 0}$dynamic(){return this}};var Vo=class extends je{constructor(e,r,n){super(),this.session=r,this.dialect=n,this.config={view:e}}static[h]=\"PgRefreshMaterializedView\";config;concurrently(){if(this.config.withNoData!==void 0)throw new Error(\"Cannot use concurrently and withNoData together\");return this.config.concurrently=!0,this}withNoData(){if(this.config.concurrently!==void 0)throw new Error(\"Cannot use concurrently and withNoData together\");return this.config.withNoData=!0,this}getSQL(){return this.dialect.buildRefreshMaterializedViewQuery(this.config)}toSQL(){let{typings:e,...r}=this.dialect.sqlToQuery(this.getSQL());return r}_prepare(e){return ee.startActiveSpan(\"drizzle.prepareQuery\",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),void 0,e,!0))}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>ee.startActiveSpan(\"drizzle.operation\",()=>this._prepare().execute(e,this.authToken))};var Ia=class{constructor(e,r,n,i){this.table=e,this.session=r,this.dialect=n,this.withList=i}static[h]=\"PgUpdateBuilder\";authToken;setToken(e){return this.authToken=e,this}set(e){return new Nf(this.table,No(this.table,e),this.session,this.dialect,this.withList).setToken(this.authToken)}},Nf=class extends je{constructor(e,r,n,i,a){super(),this.session=n,this.dialect=i,this.config={set:r,table:e,withList:a,joins:[]},this.tableName=er(e),this.joinsNotNullableMap=typeof this.tableName==\"string\"?{[this.tableName]:!0}:{}}static[h]=\"PgUpdate\";config;tableName;joinsNotNullableMap;from(e){let r=e,n=er(r);return typeof n==\"string\"&&(this.joinsNotNullableMap[n]=!0),this.config.from=r,this}getTableLikeFields(e){return b(e,Te)?e[A.Symbol.Columns]:b(e,ye)?e._.selectedFields:e[te].selectedFields}createJoin(e){return(r,n)=>{let i=er(r);if(typeof i==\"string\"&&this.config.joins.some(a=>a.alias===i))throw new Error(`Alias \"${i}\" is already used in this query`);if(typeof n==\"function\"){let a=this.config.from&&!b(this.config.from,O)?this.getTableLikeFields(this.config.from):void 0;n=n(new Proxy(this.config.table[A.Symbol.Columns],new de({sqlAliasedBehavior:\"sql\",sqlBehavior:\"sql\"})),a&&new Proxy(a,new de({sqlAliasedBehavior:\"sql\",sqlBehavior:\"sql\"})))}if(this.config.joins.push({on:n,table:r,joinType:e,alias:i}),typeof i==\"string\")switch(e){case\"left\":{this.joinsNotNullableMap[i]=!1;break}case\"right\":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([a])=>[a,!1])),this.joinsNotNullableMap[i]=!0;break}case\"inner\":{this.joinsNotNullableMap[i]=!0;break}case\"full\":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([a])=>[a,!1])),this.joinsNotNullableMap[i]=!1;break}}return this}}leftJoin=this.createJoin(\"left\");rightJoin=this.createJoin(\"right\");innerJoin=this.createJoin(\"inner\");fullJoin=this.createJoin(\"full\");where(e){return this.config.where=e,this}returning(e){if(!e&&(e=Object.assign({},this.config.table[A.Symbol.Columns]),this.config.from)){let r=er(this.config.from);if(typeof r==\"string\"&&this.config.from&&!b(this.config.from,O)){let n=this.getTableLikeFields(this.config.from);e[r]=n}for(let n of this.config.joins){let i=er(n.table);if(typeof i==\"string\"&&!b(n.table,O)){let a=this.getTableLikeFields(n.table);e[i]=a}}}return this.config.returningFields=e,this.config.returning=gt(e),this}getSQL(){return this.dialect.buildUpdateQuery(this.config)}toSQL(){let{typings:e,...r}=this.dialect.sqlToQuery(this.getSQL());return r}_prepare(e){let r=this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,e,!0);return r.joinsNotNullableMap=this.joinsNotNullableMap,r}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>this._prepare().execute(e,this.authToken);getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new de({alias:We(this.config.table),sqlAliasedBehavior:\"alias\",sqlBehavior:\"error\"})):void 0}$dynamic(){return this}};var Ko=class t extends O{constructor(e){super(t.buildEmbeddedCount(e.source,e.filters).queryChunks),this.params=e,this.mapWith(Number),this.session=e.session,this.sql=t.buildCount(e.source,e.filters)}sql;token;static[h]=\"PgCountBuilder\";[Symbol.toStringTag]=\"PgCountBuilder\";session;static buildEmbeddedCount(e,r){return g`(select count(*) from ${e}${g.raw(\" where \").if(r)}${r})`}static buildCount(e,r){return g`select count(*) as count from ${e}${g.raw(\" where \").if(r)}${r};`}setToken(e){return this.token=e,this}then(e,r){return Promise.resolve(this.session.count(this.sql,this.token)).then(e,r)}catch(e){return this.then(void 0,e)}finally(e){return this.then(r=>(e?.(),r),r=>{throw e?.(),r})}};var Wo=class{constructor(e,r,n,i,a,s,o){this.fullSchema=e,this.schema=r,this.tableNamesMap=n,this.table=i,this.tableConfig=a,this.dialect=s,this.session=o}static[h]=\"PgRelationalQueryBuilder\";findMany(e){return new Go(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,e||{},\"many\")}findFirst(e){return new Go(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,e?{...e,limit:1}:{limit:1},\"first\")}},Go=class extends je{constructor(e,r,n,i,a,s,o,u,c){super(),this.fullSchema=e,this.schema=r,this.tableNamesMap=n,this.table=i,this.tableConfig=a,this.dialect=s,this.session=o,this.config=u,this.mode=c}static[h]=\"PgRelationalQuery\";_prepare(e){return ee.startActiveSpan(\"drizzle.prepareQuery\",()=>{let{query:r,builtQuery:n}=this._toSQL();return this.session.prepareQuery(n,void 0,e,!0,(i,a)=>{let s=i.map(o=>Bo(this.schema,this.tableConfig,o,r.selection,a));return this.mode===\"first\"?s[0]:s})})}prepare(e){return this._prepare(e)}_getQuery(){return this.dialect.buildRelationalQueryWithoutPK({fullSchema:this.fullSchema,schema:this.schema,tableNamesMap:this.tableNamesMap,table:this.table,tableConfig:this.tableConfig,queryConfig:this.config,tableAlias:this.tableConfig.tsName})}getSQL(){return this._getQuery().sql}_toSQL(){let e=this._getQuery(),r=this.dialect.sqlToQuery(e.sql);return{query:e,builtQuery:r}}toSQL(){return this._toSQL().builtQuery}authToken;setToken(e){return this.authToken=e,this}execute(){return ee.startActiveSpan(\"drizzle.operation\",()=>this._prepare().execute(void 0,this.authToken))}};var Jo=class extends je{constructor(e,r,n,i){super(),this.execute=e,this.sql=r,this.query=n,this.mapBatchResult=i}static[h]=\"PgRaw\";getSQL(){return this.sql}getQuery(){return this.query}mapResult(e,r){return r?this.mapBatchResult(e):e}_prepare(){return this}isResponseInArrayMode(){return!1}};var li=class{constructor(e,r,n){if(this.dialect=e,this.session=r,this._=n?{schema:n.schema,fullSchema:n.fullSchema,tableNamesMap:n.tableNamesMap,session:r}:{schema:void 0,fullSchema:{},tableNamesMap:{},session:r},this.query={},this._.schema)for(let[i,a]of Object.entries(this._.schema))this.query[i]=new Wo(n.fullSchema,this._.schema,this._.tableNamesMap,n.fullSchema[i],a,e,r)}static[h]=\"PgDatabase\";query;$with=(e,r)=>{let n=this;return{as:a=>(typeof a==\"function\"&&(a=a(new ui(n.dialect))),new Proxy(new ni(a.getSQL(),r??(\"getSelectedFields\"in a?a.getSelectedFields()??{}:{}),e,!0),new de({alias:e,sqlAliasedBehavior:\"alias\",sqlBehavior:\"error\"})))}};$count(e,r){return new Ko({source:e,filters:r,session:this.session})}with(...e){let r=this;function n(c){return new De({fields:c??void 0,session:r.session,dialect:r.dialect,withList:e})}function i(c){return new De({fields:c??void 0,session:r.session,dialect:r.dialect,withList:e,distinct:!0})}function a(c,l){return new De({fields:l??void 0,session:r.session,dialect:r.dialect,withList:e,distinct:{on:c}})}function s(c){return new Ia(c,r.session,r.dialect,e)}function o(c){return new Ra(c,r.session,r.dialect,e)}function u(c){return new ya(c,r.session,r.dialect,e)}return{select:n,selectDistinct:i,selectDistinctOn:a,update:s,insert:o,delete:u}}select(e){return new De({fields:e??void 0,session:this.session,dialect:this.dialect})}selectDistinct(e){return new De({fields:e??void 0,session:this.session,dialect:this.dialect,distinct:!0})}selectDistinctOn(e,r){return new De({fields:r??void 0,session:this.session,dialect:this.dialect,distinct:{on:e}})}update(e){return new Ia(e,this.session,this.dialect)}insert(e){return new Ra(e,this.session,this.dialect)}delete(e){return new ya(e,this.session,this.dialect)}refreshMaterializedView(e){return new Vo(e,this.session,this.dialect)}authToken;execute(e){let r=typeof e==\"string\"?g.raw(e):e.getSQL(),n=this.dialect.sqlToQuery(r),i=this.session.prepareQuery(n,void 0,void 0,!1);return new Jo(()=>i.execute(void 0,this.authToken),r,n,a=>i.mapResult(a,!0))}transaction(e,r){return this.session.transaction(e,r)}};var qf=class{constructor(e,r){this.unique=e,this.name=r}static[h]=\"PgIndexBuilderOn\";on(...e){return new Na(e.map(r=>{if(b(r,O))return r;r=r;let n=new ri(r.name,!!r.keyAsName,r.columnType,r.indexConfig);return r.indexConfig=JSON.parse(JSON.stringify(r.defaultConfig)),n}),this.unique,!1,this.name)}onOnly(...e){return new Na(e.map(r=>{if(b(r,O))return r;r=r;let n=new ri(r.name,!!r.keyAsName,r.columnType,r.indexConfig);return r.indexConfig=r.defaultConfig,n}),this.unique,!0,this.name)}using(e,...r){return new Na(r.map(n=>{if(b(n,O))return n;n=n;let i=new ri(n.name,!!n.keyAsName,n.columnType,n.indexConfig);return n.indexConfig=JSON.parse(JSON.stringify(n.defaultConfig)),i}),this.unique,!0,this.name,e)}},Na=class{static[h]=\"PgIndexBuilder\";config;constructor(e,r,n,i,a=\"btree\"){this.config={name:i,columns:e,unique:r,only:n,method:a}}concurrently(){return this.config.concurrently=!0,this}with(e){return this.config.with=e,this}where(e){return this.config.where=e,this}build(e){return new jf(this.config,e)}},jf=class{static[h]=\"PgIndex\";config;constructor(e,r){this.config={...e,table:r}}};function H_(t){return new qf(!1,t)}var Zo=class{constructor(e){this.query=e}authToken;getQuery(){return this.query}mapResult(e,r){return e}setToken(e){return this.authToken=e,this}static[h]=\"PgPreparedQuery\";joinsNotNullableMap},Xo=class{constructor(e){this.dialect=e}static[h]=\"PgSession\";execute(e,r){return ee.startActiveSpan(\"drizzle.operation\",()=>ee.startActiveSpan(\"drizzle.prepareQuery\",()=>this.prepareQuery(this.dialect.sqlToQuery(e),void 0,void 0,!1)).setToken(r).execute(void 0,r))}all(e){return this.prepareQuery(this.dialect.sqlToQuery(e),void 0,void 0,!1).all()}async count(e,r){let n=await this.execute(e,r);return Number(n[0].count)}},Yo=class extends li{constructor(e,r,n,i=0){super(e,r,n),this.schema=n,this.nestedIndex=i}static[h]=\"PgTransaction\";rollback(){throw new Do}getTransactionConfigSQL(e){let r=[];return e.isolationLevel&&r.push(`isolation level ${e.isolationLevel}`),e.accessMode&&r.push(e.accessMode),typeof e.deferrable==\"boolean\"&&r.push(e.deferrable?\"deferrable\":\"not deferrable\"),g.raw(r.join(\" \"))}setTransaction(e){return this.session.execute(g`set transaction ${this.getTransactionConfigSQL(e)}`)}};var{Pool:Q_,types:Mt}=yr,Df=class extends Zo{constructor(e,r,n,i,a,s,o,u){super({sql:r,params:n}),this.client=e,this.params=n,this.logger=i,this.fields=a,this._isResponseInArrayMode=o,this.customResultMapper=u,this.rawQueryConfig={name:s,text:r,types:{getTypeParser:(c,l)=>c===Mt.builtins.TIMESTAMPTZ?p=>p:c===Mt.builtins.TIMESTAMP?p=>p:c===Mt.builtins.DATE?p=>p:c===Mt.builtins.INTERVAL?p=>p:Mt.getTypeParser(c,l)}},this.queryConfig={name:s,text:r,rowMode:\"array\",types:{getTypeParser:(c,l)=>c===Mt.builtins.TIMESTAMPTZ?p=>p:c===Mt.builtins.TIMESTAMP?p=>p:c===Mt.builtins.DATE?p=>p:c===Mt.builtins.INTERVAL?p=>p:Mt.getTypeParser(c,l)}}}static[h]=\"NodePgPreparedQuery\";rawQueryConfig;queryConfig;async execute(e={}){return ee.startActiveSpan(\"drizzle.execute\",async()=>{let r=ld(this.params,e);this.logger.logQuery(this.rawQueryConfig.text,r);let{fields:n,rawQueryConfig:i,client:a,queryConfig:s,joinsNotNullableMap:o,customResultMapper:u}=this;if(!n&&!u)return ee.startActiveSpan(\"drizzle.driver.execute\",async l=>(l?.setAttributes({\"drizzle.query.name\":i.name,\"drizzle.query.text\":i.text,\"drizzle.query.params\":JSON.stringify(r)}),a.query(i,r)));let c=await ee.startActiveSpan(\"drizzle.driver.execute\",l=>(l?.setAttributes({\"drizzle.query.name\":s.name,\"drizzle.query.text\":s.text,\"drizzle.query.params\":JSON.stringify(r)}),a.query(s,r)));return ee.startActiveSpan(\"drizzle.mapResponse\",()=>u?u(c.rows):c.rows.map(l=>F1(n,l,o)))})}all(e={}){return ee.startActiveSpan(\"drizzle.execute\",()=>{let r=ld(this.params,e);return this.logger.logQuery(this.rawQueryConfig.text,r),ee.startActiveSpan(\"drizzle.driver.execute\",n=>(n?.setAttributes({\"drizzle.query.name\":this.rawQueryConfig.name,\"drizzle.query.text\":this.rawQueryConfig.text,\"drizzle.query.params\":JSON.stringify(r)}),this.client.query(this.rawQueryConfig,r).then(i=>i.rows)))})}isResponseInArrayMode(){return this._isResponseInArrayMode}},ec=class t extends Xo{constructor(e,r,n,i={}){super(r),this.client=e,this.schema=n,this.options=i,this.logger=i.logger??new Ao}static[h]=\"NodePgSession\";logger;prepareQuery(e,r,n,i,a){return new Df(this.client,e.sql,e.params,this.logger,r,n,i,a)}async transaction(e,r){let n=this.client instanceof Q_?new t(await this.client.connect(),this.dialect,this.schema,this.options):this,i=new Lf(this.dialect,n,this.schema);await i.execute(g`begin${r?g` ${i.getTransactionConfigSQL(r)}`:void 0}`);try{let a=await e(i);return await i.execute(g`commit`),a}catch(a){throw await i.execute(g`rollback`),a}finally{this.client instanceof Q_&&n.client.release()}}async count(e){let r=await this.execute(e);return Number(r.rows[0].count)}},Lf=class t extends Yo{static[h]=\"NodePgTransaction\";async transaction(e){let r=`sp${this.nestedIndex+1}`,n=new t(this.dialect,this.session,this.schema,this.nestedIndex+1);await n.execute(g.raw(`savepoint ${r}`));try{let i=await e(n);return await n.execute(g.raw(`release savepoint ${r}`)),i}catch(i){throw await n.execute(g.raw(`rollback to savepoint ${r}`)),i}}};var Mf=class{constructor(e,r,n={}){this.client=e,this.dialect=r,this.options=n}static[h]=\"NodePgDriver\";createSession(e){return new ec(this.client,this.dialect,e,{logger:this.options.logger})}},Ff=class extends li{static[h]=\"NodePgDatabase\"};function qa(t,e={}){let r=new br({casing:e.casing}),n;e.logger===!0?n=new ko:e.logger!==!1&&(n=e.logger);let i;if(e.schema){let u=U_(e.schema,z_);i={fullSchema:e.schema,schema:u.tables,tableNamesMap:u.tableNamesMap}}let s=new Mf(t,r,{logger:n}).createSession(i),o=new Ff(r,s,i);return o.$client=t,o}function tc(...t){if(typeof t[0]==\"string\"){let e=new yr.Pool({connectionString:t[0]});return qa(e,t[1])}if(B1(t[0])){let{connection:e,client:r,...n}=t[0];if(r)return qa(r,n);let i=typeof e==\"string\"?new yr.Pool({connectionString:e}):new yr.Pool(e);return qa(i,n)}return qa(t[0],t[1])}(t=>{function e(r){return qa({},r)}t.mock=e})(tc||(tc={}));var oc={};Rc(oc,{inquiries:()=>at,insertInquirySchema:()=>Hf,insertUserSchema:()=>lN,sessions:()=>uN,users:()=>Tr});var Ie={};Rc(Ie,{BRAND:()=>g9,DIRTY:()=>Vr,EMPTY_PATH:()=>WI,INVALID:()=>D,NEVER:()=>eN,OK:()=>Le,ParseStatus:()=>Re,Schema:()=>H,ZodAny:()=>Sr,ZodArray:()=>ar,ZodBigInt:()=>Wr,ZodBoolean:()=>Gr,ZodBranded:()=>Da,ZodCatch:()=>on,ZodDate:()=>Jr,ZodDefault:()=>sn,ZodDiscriminatedUnion:()=>ic,ZodEffects:()=>bt,ZodEnum:()=>nn,ZodError:()=>Ze,ZodFirstPartyTypeKind:()=>M,ZodFunction:()=>sc,ZodIntersection:()=>en,ZodIssueCode:()=>_,ZodLazy:()=>tn,ZodLiteral:()=>rn,ZodMap:()=>gi,ZodNaN:()=>yi,ZodNativeEnum:()=>an,ZodNever:()=>At,ZodNull:()=>Xr,ZodNullable:()=>Ut,ZodNumber:()=>Kr,ZodObject:()=>Xe,ZodOptional:()=>yt,ZodParsedType:()=>P,ZodPipeline:()=>La,ZodPromise:()=>Er,ZodReadonly:()=>cn,ZodRecord:()=>ac,ZodSchema:()=>H,ZodSet:()=>vi,ZodString:()=>_r,ZodSymbol:()=>hi,ZodTransformer:()=>bt,ZodTuple:()=>$t,ZodType:()=>H,ZodUndefined:()=>Zr,ZodUnion:()=>Yr,ZodUnknown:()=>ir,ZodVoid:()=>mi,addIssueToContext:()=>k,any:()=>T9,array:()=>P9,bigint:()=>b9,boolean:()=>rS,coerce:()=>Y9,custom:()=>Y_,date:()=>w9,datetimeRegex:()=>Z_,defaultErrorMap:()=>rr,discriminatedUnion:()=>N9,effect:()=>Q9,enum:()=>B9,function:()=>F9,getErrorMap:()=>pi,getParsedType:()=>Ft,instanceof:()=>y9,intersection:()=>q9,isAborted:()=>rc,isAsync:()=>di,isDirty:()=>nc,isValid:()=>wr,late:()=>v9,lazy:()=>$9,literal:()=>U9,makeIssue:()=>ja,map:()=>L9,nan:()=>x9,nativeEnum:()=>z9,never:()=>A9,null:()=>E9,nullable:()=>K9,number:()=>tS,object:()=>O9,objectUtil:()=>$f,oboolean:()=>X9,onumber:()=>Z9,optional:()=>V9,ostring:()=>J9,pipeline:()=>G9,preprocess:()=>W9,promise:()=>H9,quotelessJson:()=>QI,record:()=>D9,set:()=>M9,setErrorMap:()=>KI,strictObject:()=>R9,string:()=>eS,symbol:()=>_9,transformer:()=>Q9,tuple:()=>j9,undefined:()=>S9,union:()=>I9,unknown:()=>k9,util:()=>K,void:()=>C9});var K;(function(t){t.assertEqual=i=>{};function e(i){}t.assertIs=e;function r(i){throw new Error}t.assertNever=r,t.arrayToEnum=i=>{let a={};for(let s of i)a[s]=s;return a},t.getValidEnumValues=i=>{let a=t.objectKeys(i).filter(o=>typeof i[i[o]]!=\"number\"),s={};for(let o of a)s[o]=i[o];return t.objectValues(s)},t.objectValues=i=>t.objectKeys(i).map(function(a){return i[a]}),t.objectKeys=typeof Object.keys==\"function\"?i=>Object.keys(i):i=>{let a=[];for(let s in i)Object.prototype.hasOwnProperty.call(i,s)&&a.push(s);return a},t.find=(i,a)=>{for(let s of i)if(a(s))return s},t.isInteger=typeof Number.isInteger==\"function\"?i=>Number.isInteger(i):i=>typeof i==\"number\"&&Number.isFinite(i)&&Math.floor(i)===i;function n(i,a=\" | \"){return i.map(s=>typeof s==\"string\"?`'${s}'`:s).join(a)}t.joinValues=n,t.jsonStringifyReplacer=(i,a)=>typeof a==\"bigint\"?a.toString():a})(K||(K={}));var $f;(function(t){t.mergeShapes=(e,r)=>({...e,...r})})($f||($f={}));var P=K.arrayToEnum([\"string\",\"nan\",\"number\",\"integer\",\"float\",\"boolean\",\"date\",\"bigint\",\"symbol\",\"function\",\"undefined\",\"null\",\"array\",\"object\",\"unknown\",\"promise\",\"void\",\"never\",\"map\",\"set\"]),Ft=t=>{switch(typeof t){case\"undefined\":return P.undefined;case\"string\":return P.string;case\"number\":return Number.isNaN(t)?P.nan:P.number;case\"boolean\":return P.boolean;case\"function\":return P.function;case\"bigint\":return P.bigint;case\"symbol\":return P.symbol;case\"object\":return Array.isArray(t)?P.array:t===null?P.null:t.then&&typeof t.then==\"function\"&&t.catch&&typeof t.catch==\"function\"?P.promise:typeof Map<\"u\"&&t instanceof Map?P.map:typeof Set<\"u\"&&t instanceof Set?P.set:typeof Date<\"u\"&&t instanceof Date?P.date:P.object;default:return P.unknown}};var _=K.arrayToEnum([\"invalid_type\",\"invalid_literal\",\"custom\",\"invalid_union\",\"invalid_union_discriminator\",\"invalid_enum_value\",\"unrecognized_keys\",\"invalid_arguments\",\"invalid_return_type\",\"invalid_date\",\"invalid_string\",\"too_small\",\"too_big\",\"invalid_intersection_types\",\"not_multiple_of\",\"not_finite\"]),QI=t=>JSON.stringify(t,null,2).replace(/\"([^\"]+)\":/g,\"$1:\"),Ze=class t extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};let r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name=\"ZodError\",this.issues=e}format(e){let r=e||function(a){return a.message},n={_errors:[]},i=a=>{for(let s of a.issues)if(s.code===\"invalid_union\")s.unionErrors.map(i);else if(s.code===\"invalid_return_type\")i(s.returnTypeError);else if(s.code===\"invalid_arguments\")i(s.argumentsError);else if(s.path.length===0)n._errors.push(r(s));else{let o=n,u=0;for(;u<s.path.length;){let c=s.path[u];u===s.path.length-1?(o[c]=o[c]||{_errors:[]},o[c]._errors.push(r(s))):o[c]=o[c]||{_errors:[]},o=o[c],u++}}};return i(this),n}static assert(e){if(!(e instanceof t))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,K.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=r=>r.message){let r={},n=[];for(let i of this.issues)if(i.path.length>0){let a=i.path[0];r[a]=r[a]||[],r[a].push(e(i))}else n.push(e(i));return{formErrors:n,fieldErrors:r}}get formErrors(){return this.flatten()}};Ze.create=t=>new Ze(t);var VI=(t,e)=>{let r;switch(t.code){case _.invalid_type:t.received===P.undefined?r=\"Required\":r=`Expected ${t.expected}, received ${t.received}`;break;case _.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(t.expected,K.jsonStringifyReplacer)}`;break;case _.unrecognized_keys:r=`Unrecognized key(s) in object: ${K.joinValues(t.keys,\", \")}`;break;case _.invalid_union:r=\"Invalid input\";break;case _.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${K.joinValues(t.options)}`;break;case _.invalid_enum_value:r=`Invalid enum value. Expected ${K.joinValues(t.options)}, received '${t.received}'`;break;case _.invalid_arguments:r=\"Invalid function arguments\";break;case _.invalid_return_type:r=\"Invalid function return type\";break;case _.invalid_date:r=\"Invalid date\";break;case _.invalid_string:typeof t.validation==\"object\"?\"includes\"in t.validation?(r=`Invalid input: must include \"${t.validation.includes}\"`,typeof t.validation.position==\"number\"&&(r=`${r} at one or more positions greater than or equal to ${t.validation.position}`)):\"startsWith\"in t.validation?r=`Invalid input: must start with \"${t.validation.startsWith}\"`:\"endsWith\"in t.validation?r=`Invalid input: must end with \"${t.validation.endsWith}\"`:K.assertNever(t.validation):t.validation!==\"regex\"?r=`Invalid ${t.validation}`:r=\"Invalid\";break;case _.too_small:t.type===\"array\"?r=`Array must contain ${t.exact?\"exactly\":t.inclusive?\"at least\":\"more than\"} ${t.minimum} element(s)`:t.type===\"string\"?r=`String must contain ${t.exact?\"exactly\":t.inclusive?\"at least\":\"over\"} ${t.minimum} character(s)`:t.type===\"number\"?r=`Number must be ${t.exact?\"exactly equal to \":t.inclusive?\"greater than or equal to \":\"greater than \"}${t.minimum}`:t.type===\"bigint\"?r=`Number must be ${t.exact?\"exactly equal to \":t.inclusive?\"greater than or equal to \":\"greater than \"}${t.minimum}`:t.type===\"date\"?r=`Date must be ${t.exact?\"exactly equal to \":t.inclusive?\"greater than or equal to \":\"greater than \"}${new Date(Number(t.minimum))}`:r=\"Invalid input\";break;case _.too_big:t.type===\"array\"?r=`Array must contain ${t.exact?\"exactly\":t.inclusive?\"at most\":\"less than\"} ${t.maximum} element(s)`:t.type===\"string\"?r=`String must contain ${t.exact?\"exactly\":t.inclusive?\"at most\":\"under\"} ${t.maximum} character(s)`:t.type===\"number\"?r=`Number must be ${t.exact?\"exactly\":t.inclusive?\"less than or equal to\":\"less than\"} ${t.maximum}`:t.type===\"bigint\"?r=`BigInt must be ${t.exact?\"exactly\":t.inclusive?\"less than or equal to\":\"less than\"} ${t.maximum}`:t.type===\"date\"?r=`Date must be ${t.exact?\"exactly\":t.inclusive?\"smaller than or equal to\":\"smaller than\"} ${new Date(Number(t.maximum))}`:r=\"Invalid input\";break;case _.custom:r=\"Invalid input\";break;case _.invalid_intersection_types:r=\"Intersection results could not be merged\";break;case _.not_multiple_of:r=`Number must be a multiple of ${t.multipleOf}`;break;case _.not_finite:r=\"Number must be finite\";break;default:r=e.defaultError,K.assertNever(t)}return{message:r}},rr=VI;var V_=rr;function KI(t){V_=t}function pi(){return V_}var ja=t=>{let{data:e,path:r,errorMaps:n,issueData:i}=t,a=[...r,...i.path||[]],s={...i,path:a};if(i.message!==void 0)return{...i,path:a,message:i.message};let o=\"\",u=n.filter(c=>!!c).slice().reverse();for(let c of u)o=c(s,{data:e,defaultError:o}).message;return{...i,path:a,message:o}},WI=[];function k(t,e){let r=pi(),n=ja({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,r,r===rr?void 0:rr].filter(i=>!!i)});t.common.issues.push(n)}var Re=class t{constructor(){this.value=\"valid\"}dirty(){this.value===\"valid\"&&(this.value=\"dirty\")}abort(){this.value!==\"aborted\"&&(this.value=\"aborted\")}static mergeArray(e,r){let n=[];for(let i of r){if(i.status===\"aborted\")return D;i.status===\"dirty\"&&e.dirty(),n.push(i.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,r){let n=[];for(let i of r){let a=await i.key,s=await i.value;n.push({key:a,value:s})}return t.mergeObjectSync(e,n)}static mergeObjectSync(e,r){let n={};for(let i of r){let{key:a,value:s}=i;if(a.status===\"aborted\"||s.status===\"aborted\")return D;a.status===\"dirty\"&&e.dirty(),s.status===\"dirty\"&&e.dirty(),a.value!==\"__proto__\"&&(typeof s.value<\"u\"||i.alwaysSet)&&(n[a.value]=s.value)}return{status:e.value,value:n}}},D=Object.freeze({status:\"aborted\"}),Vr=t=>({status:\"dirty\",value:t}),Le=t=>({status:\"valid\",value:t}),rc=t=>t.status===\"aborted\",nc=t=>t.status===\"dirty\",wr=t=>t.status===\"valid\",di=t=>typeof Promise<\"u\"&&t instanceof Promise;var q;(function(t){t.errToObj=e=>typeof e==\"string\"?{message:e}:e||{},t.toString=e=>typeof e==\"string\"?e:e?.message})(q||(q={}));var xt=class{constructor(e,r,n,i){this._cachedPath=[],this.parent=e,this.data=r,this._path=n,this._key=i}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}},K_=(t,e)=>{if(wr(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error(\"Validation failed but no issues detected.\");return{success:!1,get error(){if(this._error)return this._error;let r=new Ze(t.common.issues);return this._error=r,this._error}}};function z(t){if(!t)return{};let{errorMap:e,invalid_type_error:r,required_error:n,description:i}=t;if(e&&(r||n))throw new Error(`Can't use \"invalid_type_error\" or \"required_error\" in conjunction with custom error map.`);return e?{errorMap:e,description:i}:{errorMap:(s,o)=>{let{message:u}=t;return s.code===\"invalid_enum_value\"?{message:u??o.defaultError}:typeof o.data>\"u\"?{message:u??n??o.defaultError}:s.code!==\"invalid_type\"?{message:o.defaultError}:{message:u??r??o.defaultError}},description:i}}var H=class{get description(){return this._def.description}_getType(e){return Ft(e.data)}_getOrReturnCtx(e,r){return r||{common:e.parent.common,data:e.data,parsedType:Ft(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Re,ctx:{common:e.parent.common,data:e.data,parsedType:Ft(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let r=this._parse(e);if(di(r))throw new Error(\"Synchronous parse encountered promise.\");return r}_parseAsync(e){let r=this._parse(e);return Promise.resolve(r)}parse(e,r){let n=this.safeParse(e,r);if(n.success)return n.data;throw n.error}safeParse(e,r){let n={common:{issues:[],async:r?.async??!1,contextualErrorMap:r?.errorMap},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ft(e)},i=this._parseSync({data:e,path:n.path,parent:n});return K_(n,i)}\"~validate\"(e){let r={common:{issues:[],async:!!this[\"~standard\"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ft(e)};if(!this[\"~standard\"].async)try{let n=this._parseSync({data:e,path:[],parent:r});return wr(n)?{value:n.value}:{issues:r.common.issues}}catch(n){n?.message?.toLowerCase()?.includes(\"encountered\")&&(this[\"~standard\"].async=!0),r.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:r}).then(n=>wr(n)?{value:n.value}:{issues:r.common.issues})}async parseAsync(e,r){let n=await this.safeParseAsync(e,r);if(n.success)return n.data;throw n.error}async safeParseAsync(e,r){let n={common:{issues:[],contextualErrorMap:r?.errorMap,async:!0},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ft(e)},i=this._parse({data:e,path:n.path,parent:n}),a=await(di(i)?i:Promise.resolve(i));return K_(n,a)}refine(e,r){let n=i=>typeof r==\"string\"||typeof r>\"u\"?{message:r}:typeof r==\"function\"?r(i):r;return this._refinement((i,a)=>{let s=e(i),o=()=>a.addIssue({code:_.custom,...n(i)});return typeof Promise<\"u\"&&s instanceof Promise?s.then(u=>u?!0:(o(),!1)):s?!0:(o(),!1)})}refinement(e,r){return this._refinement((n,i)=>e(n)?!0:(i.addIssue(typeof r==\"function\"?r(n,i):r),!1))}_refinement(e){return new bt({schema:this,typeName:M.ZodEffects,effect:{type:\"refinement\",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this[\"~standard\"]={version:1,vendor:\"zod\",validate:r=>this[\"~validate\"](r)}}optional(){return yt.create(this,this._def)}nullable(){return Ut.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return ar.create(this)}promise(){return Er.create(this,this._def)}or(e){return Yr.create([this,e],this._def)}and(e){return en.create(this,e,this._def)}transform(e){return new bt({...z(this._def),schema:this,typeName:M.ZodEffects,effect:{type:\"transform\",transform:e}})}default(e){let r=typeof e==\"function\"?e:()=>e;return new sn({...z(this._def),innerType:this,defaultValue:r,typeName:M.ZodDefault})}brand(){return new Da({typeName:M.ZodBranded,type:this,...z(this._def)})}catch(e){let r=typeof e==\"function\"?e:()=>e;return new on({...z(this._def),innerType:this,catchValue:r,typeName:M.ZodCatch})}describe(e){let r=this.constructor;return new r({...this._def,description:e})}pipe(e){return La.create(this,e)}readonly(){return cn.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}},GI=/^c[^\\s-]{8,}$/i,JI=/^[0-9a-z]+$/,ZI=/^[0-9A-HJKMNP-TV-Z]{26}$/i,XI=/^[0-9a-fA-F]{8}\\b-[0-9a-fA-F]{4}\\b-[0-9a-fA-F]{4}\\b-[0-9a-fA-F]{4}\\b-[0-9a-fA-F]{12}$/i,YI=/^[a-z0-9_-]{21}$/i,e9=/^[A-Za-z0-9-_]+\\.[A-Za-z0-9-_]+\\.[A-Za-z0-9-_]*$/,t9=/^[-+]?P(?!$)(?:(?:[-+]?\\d+Y)|(?:[-+]?\\d+[.,]\\d+Y$))?(?:(?:[-+]?\\d+M)|(?:[-+]?\\d+[.,]\\d+M$))?(?:(?:[-+]?\\d+W)|(?:[-+]?\\d+[.,]\\d+W$))?(?:(?:[-+]?\\d+D)|(?:[-+]?\\d+[.,]\\d+D$))?(?:T(?=[\\d+-])(?:(?:[-+]?\\d+H)|(?:[-+]?\\d+[.,]\\d+H$))?(?:(?:[-+]?\\d+M)|(?:[-+]?\\d+[.,]\\d+M$))?(?:[-+]?\\d+(?:[.,]\\d+)?S)?)??$/,r9=/^(?!\\.)(?!.*\\.\\.)([A-Z0-9_'+\\-\\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\\-]*\\.)+[A-Z]{2,}$/i,n9=\"^(\\\\p{Extended_Pictographic}|\\\\p{Emoji_Component})+$\",Uf,i9=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,a9=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\\/(3[0-2]|[12]?[0-9])$/,s9=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,o9=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,c9=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,u9=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,G_=\"((\\\\d\\\\d[2468][048]|\\\\d\\\\d[13579][26]|\\\\d\\\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\\\d|30)|(02)-(0[1-9]|1\\\\d|2[0-8])))\",l9=new RegExp(`^${G_}$`);function J_(t){let e=\"[0-5]\\\\d\";t.precision?e=`${e}\\\\.\\\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\\\.\\\\d+)?`);let r=t.precision?\"+\":\"?\";return`([01]\\\\d|2[0-3]):[0-5]\\\\d(:${e})${r}`}function p9(t){return new RegExp(`^${J_(t)}$`)}function Z_(t){let e=`${G_}T${J_(t)}`,r=[];return r.push(t.local?\"Z?\":\"Z\"),t.offset&&r.push(\"([+-]\\\\d{2}:?\\\\d{2})\"),e=`${e}(${r.join(\"|\")})`,new RegExp(`^${e}$`)}function d9(t,e){return!!((e===\"v4\"||!e)&&i9.test(t)||(e===\"v6\"||!e)&&s9.test(t))}function f9(t,e){if(!e9.test(t))return!1;try{let[r]=t.split(\".\");if(!r)return!1;let n=r.replace(/-/g,\"+\").replace(/_/g,\"/\").padEnd(r.length+(4-r.length%4)%4,\"=\"),i=JSON.parse(atob(n));return!(typeof i!=\"object\"||i===null||\"typ\"in i&&i?.typ!==\"JWT\"||!i.alg||e&&i.alg!==e)}catch{return!1}}function h9(t,e){return!!((e===\"v4\"||!e)&&a9.test(t)||(e===\"v6\"||!e)&&o9.test(t))}var _r=class t extends H{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==P.string){let a=this._getOrReturnCtx(e);return k(a,{code:_.invalid_type,expected:P.string,received:a.parsedType}),D}let n=new Re,i;for(let a of this._def.checks)if(a.kind===\"min\")e.data.length<a.value&&(i=this._getOrReturnCtx(e,i),k(i,{code:_.too_small,minimum:a.value,type:\"string\",inclusive:!0,exact:!1,message:a.message}),n.dirty());else if(a.kind===\"max\")e.data.length>a.value&&(i=this._getOrReturnCtx(e,i),k(i,{code:_.too_big,maximum:a.value,type:\"string\",inclusive:!0,exact:!1,message:a.message}),n.dirty());else if(a.kind===\"length\"){let s=e.data.length>a.value,o=e.data.length<a.value;(s||o)&&(i=this._getOrReturnCtx(e,i),s?k(i,{code:_.too_big,maximum:a.value,type:\"string\",inclusive:!0,exact:!0,message:a.message}):o&&k(i,{code:_.too_small,minimum:a.value,type:\"string\",inclusive:!0,exact:!0,message:a.message}),n.dirty())}else if(a.kind===\"email\")r9.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"email\",code:_.invalid_string,message:a.message}),n.dirty());else if(a.kind===\"emoji\")Uf||(Uf=new RegExp(n9,\"u\")),Uf.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"emoji\",code:_.invalid_string,message:a.message}),n.dirty());else if(a.kind===\"uuid\")XI.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"uuid\",code:_.invalid_string,message:a.message}),n.dirty());else if(a.kind===\"nanoid\")YI.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"nanoid\",code:_.invalid_string,message:a.message}),n.dirty());else if(a.kind===\"cuid\")GI.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"cuid\",code:_.invalid_string,message:a.message}),n.dirty());else if(a.kind===\"cuid2\")JI.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"cuid2\",code:_.invalid_string,message:a.message}),n.dirty());else if(a.kind===\"ulid\")ZI.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"ulid\",code:_.invalid_string,message:a.message}),n.dirty());else if(a.kind===\"url\")try{new URL(e.data)}catch{i=this._getOrReturnCtx(e,i),k(i,{validation:\"url\",code:_.invalid_string,message:a.message}),n.dirty()}else a.kind===\"regex\"?(a.regex.lastIndex=0,a.regex.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"regex\",code:_.invalid_string,message:a.message}),n.dirty())):a.kind===\"trim\"?e.data=e.data.trim():a.kind===\"includes\"?e.data.includes(a.value,a.position)||(i=this._getOrReturnCtx(e,i),k(i,{code:_.invalid_string,validation:{includes:a.value,position:a.position},message:a.message}),n.dirty()):a.kind===\"toLowerCase\"?e.data=e.data.toLowerCase():a.kind===\"toUpperCase\"?e.data=e.data.toUpperCase():a.kind===\"startsWith\"?e.data.startsWith(a.value)||(i=this._getOrReturnCtx(e,i),k(i,{code:_.invalid_string,validation:{startsWith:a.value},message:a.message}),n.dirty()):a.kind===\"endsWith\"?e.data.endsWith(a.value)||(i=this._getOrReturnCtx(e,i),k(i,{code:_.invalid_string,validation:{endsWith:a.value},message:a.message}),n.dirty()):a.kind===\"datetime\"?Z_(a).test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{code:_.invalid_string,validation:\"datetime\",message:a.message}),n.dirty()):a.kind===\"date\"?l9.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{code:_.invalid_string,validation:\"date\",message:a.message}),n.dirty()):a.kind===\"time\"?p9(a).test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{code:_.invalid_string,validation:\"time\",message:a.message}),n.dirty()):a.kind===\"duration\"?t9.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"duration\",code:_.invalid_string,message:a.message}),n.dirty()):a.kind===\"ip\"?d9(e.data,a.version)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"ip\",code:_.invalid_string,message:a.message}),n.dirty()):a.kind===\"jwt\"?f9(e.data,a.alg)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"jwt\",code:_.invalid_string,message:a.message}),n.dirty()):a.kind===\"cidr\"?h9(e.data,a.version)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"cidr\",code:_.invalid_string,message:a.message}),n.dirty()):a.kind===\"base64\"?c9.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"base64\",code:_.invalid_string,message:a.message}),n.dirty()):a.kind===\"base64url\"?u9.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"base64url\",code:_.invalid_string,message:a.message}),n.dirty()):K.assertNever(a);return{status:n.value,value:e.data}}_regex(e,r,n){return this.refinement(i=>e.test(i),{validation:r,code:_.invalid_string,...q.errToObj(n)})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:\"email\",...q.errToObj(e)})}url(e){return this._addCheck({kind:\"url\",...q.errToObj(e)})}emoji(e){return this._addCheck({kind:\"emoji\",...q.errToObj(e)})}uuid(e){return this._addCheck({kind:\"uuid\",...q.errToObj(e)})}nanoid(e){return this._addCheck({kind:\"nanoid\",...q.errToObj(e)})}cuid(e){return this._addCheck({kind:\"cuid\",...q.errToObj(e)})}cuid2(e){return this._addCheck({kind:\"cuid2\",...q.errToObj(e)})}ulid(e){return this._addCheck({kind:\"ulid\",...q.errToObj(e)})}base64(e){return this._addCheck({kind:\"base64\",...q.errToObj(e)})}base64url(e){return this._addCheck({kind:\"base64url\",...q.errToObj(e)})}jwt(e){return this._addCheck({kind:\"jwt\",...q.errToObj(e)})}ip(e){return this._addCheck({kind:\"ip\",...q.errToObj(e)})}cidr(e){return this._addCheck({kind:\"cidr\",...q.errToObj(e)})}datetime(e){return typeof e==\"string\"?this._addCheck({kind:\"datetime\",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:\"datetime\",precision:typeof e?.precision>\"u\"?null:e?.precision,offset:e?.offset??!1,local:e?.local??!1,...q.errToObj(e?.message)})}date(e){return this._addCheck({kind:\"date\",message:e})}time(e){return typeof e==\"string\"?this._addCheck({kind:\"time\",precision:null,message:e}):this._addCheck({kind:\"time\",precision:typeof e?.precision>\"u\"?null:e?.precision,...q.errToObj(e?.message)})}duration(e){return this._addCheck({kind:\"duration\",...q.errToObj(e)})}regex(e,r){return this._addCheck({kind:\"regex\",regex:e,...q.errToObj(r)})}includes(e,r){return this._addCheck({kind:\"includes\",value:e,position:r?.position,...q.errToObj(r?.message)})}startsWith(e,r){return this._addCheck({kind:\"startsWith\",value:e,...q.errToObj(r)})}endsWith(e,r){return this._addCheck({kind:\"endsWith\",value:e,...q.errToObj(r)})}min(e,r){return this._addCheck({kind:\"min\",value:e,...q.errToObj(r)})}max(e,r){return this._addCheck({kind:\"max\",value:e,...q.errToObj(r)})}length(e,r){return this._addCheck({kind:\"length\",value:e,...q.errToObj(r)})}nonempty(e){return this.min(1,q.errToObj(e))}trim(){return new t({...this._def,checks:[...this._def.checks,{kind:\"trim\"}]})}toLowerCase(){return new t({...this._def,checks:[...this._def.checks,{kind:\"toLowerCase\"}]})}toUpperCase(){return new t({...this._def,checks:[...this._def.checks,{kind:\"toUpperCase\"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind===\"datetime\")}get isDate(){return!!this._def.checks.find(e=>e.kind===\"date\")}get isTime(){return!!this._def.checks.find(e=>e.kind===\"time\")}get isDuration(){return!!this._def.checks.find(e=>e.kind===\"duration\")}get isEmail(){return!!this._def.checks.find(e=>e.kind===\"email\")}get isURL(){return!!this._def.checks.find(e=>e.kind===\"url\")}get isEmoji(){return!!this._def.checks.find(e=>e.kind===\"emoji\")}get isUUID(){return!!this._def.checks.find(e=>e.kind===\"uuid\")}get isNANOID(){return!!this._def.checks.find(e=>e.kind===\"nanoid\")}get isCUID(){return!!this._def.checks.find(e=>e.kind===\"cuid\")}get isCUID2(){return!!this._def.checks.find(e=>e.kind===\"cuid2\")}get isULID(){return!!this._def.checks.find(e=>e.kind===\"ulid\")}get isIP(){return!!this._def.checks.find(e=>e.kind===\"ip\")}get isCIDR(){return!!this._def.checks.find(e=>e.kind===\"cidr\")}get isBase64(){return!!this._def.checks.find(e=>e.kind===\"base64\")}get isBase64url(){return!!this._def.checks.find(e=>e.kind===\"base64url\")}get minLength(){let e=null;for(let r of this._def.checks)r.kind===\"min\"&&(e===null||r.value>e)&&(e=r.value);return e}get maxLength(){let e=null;for(let r of this._def.checks)r.kind===\"max\"&&(e===null||r.value<e)&&(e=r.value);return e}};_r.create=t=>new _r({checks:[],typeName:M.ZodString,coerce:t?.coerce??!1,...z(t)});function m9(t,e){let r=(t.toString().split(\".\")[1]||\"\").length,n=(e.toString().split(\".\")[1]||\"\").length,i=r>n?r:n,a=Number.parseInt(t.toFixed(i).replace(\".\",\"\")),s=Number.parseInt(e.toFixed(i).replace(\".\",\"\"));return a%s/10**i}var Kr=class t extends H{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==P.number){let a=this._getOrReturnCtx(e);return k(a,{code:_.invalid_type,expected:P.number,received:a.parsedType}),D}let n,i=new Re;for(let a of this._def.checks)a.kind===\"int\"?K.isInteger(e.data)||(n=this._getOrReturnCtx(e,n),k(n,{code:_.invalid_type,expected:\"integer\",received:\"float\",message:a.message}),i.dirty()):a.kind===\"min\"?(a.inclusive?e.data<a.value:e.data<=a.value)&&(n=this._getOrReturnCtx(e,n),k(n,{code:_.too_small,minimum:a.value,type:\"number\",inclusive:a.inclusive,exact:!1,message:a.message}),i.dirty()):a.kind===\"max\"?(a.inclusive?e.data>a.value:e.data>=a.value)&&(n=this._getOrReturnCtx(e,n),k(n,{code:_.too_big,maximum:a.value,type:\"number\",inclusive:a.inclusive,exact:!1,message:a.message}),i.dirty()):a.kind===\"multipleOf\"?m9(e.data,a.value)!==0&&(n=this._getOrReturnCtx(e,n),k(n,{code:_.not_multiple_of,multipleOf:a.value,message:a.message}),i.dirty()):a.kind===\"finite\"?Number.isFinite(e.data)||(n=this._getOrReturnCtx(e,n),k(n,{code:_.not_finite,message:a.message}),i.dirty()):K.assertNever(a);return{status:i.value,value:e.data}}gte(e,r){return this.setLimit(\"min\",e,!0,q.toString(r))}gt(e,r){return this.setLimit(\"min\",e,!1,q.toString(r))}lte(e,r){return this.setLimit(\"max\",e,!0,q.toString(r))}lt(e,r){return this.setLimit(\"max\",e,!1,q.toString(r))}setLimit(e,r,n,i){return new t({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:n,message:q.toString(i)}]})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:\"int\",message:q.toString(e)})}positive(e){return this._addCheck({kind:\"min\",value:0,inclusive:!1,message:q.toString(e)})}negative(e){return this._addCheck({kind:\"max\",value:0,inclusive:!1,message:q.toString(e)})}nonpositive(e){return this._addCheck({kind:\"max\",value:0,inclusive:!0,message:q.toString(e)})}nonnegative(e){return this._addCheck({kind:\"min\",value:0,inclusive:!0,message:q.toString(e)})}multipleOf(e,r){return this._addCheck({kind:\"multipleOf\",value:e,message:q.toString(r)})}finite(e){return this._addCheck({kind:\"finite\",message:q.toString(e)})}safe(e){return this._addCheck({kind:\"min\",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:q.toString(e)})._addCheck({kind:\"max\",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:q.toString(e)})}get minValue(){let e=null;for(let r of this._def.checks)r.kind===\"min\"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(let r of this._def.checks)r.kind===\"max\"&&(e===null||r.value<e)&&(e=r.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind===\"int\"||e.kind===\"multipleOf\"&&K.isInteger(e.value))}get isFinite(){let e=null,r=null;for(let n of this._def.checks){if(n.kind===\"finite\"||n.kind===\"int\"||n.kind===\"multipleOf\")return!0;n.kind===\"min\"?(r===null||n.value>r)&&(r=n.value):n.kind===\"max\"&&(e===null||n.value<e)&&(e=n.value)}return Number.isFinite(r)&&NumberThu, 29 Jan 2026 21:35:02 GMT express-session deprecated req.secret; provide secret option at node:internal/modules/cjs/loader:1706:14","attributes":{"level":"error"},"tags":{"project":"29c6c2c4-ea10-4fe6-8901-1198a13520db","environment":"9a47f9fb-0d50-4031-a85e-16db1d46fb86","service":"09a1965e-88d6-44ee-9836-14176d4bb0b5","deployment":"e78c90dd-bc00-48f5-9312-8a8fa977b2c2","replica":"68b779c1-91b1-4ca6-88f4-a907899be5f1"},"timestamp":"2026-01-29T21:35:02.726383592Z"},{"message":"/app/dist/index.cjs:71","attributes":{"level":"error"},"tags":{"project":"29c6c2c4-ea10-4fe6-8901-1198a13520db","environment":"9a47f9fb-0d50-4031-a85e-16db1d46fb86","service":"09a1965e-88d6-44ee-9836-14176d4bb0b5","deployment":"e78c90dd-bc00-48f5-9312-8a8fa977b2c2","replica":"68b779c1-91b1-4ca6-88f4-a907899be5f1"},"timestamp":"2026-01-29T21:35:03.452256231Z"},{"message":"\t\t`;await r.execute(g`CREATE SCHEMA IF NOT EXISTS ${g.identifier(a)}`),await r.execute(s);let u=(await r.all(g`select id, hash, created_at from ${g.identifier(a)}.${g.identifier(i)} order by created_at desc limit 1`))[0];await r.transaction(async c=>{for await(let l of e)if(!u||Number(u.created_at)<l.folderMillis){for(let p of l.sql)await c.execute(g.raw(p));await c.execute(g`insert into ${g.identifier(a)}.${g.identifier(i)} (\"hash\", \"created_at\") values(${l.hash}, ${l.folderMillis})`)}})}escapeName(e){return`\"${e}\"`}escapeParam(e){return`$${e+1}`}escapeString(e){return`'${e.replace(/'/g,\"''\")}'`}buildWithCTE(e){if(!e?.length)return;let r=[g`with `];for(let[n,i]of e.entries())r.push(g`${g.identifier(i._.alias)} as (${i._.sql})`),n<e.length-1&&r.push(g`, `);return r.push(g` `),g.join(r)}buildDeleteQuery({table:e,where:r,returning:n,withList:i}){let a=this.buildWithCTE(i),s=n?g` returning ${this.buildSelection(n,{isSingleTable:!0})}`:void 0,o=r?g` where ${r}`:void 0;return g`${a}delete from ${e}${o}${s}`}buildUpdateSet(e,r){let n=e[A.Symbol.Columns],i=Object.keys(n).filter(s=>r[s]!==void 0||n[s]?.onUpdateFn!==void 0),a=i.length;return g.join(i.flatMap((s,o)=>{let u=n[s],c=r[s]??g.param(u.onUpdateFn(),u),l=g`${g.identifier(this.casing.getColumnCasing(u))} = ${c}`;return o<a-1?[l,g.raw(\", \")]:[l]}))}buildUpdateQuery({table:e,set:r,where:n,returning:i,withList:a,from:s,joins:o}){let u=this.buildWithCTE(a),c=e[Te.Symbol.Name],l=e[Te.Symbol.Schema],p=e[Te.Symbol.OriginalName],d=c===p?void 0:c,f=g`${l?g`${g.identifier(l)}.`:void 0}${g.identifier(p)}${d&&g` ${g.identifier(d)}`}`,y=this.buildUpdateSet(e,r),m=s&&g.join([g.raw(\" from \"),this.buildFromTable(s)]),x=this.buildJoins(o),w=i?g` returning ${this.buildSelection(i,{isSingleTable:!s})}`:void 0,T=n?g` where ${n}`:void 0;return g`${u}update ${f} set ${y}${m}${x}${T}${w}`}buildSelection(e,{isSingleTable:r=!1}={}){let n=e.length,i=e.flatMap(({field:a},s)=>{let o=[];if(b(a,O.Aliased)&&a.isSelectionField)o.push(g.identifier(a.fieldAlias));else if(b(a,O.Aliased)||b(a,O)){let u=b(a,O.Aliased)?a.sql:a;r?o.push(new O(u.queryChunks.map(c=>b(c,E)?g.identifier(this.casing.getColumnCasing(c)):c))):o.push(u),b(a,O.Aliased)&&o.push(g` as ${g.identifier(a.fieldAlias)}`)}else b(a,J)&&(r?o.push(g.identifier(this.casing.getColumnCasing(a))):o.push(a));return s<n-1&&o.push(g`, `),o});return g.join(i)}buildJoins(e){if(!e||e.length===0)return;let r=[];for(let[n,i]of e.entries()){n===0&&r.push(g` `);let a=i.table,s=i.lateral?g` lateral`:void 0;if(b(a,Te)){let o=a[Te.Symbol.Name],u=a[Te.Symbol.Schema],c=a[Te.Symbol.OriginalName],l=o===c?void 0:i.alias;r.push(g`${g.raw(i.joinType)} join${s} ${u?g`${g.identifier(u)}.`:void 0}${g.identifier(c)}${l&&g` ${g.identifier(l)}`} on ${i.on}`)}else if(b(a,Ue)){let o=a[te].name,u=a[te].schema,c=a[te].originalName,l=o===c?void 0:i.alias;r.push(g`${g.raw(i.joinType)} join${s} ${u?g`${g.identifier(u)}.`:void 0}${g.identifier(c)}${l&&g` ${g.identifier(l)}`} on ${i.on}`)}else r.push(g`${g.raw(i.joinType)} join${s} ${a} on ${i.on}`);n<e.length-1&&r.push(g` `)}return g.join(r)}buildFromTable(e){if(b(e,A)&&e[A.Symbol.OriginalName]!==e[A.Symbol.Name]){let r=g`${g.identifier(e[A.Symbol.OriginalName])}`;return e[A.Symbol.Schema]&&(r=g`${g.identifier(e[A.Symbol.Schema])}.${r}`),g`${r} ${g.identifier(e[A.Symbol.Name])}`}return e}buildSelectQuery({withList:e,fields:r,fieldsFlat:n,where:i,having:a,table:s,joins:o,orderBy:u,groupBy:c,limit:l,offset:p,lockingClause:d,distinct:f,setOperators:y}){let m=n??gt(r);for(let ne of m)if(b(ne.field,J)&&We(ne.field.table)!==(b(s,ye)?s._.alias:b(s,oi)?s[te].name:b(s,O)?void 0:We(s))&&!(he=>o?.some(({alias:et})=>et===(he[A.Symbol.IsAlias]?We(he):he[A.Symbol.BaseName])))(ne.field.table)){let he=We(ne.field.table);throw new Error(`Your \"${ne.path.join(\"->\")}\" field references a column \"${he}\".\"${ne.field.name}\", but the table \"${he}\" is not part of the query! Did you forget to join it?`)}let x=!o||o.length===0,w=this.buildWithCTE(e),T;f&&(T=f===!0?g` distinct`:g` distinct on (${g.join(f.on,g`, `)})`);let S=this.buildSelection(m,{isSingleTable:x}),C=this.buildFromTable(s),L=this.buildJoins(o),j=i?g` where ${i}`:void 0,R=a?g` having ${a}`:void 0,N;u&&u.length>0&&(N=g` order by ${g.join(u,g`, `)}`);let Q;c&&c.length>0&&(Q=g` group by ${g.join(c,g`, `)}`);let fe=typeof l==\"object\"||typeof l==\"number\"&&l>=0?g` limit ${l}`:void 0,_t=p?g` offset ${p}`:void 0,qe=g.empty();if(d){let ne=g` for ${g.raw(d.strength)}`;d.config.of&&ne.append(g` of ${g.join(Array.isArray(d.config.of)?d.config.of:[d.config.of],g`, `)}`),d.config.noWait?ne.append(g` no wait`):d.config.skipLocked&&ne.append(g` skip locked`),qe.append(ne)}let se=g`${w}select${T} ${S} from ${C}${L}${j}${Q}${R}${N}${fe}${_t}${qe}`;return y.length>0?this.buildSetOperations(se,y):se}buildSetOperations(e,r){let[n,...i]=r;if(!n)throw new Error(\"Cannot pass undefined values to any set operator\");return i.length===0?this.buildSetOperationQuery({leftSelect:e,setOperator:n}):this.buildSetOperations(this.buildSetOperationQuery({leftSelect:e,setOperator:n}),i)}buildSetOperationQuery({leftSelect:e,setOperator:{type:r,isAll:n,rightSelect:i,limit:a,orderBy:s,offset:o}}){let u=g`(${e.getSQL()}) `,c=g`(${i.getSQL()})`,l;if(s&&s.length>0){let y=[];for(let m of s)if(b(m,E))y.push(g.identifier(m.name));else if(b(m,O)){for(let x=0;x<m.queryChunks.length;x++){let w=m.queryChunks[x];b(w,E)&&(m.queryChunks[x]=g.identifier(w.name))}y.push(g`${m}`)}else y.push(g`${m}`);l=g` order by ${g.join(y,g`, `)} `}let p=typeof a==\"object\"||typeof a==\"number\"&&a>=0?g` limit ${a}`:void 0,d=g.raw(`${r} ${n?\"all \":\"\"}`),f=o?g` offset ${o}`:void 0;return g`${u}${d}${c}${l}${p}${f}`}buildInsertQuery({table:e,values:r,onConflict:n,returning:i,withList:a,select:s,overridingSystemValue_:o}){let u=[],c=e[A.Symbol.Columns],l=Object.entries(c).filter(([w,T])=>!T.shouldDisableInsert()),p=l.map(([,w])=>g.identifier(this.casing.getColumnCasing(w)));if(s){let w=r;b(w,O)?u.push(w):u.push(w.getSQL())}else{let w=r;u.push(g.raw(\"values \"));for(let[T,S]of w.entries()){let C=[];for(let[L,j]of l){let R=S[L];if(R===void 0||b(R,Ge)&&R.value===void 0)if(j.defaultFn!==void 0){let N=j.defaultFn(),Q=b(N,O)?N:g.param(N,j);C.push(Q)}else if(!j.default&&j.onUpdateFn!==void 0){let N=j.onUpdateFn(),Q=b(N,O)?N:g.param(N,j);C.push(Q)}else C.push(g`default`);else C.push(R)}u.push(C),T<w.length-1&&u.push(g`, `)}}let d=this.buildWithCTE(a),f=g.join(u),y=i?g` returning ${this.buildSelection(i,{isSingleTable:!0})}`:void 0,m=n?g` on conflict ${n}`:void 0,x=o===!0?g`overriding system value `:void 0;return g`${d}insert into ${e} ${p} ${x}${f}${m}${y}`}buildRefreshMaterializedViewQuery({view:e,concurrently:r,withNoData:n}){let i=r?g` concurrently`:void 0,a=n?g` with no data`:void 0;return g`refresh materialized view${i} ${e}${a}`}prepareTyping(e){return b(e,Sa)||b(e,_a)?\"json\":b(e,Ea)?\"decimal\":b(e,Ta)?\"time\":b(e,ka)||b(e,Aa)?\"timestamp\":b(e,ba)||b(e,wa)?\"date\":b(e,Ca)?\"uuid\":\"none\"}sqlToQuery(e,r){return e.toQuery({casing:this.casing,escapeName:this.escapeName,escapeParam:this.escapeParam,escapeString:this.escapeString,prepareTyping:this.prepareTyping,invokeSource:r})}buildRelationalQueryWithoutPK({fullSchema:e,schema:r,tableNamesMap:n,table:i,tableConfig:a,queryConfig:s,tableAlias:o,nestedQueryRelation:u,joinOn:c}){let l=[],p,d,f=[],y,m=[];if(s===!0)l=Object.entries(a.columns).map(([T,S])=>({dbKey:S.name,tsKey:T,field:Dt(S,o),relationTableTsKey:void 0,isJson:!1,selection:[]}));else{let w=Object.fromEntries(Object.entries(a.columns).map(([R,N])=>[R,Dt(N,o)]));if(s.where){let R=typeof s.where==\"function\"?s.where(w,F_()):s.where;y=R&&ga(R,o)}let T=[],S=[];if(s.columns){let R=!1;for(let[N,Q]of Object.entries(s.columns))Q!==void 0&&N in a.columns&&(!R&&Q===!0&&(R=!0),S.push(N));S.length>0&&(S=R?S.filter(N=>s.columns?.[N]===!0):Object.keys(a.columns).filter(N=>!S.includes(N)))}else S=Object.keys(a.columns);for(let R of S){let N=a.columns[R];T.push({tsKey:R,value:N})}let C=[];s.with&&(C=Object.entries(s.with).filter(R=>!!R[1]).map(([R,N])=>({tsKey:R,queryConfig:N,relation:a.relations[R]})));let L;if(s.extras){L=typeof s.extras==\"function\"?s.extras(w,{sql:g}):s.extras;for(let[R,N]of Object.entries(L))T.push({tsKey:R,value:pd(N,o)})}for(let{tsKey:R,value:N}of T)l.push({dbKey:b(N,O.Aliased)?N.fieldAlias:a.columns[R].name,tsKey:R,field:b(N,J)?Dt(N,o):N,relationTableTsKey:void 0,isJson:!1,selection:[]});let j=typeof s.orderBy==\"function\"?s.orderBy(w,$_()):s.orderBy??[];Array.isArray(j)||(j=[j]),f=j.map(R=>b(R,J)?Dt(R,o):ga(R,o)),p=s.limit,d=s.offset;for(let{tsKey:R,queryConfig:N,relation:Q}of C){let fe=B_(r,n,Q),_t=Hr(Q.referencedTable),qe=n[_t],se=`${o}_${R}`,ne=Pa(...fe.fields.map((Ht,qi)=>kt(Dt(fe.references[qi],se),Dt(Ht,o)))),he=this.buildRelationalQueryWithoutPK({fullSchema:e,schema:r,tableNamesMap:n,table:e[qe],tableConfig:r[qe],queryConfig:b(Q,xr)?N===!0?{limit:1}:{...N,limit:1}:N,tableAlias:se,joinOn:ne,nestedQueryRelation:Q}),et=g`${g.identifier(se)}.${g.identifier(\"data\")}`.as(R);m.push({on:g`true`,table:new ye(he.sql,{},se),alias:se,joinType:\"left\",lateral:!0}),l.push({dbKey:R,tsKey:R,field:et,relationTableTsKey:qe,isJson:!0,selection:he.selection})}}if(l.length===0)throw new xa({message:`No fields selected for table \"${a.tsName}\" (\"${o}\")`});let x;if(y=Pa(c,y),u){let w=g`json_build_array(${g.join(l.map(({field:C,tsKey:L,isJson:j})=>j?g`${g.identifier(`${o}_${L}`)}.${g.identifier(\"data\")}`:b(C,O.Aliased)?C.sql:C),g`, `)})`;b(u,Oa)&&(w=g`coalesce(json_agg(${w}${f.length>0?g` order by ${g.join(f,g`, `)}`:void 0}), '[]'::json)`);let T=[{dbKey:\"data\",tsKey:\"data\",field:w.as(\"data\"),isJson:!0,relationTableTsKey:a.tsName,selection:l}];p!==void 0||d!==void 0||f.length>0?(x=this.buildSelectQuery({table:ma(i,o),fields:{},fieldsFlat:[{path:[],field:g.raw(\"*\")}],where:y,limit:p,offset:d,orderBy:f,setOperators:[]}),y=void 0,p=void 0,d=void 0,f=[]):x=ma(i,o),x=this.buildSelectQuery({table:b(x,Te)?x:new ye(x,{},o),fields:{},fieldsFlat:T.map(({field:C})=>({path:[],field:b(C,J)?Dt(C,o):C})),joins:m,where:y,limit:p,offset:d,orderBy:f,setOperators:[]})}else x=this.buildSelectQuery({table:ma(i,o),fields:{},fieldsFlat:l.map(({field:w})=>({path:[],field:b(w,J)?Dt(w,o):w})),joins:m,where:y,limit:p,offset:d,orderBy:f,setOperators:[]});return{tableTsKey:a.tsName,sql:x,selection:l}}};var zo=class{static[h]=\"TypedQueryBuilder\";getSelectedFields(){return this._.selectedFields}};var De=class{static[h]=\"PgSelectBuilder\";fields;session;dialect;withList=[];distinct;constructor(e){this.fields=e.fields,this.session=e.session,this.dialect=e.dialect,e.withList&&(this.withList=e.withList),this.distinct=e.distinct}authToken;setToken(e){return this.authToken=e,this}from(e){let r=!!this.fields,n=e,i;return this.fields?i=this.fields:b(n,ye)?i=Object.fromEntries(Object.keys(n._.selectedFields).map(a=>[a,n[a]])):b(n,oi)?i=n[te].selectedFields:b(n,O)?i={}:i=qo(n),new Ho({table:n,fields:i,isPartialSelect:r,session:this.session,dialect:this.dialect,withList:this.withList,distinct:this.distinct}).setToken(this.authToken)}},If=class extends zo{static[h]=\"PgSelectQueryBuilder\";_;config;joinsNotNullableMap;tableName;isPartialSelect;session;dialect;constructor({table:e,fields:r,isPartialSelect:n,session:i,dialect:a,withList:s,distinct:o}){super(),this.config={withList:s,table:e,fields:{...r},distinct:o,setOperators:[]},this.isPartialSelect=n,this.session=i,this.dialect=a,this._={selectedFields:r},this.tableName=er(e),this.joinsNotNullableMap=typeof this.tableName==\"string\"?{[this.tableName]:!0}:{}}createJoin(e){return(r,n)=>{let i=this.tableName,a=er(r);if(typeof a==\"string\"&&this.config.joins?.some(s=>s.alias===a))throw new Error(`Alias \"${a}\" is already used in this query`);if(!this.isPartialSelect&&(Object.keys(this.joinsNotNullableMap).length===1&&typeof i==\"string\"&&(this.config.fields={[i]:this.config.fields}),typeof a==\"string\"&&!b(r,O))){let s=b(r,ye)?r._.selectedFields:b(r,Ue)?r[te].selectedFields:r[A.Symbol.Columns];this.config.fields[a]=s}if(typeof n==\"function\"&&(n=n(new Proxy(this.config.fields,new de({sqlAliasedBehavior:\"sql\",sqlBehavior:\"sql\"})))),this.config.joins||(this.config.joins=[]),this.config.joins.push({on:n,table:r,joinType:e,alias:a}),typeof a==\"string\")switch(e){case\"left\":{this.joinsNotNullableMap[a]=!1;break}case\"right\":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([s])=>[s,!1])),this.joinsNotNullableMap[a]=!0;break}case\"inner\":{this.joinsNotNullableMap[a]=!0;break}case\"full\":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([s])=>[s,!1])),this.joinsNotNullableMap[a]=!1;break}}return this}}leftJoin=this.createJoin(\"left\");rightJoin=this.createJoin(\"right\");innerJoin=this.createJoin(\"inner\");fullJoin=this.createJoin(\"full\");createSetOperator(e,r){return n=>{let i=typeof n==\"function\"?n(MI()):n;if(!va(this.getSelectedFields(),i.getSelectedFields()))throw new Error(\"Set operator error (union / intersect / except): selected fields are not the same or are in a different order\");return this.config.setOperators.push({type:e,isAll:r,rightSelect:i}),this}}union=this.createSetOperator(\"union\",!1);unionAll=this.createSetOperator(\"union\",!0);intersect=this.createSetOperator(\"intersect\",!1);intersectAll=this.createSetOperator(\"intersect\",!0);except=this.createSetOperator(\"except\",!1);exceptAll=this.createSetOperator(\"except\",!0);addSetOperators(e){return this.config.setOperators.push(...e),this}where(e){return typeof e==\"function\"&&(e=e(new Proxy(this.config.fields,new de({sqlAliasedBehavior:\"sql\",sqlBehavior:\"sql\"})))),this.config.where=e,this}having(e){return typeof e==\"function\"&&(e=e(new Proxy(this.config.fields,new de({sqlAliasedBehavior:\"sql\",sqlBehavior:\"sql\"})))),this.config.having=e,this}groupBy(...e){if(typeof e[0]==\"function\"){let r=e[0](new Proxy(this.config.fields,new de({sqlAliasedBehavior:\"alias\",sqlBehavior:\"sql\"})));this.config.groupBy=Array.isArray(r)?r:[r]}else this.config.groupBy=e;return this}orderBy(...e){if(typeof e[0]==\"function\"){let r=e[0](new Proxy(this.config.fields,new de({sqlAliasedBehavior:\"alias\",sqlBehavior:\"sql\"}))),n=Array.isArray(r)?r:[r];this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=n:this.config.orderBy=n}else{let r=e;this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=r:this.config.orderBy=r}return this}limit(e){return this.config.setOperators.length>0?this.config.setOperators.at(-1).limit=e:this.config.limit=e,this}offset(e){return this.config.setOperators.length>0?this.config.setOperators.at(-1).offset=e:this.config.offset=e,this}for(e,r={}){return this.config.lockingClause={strength:e,config:r},this}getSQL(){return this.dialect.buildSelectQuery(this.config)}toSQL(){let{typings:e,...r}=this.dialect.sqlToQuery(this.getSQL());return r}as(e){return new Proxy(new ye(this.getSQL(),this.config.fields,e),new de({alias:e,sqlAliasedBehavior:\"alias\",sqlBehavior:\"error\"}))}getSelectedFields(){return new Proxy(this.config.fields,new de({alias:this.tableName,sqlAliasedBehavior:\"alias\",sqlBehavior:\"error\"}))}$dynamic(){return this}},Ho=class extends If{static[h]=\"PgSelect\";_prepare(e){let{session:r,config:n,dialect:i,joinsNotNullableMap:a,authToken:s}=this;if(!r)throw new Error(\"Cannot execute a query on a query builder. Please use a database instance instead.\");return ee.startActiveSpan(\"drizzle.prepareQuery\",()=>{let o=gt(n.fields),u=r.prepareQuery(i.sqlToQuery(this.getSQL()),o,e,!0);return u.joinsNotNullableMap=a,u.setToken(s)})}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>ee.startActiveSpan(\"drizzle.operation\",()=>this._prepare().execute(e,this.authToken))};$1(Ho,[je]);function ci(t,e){return(r,n,...i)=>{let a=[n,...i].map(s=>({type:t,isAll:e,rightSelect:s}));for(let s of a)if(!va(r.getSelectedFields(),s.rightSelect.getSelectedFields()))throw new Error(\"Set operator error (union / intersect / except): selected fields are not the same or are in a different order\");return r.addSetOperators(a)}}var MI=()=>({union:FI,unionAll:$I,intersect:UI,intersectAll:BI,except:zI,exceptAll:HI}),FI=ci(\"union\",!1),$I=ci(\"union\",!0),UI=ci(\"intersect\",!1),BI=ci(\"intersect\",!0),zI=ci(\"except\",!1),HI=ci(\"except\",!0);var ui=class{static[h]=\"PgQueryBuilder\";dialect;dialectConfig;constructor(e){this.dialect=b(e,br)?e:void 0,this.dialectConfig=b(e,br)?void 0:e}$with=(e,r)=>{let n=this;return{as:a=>(typeof a==\"function\"&&(a=a(n)),new Proxy(new ni(a.getSQL(),r??(\"getSelectedFields\"in a?a.getSelectedFields()??{}:{}),e,!0),new de({alias:e,sqlAliasedBehavior:\"alias\",sqlBehavior:\"error\"})))}};with(...e){let r=this;function n(s){return new De({fields:s??void 0,session:void 0,dialect:r.getDialect(),withList:e})}function i(s){return new De({fields:s??void 0,session:void 0,dialect:r.getDialect(),distinct:!0})}function a(s,o){return new De({fields:o??void 0,session:void 0,dialect:r.getDialect(),distinct:{on:s}})}return{select:n,selectDistinct:i,selectDistinctOn:a}}select(e){return new De({fields:e??void 0,session:void 0,dialect:this.getDialect()})}selectDistinct(e){return new De({fields:e??void 0,session:void 0,dialect:this.getDialect(),distinct:!0})}selectDistinctOn(e,r){return new De({fields:r??void 0,session:void 0,dialect:this.getDialect(),distinct:{on:e}})}getDialect(){return this.dialect||(this.dialect=new br(this.dialectConfig)),this.dialect}};var Ra=class{constructor(e,r,n,i,a){this.table=e,this.session=r,this.dialect=n,this.withList=i,this.overridingSystemValue_=a}static[h]=\"PgInsertBuilder\";authToken;setToken(e){return this.authToken=e,this}overridingSystemValue(){return this.overridingSystemValue_=!0,this}values(e){if(e=Array.isArray(e)?e:[e],e.length===0)throw new Error(\"values() must be called with at least one value\");let r=e.map(n=>{let i={},a=this.table[A.Symbol.Columns];for(let s of Object.keys(n)){let o=n[s];i[s]=b(o,O)?o:new Ge(o,a[s])}return i});return new Qo(this.table,r,this.session,this.dialect,this.withList,!1,this.overridingSystemValue_).setToken(this.authToken)}select(e){let r=typeof e==\"function\"?e(new ui):e;if(!b(r,O)&&!va(this.table[Io],r._.selectedFields))throw new Error(\"Insert select error: selected fields are not the same or are in a different order compared to the table definition\");return new Qo(this.table,r,this.session,this.dialect,this.withList,!0)}},Qo=class extends je{constructor(e,r,n,i,a,s,o){super(),this.session=n,this.dialect=i,this.config={table:e,values:r,withList:a,select:s,overridingSystemValue_:o}}static[h]=\"PgInsert\";config;returning(e=this.config.table[A.Symbol.Columns]){return this.config.returningFields=e,this.config.returning=gt(e),this}onConflictDoNothing(e={}){if(e.target===void 0)this.config.onConflict=g`do nothing`;else{let r=\"\";r=Array.isArray(e.target)?e.target.map(i=>this.dialect.escapeName(this.dialect.casing.getColumnCasing(i))).join(\",\"):this.dialect.escapeName(this.dialect.casing.getColumnCasing(e.target));let n=e.where?g` where ${e.where}`:void 0;this.config.onConflict=g`(${g.raw(r)})${n} do nothing`}return this}onConflictDoUpdate(e){if(e.where&&(e.targetWhere||e.setWhere))throw new Error('You cannot use both \"where\" and \"targetWhere\"/\"setWhere\" at the same time - \"where\" is deprecated, use \"targetWhere\" or \"setWhere\" instead.');let r=e.where?g` where ${e.where}`:void 0,n=e.targetWhere?g` where ${e.targetWhere}`:void 0,i=e.setWhere?g` where ${e.setWhere}`:void 0,a=this.dialect.buildUpdateSet(this.config.table,No(this.config.table,e.set)),s=\"\";return s=Array.isArray(e.target)?e.target.map(o=>this.dialect.escapeName(this.dialect.casing.getColumnCasing(o))).join(\",\"):this.dialect.escapeName(this.dialect.casing.getColumnCasing(e.target)),this.config.onConflict=g`(${g.raw(s)})${n} do update set ${a}${r}${i}`,this}getSQL(){return this.dialect.buildInsertQuery(this.config)}toSQL(){let{typings:e,...r}=this.dialect.sqlToQuery(this.getSQL());return r}_prepare(e){return ee.startActiveSpan(\"drizzle.prepareQuery\",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,e,!0))}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>ee.startActiveSpan(\"drizzle.operation\",()=>this._prepare().execute(e,this.authToken));getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new de({alias:We(this.config.table),sqlAliasedBehavior:\"alias\",sqlBehavior:\"error\"})):void 0}$dynamic(){return this}};var Vo=class extends je{constructor(e,r,n){super(),this.session=r,this.dialect=n,this.config={view:e}}static[h]=\"PgRefreshMaterializedView\";config;concurrently(){if(this.config.withNoData!==void 0)throw new Error(\"Cannot use concurrently and withNoData together\");return this.config.concurrently=!0,this}withNoData(){if(this.config.concurrently!==void 0)throw new Error(\"Cannot use concurrently and withNoData together\");return this.config.withNoData=!0,this}getSQL(){return this.dialect.buildRefreshMaterializedViewQuery(this.config)}toSQL(){let{typings:e,...r}=this.dialect.sqlToQuery(this.getSQL());return r}_prepare(e){return ee.startActiveSpan(\"drizzle.prepareQuery\",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),void 0,e,!0))}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>ee.startActiveSpan(\"drizzle.operation\",()=>this._prepare().execute(e,this.authToken))};var Ia=class{constructor(e,r,n,i){this.table=e,this.session=r,this.dialect=n,this.withList=i}static[h]=\"PgUpdateBuilder\";authToken;setToken(e){return this.authToken=e,this}set(e){return new Nf(this.table,No(this.table,e),this.session,this.dialect,this.withList).setToken(this.authToken)}},Nf=class extends je{constructor(e,r,n,i,a){super(),this.session=n,this.dialect=i,this.config={set:r,table:e,withList:a,joins:[]},this.tableName=er(e),this.joinsNotNullableMap=typeof this.tableName==\"string\"?{[this.tableName]:!0}:{}}static[h]=\"PgUpdate\";config;tableName;joinsNotNullableMap;from(e){let r=e,n=er(r);return typeof n==\"string\"&&(this.joinsNotNullableMap[n]=!0),this.config.from=r,this}getTableLikeFields(e){return b(e,Te)?e[A.Symbol.Columns]:b(e,ye)?e._.selectedFields:e[te].selectedFields}createJoin(e){return(r,n)=>{let i=er(r);if(typeof i==\"string\"&&this.config.joins.some(a=>a.alias===i))throw new Error(`Alias \"${i}\" is already used in this query`);if(typeof n==\"function\"){let a=this.config.from&&!b(this.config.from,O)?this.getTableLikeFields(this.config.from):void 0;n=n(new Proxy(this.config.table[A.Symbol.Columns],new de({sqlAliasedBehavior:\"sql\",sqlBehavior:\"sql\"})),a&&new Proxy(a,new de({sqlAliasedBehavior:\"sql\",sqlBehavior:\"sql\"})))}if(this.config.joins.push({on:n,table:r,joinType:e,alias:i}),typeof i==\"string\")switch(e){case\"left\":{this.joinsNotNullableMap[i]=!1;break}case\"right\":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([a])=>[a,!1])),this.joinsNotNullableMap[i]=!0;break}case\"inner\":{this.joinsNotNullableMap[i]=!0;break}case\"full\":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([a])=>[a,!1])),this.joinsNotNullableMap[i]=!1;break}}return this}}leftJoin=this.createJoin(\"left\");rightJoin=this.createJoin(\"right\");innerJoin=this.createJoin(\"inner\");fullJoin=this.createJoin(\"full\");where(e){return this.config.where=e,this}returning(e){if(!e&&(e=Object.assign({},this.config.table[A.Symbol.Columns]),this.config.from)){let r=er(this.config.from);if(typeof r==\"string\"&&this.config.from&&!b(this.config.from,O)){let n=this.getTableLikeFields(this.config.from);e[r]=n}for(let n of this.config.joins){let i=er(n.table);if(typeof i==\"string\"&&!b(n.table,O)){let a=this.getTableLikeFields(n.table);e[i]=a}}}return this.config.returningFields=e,this.config.returning=gt(e),this}getSQL(){return this.dialect.buildUpdateQuery(this.config)}toSQL(){let{typings:e,...r}=this.dialect.sqlToQuery(this.getSQL());return r}_prepare(e){let r=this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,e,!0);return r.joinsNotNullableMap=this.joinsNotNullableMap,r}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>this._prepare().execute(e,this.authToken);getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new de({alias:We(this.config.table),sqlAliasedBehavior:\"alias\",sqlBehavior:\"error\"})):void 0}$dynamic(){return this}};var Ko=class t extends O{constructor(e){super(t.buildEmbeddedCount(e.source,e.filters).queryChunks),this.params=e,this.mapWith(Number),this.session=e.session,this.sql=t.buildCount(e.source,e.filters)}sql;token;static[h]=\"PgCountBuilder\";[Symbol.toStringTag]=\"PgCountBuilder\";session;static buildEmbeddedCount(e,r){return g`(select count(*) from ${e}${g.raw(\" where \").if(r)}${r})`}static buildCount(e,r){return g`select count(*) as count from ${e}${g.raw(\" where \").if(r)}${r};`}setToken(e){return this.token=e,this}then(e,r){return Promise.resolve(this.session.count(this.sql,this.token)).then(e,r)}catch(e){return this.then(void 0,e)}finally(e){return this.then(r=>(e?.(),r),r=>{throw e?.(),r})}};var Wo=class{constructor(e,r,n,i,a,s,o){this.fullSchema=e,this.schema=r,this.tableNamesMap=n,this.table=i,this.tableConfig=a,this.dialect=s,this.session=o}static[h]=\"PgRelationalQueryBuilder\";findMany(e){return new Go(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,e||{},\"many\")}findFirst(e){return new Go(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,e?{...e,limit:1}:{limit:1},\"first\")}},Go=class extends je{constructor(e,r,n,i,a,s,o,u,c){super(),this.fullSchema=e,this.schema=r,this.tableNamesMap=n,this.table=i,this.tableConfig=a,this.dialect=s,this.session=o,this.config=u,this.mode=c}static[h]=\"PgRelationalQuery\";_prepare(e){return ee.startActiveSpan(\"drizzle.prepareQuery\",()=>{let{query:r,builtQuery:n}=this._toSQL();return this.session.prepareQuery(n,void 0,e,!0,(i,a)=>{let s=i.map(o=>Bo(this.schema,this.tableConfig,o,r.selection,a));return this.mode===\"first\"?s[0]:s})})}prepare(e){return this._prepare(e)}_getQuery(){return this.dialect.buildRelationalQueryWithoutPK({fullSchema:this.fullSchema,schema:this.schema,tableNamesMap:this.tableNamesMap,table:this.table,tableConfig:this.tableConfig,queryConfig:this.config,tableAlias:this.tableConfig.tsName})}getSQL(){return this._getQuery().sql}_toSQL(){let e=this._getQuery(),r=this.dialect.sqlToQuery(e.sql);return{query:e,builtQuery:r}}toSQL(){return this._toSQL().builtQuery}authToken;setToken(e){return this.authToken=e,this}execute(){return ee.startActiveSpan(\"drizzle.operation\",()=>this._prepare().execute(void 0,this.authToken))}};var Jo=class extends je{constructor(e,r,n,i){super(),this.execute=e,this.sql=r,this.query=n,this.mapBatchResult=i}static[h]=\"PgRaw\";getSQL(){return this.sql}getQuery(){return this.query}mapResult(e,r){return r?this.mapBatchResult(e):e}_prepare(){return this}isResponseInArrayMode(){return!1}};var li=class{constructor(e,r,n){if(this.dialect=e,this.session=r,this._=n?{schema:n.schema,fullSchema:n.fullSchema,tableNamesMap:n.tableNamesMap,session:r}:{schema:void 0,fullSchema:{},tableNamesMap:{},session:r},this.query={},this._.schema)for(let[i,a]of Object.entries(this._.schema))this.query[i]=new Wo(n.fullSchema,this._.schema,this._.tableNamesMap,n.fullSchema[i],a,e,r)}static[h]=\"PgDatabase\";query;$with=(e,r)=>{let n=this;return{as:a=>(typeof a==\"function\"&&(a=a(new ui(n.dialect))),new Proxy(new ni(a.getSQL(),r??(\"getSelectedFields\"in a?a.getSelectedFields()??{}:{}),e,!0),new de({alias:e,sqlAliasedBehavior:\"alias\",sqlBehavior:\"error\"})))}};$count(e,r){return new Ko({source:e,filters:r,session:this.session})}with(...e){let r=this;function n(c){return new De({fields:c??void 0,session:r.session,dialect:r.dialect,withList:e})}function i(c){return new De({fields:c??void 0,session:r.session,dialect:r.dialect,withList:e,distinct:!0})}function a(c,l){return new De({fields:l??void 0,session:r.session,dialect:r.dialect,withList:e,distinct:{on:c}})}function s(c){return new Ia(c,r.session,r.dialect,e)}function o(c){return new Ra(c,r.session,r.dialect,e)}function u(c){return new ya(c,r.session,r.dialect,e)}return{select:n,selectDistinct:i,selectDistinctOn:a,update:s,insert:o,delete:u}}select(e){return new De({fields:e??void 0,session:this.session,dialect:this.dialect})}selectDistinct(e){return new De({fields:e??void 0,session:this.session,dialect:this.dialect,distinct:!0})}selectDistinctOn(e,r){return new De({fields:r??void 0,session:this.session,dialect:this.dialect,distinct:{on:e}})}update(e){return new Ia(e,this.session,this.dialect)}insert(e){return new Ra(e,this.session,this.dialect)}delete(e){return new ya(e,this.session,this.dialect)}refreshMaterializedView(e){return new Vo(e,this.session,this.dialect)}authToken;execute(e){let r=typeof e==\"string\"?g.raw(e):e.getSQL(),n=this.dialect.sqlToQuery(r),i=this.session.prepareQuery(n,void 0,void 0,!1);return new Jo(()=>i.execute(void 0,this.authToken),r,n,a=>i.mapResult(a,!0))}transaction(e,r){return this.session.transaction(e,r)}};var qf=class{constructor(e,r){this.unique=e,this.name=r}static[h]=\"PgIndexBuilderOn\";on(...e){return new Na(e.map(r=>{if(b(r,O))return r;r=r;let n=new ri(r.name,!!r.keyAsName,r.columnType,r.indexConfig);return r.indexConfig=JSON.parse(JSON.stringify(r.defaultConfig)),n}),this.unique,!1,this.name)}onOnly(...e){return new Na(e.map(r=>{if(b(r,O))return r;r=r;let n=new ri(r.name,!!r.keyAsName,r.columnType,r.indexConfig);return r.indexConfig=r.defaultConfig,n}),this.unique,!0,this.name)}using(e,...r){return new Na(r.map(n=>{if(b(n,O))return n;n=n;let i=new ri(n.name,!!n.keyAsName,n.columnType,n.indexConfig);return n.indexConfig=JSON.parse(JSON.stringify(n.defaultConfig)),i}),this.unique,!0,this.name,e)}},Na=class{static[h]=\"PgIndexBuilder\";config;constructor(e,r,n,i,a=\"btree\"){this.config={name:i,columns:e,unique:r,only:n,method:a}}concurrently(){return this.config.concurrently=!0,this}with(e){return this.config.with=e,this}where(e){return this.config.where=e,this}build(e){return new jf(this.config,e)}},jf=class{static[h]=\"PgIndex\";config;constructor(e,r){this.config={...e,table:r}}};function H_(t){return new qf(!1,t)}var Zo=class{constructor(e){this.query=e}authToken;getQuery(){return this.query}mapResult(e,r){return e}setToken(e){return this.authToken=e,this}static[h]=\"PgPreparedQuery\";joinsNotNullableMap},Xo=class{constructor(e){this.dialect=e}static[h]=\"PgSession\";execute(e,r){return ee.startActiveSpan(\"drizzle.operation\",()=>ee.startActiveSpan(\"drizzle.prepareQuery\",()=>this.prepareQuery(this.dialect.sqlToQuery(e),void 0,void 0,!1)).setToken(r).execute(void 0,r))}all(e){return this.prepareQuery(this.dialect.sqlToQuery(e),void 0,void 0,!1).all()}async count(e,r){let n=await this.execute(e,r);return Number(n[0].count)}},Yo=class extends li{constructor(e,r,n,i=0){super(e,r,n),this.schema=n,this.nestedIndex=i}static[h]=\"PgTransaction\";rollback(){throw new Do}getTransactionConfigSQL(e){let r=[];return e.isolationLevel&&r.push(`isolation level ${e.isolationLevel}`),e.accessMode&&r.push(e.accessMode),typeof e.deferrable==\"boolean\"&&r.push(e.deferrable?\"deferrable\":\"not deferrable\"),g.raw(r.join(\" \"))}setTransaction(e){return this.session.execute(g`set transaction ${this.getTransactionConfigSQL(e)}`)}};var{Pool:Q_,types:Mt}=yr,Df=class extends Zo{constructor(e,r,n,i,a,s,o,u){super({sql:r,params:n}),this.client=e,this.params=n,this.logger=i,this.fields=a,this._isResponseInArrayMode=o,this.customResultMapper=u,this.rawQueryConfig={name:s,text:r,types:{getTypeParser:(c,l)=>c===Mt.builtins.TIMESTAMPTZ?p=>p:c===Mt.builtins.TIMESTAMP?p=>p:c===Mt.builtins.DATE?p=>p:c===Mt.builtins.INTERVAL?p=>p:Mt.getTypeParser(c,l)}},this.queryConfig={name:s,text:r,rowMode:\"array\",types:{getTypeParser:(c,l)=>c===Mt.builtins.TIMESTAMPTZ?p=>p:c===Mt.builtins.TIMESTAMP?p=>p:c===Mt.builtins.DATE?p=>p:c===Mt.builtins.INTERVAL?p=>p:Mt.getTypeParser(c,l)}}}static[h]=\"NodePgPreparedQuery\";rawQueryConfig;queryConfig;async execute(e={}){return ee.startActiveSpan(\"drizzle.execute\",async()=>{let r=ld(this.params,e);this.logger.logQuery(this.rawQueryConfig.text,r);let{fields:n,rawQueryConfig:i,client:a,queryConfig:s,joinsNotNullableMap:o,customResultMapper:u}=this;if(!n&&!u)return ee.startActiveSpan(\"drizzle.driver.execute\",async l=>(l?.setAttributes({\"drizzle.query.name\":i.name,\"drizzle.query.text\":i.text,\"drizzle.query.params\":JSON.stringify(r)}),a.query(i,r)));let c=await ee.startActiveSpan(\"drizzle.driver.execute\",l=>(l?.setAttributes({\"drizzle.query.name\":s.name,\"drizzle.query.text\":s.text,\"drizzle.query.params\":JSON.stringify(r)}),a.query(s,r)));return ee.startActiveSpan(\"drizzle.mapResponse\",()=>u?u(c.rows):c.rows.map(l=>F1(n,l,o)))})}all(e={}){return ee.startActiveSpan(\"drizzle.execute\",()=>{let r=ld(this.params,e);return this.logger.logQuery(this.rawQueryConfig.text,r),ee.startActiveSpan(\"drizzle.driver.execute\",n=>(n?.setAttributes({\"drizzle.query.name\":this.rawQueryConfig.name,\"drizzle.query.text\":this.rawQueryConfig.text,\"drizzle.query.params\":JSON.stringify(r)}),this.client.query(this.rawQueryConfig,r).then(i=>i.rows)))})}isResponseInArrayMode(){return this._isResponseInArrayMode}},ec=class t extends Xo{constructor(e,r,n,i={}){super(r),this.client=e,this.schema=n,this.options=i,this.logger=i.logger??new Ao}static[h]=\"NodePgSession\";logger;prepareQuery(e,r,n,i,a){return new Df(this.client,e.sql,e.params,this.logger,r,n,i,a)}async transaction(e,r){let n=this.client instanceof Q_?new t(await this.client.connect(),this.dialect,this.schema,this.options):this,i=new Lf(this.dialect,n,this.schema);await i.execute(g`begin${r?g` ${i.getTransactionConfigSQL(r)}`:void 0}`);try{let a=await e(i);return await i.execute(g`commit`),a}catch(a){throw await i.execute(g`rollback`),a}finally{this.client instanceof Q_&&n.client.release()}}async count(e){let r=await this.execute(e);return Number(r.rows[0].count)}},Lf=class t extends Yo{static[h]=\"NodePgTransaction\";async transaction(e){let r=`sp${this.nestedIndex+1}`,n=new t(this.dialect,this.session,this.schema,this.nestedIndex+1);await n.execute(g.raw(`savepoint ${r}`));try{let i=await e(n);return await n.execute(g.raw(`release savepoint ${r}`)),i}catch(i){throw await n.execute(g.raw(`rollback to savepoint ${r}`)),i}}};var Mf=class{constructor(e,r,n={}){this.client=e,this.dialect=r,this.options=n}static[h]=\"NodePgDriver\";createSession(e){return new ec(this.client,this.dialect,e,{logger:this.options.logger})}},Ff=class extends li{static[h]=\"NodePgDatabase\"};function qa(t,e={}){let r=new br({casing:e.casing}),n;e.logger===!0?n=new ko:e.logger!==!1&&(n=e.logger);let i;if(e.schema){let u=U_(e.schema,z_);i={fullSchema:e.schema,schema:u.tables,tableNamesMap:u.tableNamesMap}}let s=new Mf(t,r,{logger:n}).createSession(i),o=new Ff(r,s,i);return o.$client=t,o}function tc(...t){if(typeof t[0]==\"string\"){let e=new yr.Pool({connectionString:t[0]});return qa(e,t[1])}if(B1(t[0])){let{connection:e,client:r,...n}=t[0];if(r)return qa(r,n);let i=typeof e==\"string\"?new yr.Pool({connectionString:e}):new yr.Pool(e);return qa(i,n)}return qa(t[0],t[1])}(t=>{function e(r){return qa({},r)}t.mock=e})(tc||(tc={}));var oc={};Rc(oc,{inquiries:()=>at,insertInquirySchema:()=>Hf,insertUserSchema:()=>lN,sessions:()=>uN,users:()=>Tr});var Ie={};Rc(Ie,{BRAND:()=>g9,DIRTY:()=>Vr,EMPTY_PATH:()=>WI,INVALID:()=>D,NEVER:()=>eN,OK:()=>Le,ParseStatus:()=>Re,Schema:()=>H,ZodAny:()=>Sr,ZodArray:()=>ar,ZodBigInt:()=>Wr,ZodBoolean:()=>Gr,ZodBranded:()=>Da,ZodCatch:()=>on,ZodDate:()=>Jr,ZodDefault:()=>sn,ZodDiscriminatedUnion:()=>ic,ZodEffects:()=>bt,ZodEnum:()=>nn,ZodError:()=>Ze,ZodFirstPartyTypeKind:()=>M,ZodFunction:()=>sc,ZodIntersection:()=>en,ZodIssueCode:()=>_,ZodLazy:()=>tn,ZodLiteral:()=>rn,ZodMap:()=>gi,ZodNaN:()=>yi,ZodNativeEnum:()=>an,ZodNever:()=>At,ZodNull:()=>Xr,ZodNullable:()=>Ut,ZodNumber:()=>Kr,ZodObject:()=>Xe,ZodOptional:()=>yt,ZodParsedType:()=>P,ZodPipeline:()=>La,ZodPromise:()=>Er,ZodReadonly:()=>cn,ZodRecord:()=>ac,ZodSchema:()=>H,ZodSet:()=>vi,ZodString:()=>_r,ZodSymbol:()=>hi,ZodTransformer:()=>bt,ZodTuple:()=>$t,ZodType:()=>H,ZodUndefined:()=>Zr,ZodUnion:()=>Yr,ZodUnknown:()=>ir,ZodVoid:()=>mi,addIssueToContext:()=>k,any:()=>T9,array:()=>P9,bigint:()=>b9,boolean:()=>rS,coerce:()=>Y9,custom:()=>Y_,date:()=>w9,datetimeRegex:()=>Z_,defaultErrorMap:()=>rr,discriminatedUnion:()=>N9,effect:()=>Q9,enum:()=>B9,function:()=>F9,getErrorMap:()=>pi,getParsedType:()=>Ft,instanceof:()=>y9,intersection:()=>q9,isAborted:()=>rc,isAsync:()=>di,isDirty:()=>nc,isValid:()=>wr,late:()=>v9,lazy:()=>$9,literal:()=>U9,makeIssue:()=>ja,map:()=>L9,nan:()=>x9,nativeEnum:()=>z9,never:()=>A9,null:()=>E9,nullable:()=>K9,number:()=>tS,object:()=>O9,objectUtil:()=>$f,oboolean:()=>X9,onumber:()=>Z9,optional:()=>V9,ostring:()=>J9,pipeline:()=>G9,preprocess:()=>W9,promise:()=>H9,quotelessJson:()=>QI,record:()=>D9,set:()=>M9,setErrorMap:()=>KI,strictObject:()=>R9,string:()=>eS,symbol:()=>_9,transformer:()=>Q9,tuple:()=>j9,undefined:()=>S9,union:()=>I9,unknown:()=>k9,util:()=>K,void:()=>C9});var K;(function(t){t.assertEqual=i=>{};function e(i){}t.assertIs=e;function r(i){throw new Error}t.assertNever=r,t.arrayToEnum=i=>{let a={};for(let s of i)a[s]=s;return a},t.getValidEnumValues=i=>{let a=t.objectKeys(i).filter(o=>typeof i[i[o]]!=\"number\"),s={};for(let o of a)s[o]=i[o];return t.objectValues(s)},t.objectValues=i=>t.objectKeys(i).map(function(a){return i[a]}),t.objectKeys=typeof Object.keys==\"function\"?i=>Object.keys(i):i=>{let a=[];for(let s in i)Object.prototype.hasOwnProperty.call(i,s)&&a.push(s);return a},t.find=(i,a)=>{for(let s of i)if(a(s))return s},t.isInteger=typeof Number.isInteger==\"function\"?i=>Number.isInteger(i):i=>typeof i==\"number\"&&Number.isFinite(i)&&Math.floor(i)===i;function n(i,a=\" | \"){return i.map(s=>typeof s==\"string\"?`'${s}'`:s).join(a)}t.joinValues=n,t.jsonStringifyReplacer=(i,a)=>typeof a==\"bigint\"?a.toString():a})(K||(K={}));var $f;(function(t){t.mergeShapes=(e,r)=>({...e,...r})})($f||($f={}));var P=K.arrayToEnum([\"string\",\"nan\",\"number\",\"integer\",\"float\",\"boolean\",\"date\",\"bigint\",\"symbol\",\"function\",\"undefined\",\"null\",\"array\",\"object\",\"unknown\",\"promise\",\"void\",\"never\",\"map\",\"set\"]),Ft=t=>{switch(typeof t){case\"undefined\":return P.undefined;case\"string\":return P.string;case\"number\":return Number.isNaN(t)?P.nan:P.number;case\"boolean\":return P.boolean;case\"function\":return P.function;case\"bigint\":return P.bigint;case\"symbol\":return P.symbol;case\"object\":return Array.isArray(t)?P.array:t===null?P.null:t.then&&typeof t.then==\"function\"&&t.catch&&typeof t.catch==\"function\"?P.promise:typeof Map<\"u\"&&t instanceof Map?P.map:typeof Set<\"u\"&&t instanceof Set?P.set:typeof Date<\"u\"&&t instanceof Date?P.date:P.object;default:return P.unknown}};var _=K.arrayToEnum([\"invalid_type\",\"invalid_literal\",\"custom\",\"invalid_union\",\"invalid_union_discriminator\",\"invalid_enum_value\",\"unrecognized_keys\",\"invalid_arguments\",\"invalid_return_type\",\"invalid_date\",\"invalid_string\",\"too_small\",\"too_big\",\"invalid_intersection_types\",\"not_multiple_of\",\"not_finite\"]),QI=t=>JSON.stringify(t,null,2).replace(/\"([^\"]+)\":/g,\"$1:\"),Ze=class t extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};let r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name=\"ZodError\",this.issues=e}format(e){let r=e||function(a){return a.message},n={_errors:[]},i=a=>{for(let s of a.issues)if(s.code===\"invalid_union\")s.unionErrors.map(i);else if(s.code===\"invalid_return_type\")i(s.returnTypeError);else if(s.code===\"invalid_arguments\")i(s.argumentsError);else if(s.path.length===0)n._errors.push(r(s));else{let o=n,u=0;for(;u<s.path.length;){let c=s.path[u];u===s.path.length-1?(o[c]=o[c]||{_errors:[]},o[c]._errors.push(r(s))):o[c]=o[c]||{_errors:[]},o=o[c],u++}}};return i(this),n}static assert(e){if(!(e instanceof t))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,K.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=r=>r.message){let r={},n=[];for(let i of this.issues)if(i.path.length>0){let a=i.path[0];r[a]=r[a]||[],r[a].push(e(i))}else n.push(e(i));return{formErrors:n,fieldErrors:r}}get formErrors(){return this.flatten()}};Ze.create=t=>new Ze(t);var VI=(t,e)=>{let r;switch(t.code){case _.invalid_type:t.received===P.undefined?r=\"Required\":r=`Expected ${t.expected}, received ${t.received}`;break;case _.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(t.expected,K.jsonStringifyReplacer)}`;break;case _.unrecognized_keys:r=`Unrecognized key(s) in object: ${K.joinValues(t.keys,\", \")}`;break;case _.invalid_union:r=\"Invalid input\";break;case _.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${K.joinValues(t.options)}`;break;case _.invalid_enum_value:r=`Invalid enum value. Expected ${K.joinValues(t.options)}, received '${t.received}'`;break;case _.invalid_arguments:r=\"Invalid function arguments\";break;case _.invalid_return_type:r=\"Invalid function return type\";break;case _.invalid_date:r=\"Invalid date\";break;case _.invalid_string:typeof t.validation==\"object\"?\"includes\"in t.validation?(r=`Invalid input: must include \"${t.validation.includes}\"`,typeof t.validation.position==\"number\"&&(r=`${r} at one or more positions greater than or equal to ${t.validation.position}`)):\"startsWith\"in t.validation?r=`Invalid input: must start with \"${t.validation.startsWith}\"`:\"endsWith\"in t.validation?r=`Invalid input: must end with \"${t.validation.endsWith}\"`:K.assertNever(t.validation):t.validation!==\"regex\"?r=`Invalid ${t.validation}`:r=\"Invalid\";break;case _.too_small:t.type===\"array\"?r=`Array must contain ${t.exact?\"exactly\":t.inclusive?\"at least\":\"more than\"} ${t.minimum} element(s)`:t.type===\"string\"?r=`String must contain ${t.exact?\"exactly\":t.inclusive?\"at least\":\"over\"} ${t.minimum} character(s)`:t.type===\"number\"?r=`Number must be ${t.exact?\"exactly equal to \":t.inclusive?\"greater than or equal to \":\"greater than \"}${t.minimum}`:t.type===\"bigint\"?r=`Number must be ${t.exact?\"exactly equal to \":t.inclusive?\"greater than or equal to \":\"greater than \"}${t.minimum}`:t.type===\"date\"?r=`Date must be ${t.exact?\"exactly equal to \":t.inclusive?\"greater than or equal to \":\"greater than \"}${new Date(Number(t.minimum))}`:r=\"Invalid input\";break;case _.too_big:t.type===\"array\"?r=`Array must contain ${t.exact?\"exactly\":t.inclusive?\"at most\":\"less than\"} ${t.maximum} element(s)`:t.type===\"string\"?r=`String must contain ${t.exact?\"exactly\":t.inclusive?\"at most\":\"under\"} ${t.maximum} character(s)`:t.type===\"number\"?r=`Number must be ${t.exact?\"exactly\":t.inclusive?\"less than or equal to\":\"less than\"} ${t.maximum}`:t.type===\"bigint\"?r=`BigInt must be ${t.exact?\"exactly\":t.inclusive?\"less than or equal to\":\"less than\"} ${t.maximum}`:t.type===\"date\"?r=`Date must be ${t.exact?\"exactly\":t.inclusive?\"smaller than or equal to\":\"smaller than\"} ${new Date(Number(t.maximum))}`:r=\"Invalid input\";break;case _.custom:r=\"Invalid input\";break;case _.invalid_intersection_types:r=\"Intersection results could not be merged\";break;case _.not_multiple_of:r=`Number must be a multiple of ${t.multipleOf}`;break;case _.not_finite:r=\"Number must be finite\";break;default:r=e.defaultError,K.assertNever(t)}return{message:r}},rr=VI;var V_=rr;function KI(t){V_=t}function pi(){return V_}var ja=t=>{let{data:e,path:r,errorMaps:n,issueData:i}=t,a=[...r,...i.path||[]],s={...i,path:a};if(i.message!==void 0)return{...i,path:a,message:i.message};let o=\"\",u=n.filter(c=>!!c).slice().reverse();for(let c of u)o=c(s,{data:e,defaultError:o}).message;return{...i,path:a,message:o}},WI=[];function k(t,e){let r=pi(),n=ja({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,r,r===rr?void 0:rr].filter(i=>!!i)});t.common.issues.push(n)}var Re=class t{constructor(){this.value=\"valid\"}dirty(){this.value===\"valid\"&&(this.value=\"dirty\")}abort(){this.value!==\"aborted\"&&(this.value=\"aborted\")}static mergeArray(e,r){let n=[];for(let i of r){if(i.status===\"aborted\")return D;i.status===\"dirty\"&&e.dirty(),n.push(i.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,r){let n=[];for(let i of r){let a=await i.key,s=await i.value;n.push({key:a,value:s})}return t.mergeObjectSync(e,n)}static mergeObjectSync(e,r){let n={};for(let i of r){let{key:a,value:s}=i;if(a.status===\"aborted\"||s.status===\"aborted\")return D;a.status===\"dirty\"&&e.dirty(),s.status===\"dirty\"&&e.dirty(),a.value!==\"__proto__\"&&(typeof s.value<\"u\"||i.alwaysSet)&&(n[a.value]=s.value)}return{status:e.value,value:n}}},D=Object.freeze({status:\"aborted\"}),Vr=t=>({status:\"dirty\",value:t}),Le=t=>({status:\"valid\",value:t}),rc=t=>t.status===\"aborted\",nc=t=>t.status===\"dirty\",wr=t=>t.status===\"valid\",di=t=>typeof Promise<\"u\"&&t instanceof Promise;var q;(function(t){t.errToObj=e=>typeof e==\"string\"?{message:e}:e||{},t.toString=e=>typeof e==\"string\"?e:e?.message})(q||(q={}));var xt=class{constructor(e,r,n,i){this._cachedPath=[],this.parent=e,this.data=r,this._path=n,this._key=i}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}},K_=(t,e)=>{if(wr(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error(\"Validation failed but no issues detected.\");return{success:!1,get error(){if(this._error)return this._error;let r=new Ze(t.common.issues);return this._error=r,this._error}}};function z(t){if(!t)return{};let{errorMap:e,invalid_type_error:r,required_error:n,description:i}=t;if(e&&(r||n))throw new Error(`Can't use \"invalid_type_error\" or \"required_error\" in conjunction with custom error map.`);return e?{errorMap:e,description:i}:{errorMap:(s,o)=>{let{message:u}=t;return s.code===\"invalid_enum_value\"?{message:u??o.defaultError}:typeof o.data>\"u\"?{message:u??n??o.defaultError}:s.code!==\"invalid_type\"?{message:o.defaultError}:{message:u??r??o.defaultError}},description:i}}var H=class{get description(){return this._def.description}_getType(e){return Ft(e.data)}_getOrReturnCtx(e,r){return r||{common:e.parent.common,data:e.data,parsedType:Ft(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Re,ctx:{common:e.parent.common,data:e.data,parsedType:Ft(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let r=this._parse(e);if(di(r))throw new Error(\"Synchronous parse encountered promise.\");return r}_parseAsync(e){let r=this._parse(e);return Promise.resolve(r)}parse(e,r){let n=this.safeParse(e,r);if(n.success)return n.data;throw n.error}safeParse(e,r){let n={common:{issues:[],async:r?.async??!1,contextualErrorMap:r?.errorMap},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ft(e)},i=this._parseSync({data:e,path:n.path,parent:n});return K_(n,i)}\"~validate\"(e){let r={common:{issues:[],async:!!this[\"~standard\"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ft(e)};if(!this[\"~standard\"].async)try{let n=this._parseSync({data:e,path:[],parent:r});return wr(n)?{value:n.value}:{issues:r.common.issues}}catch(n){n?.message?.toLowerCase()?.includes(\"encountered\")&&(this[\"~standard\"].async=!0),r.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:r}).then(n=>wr(n)?{value:n.value}:{issues:r.common.issues})}async parseAsync(e,r){let n=await this.safeParseAsync(e,r);if(n.success)return n.data;throw n.error}async safeParseAsync(e,r){let n={common:{issues:[],contextualErrorMap:r?.errorMap,async:!0},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ft(e)},i=this._parse({data:e,path:n.path,parent:n}),a=await(di(i)?i:Promise.resolve(i));return K_(n,a)}refine(e,r){let n=i=>typeof r==\"string\"||typeof r>\"u\"?{message:r}:typeof r==\"function\"?r(i):r;return this._refinement((i,a)=>{let s=e(i),o=()=>a.addIssue({code:_.custom,...n(i)});return typeof Promise<\"u\"&&s instanceof Promise?s.then(u=>u?!0:(o(),!1)):s?!0:(o(),!1)})}refinement(e,r){return this._refinement((n,i)=>e(n)?!0:(i.addIssue(typeof r==\"function\"?r(n,i):r),!1))}_refinement(e){return new bt({schema:this,typeName:M.ZodEffects,effect:{type:\"refinement\",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this[\"~standard\"]={version:1,vendor:\"zod\",validate:r=>this[\"~validate\"](r)}}optional(){return yt.create(this,this._def)}nullable(){return Ut.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return ar.create(this)}promise(){return Er.create(this,this._def)}or(e){return Yr.create([this,e],this._def)}and(e){return en.create(this,e,this._def)}transform(e){return new bt({...z(this._def),schema:this,typeName:M.ZodEffects,effect:{type:\"transform\",transform:e}})}default(e){let r=typeof e==\"function\"?e:()=>e;return new sn({...z(this._def),innerType:this,defaultValue:r,typeName:M.ZodDefault})}brand(){return new Da({typeName:M.ZodBranded,type:this,...z(this._def)})}catch(e){let r=typeof e==\"function\"?e:()=>e;return new on({...z(this._def),innerType:this,catchValue:r,typeName:M.ZodCatch})}describe(e){let r=this.constructor;return new r({...this._def,description:e})}pipe(e){return La.create(this,e)}readonly(){return cn.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}},GI=/^c[^\\s-]{8,}$/i,JI=/^[0-9a-z]+$/,ZI=/^[0-9A-HJKMNP-TV-Z]{26}$/i,XI=/^[0-9a-fA-F]{8}\\b-[0-9a-fA-F]{4}\\b-[0-9a-fA-F]{4}\\b-[0-9a-fA-F]{4}\\b-[0-9a-fA-F]{12}$/i,YI=/^[a-z0-9_-]{21}$/i,e9=/^[A-Za-z0-9-_]+\\.[A-Za-z0-9-_]+\\.[A-Za-z0-9-_]*$/,t9=/^[-+]?P(?!$)(?:(?:[-+]?\\d+Y)|(?:[-+]?\\d+[.,]\\d+Y$))?(?:(?:[-+]?\\d+M)|(?:[-+]?\\d+[.,]\\d+M$))?(?:(?:[-+]?\\d+W)|(?:[-+]?\\d+[.,]\\d+W$))?(?:(?:[-+]?\\d+D)|(?:[-+]?\\d+[.,]\\d+D$))?(?:T(?=[\\d+-])(?:(?:[-+]?\\d+H)|(?:[-+]?\\d+[.,]\\d+H$))?(?:(?:[-+]?\\d+M)|(?:[-+]?\\d+[.,]\\d+M$))?(?:[-+]?\\d+(?:[.,]\\d+)?S)?)??$/,r9=/^(?!\\.)(?!.*\\.\\.)([A-Z0-9_'+\\-\\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\\-]*\\.)+[A-Z]{2,}$/i,n9=\"^(\\\\p{Extended_Pictographic}|\\\\p{Emoji_Component})+$\",Uf,i9=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,a9=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\\/(3[0-2]|[12]?[0-9])$/,s9=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,o9=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,c9=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,u9=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,G_=\"((\\\\d\\\\d[2468][048]|\\\\d\\\\d[13579][26]|\\\\d\\\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\\\d|30)|(02)-(0[1-9]|1\\\\d|2[0-8])))\",l9=new RegExp(`^${G_}$`);function J_(t){let e=\"[0-5]\\\\d\";t.precision?e=`${e}\\\\.\\\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\\\.\\\\d+)?`);let r=t.precision?\"+\":\"?\";return`([01]\\\\d|2[0-3]):[0-5]\\\\d(:${e})${r}`}function p9(t){return new RegExp(`^${J_(t)}$`)}function Z_(t){let e=`${G_}T${J_(t)}`,r=[];return r.push(t.local?\"Z?\":\"Z\"),t.offset&&r.push(\"([+-]\\\\d{2}:?\\\\d{2})\"),e=`${e}(${r.join(\"|\")})`,new RegExp(`^${e}$`)}function d9(t,e){return!!((e===\"v4\"||!e)&&i9.test(t)||(e===\"v6\"||!e)&&s9.test(t))}function f9(t,e){if(!e9.test(t))return!1;try{let[r]=t.split(\".\");if(!r)return!1;let n=r.replace(/-/g,\"+\").replace(/_/g,\"/\").padEnd(r.length+(4-r.length%4)%4,\"=\"),i=JSON.parse(atob(n));return!(typeof i!=\"object\"||i===null||\"typ\"in i&&i?.typ!==\"JWT\"||!i.alg||e&&i.alg!==e)}catch{return!1}}function h9(t,e){return!!((e===\"v4\"||!e)&&a9.test(t)||(e===\"v6\"||!e)&&o9.test(t))}var _r=class t extends H{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==P.string){let a=this._getOrReturnCtx(e);return k(a,{code:_.invalid_type,expected:P.string,received:a.parsedType}),D}let n=new Re,i;for(let a of this._def.checks)if(a.kind===\"min\")e.data.length<a.value&&(i=this._getOrReturnCtx(e,i),k(i,{code:_.too_small,minimum:a.value,type:\"string\",inclusive:!0,exact:!1,message:a.message}),n.dirty());else if(a.kind===\"max\")e.data.length>a.value&&(i=this._getOrReturnCtx(e,i),k(i,{code:_.too_big,maximum:a.value,type:\"string\",inclusive:!0,exact:!1,message:a.message}),n.dirty());else if(a.kind===\"length\"){let s=e.data.length>a.value,o=e.data.length<a.value;(s||o)&&(i=this._getOrReturnCtx(e,i),s?k(i,{code:_.too_big,maximum:a.value,type:\"string\",inclusive:!0,exact:!0,message:a.message}):o&&k(i,{code:_.too_small,minimum:a.value,type:\"string\",inclusive:!0,exact:!0,message:a.message}),n.dirty())}else if(a.kind===\"email\")r9.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"email\",code:_.invalid_string,message:a.message}),n.dirty());else if(a.kind===\"emoji\")Uf||(Uf=new RegExp(n9,\"u\")),Uf.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"emoji\",code:_.invalid_string,message:a.message}),n.dirty());else if(a.kind===\"uuid\")XI.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"uuid\",code:_.invalid_string,message:a.message}),n.dirty());else if(a.kind===\"nanoid\")YI.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"nanoid\",code:_.invalid_string,message:a.message}),n.dirty());else if(a.kind===\"cuid\")GI.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"cuid\",code:_.invalid_string,message:a.message}),n.dirty());else if(a.kind===\"cuid2\")JI.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"cuid2\",code:_.invalid_string,message:a.message}),n.dirty());else if(a.kind===\"ulid\")ZI.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"ulid\",code:_.invalid_string,message:a.message}),n.dirty());else if(a.kind===\"url\")try{new URL(e.data)}catch{i=this._getOrReturnCtx(e,i),k(i,{validation:\"url\",code:_.invalid_string,message:a.message}),n.dirty()}else a.kind===\"regex\"?(a.regex.lastIndex=0,a.regex.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"regex\",code:_.invalid_string,message:a.message}),n.dirty())):a.kind===\"trim\"?e.data=e.data.trim():a.kind===\"includes\"?e.data.includes(a.value,a.position)||(i=this._getOrReturnCtx(e,i),k(i,{code:_.invalid_string,validation:{includes:a.value,position:a.position},message:a.message}),n.dirty()):a.kind===\"toLowerCase\"?e.data=e.data.toLowerCase():a.kind===\"toUpperCase\"?e.data=e.data.toUpperCase():a.kind===\"startsWith\"?e.data.startsWith(a.value)||(i=this._getOrReturnCtx(e,i),k(i,{code:_.invalid_string,validation:{startsWith:a.value},message:a.message}),n.dirty()):a.kind===\"endsWith\"?e.data.endsWith(a.value)||(i=this._getOrReturnCtx(e,i),k(i,{code:_.invalid_string,validation:{endsWith:a.value},message:a.message}),n.dirty()):a.kind===\"datetime\"?Z_(a).test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{code:_.invalid_string,validation:\"datetime\",message:a.message}),n.dirty()):a.kind===\"date\"?l9.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{code:_.invalid_string,validation:\"date\",message:a.message}),n.dirty()):a.kind===\"time\"?p9(a).test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{code:_.invalid_string,validation:\"time\",message:a.message}),n.dirty()):a.kind===\"duration\"?t9.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"duration\",code:_.invalid_string,message:a.message}),n.dirty()):a.kind===\"ip\"?d9(e.data,a.version)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"ip\",code:_.invalid_string,message:a.message}),n.dirty()):a.kind===\"jwt\"?f9(e.data,a.alg)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"jwt\",code:_.invalid_string,message:a.message}),n.dirty()):a.kind===\"cidr\"?h9(e.data,a.version)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"cidr\",code:_.invalid_string,message:a.message}),n.dirty()):a.kind===\"base64\"?c9.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"base64\",code:_.invalid_string,message:a.message}),n.dirty()):a.kind===\"base64url\"?u9.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"base64url\",code:_.invalid_string,message:a.message}),n.dirty()):K.assertNever(a);return{status:n.value,value:e.data}}_regex(e,r,n){return this.refinement(i=>e.test(i),{validation:r,code:_.invalid_string,...q.errToObj(n)})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:\"email\",...q.errToObj(e)})}url(e){return this._addCheck({kind:\"url\",...q.errToObj(e)})}emoji(e){return this._addCheck({kind:\"emoji\",...q.errToObj(e)})}uuid(e){return this._addCheck({kind:\"uuid\",...q.errToObj(e)})}nanoid(e){return this._addCheck({kind:\"nanoid\",...q.errToObj(e)})}cuid(e){return this._addCheck({kind:\"cuid\",...q.errToObj(e)})}cuid2(e){return this._addCheck({kind:\"cuid2\",...q.errToObj(e)})}ulid(e){return this._addCheck({kind:\"ulid\",...q.errToObj(e)})}base64(e){return this._addCheck({kind:\"base64\",...q.errToObj(e)})}base64url(e){return this._addCheck({kind:\"base64url\",...q.errToObj(e)})}jwt(e){return this._addCheck({kind:\"jwt\",...q.errToObj(e)})}ip(e){return this._addCheck({kind:\"ip\",...q.errToObj(e)})}cidr(e){return this._addCheck({kind:\"cidr\",...q.errToObj(e)})}datetime(e){return typeof e==\"string\"?this._addCheck({kind:\"datetime\",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:\"datetime\",precision:typeof e?.precision>\"u\"?null:e?.precision,offset:e?.offset??!1,local:e?.local??!1,...q.errToObj(e?.message)})}date(e){return this._addCheck({kind:\"date\",message:e})}time(e){return typeof e==\"string\"?this._addCheck({kind:\"time\",precision:null,message:e}):this._addCheck({kind:\"time\",precision:typeof e?.precision>\"u\"?null:e?.precision,...q.errToObj(e?.message)})}duration(e){return this._addCheck({kind:\"duration\",...q.errToObj(e)})}regex(e,r){return this._addCheck({kind:\"regex\",regex:e,...q.errToObj(r)})}includes(e,r){return this._addCheck({kind:\"includes\",value:e,position:r?.position,...q.errToObj(r?.message)})}startsWith(e,r){return this._addCheck({kind:\"startsWith\",value:e,...q.errToObj(r)})}endsWith(e,r){return this._addCheck({kind:\"endsWith\",value:e,...q.errToObj(r)})}min(e,r){return this._addCheck({kind:\"min\",value:e,...q.errToObj(r)})}max(e,r){return this._addCheck({kind:\"max\",value:e,...q.errToObj(r)})}length(e,r){return this._addCheck({kind:\"length\",value:e,...q.errToObj(r)})}nonempty(e){return this.min(1,q.errToObj(e))}trim(){return new t({...this._def,checks:[...this._def.checks,{kind:\"trim\"}]})}toLowerCase(){return new t({...this._def,checks:[...this._def.checks,{kind:\"toLowerCase\"}]})}toUpperCase(){return new t({...this._def,checks:[...this._def.checks,{kind:\"toUpperCase\"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind===\"datetime\")}get isDate(){return!!this._def.checks.find(e=>e.kind===\"date\")}get isTime(){return!!this._def.checks.find(e=>e.kind===\"time\")}get isDuration(){return!!this._def.checks.find(e=>e.kind===\"duration\")}get isEmail(){return!!this._def.checks.find(e=>e.kind===\"email\")}get isURL(){return!!this._def.checks.find(e=>e.kind===\"url\")}get isEmoji(){return!!this._def.checks.find(e=>e.kind===\"emoji\")}get isUUID(){return!!this._def.checks.find(e=>e.kind===\"uuid\")}get isNANOID(){return!!this._def.checks.find(e=>e.kind===\"nanoid\")}get isCUID(){return!!this._def.checks.find(e=>e.kind===\"cuid\")}get isCUID2(){return!!this._def.checks.find(e=>e.kind===\"cuid2\")}get isULID(){return!!this._def.checks.find(e=>e.kind===\"ulid\")}get isIP(){return!!this._def.checks.find(e=>e.kind===\"ip\")}get isCIDR(){return!!this._def.checks.find(e=>e.kind===\"cidr\")}get isBase64(){return!!this._def.checks.find(e=>e.kind===\"base64\")}get isBase64url(){return!!this._def.checks.find(e=>e.kind===\"base64url\")}get minLength(){let e=null;for(let r of this._def.checks)r.kind===\"min\"&&(e===null||r.value>e)&&(e=r.value);return e}get maxLength(){let e=null;for(let r of this._def.checks)r.kind===\"max\"&&(e===null||r.value<e)&&(e=r.value);return e}};_r.create=t=>new _r({checks:[],typeName:M.ZodString,coerce:t?.coerce??!1,...z(t)});function m9(t,e){let r=(t.toString().split(\".\")[1]||\"\").length,n=(e.toString().split(\".\")[1]||\"\").length,i=r>n?r:n,a=Number.parseInt(t.toFixed(i).replace(\".\",\"\")),s=Number.parseInt(e.toFixed(i).replace(\".\",\"\"));return a%s/10**i}var Kr=class t extends H{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==P.number){let a=this._getOrReturnCtx(e);return k(a,{code:_.invalid_type,expected:P.number,received:a.parsedType}),D}let n,i=new Re;for(let a of this._def.checks)a.kind===\"int\"?K.isInteger(e.data)||(n=this._getOrReturnCtx(e,n),k(n,{code:_.invalid_type,expected:\"integer\",received:\"float\",message:a.message}),i.dirty()):a.kind===\"min\"?(a.inclusive?e.data<a.value:e.data<=a.value)&&(n=this._getOrReturnCtx(e,n),k(n,{code:_.too_small,minimum:a.value,type:\"number\",inclusive:a.inclusive,exact:!1,message:a.message}),i.dirty()):a.kind===\"max\"?(a.inclusive?e.data>a.value:e.data>=a.value)&&(n=this._getOrReturnCtx(e,n),k(n,{code:_.too_big,maximum:a.value,type:\"number\",inclusive:a.inclusive,exact:!1,message:a.message}),i.dirty()):a.kind===\"multipleOf\"?m9(e.data,a.value)!==0&&(n=this._getOrReturnCtx(e,n),k(n,{code:_.not_multiple_of,multipleOf:a.value,message:a.message}),i.dirty()):a.kind===\"finite\"?Number.isFinite(e.data)||(n=this._getOrReturnCtx(e,n),k(n,{code:_.not_finite,message:a.message}),i.dirty()):K.assertNever(a);return{status:i.value,value:e.data}}gte(e,r){return this.setLimit(\"min\",e,!0,q.toString(r))}gt(e,r){return this.setLimit(\"min\",e,!1,q.toString(r))}lte(e,r){return this.setLimit(\"max\",e,!0,q.toString(r))}lt(e,r){return this.setLimit(\"max\",e,!1,q.toString(r))}setLimit(e,r,n,i){return new t({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:n,message:q.toString(i)}]})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:\"int\",message:q.toString(e)})}positive(e){return this._addCheck({kind:\"min\",value:0,inclusive:!1,message:q.toString(e)})}negative(e){return this._addCheck({kind:\"max\",value:0,inclusive:!1,message:q.toString(e)})}nonpositive(e){return this._addCheck({kind:\"max\",value:0,inclusive:!0,message:q.toString(e)})}nonnegative(e){return this._addCheck({kind:\"min\",value:0,inclusive:!0,message:q.toString(e)})}multipleOf(e,r){return this._addCheck({kind:\"multipleOf\",value:e,message:q.toString(r)})}finite(e){return this._addCheck({kind:\"finite\",message:q.toString(e)})}safe(e){return this._addCheck({kind:\"min\",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:q.toString(e)})._addCheck({kind:\"max\",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:q.toString(e)})}get minValue(){let e=null;for(let r of this._def.checks)r.kind===\"min\"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(let r of this._def.checks)r.kind===\"max\"&&(e===null||r.value<e)&&(e=r.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind===\"int\"||e.kind===\"multipleOf\"&&K.isInteger(e.value))}get isFinite(){let e=null,r=null;for(let n of this._def.checks){if(n.kind===\"finite\"||n.kind===\"int\"||n.kind===\"multipleOf\")return!0;n.kind===\"min\"?(r===null||n.value>r)&&(r=n.value):n.kind===\"max\"&&(e===null||n.value<e)&&(e=n.value)}return Number.isFinite(r)&&NumberThu, 29 Jan 2026 21:35:05 GMT express-session deprecated req.secret; provide secret option at node:internal/modules/cjs/loader:1706:14","attributes":{"level":"error"},"tags":{"project":"29c6c2c4-ea10-4fe6-8901-1198a13520db","environment":"9a47f9fb-0d50-4031-a85e-16db1d46fb86","service":"09a1965e-88d6-44ee-9836-14176d4bb0b5","deployment":"e78c90dd-bc00-48f5-9312-8a8fa977b2c2","replica":"68b779c1-91b1-4ca6-88f4-a907899be5f1"},"timestamp":"2026-01-29T21:35:05.549743359Z"},{"message":"/app/dist/index.cjs:71","attributes":{"level":"error"},"tags":{"project":"29c6c2c4-ea10-4fe6-8901-1198a13520db","environment":"9a47f9fb-0d50-4031-a85e-16db1d46fb86","service":"09a1965e-88d6-44ee-9836-14176d4bb0b5","deployment":"e78c90dd-bc00-48f5-9312-8a8fa977b2c2","replica":"68b779c1-91b1-4ca6-88f4-a907899be5f1"},"timestamp":"2026-01-29T21:35:05.562258163Z"},{"message":"\t\t`;await r.execute(g`CREATE SCHEMA IF NOT EXISTS ${g.identifier(a)}`),await r.execute(s);let u=(await r.all(g`select id, hash, created_at from ${g.identifier(a)}.${g.identifier(i)} order by created_at desc limit 1`))[0];await r.transaction(async c=>{for await(let l of e)if(!u||Number(u.created_at)<l.folderMillis){for(let p of l.sql)await c.execute(g.raw(p));await c.execute(g`insert into ${g.identifier(a)}.${g.identifier(i)} (\"hash\", \"created_at\") values(${l.hash}, ${l.folderMillis})`)}})}escapeName(e){return`\"${e}\"`}escapeParam(e){return`$${e+1}`}escapeString(e){return`'${e.replace(/'/g,\"''\")}'`}buildWithCTE(e){if(!e?.length)return;let r=[g`with `];for(let[n,i]of e.entries())r.push(g`${g.identifier(i._.alias)} as (${i._.sql})`),n<e.length-1&&r.push(g`, `);return r.push(g` `),g.join(r)}buildDeleteQuery({table:e,where:r,returning:n,withList:i}){let a=this.buildWithCTE(i),s=n?g` returning ${this.buildSelection(n,{isSingleTable:!0})}`:void 0,o=r?g` where ${r}`:void 0;return g`${a}delete from ${e}${o}${s}`}buildUpdateSet(e,r){let n=e[A.Symbol.Columns],i=Object.keys(n).filter(s=>r[s]!==void 0||n[s]?.onUpdateFn!==void 0),a=i.length;return g.join(i.flatMap((s,o)=>{let u=n[s],c=r[s]??g.param(u.onUpdateFn(),u),l=g`${g.identifier(this.casing.getColumnCasing(u))} = ${c}`;return o<a-1?[l,g.raw(\", \")]:[l]}))}buildUpdateQuery({table:e,set:r,where:n,returning:i,withList:a,from:s,joins:o}){let u=this.buildWithCTE(a),c=e[Te.Symbol.Name],l=e[Te.Symbol.Schema],p=e[Te.Symbol.OriginalName],d=c===p?void 0:c,f=g`${l?g`${g.identifier(l)}.`:void 0}${g.identifier(p)}${d&&g` ${g.identifier(d)}`}`,y=this.buildUpdateSet(e,r),m=s&&g.join([g.raw(\" from \"),this.buildFromTable(s)]),x=this.buildJoins(o),w=i?g` returning ${this.buildSelection(i,{isSingleTable:!s})}`:void 0,T=n?g` where ${n}`:void 0;return g`${u}update ${f} set ${y}${m}${x}${T}${w}`}buildSelection(e,{isSingleTable:r=!1}={}){let n=e.length,i=e.flatMap(({field:a},s)=>{let o=[];if(b(a,O.Aliased)&&a.isSelectionField)o.push(g.identifier(a.fieldAlias));else if(b(a,O.Aliased)||b(a,O)){let u=b(a,O.Aliased)?a.sql:a;r?o.push(new O(u.queryChunks.map(c=>b(c,E)?g.identifier(this.casing.getColumnCasing(c)):c))):o.push(u),b(a,O.Aliased)&&o.push(g` as ${g.identifier(a.fieldAlias)}`)}else b(a,J)&&(r?o.push(g.identifier(this.casing.getColumnCasing(a))):o.push(a));return s<n-1&&o.push(g`, `),o});return g.join(i)}buildJoins(e){if(!e||e.length===0)return;let r=[];for(let[n,i]of e.entries()){n===0&&r.push(g` `);let a=i.table,s=i.lateral?g` lateral`:void 0;if(b(a,Te)){let o=a[Te.Symbol.Name],u=a[Te.Symbol.Schema],c=a[Te.Symbol.OriginalName],l=o===c?void 0:i.alias;r.push(g`${g.raw(i.joinType)} join${s} ${u?g`${g.identifier(u)}.`:void 0}${g.identifier(c)}${l&&g` ${g.identifier(l)}`} on ${i.on}`)}else if(b(a,Ue)){let o=a[te].name,u=a[te].schema,c=a[te].originalName,l=o===c?void 0:i.alias;r.push(g`${g.raw(i.joinType)} join${s} ${u?g`${g.identifier(u)}.`:void 0}${g.identifier(c)}${l&&g` ${g.identifier(l)}`} on ${i.on}`)}else r.push(g`${g.raw(i.joinType)} join${s} ${a} on ${i.on}`);n<e.length-1&&r.push(g` `)}return g.join(r)}buildFromTable(e){if(b(e,A)&&e[A.Symbol.OriginalName]!==e[A.Symbol.Name]){let r=g`${g.identifier(e[A.Symbol.OriginalName])}`;return e[A.Symbol.Schema]&&(r=g`${g.identifier(e[A.Symbol.Schema])}.${r}`),g`${r} ${g.identifier(e[A.Symbol.Name])}`}return e}buildSelectQuery({withList:e,fields:r,fieldsFlat:n,where:i,having:a,table:s,joins:o,orderBy:u,groupBy:c,limit:l,offset:p,lockingClause:d,distinct:f,setOperators:y}){let m=n??gt(r);for(let ne of m)if(b(ne.field,J)&&We(ne.field.table)!==(b(s,ye)?s._.alias:b(s,oi)?s[te].name:b(s,O)?void 0:We(s))&&!(he=>o?.some(({alias:et})=>et===(he[A.Symbol.IsAlias]?We(he):he[A.Symbol.BaseName])))(ne.field.table)){let he=We(ne.field.table);throw new Error(`Your \"${ne.path.join(\"->\")}\" field references a column \"${he}\".\"${ne.field.name}\", but the table \"${he}\" is not part of the query! Did you forget to join it?`)}let x=!o||o.length===0,w=this.buildWithCTE(e),T;f&&(T=f===!0?g` distinct`:g` distinct on (${g.join(f.on,g`, `)})`);let S=this.buildSelection(m,{isSingleTable:x}),C=this.buildFromTable(s),L=this.buildJoins(o),j=i?g` where ${i}`:void 0,R=a?g` having ${a}`:void 0,N;u&&u.length>0&&(N=g` order by ${g.join(u,g`, `)}`);let Q;c&&c.length>0&&(Q=g` group by ${g.join(c,g`, `)}`);let fe=typeof l==\"object\"||typeof l==\"number\"&&l>=0?g` limit ${l}`:void 0,_t=p?g` offset ${p}`:void 0,qe=g.empty();if(d){let ne=g` for ${g.raw(d.strength)}`;d.config.of&&ne.append(g` of ${g.join(Array.isArray(d.config.of)?d.config.of:[d.config.of],g`, `)}`),d.config.noWait?ne.append(g` no wait`):d.config.skipLocked&&ne.append(g` skip locked`),qe.append(ne)}let se=g`${w}select${T} ${S} from ${C}${L}${j}${Q}${R}${N}${fe}${_t}${qe}`;return y.length>0?this.buildSetOperations(se,y):se}buildSetOperations(e,r){let[n,...i]=r;if(!n)throw new Error(\"Cannot pass undefined values to any set operator\");return i.length===0?this.buildSetOperationQuery({leftSelect:e,setOperator:n}):this.buildSetOperations(this.buildSetOperationQuery({leftSelect:e,setOperator:n}),i)}buildSetOperationQuery({leftSelect:e,setOperator:{type:r,isAll:n,rightSelect:i,limit:a,orderBy:s,offset:o}}){let u=g`(${e.getSQL()}) `,c=g`(${i.getSQL()})`,l;if(s&&s.length>0){let y=[];for(let m of s)if(b(m,E))y.push(g.identifier(m.name));else if(b(m,O)){for(let x=0;x<m.queryChunks.length;x++){let w=m.queryChunks[x];b(w,E)&&(m.queryChunks[x]=g.identifier(w.name))}y.push(g`${m}`)}else y.push(g`${m}`);l=g` order by ${g.join(y,g`, `)} `}let p=typeof a==\"object\"||typeof a==\"number\"&&a>=0?g` limit ${a}`:void 0,d=g.raw(`${r} ${n?\"all \":\"\"}`),f=o?g` offset ${o}`:void 0;return g`${u}${d}${c}${l}${p}${f}`}buildInsertQuery({table:e,values:r,onConflict:n,returning:i,withList:a,select:s,overridingSystemValue_:o}){let u=[],c=e[A.Symbol.Columns],l=Object.entries(c).filter(([w,T])=>!T.shouldDisableInsert()),p=l.map(([,w])=>g.identifier(this.casing.getColumnCasing(w)));if(s){let w=r;b(w,O)?u.push(w):u.push(w.getSQL())}else{let w=r;u.push(g.raw(\"values \"));for(let[T,S]of w.entries()){let C=[];for(let[L,j]of l){let R=S[L];if(R===void 0||b(R,Ge)&&R.value===void 0)if(j.defaultFn!==void 0){let N=j.defaultFn(),Q=b(N,O)?N:g.param(N,j);C.push(Q)}else if(!j.default&&j.onUpdateFn!==void 0){let N=j.onUpdateFn(),Q=b(N,O)?N:g.param(N,j);C.push(Q)}else C.push(g`default`);else C.push(R)}u.push(C),T<w.length-1&&u.push(g`, `)}}let d=this.buildWithCTE(a),f=g.join(u),y=i?g` returning ${this.buildSelection(i,{isSingleTable:!0})}`:void 0,m=n?g` on conflict ${n}`:void 0,x=o===!0?g`overriding system value `:void 0;return g`${d}insert into ${e} ${p} ${x}${f}${m}${y}`}buildRefreshMaterializedViewQuery({view:e,concurrently:r,withNoData:n}){let i=r?g` concurrently`:void 0,a=n?g` with no data`:void 0;return g`refresh materialized view${i} ${e}${a}`}prepareTyping(e){return b(e,Sa)||b(e,_a)?\"json\":b(e,Ea)?\"decimal\":b(e,Ta)?\"time\":b(e,ka)||b(e,Aa)?\"timestamp\":b(e,ba)||b(e,wa)?\"date\":b(e,Ca)?\"uuid\":\"none\"}sqlToQuery(e,r){return e.toQuery({casing:this.casing,escapeName:this.escapeName,escapeParam:this.escapeParam,escapeString:this.escapeString,prepareTyping:this.prepareTyping,invokeSource:r})}buildRelationalQueryWithoutPK({fullSchema:e,schema:r,tableNamesMap:n,table:i,tableConfig:a,queryConfig:s,tableAlias:o,nestedQueryRelation:u,joinOn:c}){let l=[],p,d,f=[],y,m=[];if(s===!0)l=Object.entries(a.columns).map(([T,S])=>({dbKey:S.name,tsKey:T,field:Dt(S,o),relationTableTsKey:void 0,isJson:!1,selection:[]}));else{let w=Object.fromEntries(Object.entries(a.columns).map(([R,N])=>[R,Dt(N,o)]));if(s.where){let R=typeof s.where==\"function\"?s.where(w,F_()):s.where;y=R&&ga(R,o)}let T=[],S=[];if(s.columns){let R=!1;for(let[N,Q]of Object.entries(s.columns))Q!==void 0&&N in a.columns&&(!R&&Q===!0&&(R=!0),S.push(N));S.length>0&&(S=R?S.filter(N=>s.columns?.[N]===!0):Object.keys(a.columns).filter(N=>!S.includes(N)))}else S=Object.keys(a.columns);for(let R of S){let N=a.columns[R];T.push({tsKey:R,value:N})}let C=[];s.with&&(C=Object.entries(s.with).filter(R=>!!R[1]).map(([R,N])=>({tsKey:R,queryConfig:N,relation:a.relations[R]})));let L;if(s.extras){L=typeof s.extras==\"function\"?s.extras(w,{sql:g}):s.extras;for(let[R,N]of Object.entries(L))T.push({tsKey:R,value:pd(N,o)})}for(let{tsKey:R,value:N}of T)l.push({dbKey:b(N,O.Aliased)?N.fieldAlias:a.columns[R].name,tsKey:R,field:b(N,J)?Dt(N,o):N,relationTableTsKey:void 0,isJson:!1,selection:[]});let j=typeof s.orderBy==\"function\"?s.orderBy(w,$_()):s.orderBy??[];Array.isArray(j)||(j=[j]),f=j.map(R=>b(R,J)?Dt(R,o):ga(R,o)),p=s.limit,d=s.offset;for(let{tsKey:R,queryConfig:N,relation:Q}of C){let fe=B_(r,n,Q),_t=Hr(Q.referencedTable),qe=n[_t],se=`${o}_${R}`,ne=Pa(...fe.fields.map((Ht,qi)=>kt(Dt(fe.references[qi],se),Dt(Ht,o)))),he=this.buildRelationalQueryWithoutPK({fullSchema:e,schema:r,tableNamesMap:n,table:e[qe],tableConfig:r[qe],queryConfig:b(Q,xr)?N===!0?{limit:1}:{...N,limit:1}:N,tableAlias:se,joinOn:ne,nestedQueryRelation:Q}),et=g`${g.identifier(se)}.${g.identifier(\"data\")}`.as(R);m.push({on:g`true`,table:new ye(he.sql,{},se),alias:se,joinType:\"left\",lateral:!0}),l.push({dbKey:R,tsKey:R,field:et,relationTableTsKey:qe,isJson:!0,selection:he.selection})}}if(l.length===0)throw new xa({message:`No fields selected for table \"${a.tsName}\" (\"${o}\")`});let x;if(y=Pa(c,y),u){let w=g`json_build_array(${g.join(l.map(({field:C,tsKey:L,isJson:j})=>j?g`${g.identifier(`${o}_${L}`)}.${g.identifier(\"data\")}`:b(C,O.Aliased)?C.sql:C),g`, `)})`;b(u,Oa)&&(w=g`coalesce(json_agg(${w}${f.length>0?g` order by ${g.join(f,g`, `)}`:void 0}), '[]'::json)`);let T=[{dbKey:\"data\",tsKey:\"data\",field:w.as(\"data\"),isJson:!0,relationTableTsKey:a.tsName,selection:l}];p!==void 0||d!==void 0||f.length>0?(x=this.buildSelectQuery({table:ma(i,o),fields:{},fieldsFlat:[{path:[],field:g.raw(\"*\")}],where:y,limit:p,offset:d,orderBy:f,setOperators:[]}),y=void 0,p=void 0,d=void 0,f=[]):x=ma(i,o),x=this.buildSelectQuery({table:b(x,Te)?x:new ye(x,{},o),fields:{},fieldsFlat:T.map(({field:C})=>({path:[],field:b(C,J)?Dt(C,o):C})),joins:m,where:y,limit:p,offset:d,orderBy:f,setOperators:[]})}else x=this.buildSelectQuery({table:ma(i,o),fields:{},fieldsFlat:l.map(({field:w})=>({path:[],field:b(w,J)?Dt(w,o):w})),joins:m,where:y,limit:p,offset:d,orderBy:f,setOperators:[]});return{tableTsKey:a.tsName,sql:x,selection:l}}};var zo=class{static[h]=\"TypedQueryBuilder\";getSelectedFields(){return this._.selectedFields}};var De=class{static[h]=\"PgSelectBuilder\";fields;session;dialect;withList=[];distinct;constructor(e){this.fields=e.fields,this.session=e.session,this.dialect=e.dialect,e.withList&&(this.withList=e.withList),this.distinct=e.distinct}authToken;setToken(e){return this.authToken=e,this}from(e){let r=!!this.fields,n=e,i;return this.fields?i=this.fields:b(n,ye)?i=Object.fromEntries(Object.keys(n._.selectedFields).map(a=>[a,n[a]])):b(n,oi)?i=n[te].selectedFields:b(n,O)?i={}:i=qo(n),new Ho({table:n,fields:i,isPartialSelect:r,session:this.session,dialect:this.dialect,withList:this.withList,distinct:this.distinct}).setToken(this.authToken)}},If=class extends zo{static[h]=\"PgSelectQueryBuilder\";_;config;joinsNotNullableMap;tableName;isPartialSelect;session;dialect;constructor({table:e,fields:r,isPartialSelect:n,session:i,dialect:a,withList:s,distinct:o}){super(),this.config={withList:s,table:e,fields:{...r},distinct:o,setOperators:[]},this.isPartialSelect=n,this.session=i,this.dialect=a,this._={selectedFields:r},this.tableName=er(e),this.joinsNotNullableMap=typeof this.tableName==\"string\"?{[this.tableName]:!0}:{}}createJoin(e){return(r,n)=>{let i=this.tableName,a=er(r);if(typeof a==\"string\"&&this.config.joins?.some(s=>s.alias===a))throw new Error(`Alias \"${a}\" is already used in this query`);if(!this.isPartialSelect&&(Object.keys(this.joinsNotNullableMap).length===1&&typeof i==\"string\"&&(this.config.fields={[i]:this.config.fields}),typeof a==\"string\"&&!b(r,O))){let s=b(r,ye)?r._.selectedFields:b(r,Ue)?r[te].selectedFields:r[A.Symbol.Columns];this.config.fields[a]=s}if(typeof n==\"function\"&&(n=n(new Proxy(this.config.fields,new de({sqlAliasedBehavior:\"sql\",sqlBehavior:\"sql\"})))),this.config.joins||(this.config.joins=[]),this.config.joins.push({on:n,table:r,joinType:e,alias:a}),typeof a==\"string\")switch(e){case\"left\":{this.joinsNotNullableMap[a]=!1;break}case\"right\":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([s])=>[s,!1])),this.joinsNotNullableMap[a]=!0;break}case\"inner\":{this.joinsNotNullableMap[a]=!0;break}case\"full\":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([s])=>[s,!1])),this.joinsNotNullableMap[a]=!1;break}}return this}}leftJoin=this.createJoin(\"left\");rightJoin=this.createJoin(\"right\");innerJoin=this.createJoin(\"inner\");fullJoin=this.createJoin(\"full\");createSetOperator(e,r){return n=>{let i=typeof n==\"function\"?n(MI()):n;if(!va(this.getSelectedFields(),i.getSelectedFields()))throw new Error(\"Set operator error (union / intersect / except): selected fields are not the same or are in a different order\");return this.config.setOperators.push({type:e,isAll:r,rightSelect:i}),this}}union=this.createSetOperator(\"union\",!1);unionAll=this.createSetOperator(\"union\",!0);intersect=this.createSetOperator(\"intersect\",!1);intersectAll=this.createSetOperator(\"intersect\",!0);except=this.createSetOperator(\"except\",!1);exceptAll=this.createSetOperator(\"except\",!0);addSetOperators(e){return this.config.setOperators.push(...e),this}where(e){return typeof e==\"function\"&&(e=e(new Proxy(this.config.fields,new de({sqlAliasedBehavior:\"sql\",sqlBehavior:\"sql\"})))),this.config.where=e,this}having(e){return typeof e==\"function\"&&(e=e(new Proxy(this.config.fields,new de({sqlAliasedBehavior:\"sql\",sqlBehavior:\"sql\"})))),this.config.having=e,this}groupBy(...e){if(typeof e[0]==\"function\"){let r=e[0](new Proxy(this.config.fields,new de({sqlAliasedBehavior:\"alias\",sqlBehavior:\"sql\"})));this.config.groupBy=Array.isArray(r)?r:[r]}else this.config.groupBy=e;return this}orderBy(...e){if(typeof e[0]==\"function\"){let r=e[0](new Proxy(this.config.fields,new de({sqlAliasedBehavior:\"alias\",sqlBehavior:\"sql\"}))),n=Array.isArray(r)?r:[r];this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=n:this.config.orderBy=n}else{let r=e;this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=r:this.config.orderBy=r}return this}limit(e){return this.config.setOperators.length>0?this.config.setOperators.at(-1).limit=e:this.config.limit=e,this}offset(e){return this.config.setOperators.length>0?this.config.setOperators.at(-1).offset=e:this.config.offset=e,this}for(e,r={}){return this.config.lockingClause={strength:e,config:r},this}getSQL(){return this.dialect.buildSelectQuery(this.config)}toSQL(){let{typings:e,...r}=this.dialect.sqlToQuery(this.getSQL());return r}as(e){return new Proxy(new ye(this.getSQL(),this.config.fields,e),new de({alias:e,sqlAliasedBehavior:\"alias\",sqlBehavior:\"error\"}))}getSelectedFields(){return new Proxy(this.config.fields,new de({alias:this.tableName,sqlAliasedBehavior:\"alias\",sqlBehavior:\"error\"}))}$dynamic(){return this}},Ho=class extends If{static[h]=\"PgSelect\";_prepare(e){let{session:r,config:n,dialect:i,joinsNotNullableMap:a,authToken:s}=this;if(!r)throw new Error(\"Cannot execute a query on a query builder. Please use a database instance instead.\");return ee.startActiveSpan(\"drizzle.prepareQuery\",()=>{let o=gt(n.fields),u=r.prepareQuery(i.sqlToQuery(this.getSQL()),o,e,!0);return u.joinsNotNullableMap=a,u.setToken(s)})}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>ee.startActiveSpan(\"drizzle.operation\",()=>this._prepare().execute(e,this.authToken))};$1(Ho,[je]);function ci(t,e){return(r,n,...i)=>{let a=[n,...i].map(s=>({type:t,isAll:e,rightSelect:s}));for(let s of a)if(!va(r.getSelectedFields(),s.rightSelect.getSelectedFields()))throw new Error(\"Set operator error (union / intersect / except): selected fields are not the same or are in a different order\");return r.addSetOperators(a)}}var MI=()=>({union:FI,unionAll:$I,intersect:UI,intersectAll:BI,except:zI,exceptAll:HI}),FI=ci(\"union\",!1),$I=ci(\"union\",!0),UI=ci(\"intersect\",!1),BI=ci(\"intersect\",!0),zI=ci(\"except\",!1),HI=ci(\"except\",!0);var ui=class{static[h]=\"PgQueryBuilder\";dialect;dialectConfig;constructor(e){this.dialect=b(e,br)?e:void 0,this.dialectConfig=b(e,br)?void 0:e}$with=(e,r)=>{let n=this;return{as:a=>(typeof a==\"function\"&&(a=a(n)),new Proxy(new ni(a.getSQL(),r??(\"getSelectedFields\"in a?a.getSelectedFields()??{}:{}),e,!0),new de({alias:e,sqlAliasedBehavior:\"alias\",sqlBehavior:\"error\"})))}};with(...e){let r=this;function n(s){return new De({fields:s??void 0,session:void 0,dialect:r.getDialect(),withList:e})}function i(s){return new De({fields:s??void 0,session:void 0,dialect:r.getDialect(),distinct:!0})}function a(s,o){return new De({fields:o??void 0,session:void 0,dialect:r.getDialect(),distinct:{on:s}})}return{select:n,selectDistinct:i,selectDistinctOn:a}}select(e){return new De({fields:e??void 0,session:void 0,dialect:this.getDialect()})}selectDistinct(e){return new De({fields:e??void 0,session:void 0,dialect:this.getDialect(),distinct:!0})}selectDistinctOn(e,r){return new De({fields:r??void 0,session:void 0,dialect:this.getDialect(),distinct:{on:e}})}getDialect(){return this.dialect||(this.dialect=new br(this.dialectConfig)),this.dialect}};var Ra=class{constructor(e,r,n,i,a){this.table=e,this.session=r,this.dialect=n,this.withList=i,this.overridingSystemValue_=a}static[h]=\"PgInsertBuilder\";authToken;setToken(e){return this.authToken=e,this}overridingSystemValue(){return this.overridingSystemValue_=!0,this}values(e){if(e=Array.isArray(e)?e:[e],e.length===0)throw new Error(\"values() must be called with at least one value\");let r=e.map(n=>{let i={},a=this.table[A.Symbol.Columns];for(let s of Object.keys(n)){let o=n[s];i[s]=b(o,O)?o:new Ge(o,a[s])}return i});return new Qo(this.table,r,this.session,this.dialect,this.withList,!1,this.overridingSystemValue_).setToken(this.authToken)}select(e){let r=typeof e==\"function\"?e(new ui):e;if(!b(r,O)&&!va(this.table[Io],r._.selectedFields))throw new Error(\"Insert select error: selected fields are not the same or are in a different order compared to the table definition\");return new Qo(this.table,r,this.session,this.dialect,this.withList,!0)}},Qo=class extends je{constructor(e,r,n,i,a,s,o){super(),this.session=n,this.dialect=i,this.config={table:e,values:r,withList:a,select:s,overridingSystemValue_:o}}static[h]=\"PgInsert\";config;returning(e=this.config.table[A.Symbol.Columns]){return this.config.returningFields=e,this.config.returning=gt(e),this}onConflictDoNothing(e={}){if(e.target===void 0)this.config.onConflict=g`do nothing`;else{let r=\"\";r=Array.isArray(e.target)?e.target.map(i=>this.dialect.escapeName(this.dialect.casing.getColumnCasing(i))).join(\",\"):this.dialect.escapeName(this.dialect.casing.getColumnCasing(e.target));let n=e.where?g` where ${e.where}`:void 0;this.config.onConflict=g`(${g.raw(r)})${n} do nothing`}return this}onConflictDoUpdate(e){if(e.where&&(e.targetWhere||e.setWhere))throw new Error('You cannot use both \"where\" and \"targetWhere\"/\"setWhere\" at the same time - \"where\" is deprecated, use \"targetWhere\" or \"setWhere\" instead.');let r=e.where?g` where ${e.where}`:void 0,n=e.targetWhere?g` where ${e.targetWhere}`:void 0,i=e.setWhere?g` where ${e.setWhere}`:void 0,a=this.dialect.buildUpdateSet(this.config.table,No(this.config.table,e.set)),s=\"\";return s=Array.isArray(e.target)?e.target.map(o=>this.dialect.escapeName(this.dialect.casing.getColumnCasing(o))).join(\",\"):this.dialect.escapeName(this.dialect.casing.getColumnCasing(e.target)),this.config.onConflict=g`(${g.raw(s)})${n} do update set ${a}${r}${i}`,this}getSQL(){return this.dialect.buildInsertQuery(this.config)}toSQL(){let{typings:e,...r}=this.dialect.sqlToQuery(this.getSQL());return r}_prepare(e){return ee.startActiveSpan(\"drizzle.prepareQuery\",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,e,!0))}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>ee.startActiveSpan(\"drizzle.operation\",()=>this._prepare().execute(e,this.authToken));getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new de({alias:We(this.config.table),sqlAliasedBehavior:\"alias\",sqlBehavior:\"error\"})):void 0}$dynamic(){return this}};var Vo=class extends je{constructor(e,r,n){super(),this.session=r,this.dialect=n,this.config={view:e}}static[h]=\"PgRefreshMaterializedView\";config;concurrently(){if(this.config.withNoData!==void 0)throw new Error(\"Cannot use concurrently and withNoData together\");return this.config.concurrently=!0,this}withNoData(){if(this.config.concurrently!==void 0)throw new Error(\"Cannot use concurrently and withNoData together\");return this.config.withNoData=!0,this}getSQL(){return this.dialect.buildRefreshMaterializedViewQuery(this.config)}toSQL(){let{typings:e,...r}=this.dialect.sqlToQuery(this.getSQL());return r}_prepare(e){return ee.startActiveSpan(\"drizzle.prepareQuery\",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),void 0,e,!0))}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>ee.startActiveSpan(\"drizzle.operation\",()=>this._prepare().execute(e,this.authToken))};var Ia=class{constructor(e,r,n,i){this.table=e,this.session=r,this.dialect=n,this.withList=i}static[h]=\"PgUpdateBuilder\";authToken;setToken(e){return this.authToken=e,this}set(e){return new Nf(this.table,No(this.table,e),this.session,this.dialect,this.withList).setToken(this.authToken)}},Nf=class extends je{constructor(e,r,n,i,a){super(),this.session=n,this.dialect=i,this.config={set:r,table:e,withList:a,joins:[]},this.tableName=er(e),this.joinsNotNullableMap=typeof this.tableName==\"string\"?{[this.tableName]:!0}:{}}static[h]=\"PgUpdate\";config;tableName;joinsNotNullableMap;from(e){let r=e,n=er(r);return typeof n==\"string\"&&(this.joinsNotNullableMap[n]=!0),this.config.from=r,this}getTableLikeFields(e){return b(e,Te)?e[A.Symbol.Columns]:b(e,ye)?e._.selectedFields:e[te].selectedFields}createJoin(e){return(r,n)=>{let i=er(r);if(typeof i==\"string\"&&this.config.joins.some(a=>a.alias===i))throw new Error(`Alias \"${i}\" is already used in this query`);if(typeof n==\"function\"){let a=this.config.from&&!b(this.config.from,O)?this.getTableLikeFields(this.config.from):void 0;n=n(new Proxy(this.config.table[A.Symbol.Columns],new de({sqlAliasedBehavior:\"sql\",sqlBehavior:\"sql\"})),a&&new Proxy(a,new de({sqlAliasedBehavior:\"sql\",sqlBehavior:\"sql\"})))}if(this.config.joins.push({on:n,table:r,joinType:e,alias:i}),typeof i==\"string\")switch(e){case\"left\":{this.joinsNotNullableMap[i]=!1;break}case\"right\":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([a])=>[a,!1])),this.joinsNotNullableMap[i]=!0;break}case\"inner\":{this.joinsNotNullableMap[i]=!0;break}case\"full\":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([a])=>[a,!1])),this.joinsNotNullableMap[i]=!1;break}}return this}}leftJoin=this.createJoin(\"left\");rightJoin=this.createJoin(\"right\");innerJoin=this.createJoin(\"inner\");fullJoin=this.createJoin(\"full\");where(e){return this.config.where=e,this}returning(e){if(!e&&(e=Object.assign({},this.config.table[A.Symbol.Columns]),this.config.from)){let r=er(this.config.from);if(typeof r==\"string\"&&this.config.from&&!b(this.config.from,O)){let n=this.getTableLikeFields(this.config.from);e[r]=n}for(let n of this.config.joins){let i=er(n.table);if(typeof i==\"string\"&&!b(n.table,O)){let a=this.getTableLikeFields(n.table);e[i]=a}}}return this.config.returningFields=e,this.config.returning=gt(e),this}getSQL(){return this.dialect.buildUpdateQuery(this.config)}toSQL(){let{typings:e,...r}=this.dialect.sqlToQuery(this.getSQL());return r}_prepare(e){let r=this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,e,!0);return r.joinsNotNullableMap=this.joinsNotNullableMap,r}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>this._prepare().execute(e,this.authToken);getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new de({alias:We(this.config.table),sqlAliasedBehavior:\"alias\",sqlBehavior:\"error\"})):void 0}$dynamic(){return this}};var Ko=class t extends O{constructor(e){super(t.buildEmbeddedCount(e.source,e.filters).queryChunks),this.params=e,this.mapWith(Number),this.session=e.session,this.sql=t.buildCount(e.source,e.filters)}sql;token;static[h]=\"PgCountBuilder\";[Symbol.toStringTag]=\"PgCountBuilder\";session;static buildEmbeddedCount(e,r){return g`(select count(*) from ${e}${g.raw(\" where \").if(r)}${r})`}static buildCount(e,r){return g`select count(*) as count from ${e}${g.raw(\" where \").if(r)}${r};`}setToken(e){return this.token=e,this}then(e,r){return Promise.resolve(this.session.count(this.sql,this.token)).then(e,r)}catch(e){return this.then(void 0,e)}finally(e){return this.then(r=>(e?.(),r),r=>{throw e?.(),r})}};var Wo=class{constructor(e,r,n,i,a,s,o){this.fullSchema=e,this.schema=r,this.tableNamesMap=n,this.table=i,this.tableConfig=a,this.dialect=s,this.session=o}static[h]=\"PgRelationalQueryBuilder\";findMany(e){return new Go(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,e||{},\"many\")}findFirst(e){return new Go(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,e?{...e,limit:1}:{limit:1},\"first\")}},Go=class extends je{constructor(e,r,n,i,a,s,o,u,c){super(),this.fullSchema=e,this.schema=r,this.tableNamesMap=n,this.table=i,this.tableConfig=a,this.dialect=s,this.session=o,this.config=u,this.mode=c}static[h]=\"PgRelationalQuery\";_prepare(e){return ee.startActiveSpan(\"drizzle.prepareQuery\",()=>{let{query:r,builtQuery:n}=this._toSQL();return this.session.prepareQuery(n,void 0,e,!0,(i,a)=>{let s=i.map(o=>Bo(this.schema,this.tableConfig,o,r.selection,a));return this.mode===\"first\"?s[0]:s})})}prepare(e){return this._prepare(e)}_getQuery(){return this.dialect.buildRelationalQueryWithoutPK({fullSchema:this.fullSchema,schema:this.schema,tableNamesMap:this.tableNamesMap,table:this.table,tableConfig:this.tableConfig,queryConfig:this.config,tableAlias:this.tableConfig.tsName})}getSQL(){return this._getQuery().sql}_toSQL(){let e=this._getQuery(),r=this.dialect.sqlToQuery(e.sql);return{query:e,builtQuery:r}}toSQL(){return this._toSQL().builtQuery}authToken;setToken(e){return this.authToken=e,this}execute(){return ee.startActiveSpan(\"drizzle.operation\",()=>this._prepare().execute(void 0,this.authToken))}};var Jo=class extends je{constructor(e,r,n,i){super(),this.execute=e,this.sql=r,this.query=n,this.mapBatchResult=i}static[h]=\"PgRaw\";getSQL(){return this.sql}getQuery(){return this.query}mapResult(e,r){return r?this.mapBatchResult(e):e}_prepare(){return this}isResponseInArrayMode(){return!1}};var li=class{constructor(e,r,n){if(this.dialect=e,this.session=r,this._=n?{schema:n.schema,fullSchema:n.fullSchema,tableNamesMap:n.tableNamesMap,session:r}:{schema:void 0,fullSchema:{},tableNamesMap:{},session:r},this.query={},this._.schema)for(let[i,a]of Object.entries(this._.schema))this.query[i]=new Wo(n.fullSchema,this._.schema,this._.tableNamesMap,n.fullSchema[i],a,e,r)}static[h]=\"PgDatabase\";query;$with=(e,r)=>{let n=this;return{as:a=>(typeof a==\"function\"&&(a=a(new ui(n.dialect))),new Proxy(new ni(a.getSQL(),r??(\"getSelectedFields\"in a?a.getSelectedFields()??{}:{}),e,!0),new de({alias:e,sqlAliasedBehavior:\"alias\",sqlBehavior:\"error\"})))}};$count(e,r){return new Ko({source:e,filters:r,session:this.session})}with(...e){let r=this;function n(c){return new De({fields:c??void 0,session:r.session,dialect:r.dialect,withList:e})}function i(c){return new De({fields:c??void 0,session:r.session,dialect:r.dialect,withList:e,distinct:!0})}function a(c,l){return new De({fields:l??void 0,session:r.session,dialect:r.dialect,withList:e,distinct:{on:c}})}function s(c){return new Ia(c,r.session,r.dialect,e)}function o(c){return new Ra(c,r.session,r.dialect,e)}function u(c){return new ya(c,r.session,r.dialect,e)}return{select:n,selectDistinct:i,selectDistinctOn:a,update:s,insert:o,delete:u}}select(e){return new De({fields:e??void 0,session:this.session,dialect:this.dialect})}selectDistinct(e){return new De({fields:e??void 0,session:this.session,dialect:this.dialect,distinct:!0})}selectDistinctOn(e,r){return new De({fields:r??void 0,session:this.session,dialect:this.dialect,distinct:{on:e}})}update(e){return new Ia(e,this.session,this.dialect)}insert(e){return new Ra(e,this.session,this.dialect)}delete(e){return new ya(e,this.session,this.dialect)}refreshMaterializedView(e){return new Vo(e,this.session,this.dialect)}authToken;execute(e){let r=typeof e==\"string\"?g.raw(e):e.getSQL(),n=this.dialect.sqlToQuery(r),i=this.session.prepareQuery(n,void 0,void 0,!1);return new Jo(()=>i.execute(void 0,this.authToken),r,n,a=>i.mapResult(a,!0))}transaction(e,r){return this.session.transaction(e,r)}};var qf=class{constructor(e,r){this.unique=e,this.name=r}static[h]=\"PgIndexBuilderOn\";on(...e){return new Na(e.map(r=>{if(b(r,O))return r;r=r;let n=new ri(r.name,!!r.keyAsName,r.columnType,r.indexConfig);return r.indexConfig=JSON.parse(JSON.stringify(r.defaultConfig)),n}),this.unique,!1,this.name)}onOnly(...e){return new Na(e.map(r=>{if(b(r,O))return r;r=r;let n=new ri(r.name,!!r.keyAsName,r.columnType,r.indexConfig);return r.indexConfig=r.defaultConfig,n}),this.unique,!0,this.name)}using(e,...r){return new Na(r.map(n=>{if(b(n,O))return n;n=n;let i=new ri(n.name,!!n.keyAsName,n.columnType,n.indexConfig);return n.indexConfig=JSON.parse(JSON.stringify(n.defaultConfig)),i}),this.unique,!0,this.name,e)}},Na=class{static[h]=\"PgIndexBuilder\";config;constructor(e,r,n,i,a=\"btree\"){this.config={name:i,columns:e,unique:r,only:n,method:a}}concurrently(){return this.config.concurrently=!0,this}with(e){return this.config.with=e,this}where(e){return this.config.where=e,this}build(e){return new jf(this.config,e)}},jf=class{static[h]=\"PgIndex\";config;constructor(e,r){this.config={...e,table:r}}};function H_(t){return new qf(!1,t)}var Zo=class{constructor(e){this.query=e}authToken;getQuery(){return this.query}mapResult(e,r){return e}setToken(e){return this.authToken=e,this}static[h]=\"PgPreparedQuery\";joinsNotNullableMap},Xo=class{constructor(e){this.dialect=e}static[h]=\"PgSession\";execute(e,r){return ee.startActiveSpan(\"drizzle.operation\",()=>ee.startActiveSpan(\"drizzle.prepareQuery\",()=>this.prepareQuery(this.dialect.sqlToQuery(e),void 0,void 0,!1)).setToken(r).execute(void 0,r))}all(e){return this.prepareQuery(this.dialect.sqlToQuery(e),void 0,void 0,!1).all()}async count(e,r){let n=await this.execute(e,r);return Number(n[0].count)}},Yo=class extends li{constructor(e,r,n,i=0){super(e,r,n),this.schema=n,this.nestedIndex=i}static[h]=\"PgTransaction\";rollback(){throw new Do}getTransactionConfigSQL(e){let r=[];return e.isolationLevel&&r.push(`isolation level ${e.isolationLevel}`),e.accessMode&&r.push(e.accessMode),typeof e.deferrable==\"boolean\"&&r.push(e.deferrable?\"deferrable\":\"not deferrable\"),g.raw(r.join(\" \"))}setTransaction(e){return this.session.execute(g`set transaction ${this.getTransactionConfigSQL(e)}`)}};var{Pool:Q_,types:Mt}=yr,Df=class extends Zo{constructor(e,r,n,i,a,s,o,u){super({sql:r,params:n}),this.client=e,this.params=n,this.logger=i,this.fields=a,this._isResponseInArrayMode=o,this.customResultMapper=u,this.rawQueryConfig={name:s,text:r,types:{getTypeParser:(c,l)=>c===Mt.builtins.TIMESTAMPTZ?p=>p:c===Mt.builtins.TIMESTAMP?p=>p:c===Mt.builtins.DATE?p=>p:c===Mt.builtins.INTERVAL?p=>p:Mt.getTypeParser(c,l)}},this.queryConfig={name:s,text:r,rowMode:\"array\",types:{getTypeParser:(c,l)=>c===Mt.builtins.TIMESTAMPTZ?p=>p:c===Mt.builtins.TIMESTAMP?p=>p:c===Mt.builtins.DATE?p=>p:c===Mt.builtins.INTERVAL?p=>p:Mt.getTypeParser(c,l)}}}static[h]=\"NodePgPreparedQuery\";rawQueryConfig;queryConfig;async execute(e={}){return ee.startActiveSpan(\"drizzle.execute\",async()=>{let r=ld(this.params,e);this.logger.logQuery(this.rawQueryConfig.text,r);let{fields:n,rawQueryConfig:i,client:a,queryConfig:s,joinsNotNullableMap:o,customResultMapper:u}=this;if(!n&&!u)return ee.startActiveSpan(\"drizzle.driver.execute\",async l=>(l?.setAttributes({\"drizzle.query.name\":i.name,\"drizzle.query.text\":i.text,\"drizzle.query.params\":JSON.stringify(r)}),a.query(i,r)));let c=await ee.startActiveSpan(\"drizzle.driver.execute\",l=>(l?.setAttributes({\"drizzle.query.name\":s.name,\"drizzle.query.text\":s.text,\"drizzle.query.params\":JSON.stringify(r)}),a.query(s,r)));return ee.startActiveSpan(\"drizzle.mapResponse\",()=>u?u(c.rows):c.rows.map(l=>F1(n,l,o)))})}all(e={}){return ee.startActiveSpan(\"drizzle.execute\",()=>{let r=ld(this.params,e);return this.logger.logQuery(this.rawQueryConfig.text,r),ee.startActiveSpan(\"drizzle.driver.execute\",n=>(n?.setAttributes({\"drizzle.query.name\":this.rawQueryConfig.name,\"drizzle.query.text\":this.rawQueryConfig.text,\"drizzle.query.params\":JSON.stringify(r)}),this.client.query(this.rawQueryConfig,r).then(i=>i.rows)))})}isResponseInArrayMode(){return this._isResponseInArrayMode}},ec=class t extends Xo{constructor(e,r,n,i={}){super(r),this.client=e,this.schema=n,this.options=i,this.logger=i.logger??new Ao}static[h]=\"NodePgSession\";logger;prepareQuery(e,r,n,i,a){return new Df(this.client,e.sql,e.params,this.logger,r,n,i,a)}async transaction(e,r){let n=this.client instanceof Q_?new t(await this.client.connect(),this.dialect,this.schema,this.options):this,i=new Lf(this.dialect,n,this.schema);await i.execute(g`begin${r?g` ${i.getTransactionConfigSQL(r)}`:void 0}`);try{let a=await e(i);return await i.execute(g`commit`),a}catch(a){throw await i.execute(g`rollback`),a}finally{this.client instanceof Q_&&n.client.release()}}async count(e){let r=await this.execute(e);return Number(r.rows[0].count)}},Lf=class t extends Yo{static[h]=\"NodePgTransaction\";async transaction(e){let r=`sp${this.nestedIndex+1}`,n=new t(this.dialect,this.session,this.schema,this.nestedIndex+1);await n.execute(g.raw(`savepoint ${r}`));try{let i=await e(n);return await n.execute(g.raw(`release savepoint ${r}`)),i}catch(i){throw await n.execute(g.raw(`rollback to savepoint ${r}`)),i}}};var Mf=class{constructor(e,r,n={}){this.client=e,this.dialect=r,this.options=n}static[h]=\"NodePgDriver\";createSession(e){return new ec(this.client,this.dialect,e,{logger:this.options.logger})}},Ff=class extends li{static[h]=\"NodePgDatabase\"};function qa(t,e={}){let r=new br({casing:e.casing}),n;e.logger===!0?n=new ko:e.logger!==!1&&(n=e.logger);let i;if(e.schema){let u=U_(e.schema,z_);i={fullSchema:e.schema,schema:u.tables,tableNamesMap:u.tableNamesMap}}let s=new Mf(t,r,{logger:n}).createSession(i),o=new Ff(r,s,i);return o.$client=t,o}function tc(...t){if(typeof t[0]==\"string\"){let e=new yr.Pool({connectionString:t[0]});return qa(e,t[1])}if(B1(t[0])){let{connection:e,client:r,...n}=t[0];if(r)return qa(r,n);let i=typeof e==\"string\"?new yr.Pool({connectionString:e}):new yr.Pool(e);return qa(i,n)}return qa(t[0],t[1])}(t=>{function e(r){return qa({},r)}t.mock=e})(tc||(tc={}));var oc={};Rc(oc,{inquiries:()=>at,insertInquirySchema:()=>Hf,insertUserSchema:()=>lN,sessions:()=>uN,users:()=>Tr});var Ie={};Rc(Ie,{BRAND:()=>g9,DIRTY:()=>Vr,EMPTY_PATH:()=>WI,INVALID:()=>D,NEVER:()=>eN,OK:()=>Le,ParseStatus:()=>Re,Schema:()=>H,ZodAny:()=>Sr,ZodArray:()=>ar,ZodBigInt:()=>Wr,ZodBoolean:()=>Gr,ZodBranded:()=>Da,ZodCatch:()=>on,ZodDate:()=>Jr,ZodDefault:()=>sn,ZodDiscriminatedUnion:()=>ic,ZodEffects:()=>bt,ZodEnum:()=>nn,ZodError:()=>Ze,ZodFirstPartyTypeKind:()=>M,ZodFunction:()=>sc,ZodIntersection:()=>en,ZodIssueCode:()=>_,ZodLazy:()=>tn,ZodLiteral:()=>rn,ZodMap:()=>gi,ZodNaN:()=>yi,ZodNativeEnum:()=>an,ZodNever:()=>At,ZodNull:()=>Xr,ZodNullable:()=>Ut,ZodNumber:()=>Kr,ZodObject:()=>Xe,ZodOptional:()=>yt,ZodParsedType:()=>P,ZodPipeline:()=>La,ZodPromise:()=>Er,ZodReadonly:()=>cn,ZodRecord:()=>ac,ZodSchema:()=>H,ZodSet:()=>vi,ZodString:()=>_r,ZodSymbol:()=>hi,ZodTransformer:()=>bt,ZodTuple:()=>$t,ZodType:()=>H,ZodUndefined:()=>Zr,ZodUnion:()=>Yr,ZodUnknown:()=>ir,ZodVoid:()=>mi,addIssueToContext:()=>k,any:()=>T9,array:()=>P9,bigint:()=>b9,boolean:()=>rS,coerce:()=>Y9,custom:()=>Y_,date:()=>w9,datetimeRegex:()=>Z_,defaultErrorMap:()=>rr,discriminatedUnion:()=>N9,effect:()=>Q9,enum:()=>B9,function:()=>F9,getErrorMap:()=>pi,getParsedType:()=>Ft,instanceof:()=>y9,intersection:()=>q9,isAborted:()=>rc,isAsync:()=>di,isDirty:()=>nc,isValid:()=>wr,late:()=>v9,lazy:()=>$9,literal:()=>U9,makeIssue:()=>ja,map:()=>L9,nan:()=>x9,nativeEnum:()=>z9,never:()=>A9,null:()=>E9,nullable:()=>K9,number:()=>tS,object:()=>O9,objectUtil:()=>$f,oboolean:()=>X9,onumber:()=>Z9,optional:()=>V9,ostring:()=>J9,pipeline:()=>G9,preprocess:()=>W9,promise:()=>H9,quotelessJson:()=>QI,record:()=>D9,set:()=>M9,setErrorMap:()=>KI,strictObject:()=>R9,string:()=>eS,symbol:()=>_9,transformer:()=>Q9,tuple:()=>j9,undefined:()=>S9,union:()=>I9,unknown:()=>k9,util:()=>K,void:()=>C9});var K;(function(t){t.assertEqual=i=>{};function e(i){}t.assertIs=e;function r(i){throw new Error}t.assertNever=r,t.arrayToEnum=i=>{let a={};for(let s of i)a[s]=s;return a},t.getValidEnumValues=i=>{let a=t.objectKeys(i).filter(o=>typeof i[i[o]]!=\"number\"),s={};for(let o of a)s[o]=i[o];return t.objectValues(s)},t.objectValues=i=>t.objectKeys(i).map(function(a){return i[a]}),t.objectKeys=typeof Object.keys==\"function\"?i=>Object.keys(i):i=>{let a=[];for(let s in i)Object.prototype.hasOwnProperty.call(i,s)&&a.push(s);return a},t.find=(i,a)=>{for(let s of i)if(a(s))return s},t.isInteger=typeof Number.isInteger==\"function\"?i=>Number.isInteger(i):i=>typeof i==\"number\"&&Number.isFinite(i)&&Math.floor(i)===i;function n(i,a=\" | \"){return i.map(s=>typeof s==\"string\"?`'${s}'`:s).join(a)}t.joinValues=n,t.jsonStringifyReplacer=(i,a)=>typeof a==\"bigint\"?a.toString():a})(K||(K={}));var $f;(function(t){t.mergeShapes=(e,r)=>({...e,...r})})($f||($f={}));var P=K.arrayToEnum([\"string\",\"nan\",\"number\",\"integer\",\"float\",\"boolean\",\"date\",\"bigint\",\"symbol\",\"function\",\"undefined\",\"null\",\"array\",\"object\",\"unknown\",\"promise\",\"void\",\"never\",\"map\",\"set\"]),Ft=t=>{switch(typeof t){case\"undefined\":return P.undefined;case\"string\":return P.string;case\"number\":return Number.isNaN(t)?P.nan:P.number;case\"boolean\":return P.boolean;case\"function\":return P.function;case\"bigint\":return P.bigint;case\"symbol\":return P.symbol;case\"object\":return Array.isArray(t)?P.array:t===null?P.null:t.then&&typeof t.then==\"function\"&&t.catch&&typeof t.catch==\"function\"?P.promise:typeof Map<\"u\"&&t instanceof Map?P.map:typeof Set<\"u\"&&t instanceof Set?P.set:typeof Date<\"u\"&&t instanceof Date?P.date:P.object;default:return P.unknown}};var _=K.arrayToEnum([\"invalid_type\",\"invalid_literal\",\"custom\",\"invalid_union\",\"invalid_union_discriminator\",\"invalid_enum_value\",\"unrecognized_keys\",\"invalid_arguments\",\"invalid_return_type\",\"invalid_date\",\"invalid_string\",\"too_small\",\"too_big\",\"invalid_intersection_types\",\"not_multiple_of\",\"not_finite\"]),QI=t=>JSON.stringify(t,null,2).replace(/\"([^\"]+)\":/g,\"$1:\"),Ze=class t extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};let r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name=\"ZodError\",this.issues=e}format(e){let r=e||function(a){return a.message},n={_errors:[]},i=a=>{for(let s of a.issues)if(s.code===\"invalid_union\")s.unionErrors.map(i);else if(s.code===\"invalid_return_type\")i(s.returnTypeError);else if(s.code===\"invalid_arguments\")i(s.argumentsError);else if(s.path.length===0)n._errors.push(r(s));else{let o=n,u=0;for(;u<s.path.length;){let c=s.path[u];u===s.path.length-1?(o[c]=o[c]||{_errors:[]},o[c]._errors.push(r(s))):o[c]=o[c]||{_errors:[]},o=o[c],u++}}};return i(this),n}static assert(e){if(!(e instanceof t))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,K.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=r=>r.message){let r={},n=[];for(let i of this.issues)if(i.path.length>0){let a=i.path[0];r[a]=r[a]||[],r[a].push(e(i))}else n.push(e(i));return{formErrors:n,fieldErrors:r}}get formErrors(){return this.flatten()}};Ze.create=t=>new Ze(t);var VI=(t,e)=>{let r;switch(t.code){case _.invalid_type:t.received===P.undefined?r=\"Required\":r=`Expected ${t.expected}, received ${t.received}`;break;case _.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(t.expected,K.jsonStringifyReplacer)}`;break;case _.unrecognized_keys:r=`Unrecognized key(s) in object: ${K.joinValues(t.keys,\", \")}`;break;case _.invalid_union:r=\"Invalid input\";break;case _.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${K.joinValues(t.options)}`;break;case _.invalid_enum_value:r=`Invalid enum value. Expected ${K.joinValues(t.options)}, received '${t.received}'`;break;case _.invalid_arguments:r=\"Invalid function arguments\";break;case _.invalid_return_type:r=\"Invalid function return type\";break;case _.invalid_date:r=\"Invalid date\";break;case _.invalid_string:typeof t.validation==\"object\"?\"includes\"in t.validation?(r=`Invalid input: must include \"${t.validation.includes}\"`,typeof t.validation.position==\"number\"&&(r=`${r} at one or more positions greater than or equal to ${t.validation.position}`)):\"startsWith\"in t.validation?r=`Invalid input: must start with \"${t.validation.startsWith}\"`:\"endsWith\"in t.validation?r=`Invalid input: must end with \"${t.validation.endsWith}\"`:K.assertNever(t.validation):t.validation!==\"regex\"?r=`Invalid ${t.validation}`:r=\"Invalid\";break;case _.too_small:t.type===\"array\"?r=`Array must contain ${t.exact?\"exactly\":t.inclusive?\"at least\":\"more than\"} ${t.minimum} element(s)`:t.type===\"string\"?r=`String must contain ${t.exact?\"exactly\":t.inclusive?\"at least\":\"over\"} ${t.minimum} character(s)`:t.type===\"number\"?r=`Number must be ${t.exact?\"exactly equal to \":t.inclusive?\"greater than or equal to \":\"greater than \"}${t.minimum}`:t.type===\"bigint\"?r=`Number must be ${t.exact?\"exactly equal to \":t.inclusive?\"greater than or equal to \":\"greater than \"}${t.minimum}`:t.type===\"date\"?r=`Date must be ${t.exact?\"exactly equal to \":t.inclusive?\"greater than or equal to \":\"greater than \"}${new Date(Number(t.minimum))}`:r=\"Invalid input\";break;case _.too_big:t.type===\"array\"?r=`Array must contain ${t.exact?\"exactly\":t.inclusive?\"at most\":\"less than\"} ${t.maximum} element(s)`:t.type===\"string\"?r=`String must contain ${t.exact?\"exactly\":t.inclusive?\"at most\":\"under\"} ${t.maximum} character(s)`:t.type===\"number\"?r=`Number must be ${t.exact?\"exactly\":t.inclusive?\"less than or equal to\":\"less than\"} ${t.maximum}`:t.type===\"bigint\"?r=`BigInt must be ${t.exact?\"exactly\":t.inclusive?\"less than or equal to\":\"less than\"} ${t.maximum}`:t.type===\"date\"?r=`Date must be ${t.exact?\"exactly\":t.inclusive?\"smaller than or equal to\":\"smaller than\"} ${new Date(Number(t.maximum))}`:r=\"Invalid input\";break;case _.custom:r=\"Invalid input\";break;case _.invalid_intersection_types:r=\"Intersection results could not be merged\";break;case _.not_multiple_of:r=`Number must be a multiple of ${t.multipleOf}`;break;case _.not_finite:r=\"Number must be finite\";break;default:r=e.defaultError,K.assertNever(t)}return{message:r}},rr=VI;var V_=rr;function KI(t){V_=t}function pi(){return V_}var ja=t=>{let{data:e,path:r,errorMaps:n,issueData:i}=t,a=[...r,...i.path||[]],s={...i,path:a};if(i.message!==void 0)return{...i,path:a,message:i.message};let o=\"\",u=n.filter(c=>!!c).slice().reverse();for(let c of u)o=c(s,{data:e,defaultError:o}).message;return{...i,path:a,message:o}},WI=[];function k(t,e){let r=pi(),n=ja({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,r,r===rr?void 0:rr].filter(i=>!!i)});t.common.issues.push(n)}var Re=class t{constructor(){this.value=\"valid\"}dirty(){this.value===\"valid\"&&(this.value=\"dirty\")}abort(){this.value!==\"aborted\"&&(this.value=\"aborted\")}static mergeArray(e,r){let n=[];for(let i of r){if(i.status===\"aborted\")return D;i.status===\"dirty\"&&e.dirty(),n.push(i.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,r){let n=[];for(let i of r){let a=await i.key,s=await i.value;n.push({key:a,value:s})}return t.mergeObjectSync(e,n)}static mergeObjectSync(e,r){let n={};for(let i of r){let{key:a,value:s}=i;if(a.status===\"aborted\"||s.status===\"aborted\")return D;a.status===\"dirty\"&&e.dirty(),s.status===\"dirty\"&&e.dirty(),a.value!==\"__proto__\"&&(typeof s.value<\"u\"||i.alwaysSet)&&(n[a.value]=s.value)}return{status:e.value,value:n}}},D=Object.freeze({status:\"aborted\"}),Vr=t=>({status:\"dirty\",value:t}),Le=t=>({status:\"valid\",value:t}),rc=t=>t.status===\"aborted\",nc=t=>t.status===\"dirty\",wr=t=>t.status===\"valid\",di=t=>typeof Promise<\"u\"&&t instanceof Promise;var q;(function(t){t.errToObj=e=>typeof e==\"string\"?{message:e}:e||{},t.toString=e=>typeof e==\"string\"?e:e?.message})(q||(q={}));var xt=class{constructor(e,r,n,i){this._cachedPath=[],this.parent=e,this.data=r,this._path=n,this._key=i}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}},K_=(t,e)=>{if(wr(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error(\"Validation failed but no issues detected.\");return{success:!1,get error(){if(this._error)return this._error;let r=new Ze(t.common.issues);return this._error=r,this._error}}};function z(t){if(!t)return{};let{errorMap:e,invalid_type_error:r,required_error:n,description:i}=t;if(e&&(r||n))throw new Error(`Can't use \"invalid_type_error\" or \"required_error\" in conjunction with custom error map.`);return e?{errorMap:e,description:i}:{errorMap:(s,o)=>{let{message:u}=t;return s.code===\"invalid_enum_value\"?{message:u??o.defaultError}:typeof o.data>\"u\"?{message:u??n??o.defaultError}:s.code!==\"invalid_type\"?{message:o.defaultError}:{message:u??r??o.defaultError}},description:i}}var H=class{get description(){return this._def.description}_getType(e){return Ft(e.data)}_getOrReturnCtx(e,r){return r||{common:e.parent.common,data:e.data,parsedType:Ft(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Re,ctx:{common:e.parent.common,data:e.data,parsedType:Ft(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let r=this._parse(e);if(di(r))throw new Error(\"Synchronous parse encountered promise.\");return r}_parseAsync(e){let r=this._parse(e);return Promise.resolve(r)}parse(e,r){let n=this.safeParse(e,r);if(n.success)return n.data;throw n.error}safeParse(e,r){let n={common:{issues:[],async:r?.async??!1,contextualErrorMap:r?.errorMap},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ft(e)},i=this._parseSync({data:e,path:n.path,parent:n});return K_(n,i)}\"~validate\"(e){let r={common:{issues:[],async:!!this[\"~standard\"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ft(e)};if(!this[\"~standard\"].async)try{let n=this._parseSync({data:e,path:[],parent:r});return wr(n)?{value:n.value}:{issues:r.common.issues}}catch(n){n?.message?.toLowerCase()?.includes(\"encountered\")&&(this[\"~standard\"].async=!0),r.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:r}).then(n=>wr(n)?{value:n.value}:{issues:r.common.issues})}async parseAsync(e,r){let n=await this.safeParseAsync(e,r);if(n.success)return n.data;throw n.error}async safeParseAsync(e,r){let n={common:{issues:[],contextualErrorMap:r?.errorMap,async:!0},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ft(e)},i=this._parse({data:e,path:n.path,parent:n}),a=await(di(i)?i:Promise.resolve(i));return K_(n,a)}refine(e,r){let n=i=>typeof r==\"string\"||typeof r>\"u\"?{message:r}:typeof r==\"function\"?r(i):r;return this._refinement((i,a)=>{let s=e(i),o=()=>a.addIssue({code:_.custom,...n(i)});return typeof Promise<\"u\"&&s instanceof Promise?s.then(u=>u?!0:(o(),!1)):s?!0:(o(),!1)})}refinement(e,r){return this._refinement((n,i)=>e(n)?!0:(i.addIssue(typeof r==\"function\"?r(n,i):r),!1))}_refinement(e){return new bt({schema:this,typeName:M.ZodEffects,effect:{type:\"refinement\",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this[\"~standard\"]={version:1,vendor:\"zod\",validate:r=>this[\"~validate\"](r)}}optional(){return yt.create(this,this._def)}nullable(){return Ut.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return ar.create(this)}promise(){return Er.create(this,this._def)}or(e){return Yr.create([this,e],this._def)}and(e){return en.create(this,e,this._def)}transform(e){return new bt({...z(this._def),schema:this,typeName:M.ZodEffects,effect:{type:\"transform\",transform:e}})}default(e){let r=typeof e==\"function\"?e:()=>e;return new sn({...z(this._def),innerType:this,defaultValue:r,typeName:M.ZodDefault})}brand(){return new Da({typeName:M.ZodBranded,type:this,...z(this._def)})}catch(e){let r=typeof e==\"function\"?e:()=>e;return new on({...z(this._def),innerType:this,catchValue:r,typeName:M.ZodCatch})}describe(e){let r=this.constructor;return new r({...this._def,description:e})}pipe(e){return La.create(this,e)}readonly(){return cn.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}},GI=/^c[^\\s-]{8,}$/i,JI=/^[0-9a-z]+$/,ZI=/^[0-9A-HJKMNP-TV-Z]{26}$/i,XI=/^[0-9a-fA-F]{8}\\b-[0-9a-fA-F]{4}\\b-[0-9a-fA-F]{4}\\b-[0-9a-fA-F]{4}\\b-[0-9a-fA-F]{12}$/i,YI=/^[a-z0-9_-]{21}$/i,e9=/^[A-Za-z0-9-_]+\\.[A-Za-z0-9-_]+\\.[A-Za-z0-9-_]*$/,t9=/^[-+]?P(?!$)(?:(?:[-+]?\\d+Y)|(?:[-+]?\\d+[.,]\\d+Y$))?(?:(?:[-+]?\\d+M)|(?:[-+]?\\d+[.,]\\d+M$))?(?:(?:[-+]?\\d+W)|(?:[-+]?\\d+[.,]\\d+W$))?(?:(?:[-+]?\\d+D)|(?:[-+]?\\d+[.,]\\d+D$))?(?:T(?=[\\d+-])(?:(?:[-+]?\\d+H)|(?:[-+]?\\d+[.,]\\d+H$))?(?:(?:[-+]?\\d+M)|(?:[-+]?\\d+[.,]\\d+M$))?(?:[-+]?\\d+(?:[.,]\\d+)?S)?)??$/,r9=/^(?!\\.)(?!.*\\.\\.)([A-Z0-9_'+\\-\\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\\-]*\\.)+[A-Z]{2,}$/i,n9=\"^(\\\\p{Extended_Pictographic}|\\\\p{Emoji_Component})+$\",Uf,i9=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,a9=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\\/(3[0-2]|[12]?[0-9])$/,s9=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,o9=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,c9=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,u9=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,G_=\"((\\\\d\\\\d[2468][048]|\\\\d\\\\d[13579][26]|\\\\d\\\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\\\d|30)|(02)-(0[1-9]|1\\\\d|2[0-8])))\",l9=new RegExp(`^${G_}$`);function J_(t){let e=\"[0-5]\\\\d\";t.precision?e=`${e}\\\\.\\\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\\\.\\\\d+)?`);let r=t.precision?\"+\":\"?\";return`([01]\\\\d|2[0-3]):[0-5]\\\\d(:${e})${r}`}function p9(t){return new RegExp(`^${J_(t)}$`)}function Z_(t){let e=`${G_}T${J_(t)}`,r=[];return r.push(t.local?\"Z?\":\"Z\"),t.offset&&r.push(\"([+-]\\\\d{2}:?\\\\d{2})\"),e=`${e}(${r.join(\"|\")})`,new RegExp(`^${e}$`)}function d9(t,e){return!!((e===\"v4\"||!e)&&i9.test(t)||(e===\"v6\"||!e)&&s9.test(t))}function f9(t,e){if(!e9.test(t))return!1;try{let[r]=t.split(\".\");if(!r)return!1;let n=r.replace(/-/g,\"+\").replace(/_/g,\"/\").padEnd(r.length+(4-r.length%4)%4,\"=\"),i=JSON.parse(atob(n));return!(typeof i!=\"object\"||i===null||\"typ\"in i&&i?.typ!==\"JWT\"||!i.alg||e&&i.alg!==e)}catch{return!1}}function h9(t,e){return!!((e===\"v4\"||!e)&&a9.test(t)||(e===\"v6\"||!e)&&o9.test(t))}var _r=class t extends H{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==P.string){let a=this._getOrReturnCtx(e);return k(a,{code:_.invalid_type,expected:P.string,received:a.parsedType}),D}let n=new Re,i;for(let a of this._def.checks)if(a.kind===\"min\")e.data.length<a.value&&(i=this._getOrReturnCtx(e,i),k(i,{code:_.too_small,minimum:a.value,type:\"string\",inclusive:!0,exact:!1,message:a.message}),n.dirty());else if(a.kind===\"max\")e.data.length>a.value&&(i=this._getOrReturnCtx(e,i),k(i,{code:_.too_big,maximum:a.value,type:\"string\",inclusive:!0,exact:!1,message:a.message}),n.dirty());else if(a.kind===\"length\"){let s=e.data.length>a.value,o=e.data.length<a.value;(s||o)&&(i=this._getOrReturnCtx(e,i),s?k(i,{code:_.too_big,maximum:a.value,type:\"string\",inclusive:!0,exact:!0,message:a.message}):o&&k(i,{code:_.too_small,minimum:a.value,type:\"string\",inclusive:!0,exact:!0,message:a.message}),n.dirty())}else if(a.kind===\"email\")r9.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"email\",code:_.invalid_string,message:a.message}),n.dirty());else if(a.kind===\"emoji\")Uf||(Uf=new RegExp(n9,\"u\")),Uf.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"emoji\",code:_.invalid_string,message:a.message}),n.dirty());else if(a.kind===\"uuid\")XI.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"uuid\",code:_.invalid_string,message:a.message}),n.dirty());else if(a.kind===\"nanoid\")YI.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"nanoid\",code:_.invalid_string,message:a.message}),n.dirty());else if(a.kind===\"cuid\")GI.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"cuid\",code:_.invalid_string,message:a.message}),n.dirty());else if(a.kind===\"cuid2\")JI.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"cuid2\",code:_.invalid_string,message:a.message}),n.dirty());else if(a.kind===\"ulid\")ZI.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"ulid\",code:_.invalid_string,message:a.message}),n.dirty());else if(a.kind===\"url\")try{new URL(e.data)}catch{i=this._getOrReturnCtx(e,i),k(i,{validation:\"url\",code:_.invalid_string,message:a.message}),n.dirty()}else a.kind===\"regex\"?(a.regex.lastIndex=0,a.regex.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"regex\",code:_.invalid_string,message:a.message}),n.dirty())):a.kind===\"trim\"?e.data=e.data.trim():a.kind===\"includes\"?e.data.includes(a.value,a.position)||(i=this._getOrReturnCtx(e,i),k(i,{code:_.invalid_string,validation:{includes:a.value,position:a.position},message:a.message}),n.dirty()):a.kind===\"toLowerCase\"?e.data=e.data.toLowerCase():a.kind===\"toUpperCase\"?e.data=e.data.toUpperCase():a.kind===\"startsWith\"?e.data.startsWith(a.value)||(i=this._getOrReturnCtx(e,i),k(i,{code:_.invalid_string,validation:{startsWith:a.value},message:a.message}),n.dirty()):a.kind===\"endsWith\"?e.data.endsWith(a.value)||(i=this._getOrReturnCtx(e,i),k(i,{code:_.invalid_string,validation:{endsWith:a.value},message:a.message}),n.dirty()):a.kind===\"datetime\"?Z_(a).test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{code:_.invalid_string,validation:\"datetime\",message:a.message}),n.dirty()):a.kind===\"date\"?l9.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{code:_.invalid_string,validation:\"date\",message:a.message}),n.dirty()):a.kind===\"time\"?p9(a).test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{code:_.invalid_string,validation:\"time\",message:a.message}),n.dirty()):a.kind===\"duration\"?t9.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"duration\",code:_.invalid_string,message:a.message}),n.dirty()):a.kind===\"ip\"?d9(e.data,a.version)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"ip\",code:_.invalid_string,message:a.message}),n.dirty()):a.kind===\"jwt\"?f9(e.data,a.alg)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"jwt\",code:_.invalid_string,message:a.message}),n.dirty()):a.kind===\"cidr\"?h9(e.data,a.version)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"cidr\",code:_.invalid_string,message:a.message}),n.dirty()):a.kind===\"base64\"?c9.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"base64\",code:_.invalid_string,message:a.message}),n.dirty()):a.kind===\"base64url\"?u9.test(e.data)||(i=this._getOrReturnCtx(e,i),k(i,{validation:\"base64url\",code:_.invalid_string,message:a.message}),n.dirty()):K.assertNever(a);return{status:n.value,value:e.data}}_regex(e,r,n){return this.refinement(i=>e.test(i),{validation:r,code:_.invalid_string,...q.errToObj(n)})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:\"email\",...q.errToObj(e)})}url(e){return this._addCheck({kind:\"url\",...q.errToObj(e)})}emoji(e){return this._addCheck({kind:\"emoji\",...q.errToObj(e)})}uuid(e){return this._addCheck({kind:\"uuid\",...q.errToObj(e)})}nanoid(e){return this._addCheck({kind:\"nanoid\",...q.errToObj(e)})}cuid(e){return this._addCheck({kind:\"cuid\",...q.errToObj(e)})}cuid2(e){return this._addCheck({kind:\"cuid2\",...q.errToObj(e)})}ulid(e){return this._addCheck({kind:\"ulid\",...q.errToObj(e)})}base64(e){return this._addCheck({kind:\"base64\",...q.errToObj(e)})}base64url(e){return this._addCheck({kind:\"base64url\",...q.errToObj(e)})}jwt(e){return this._addCheck({kind:\"jwt\",...q.errToObj(e)})}ip(e){return this._addCheck({kind:\"ip\",...q.errToObj(e)})}cidr(e){return this._addCheck({kind:\"cidr\",...q.errToObj(e)})}datetime(e){return typeof e==\"string\"?this._addCheck({kind:\"datetime\",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:\"datetime\",precision:typeof e?.precision>\"u\"?null:e?.precision,offset:e?.offset??!1,local:e?.local??!1,...q.errToObj(e?.message)})}date(e){return this._addCheck({kind:\"date\",message:e})}time(e){return typeof e==\"string\"?this._addCheck({kind:\"time\",precision:null,message:e}):this._addCheck({kind:\"time\",precision:typeof e?.precision>\"u\"?null:e?.precision,...q.errToObj(e?.message)})}duration(e){return this._addCheck({kind:\"duration\",...q.errToObj(e)})}regex(e,r){return this._addCheck({kind:\"regex\",regex:e,...q.errToObj(r)})}includes(e,r){return this._addCheck({kind:\"includes\",value:e,position:r?.position,...q.errToObj(r?.message)})}startsWith(e,r){return this._addCheck({kind:\"startsWith\",value:e,...q.errToObj(r)})}endsWith(e,r){return this._addCheck({kind:\"endsWith\",value:e,...q.errToObj(r)})}min(e,r){return this._addCheck({kind:\"min\",value:e,...q.errToObj(r)})}max(e,r){return this._addCheck({kind:\"max\",value:e,...q.errToObj(r)})}length(e,r){return this._addCheck({kind:\"length\",value:e,...q.errToObj(r)})}nonempty(e){return this.min(1,q.errToObj(e))}trim(){return new t({...this._def,checks:[...this._def.checks,{kind:\"trim\"}]})}toLowerCase(){return new t({...this._def,checks:[...this._def.checks,{kind:\"toLowerCase\"}]})}toUpperCase(){return new t({...this._def,checks:[...this._def.checks,{kind:\"toUpperCase\"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind===\"datetime\")}get isDate(){return!!this._def.checks.find(e=>e.kind===\"date\")}get isTime(){return!!this._def.checks.find(e=>e.kind===\"time\")}get isDuration(){return!!this._def.checks.find(e=>e.kind===\"duration\")}get isEmail(){return!!this._def.checks.find(e=>e.kind===\"email\")}get isURL(){return!!this._def.checks.find(e=>e.kind===\"url\")}get isEmoji(){return!!this._def.checks.find(e=>e.kind===\"emoji\")}get isUUID(){return!!this._def.checks.find(e=>e.kind===\"uuid\")}get isNANOID(){return!!this._def.checks.find(e=>e.kind===\"nanoid\")}get isCUID(){return!!this._def.checks.find(e=>e.kind===\"cuid\")}get isCUID2(){return!!this._def.checks.find(e=>e.kind===\"cuid2\")}get isULID(){return!!this._def.checks.find(e=>e.kind===\"ulid\")}get isIP(){return!!this._def.checks.find(e=>e.kind===\"ip\")}get isCIDR(){return!!this._def.checks.find(e=>e.kind===\"cidr\")}get isBase64(){return!!this._def.checks.find(e=>e.kind===\"base64\")}get isBase64url(){return!!this._def.checks.find(e=>e.kind===\"base64url\")}get minLength(){let e=null;for(let r of this._def.checks)r.kind===\"min\"&&(e===null||r.value>e)&&(e=r.value);return e}get maxLength(){let e=null;for(let r of this._def.checks)r.kind===\"max\"&&(e===null||r.value<e)&&(e=r.value);return e}};_r.create=t=>new _r({checks:[],typeName:M.ZodString,coerce:t?.coerce??!1,...z(t)});function m9(t,e){let r=(t.toString().split(\".\")[1]||\"\").length,n=(e.toString().split(\".\")[1]||\"\").length,i=r>n?r:n,a=Number.parseInt(t.toFixed(i).replace(\".\",\"\")),s=Number.parseInt(e.toFixed(i).replace(\".\",\"\"));return a%s/10**i}var Kr=class t extends H{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==P.number){let a=this._getOrReturnCtx(e);return k(a,{code:_.invalid_type,expected:P.number,received:a.parsedType}),D}let n,i=new Re;for(let a of this._def.checks)a.kind===\"int\"?K.isInteger(e.data)||(n=this._getOrReturnCtx(e,n),k(n,{code:_.invalid_type,expected:\"integer\",received:\"float\",message:a.message}),i.dirty()):a.kind===\"min\"?(a.inclusive?e.data<a.value:e.data<=a.value)&&(n=this._getOrReturnCtx(e,n),k(n,{code:_.too_small,minimum:a.value,type:\"number\",inclusive:a.inclusive,exact:!1,message:a.message}),i.dirty()):a.kind===\"max\"?(a.inclusive?e.data>a.value:e.data>=a.value)&&(n=this._getOrReturnCtx(e,n),k(n,{code:_.too_big,maximum:a.value,type:\"number\",inclusive:a.inclusive,exact:!1,message:a.message}),i.dirty()):a.kind===\"multipleOf\"?m9(e.data,a.value)!==0&&(n=this._getOrReturnCtx(e,n),k(n,{code:_.not_multiple_of,multipleOf:a.value,message:a.message}),i.dirty()):a.kind===\"finite\"?Number.isFinite(e.data)||(n=this._getOrReturnCtx(e,n),k(n,{code:_.not_finite,message:a.message}),i.dirty()):K.assertNever(a);return{status:i.value,value:e.data}}gte(e,r){return this.setLimit(\"min\",e,!0,q.toString(r))}gt(e,r){return this.setLimit(\"min\",e,!1,q.toString(r))}lte(e,r){return this.setLimit(\"max\",e,!0,q.toString(r))}lt(e,r){return this.setLimit(\"max\",e,!1,q.toString(r))}setLimit(e,r,n,i){return new t({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:n,message:q.toString(i)}]})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:\"int\",message:q.toString(e)})}positive(e){return this._addCheck({kind:\"min\",value:0,inclusive:!1,message:q.toString(e)})}negative(e){return this._addCheck({kind:\"max\",value:0,inclusive:!1,message:q.toString(e)})}nonpositive(e){return this._addCheck({kind:\"max\",value:0,inclusive:!0,message:q.toString(e)})}nonnegative(e){return this._addCheck({kind:\"min\",value:0,inclusive:!0,message:q.toString(e)})}multipleOf(e,r){return this._addCheck({kind:\"multipleOf\",value:e,message:q.toString(r)})}finite(e){return this._addCheck({kind:\"finite\",message:q.toString(e)})}safe(e){return this._addCheck({kind:\"min\",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:q.toString(e)})._addCheck({kind:\"max\",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:q.toString(e)})}get minValue(){let e=null;for(let r of this._def.checks)r.kind===\"min\"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(let r of this._def.checks)r.kind===\"max\"&&(e===null||r.value<e)&&(e=r.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind===\"int\"||e.kind===\"multipleOf\"&&K.isInteger(e.value))}get isFinite(){let e=null,r=null;for(let n of this._def.checks){if(n.kind===\"finite\"||n.kind===\"int\"||n.kind===\"multipleOf\")return!0;n.kind===\"min\"?(r===null||n.value>r)&&(r=n.value):n.kind===\"max\"&&(e===null||n.value<e)&&(e=n.value)}return Number.isFinite(r)&&Number","attributes":{"level":"error"},"tags":{"project":"29c6c2c4-ea10-4fe6-8901-1198a13520db","environment":"9a47f9fb-0d50-4031-a85e-16db1d46fb86","service":"09a1965e-88d6-44ee-9836-14176d4bb0b5","deployment":"e78c90dd-bc00-48f5-9312-8a8fa977b2c2","replica":"68b779c1-91b1-4ca6-88f4-a907899be5f1"},"timestamp":"2026-01-29T21:35:15.857282541Z"}]